{"pageProps":{"post":{"title":"HTML5 캔버스를 사용하여 픽셀 완벽한 그래픽 만들기 방법","description":"","date":"2024-06-20 06:07","slug":"2024-06-20-HowtoCreatePixelPerfectGraphicsUsingHTML5Canvas","content":"\n\n진짜 8비트 시각을 위한 캔버스 그래픽 마스터링 단계별 안내서입니다.\n\n이 포스트에서는 픽셀 완벽한 웹 게임을 만들기 위한 기반을 구축할 것입니다. \"픽셀 완벽\"이란 모든 픽셀이 선명하고 흐릿하지 않다는 것을 의미합니다. 이 자습서를 완료하면 픽셀화된 별 배경 위에 두 개의 이동하는 직사각형을 애니메이션하는 단일 HTML 파일이 생깁니다.\n\n다음 세 단계로 진행하겠습니다:\n\n1. 캔버스가 올바르게 크기 조정되는 기본 HTML 구조 설정\n\n<div class=\"content-ad\"></div>\n\n# 직사각형과 별을 그려보세요\n\n# 이미지 흐림 방지, 모든 픽셀을 선명하게 설정\n\n# 크기 조절 가능한 캔버스\n\n한 가지 HTML5 캔버스를 가진 간단한 HTML 페이지를 만들 것입니다. 이 캔버스는 브라우저 창 크기가 변경될 때 동적으로 크기가 조정됩니다. 정수 스케일링 상수를 사용하여 스케일링이 균일한 픽셀 크기를 유지하는지 제어할 수 있습니다. 정수 스케일링을 true로 설정하면 모든 픽셀이 동일한 크기를 유지합니다. 단점은 정수 스케일링으로 인해 일부 브라우저 창 크기에 따라 캔버스 주변에 더 큰 테두리가 생길 수 있다는 점입니다.\n\n<div class=\"content-ad\"></div>\n\n```js\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>빈 크기 조절 캔버스</title>\n    <style>\n      html,\n      body {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 100%;\n        margin: 0;\n        background-color: #887ecb;\n      }\n    \n      .canvas-container {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        width: 100%;\n        height: 100%;\n      }\n\n      #gameCanvas {\n        background-color: #50459b;\n        max-width: 100%;\n        max-height: 100%;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"canvas-container\">\n      <canvas id=\"gameCanvas\" width=\"64\" height=\"36\"></canvas>\n    </div>\n    <script>\n      const INTEGER_SCALING = true;\n\n      const canvas = document.getElementById(\"gameCanvas\");\n\n      function resizeCanvas() {\n        let scale = Math.min(\n          window.innerWidth / canvas.width,\n          window.innerHeight / canvas.height\n        );\n        if (INTEGER_SCALING) {\n          scale = Math.floor(scale);\n        }\n        canvas.style.width = `${Math.round(scale * canvas.width)}px`;\n        canvas.style.height = `${Math.round(scale * canvas.height)}px`;\n      }\n\n      resizeCanvas();\n      window.addEventListener(\"resize\", resizeCanvas);\n    </script>\n  </body>\n</html>\n```\n\n위 코드의 주요 포인트는 크기 조절 이벤트에 등록하고 이벤트가 발생할 때마다 페이지의 캔버스 크기를 변경하는 것입니다. 스케일은 내부 캔버스 크기가 화면에 가장 적은 수의 배에 맞도록 계산됩니다. 이는 다른 방향으로 테두리를 유발할 수 있지만 내부 캔버스 크기의 종횡비를 유지합니다.\n\n창의 크기를 조정하면 캔버스 크기가 변경되는 것을 확인할 수 있습니다. 또한 INTEGER_SCALING 값을 false로 변경하여 캔버스가 항상 창을 가로 또는 세로로 채우는 방법을 확인해보세요.\n\n# 캔버스에 그리기\n\n\n<div class=\"content-ad\"></div>\n\n캔버스에 그리기 위해서는 먼저 캔버스의 컨텍스트를 가져와야 합니다. 투명한 픽셀을 남기지 않을 것이기 때문에 알파값을 false로 설정합니다.\n\n```js\nconst canvas = document.getElementById(\"gameCanvas\");\nconst ctx = canvas.getContext(\"2d\", { alpha: false });\n```\n\n간단하게 유지하기 위해 이 게시물에서는 사각형만 그릴 것입니다.\n\n```js\nfunction drawRectangle(x, y, width, height, color) {\n  ctx.fillStyle = color;\n  ctx.fillRect(x, y, width, height);\n}\n```\n\n<div class=\"content-ad\"></div>\n\n그럼 우리는 배경을 위해 200개의 별을 만듭니다. 별은 색에 따라 정렬되어 있으므로 덜 밝은 별이 더 밝은 별 위에 그려지지 않습니다.\n\n```js\nfunction createStar() {\n  const color = Math.floor(Math.random() * 256);\n  return {\n    x: Math.random() * canvas.width,\n    y: Math.random() * canvas.height,\n    color: color,\n    fillStyle: `rgb(${color}, ${color}, ${color})`,\n  }; \n}\n\nconst stars = Array.from({ length: 200 }, createStar).sort(\n  (a, b) => a.color - b.color\n);\n```\n\n우리는 requestAnimationFrame을 사용하여 게임 루프가 필요한 매 프레임마다 발생하도록 만듭니다. gameLoop이 호출될 속도는 \"일반적으로 디스플레이 새로고침 속도와 일치\"합니다. 많은 경우에 초당 60프레임인 경우가 많지만 다를 수도 있습니다. `now` 매개변수는 이전 프레임 렌더링의 밀리초를 나타냅니다. 애니메이션 중에 이 시간을 사용하는 것이 중요하며 일정한 프레임 속도를 가정하는 대신 해당 시간을 사용해야 합니다.\n\n```js\nfunction gameLoop(now) {\n  draw(now);\n  requestAnimationFrame(gameLoop);\n}\ngameLoop();\n```\n\n<div class=\"content-ad\"></div>\n\n이제 재미있는 부분이 시작됩니다 — 캔버스에 그림을 그리는 것! 이전 프레임의 그래픽을 지우기 위해 캔버스를 지우는 것으로 시작합니다. 그런 다음, 모든 별과 두 개의 사각형을 그리는데, 이는 일정한 사인 및 코사인 패턴에 따라 움직입니다.\n\n```js\nfunction draw(t) {\n  drawRectangle(0, 0, canvas.width, canvas.height, \"#000\");\n\n  stars.forEach((star) => {\n    drawRectangle(star.x, star.y, 1, 1, star.fillStyle);\n    star.x = (star.x - star.color / 5000 + canvas.width) % canvas.width;\n  });\n  drawRectangle(\n    canvas.width / 4,\n    canvas.height / 4 + (canvas.width / 10) * Math.sin(t / 500),\n    canvas.width / 2,\n    canvas.height / 2,\n    \"#008\"\n  );\n  drawRectangle(\n    canvas.width / 2 + (canvas.width / 4) * Math.cos(t / 1000) - 4,\n    canvas.height / 2 + (canvas.height / 4) * Math.sin(t / 1000) - 4,\n    8,\n    8,\n    \"#00c\"\n  );\n}\n```\n\n그리고 이렇게 보입니다.\n\n이 코드펜에서 실행 중인 애니메이션을 확인해보세요:\n\n<div class=\"content-ad\"></div>\n\n그게 많이 8-bit스럽지 않네요, 맞죠? 우리가 마주한 두 가지 문제는 스케일링할 때 픽셀 보간과 그릴 때 안티앨리어싱입니다.\n\n# Unblur\n\n## 픽셀 보간 끄기\n\n브라우저는 캔버스를 확대할 때 픽셀을 보간하고 있습니다. 이는 합리적인 표준 동작이지만 픽셀 그래픽에 적합하지 않습니다. 대신 css에서 픽셀화된 스케일링을 사용하도록 브라우저에 지시합니다:\n\n<div class=\"content-ad\"></div>\n\n```css\ncanvas {\n  background-color: #50459b;\n  max-width: 100%;\n  max-height: 100%;\n  image-rendering: pixelated;\n}\n```\n\n## 안티앨리어싱 피하기\n\n또 다른 흐림 현상을 일으키는 문제는 정수가 아닌 값을 그릴 때 발생합니다. 별이 픽셀 사이에 위치할 때 브라우저는 일관성있게 만들려고 노력합니다. 해결책은 간단합니다. 우리는 좌표를 모두 정수로 반올림하면 됩니다. 이 해결책을 drawRectangle 함수에 넣어서 어디서든 무언가를 그릴 때마다 생각할 필요가 없게 만듭니다:\n\n```js\nfunction drawRectangle(x, y, width, height, color) {\n  ctx.fillStyle = color;\n  ctx.fillRect(\n    Math.round(x),\n    Math.round(y),\n    Math.round(width),\n    Math.round(height)\n  );\n}\n```\n\n<div class=\"content-ad\"></div>\n\n다음은 정리된 버전에 대한 코드펜입니다:\n\n여기 정리된 버전에 대한 전체 소스입니다:\n\n```js\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Pixel perfect canvas</title>\n    <style>\n      html,\n      body {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 100%;\n        margin: 0;\n        background-color: #887ecb;\n      }\n\n      .canvas-container {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        width: 100%;\n        height: 100%;\n      }\n\n      canvas {\n        background-color: #50459b;\n        max-width: 100%;\n        max-height: 100%;\n        image-rendering: pixelated;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"canvas-container\">\n      <canvas id=\"gameCanvas\" width=\"64\" height=\"36\"></canvas>\n    </div>\n    <script>\n      const INTEGER_SCALING = true;\n\n      const canvas = document.getElementById(\"gameCanvas\");\n      const ctx = canvas.getContext(\"2d\");\n\n      function createStar() {\n        const color = Math.floor(Math.random() * 256);\n        return {\n          x: Math.random() * canvas.width,\n          y: Math.random() * canvas.height,\n          color: color,\n          fillStyle: `rgb(${color}, ${color}, ${color})`,\n        };\n      }\n\n      const stars = Array.from({ length: 200 }, createStar).sort(\n        (a, b) => a.color - b.color\n      );\n\n      function resizeCanvas() {\n        let scale = Math.min(\n          window.innerWidth / canvas.width,\n          window.innerHeight / canvas.height\n        );\n        if (INTEGER_SCALING) {\n          scale = Math.floor(scale);\n        }\n        canvas.style.width = `${Math.round(scale * canvas.width)}px`;\n        canvas.style.height = `${Math.round(scale * canvas.height)}px`;\n      }\n\n      function drawRectangle(x, y, width, height, color) {\n        ctx.fillStyle = color;\n        ctx.fillRect(\n          Math.round(x),\n          Math.round(y),\n          Math.round(width),\n          Math.round(height)\n        );\n      }\n\n      function gameLoop(now) {\n        draw(now);\n        requestAnimationFrame(gameLoop);\n      }\n\n      function draw(t) {\n        drawRectangle(0, 0, canvas.width, canvas.height, \"#000\");\n\n        stars.forEach((star) => {\n          drawRectangle(star.x, star.y, 1, 1, star.fillStyle);\n          star.x = (star.x - star.color / 5000 + canvas.width) % canvas.width;\n        });\n        drawRectangle(\n          canvas.width / 4,\n          canvas.height / 4 + (canvas.width / 10) * Math.sin(t / 500),\n          canvas.width / 2,\n          canvas.height / 2,\n          \"#008\"\n        );\n        drawRectangle(\n          canvas.width / 2 + (canvas.width / 4) * Math.cos(t / 1000) - 4,\n          canvas.height / 2 + (canvas.height / 4) * Math.sin(t / 1000) - 4,\n          8,\n          8,\n          \"#00c\"\n        );\n      }\n\n      resizeCanvas();\n      window.addEventListener(\"resize\", resizeCanvas);\n      gameLoop();\n    </script>\n  </body>\n</html>\n```\n\n<div class=\"content-ad\"></div>\n\n이제 기초가 마련되었습니다 - 브라우저에서 픽셀 완벽한 그래픽을 애니메이트할 수 있는 코드 조각이 있습니다! 다음에는 몇 가지 스프라이트를 애니메이션화할 것입니다!","ogImage":{"url":"/assets/img/2024-06-20-HowtoCreatePixelPerfectGraphicsUsingHTML5Canvas_0.png"},"coverImage":"/assets/img/2024-06-20-HowtoCreatePixelPerfectGraphicsUsingHTML5Canvas_0.png","tag":["Tech"],"readingTime":9},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>진짜 8비트 시각을 위한 캔버스 그래픽 마스터링 단계별 안내서입니다.</p>\n<p>이 포스트에서는 픽셀 완벽한 웹 게임을 만들기 위한 기반을 구축할 것입니다. \"픽셀 완벽\"이란 모든 픽셀이 선명하고 흐릿하지 않다는 것을 의미합니다. 이 자습서를 완료하면 픽셀화된 별 배경 위에 두 개의 이동하는 직사각형을 애니메이션하는 단일 HTML 파일이 생깁니다.</p>\n<p>다음 세 단계로 진행하겠습니다:</p>\n<ol>\n<li>캔버스가 올바르게 크기 조정되는 기본 HTML 구조 설정</li>\n</ol>\n<h1>직사각형과 별을 그려보세요</h1>\n<h1>이미지 흐림 방지, 모든 픽셀을 선명하게 설정</h1>\n<h1>크기 조절 가능한 캔버스</h1>\n<p>한 가지 HTML5 캔버스를 가진 간단한 HTML 페이지를 만들 것입니다. 이 캔버스는 브라우저 창 크기가 변경될 때 동적으로 크기가 조정됩니다. 정수 스케일링 상수를 사용하여 스케일링이 균일한 픽셀 크기를 유지하는지 제어할 수 있습니다. 정수 스케일링을 true로 설정하면 모든 픽셀이 동일한 크기를 유지합니다. 단점은 정수 스케일링으로 인해 일부 브라우저 창 크기에 따라 캔버스 주변에 더 큰 테두리가 생길 수 있다는 점입니다.</p>\n<pre><code class=\"hljs language-js\">&#x3C;!<span class=\"hljs-variable constant_\">DOCTYPE</span> html>\n<span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">html</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">\"en\"</span>></span>\n  <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">head</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">charset</span>=<span class=\"hljs-string\">\"UTF-8\"</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"viewport\"</span> <span class=\"hljs-attr\">content</span>=<span class=\"hljs-string\">\"width=device-width, initial-scale=1.0\"</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">title</span>></span>빈 크기 조절 캔버스<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">title</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">style</span>></span><span class=\"css\">\n      <span class=\"hljs-selector-tag\">html</span>,\n      <span class=\"hljs-selector-tag\">body</span> {\n        <span class=\"hljs-attribute\">display</span>: flex;\n        <span class=\"hljs-attribute\">justify-content</span>: center;\n        <span class=\"hljs-attribute\">align-items</span>: center;\n        <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">margin</span>: <span class=\"hljs-number\">0</span>;\n        <span class=\"hljs-attribute\">background-color</span>: <span class=\"hljs-number\">#887ecb</span>;\n      }\n    \n      <span class=\"hljs-selector-class\">.canvas-container</span> {\n        <span class=\"hljs-attribute\">display</span>: flex;\n        <span class=\"hljs-attribute\">justify-content</span>: center;\n        <span class=\"hljs-attribute\">align-items</span>: center;\n        <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">100%</span>;\n      }\n\n      <span class=\"hljs-selector-id\">#gameCanvas</span> {\n        <span class=\"hljs-attribute\">background-color</span>: <span class=\"hljs-number\">#50459b</span>;\n        <span class=\"hljs-attribute\">max-width</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">max-height</span>: <span class=\"hljs-number\">100%</span>;\n      }\n    </span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">style</span>></span>\n  <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">head</span>></span>\n  <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">body</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"canvas-container\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"gameCanvas\"</span> <span class=\"hljs-attr\">width</span>=<span class=\"hljs-string\">\"64\"</span> <span class=\"hljs-attr\">height</span>=<span class=\"hljs-string\">\"36\"</span>></span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">canvas</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">div</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">script</span>></span><span class=\"javascript\">\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">INTEGER_SCALING</span> = <span class=\"hljs-literal\">true</span>;\n\n      <span class=\"hljs-keyword\">const</span> canvas = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">\"gameCanvas\"</span>);\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">resizeCanvas</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">let</span> scale = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">min</span>(\n          <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">innerWidth</span> / canvas.<span class=\"hljs-property\">width</span>,\n          <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">innerHeight</span> / canvas.<span class=\"hljs-property\">height</span>\n        );\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable constant_\">INTEGER_SCALING</span>) {\n          scale = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>(scale);\n        }\n        canvas.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">width</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-built_in\">Math</span>.round(scale * canvas.width)}</span>px`</span>;\n        canvas.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">height</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-built_in\">Math</span>.round(scale * canvas.height)}</span>px`</span>;\n      }\n\n      <span class=\"hljs-title function_\">resizeCanvas</span>();\n      <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">\"resize\"</span>, resizeCanvas);\n    </span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">script</span>></span>\n  <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">body</span>></span>\n<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">html</span>></span></span>\n</code></pre>\n<p>위 코드의 주요 포인트는 크기 조절 이벤트에 등록하고 이벤트가 발생할 때마다 페이지의 캔버스 크기를 변경하는 것입니다. 스케일은 내부 캔버스 크기가 화면에 가장 적은 수의 배에 맞도록 계산됩니다. 이는 다른 방향으로 테두리를 유발할 수 있지만 내부 캔버스 크기의 종횡비를 유지합니다.</p>\n<p>창의 크기를 조정하면 캔버스 크기가 변경되는 것을 확인할 수 있습니다. 또한 INTEGER_SCALING 값을 false로 변경하여 캔버스가 항상 창을 가로 또는 세로로 채우는 방법을 확인해보세요.</p>\n<h1>캔버스에 그리기</h1>\n<p>캔버스에 그리기 위해서는 먼저 캔버스의 컨텍스트를 가져와야 합니다. 투명한 픽셀을 남기지 않을 것이기 때문에 알파값을 false로 설정합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> canvas = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">\"gameCanvas\"</span>);\n<span class=\"hljs-keyword\">const</span> ctx = canvas.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">\"2d\"</span>, { <span class=\"hljs-attr\">alpha</span>: <span class=\"hljs-literal\">false</span> });\n</code></pre>\n<p>간단하게 유지하기 위해 이 게시물에서는 사각형만 그릴 것입니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">drawRectangle</span>(<span class=\"hljs-params\">x, y, width, height, color</span>) {\n  ctx.<span class=\"hljs-property\">fillStyle</span> = color;\n  ctx.<span class=\"hljs-title function_\">fillRect</span>(x, y, width, height);\n}\n</code></pre>\n<p>그럼 우리는 배경을 위해 200개의 별을 만듭니다. 별은 색에 따라 정렬되어 있으므로 덜 밝은 별이 더 밝은 별 위에 그려지지 않습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createStar</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> color = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>(<span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * <span class=\"hljs-number\">256</span>);\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-attr\">x</span>: <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * canvas.<span class=\"hljs-property\">width</span>,\n    <span class=\"hljs-attr\">y</span>: <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * canvas.<span class=\"hljs-property\">height</span>,\n    <span class=\"hljs-attr\">color</span>: color,\n    <span class=\"hljs-attr\">fillStyle</span>: <span class=\"hljs-string\">`rgb(<span class=\"hljs-subst\">${color}</span>, <span class=\"hljs-subst\">${color}</span>, <span class=\"hljs-subst\">${color}</span>)`</span>,\n  }; \n}\n\n<span class=\"hljs-keyword\">const</span> stars = <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-title function_\">from</span>({ <span class=\"hljs-attr\">length</span>: <span class=\"hljs-number\">200</span> }, createStar).<span class=\"hljs-title function_\">sort</span>(\n  <span class=\"hljs-function\">(<span class=\"hljs-params\">a, b</span>) =></span> a.<span class=\"hljs-property\">color</span> - b.<span class=\"hljs-property\">color</span>\n);\n</code></pre>\n<p>우리는 requestAnimationFrame을 사용하여 게임 루프가 필요한 매 프레임마다 발생하도록 만듭니다. gameLoop이 호출될 속도는 \"일반적으로 디스플레이 새로고침 속도와 일치\"합니다. 많은 경우에 초당 60프레임인 경우가 많지만 다를 수도 있습니다. <code>now</code> 매개변수는 이전 프레임 렌더링의 밀리초를 나타냅니다. 애니메이션 중에 이 시간을 사용하는 것이 중요하며 일정한 프레임 속도를 가정하는 대신 해당 시간을 사용해야 합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">gameLoop</span>(<span class=\"hljs-params\">now</span>) {\n  <span class=\"hljs-title function_\">draw</span>(now);\n  <span class=\"hljs-title function_\">requestAnimationFrame</span>(gameLoop);\n}\n<span class=\"hljs-title function_\">gameLoop</span>();\n</code></pre>\n<p>이제 재미있는 부분이 시작됩니다 — 캔버스에 그림을 그리는 것! 이전 프레임의 그래픽을 지우기 위해 캔버스를 지우는 것으로 시작합니다. 그런 다음, 모든 별과 두 개의 사각형을 그리는데, 이는 일정한 사인 및 코사인 패턴에 따라 움직입니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">draw</span>(<span class=\"hljs-params\">t</span>) {\n  <span class=\"hljs-title function_\">drawRectangle</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, canvas.<span class=\"hljs-property\">width</span>, canvas.<span class=\"hljs-property\">height</span>, <span class=\"hljs-string\">\"#000\"</span>);\n\n  stars.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">star</span>) =></span> {\n    <span class=\"hljs-title function_\">drawRectangle</span>(star.<span class=\"hljs-property\">x</span>, star.<span class=\"hljs-property\">y</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, star.<span class=\"hljs-property\">fillStyle</span>);\n    star.<span class=\"hljs-property\">x</span> = (star.<span class=\"hljs-property\">x</span> - star.<span class=\"hljs-property\">color</span> / <span class=\"hljs-number\">5000</span> + canvas.<span class=\"hljs-property\">width</span>) % canvas.<span class=\"hljs-property\">width</span>;\n  });\n  <span class=\"hljs-title function_\">drawRectangle</span>(\n    canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">4</span>,\n    canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">4</span> + (canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">10</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">sin</span>(t / <span class=\"hljs-number\">500</span>),\n    canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">2</span>,\n    canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">2</span>,\n    <span class=\"hljs-string\">\"#008\"</span>\n  );\n  <span class=\"hljs-title function_\">drawRectangle</span>(\n    canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">2</span> + (canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">4</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">cos</span>(t / <span class=\"hljs-number\">1000</span>) - <span class=\"hljs-number\">4</span>,\n    canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">2</span> + (canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">4</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">sin</span>(t / <span class=\"hljs-number\">1000</span>) - <span class=\"hljs-number\">4</span>,\n    <span class=\"hljs-number\">8</span>,\n    <span class=\"hljs-number\">8</span>,\n    <span class=\"hljs-string\">\"#00c\"</span>\n  );\n}\n</code></pre>\n<p>그리고 이렇게 보입니다.</p>\n<p>이 코드펜에서 실행 중인 애니메이션을 확인해보세요:</p>\n<p>그게 많이 8-bit스럽지 않네요, 맞죠? 우리가 마주한 두 가지 문제는 스케일링할 때 픽셀 보간과 그릴 때 안티앨리어싱입니다.</p>\n<h1>Unblur</h1>\n<h2>픽셀 보간 끄기</h2>\n<p>브라우저는 캔버스를 확대할 때 픽셀을 보간하고 있습니다. 이는 합리적인 표준 동작이지만 픽셀 그래픽에 적합하지 않습니다. 대신 css에서 픽셀화된 스케일링을 사용하도록 브라우저에 지시합니다:</p>\n<pre><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">canvas</span> {\n  <span class=\"hljs-attribute\">background-color</span>: <span class=\"hljs-number\">#50459b</span>;\n  <span class=\"hljs-attribute\">max-width</span>: <span class=\"hljs-number\">100%</span>;\n  <span class=\"hljs-attribute\">max-height</span>: <span class=\"hljs-number\">100%</span>;\n  <span class=\"hljs-attribute\">image-rendering</span>: pixelated;\n}\n</code></pre>\n<h2>안티앨리어싱 피하기</h2>\n<p>또 다른 흐림 현상을 일으키는 문제는 정수가 아닌 값을 그릴 때 발생합니다. 별이 픽셀 사이에 위치할 때 브라우저는 일관성있게 만들려고 노력합니다. 해결책은 간단합니다. 우리는 좌표를 모두 정수로 반올림하면 됩니다. 이 해결책을 drawRectangle 함수에 넣어서 어디서든 무언가를 그릴 때마다 생각할 필요가 없게 만듭니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">drawRectangle</span>(<span class=\"hljs-params\">x, y, width, height, color</span>) {\n  ctx.<span class=\"hljs-property\">fillStyle</span> = color;\n  ctx.<span class=\"hljs-title function_\">fillRect</span>(\n    <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(x),\n    <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(y),\n    <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(width),\n    <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(height)\n  );\n}\n</code></pre>\n<p>다음은 정리된 버전에 대한 코드펜입니다:</p>\n<p>여기 정리된 버전에 대한 전체 소스입니다:</p>\n<pre><code class=\"hljs language-js\">&#x3C;!<span class=\"hljs-variable constant_\">DOCTYPE</span> html>\n<span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">html</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">\"en\"</span>></span>\n  <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">head</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">charset</span>=<span class=\"hljs-string\">\"UTF-8\"</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"viewport\"</span> <span class=\"hljs-attr\">content</span>=<span class=\"hljs-string\">\"width=device-width, initial-scale=1.0\"</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">title</span>></span>Pixel perfect canvas<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">title</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">style</span>></span><span class=\"css\">\n      <span class=\"hljs-selector-tag\">html</span>,\n      <span class=\"hljs-selector-tag\">body</span> {\n        <span class=\"hljs-attribute\">display</span>: flex;\n        <span class=\"hljs-attribute\">justify-content</span>: center;\n        <span class=\"hljs-attribute\">align-items</span>: center;\n        <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">margin</span>: <span class=\"hljs-number\">0</span>;\n        <span class=\"hljs-attribute\">background-color</span>: <span class=\"hljs-number\">#887ecb</span>;\n      }\n\n      <span class=\"hljs-selector-class\">.canvas-container</span> {\n        <span class=\"hljs-attribute\">display</span>: flex;\n        <span class=\"hljs-attribute\">justify-content</span>: center;\n        <span class=\"hljs-attribute\">align-items</span>: center;\n        <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">100%</span>;\n      }\n\n      <span class=\"hljs-selector-tag\">canvas</span> {\n        <span class=\"hljs-attribute\">background-color</span>: <span class=\"hljs-number\">#50459b</span>;\n        <span class=\"hljs-attribute\">max-width</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">max-height</span>: <span class=\"hljs-number\">100%</span>;\n        <span class=\"hljs-attribute\">image-rendering</span>: pixelated;\n      }\n    </span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">style</span>></span>\n  <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">head</span>></span>\n  <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">body</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"canvas-container\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"gameCanvas\"</span> <span class=\"hljs-attr\">width</span>=<span class=\"hljs-string\">\"64\"</span> <span class=\"hljs-attr\">height</span>=<span class=\"hljs-string\">\"36\"</span>></span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">canvas</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">div</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">script</span>></span><span class=\"javascript\">\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">INTEGER_SCALING</span> = <span class=\"hljs-literal\">true</span>;\n\n      <span class=\"hljs-keyword\">const</span> canvas = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">\"gameCanvas\"</span>);\n      <span class=\"hljs-keyword\">const</span> ctx = canvas.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">\"2d\"</span>);\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createStar</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">const</span> color = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>(<span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * <span class=\"hljs-number\">256</span>);\n        <span class=\"hljs-keyword\">return</span> {\n          <span class=\"hljs-attr\">x</span>: <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * canvas.<span class=\"hljs-property\">width</span>,\n          <span class=\"hljs-attr\">y</span>: <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">random</span>() * canvas.<span class=\"hljs-property\">height</span>,\n          <span class=\"hljs-attr\">color</span>: color,\n          <span class=\"hljs-attr\">fillStyle</span>: <span class=\"hljs-string\">`rgb(<span class=\"hljs-subst\">${color}</span>, <span class=\"hljs-subst\">${color}</span>, <span class=\"hljs-subst\">${color}</span>)`</span>,\n        };\n      }\n\n      <span class=\"hljs-keyword\">const</span> stars = <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-title function_\">from</span>({ <span class=\"hljs-attr\">length</span>: <span class=\"hljs-number\">200</span> }, createStar).<span class=\"hljs-title function_\">sort</span>(\n        <span class=\"hljs-function\">(<span class=\"hljs-params\">a, b</span>) =></span> a.<span class=\"hljs-property\">color</span> - b.<span class=\"hljs-property\">color</span>\n      );\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">resizeCanvas</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">let</span> scale = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">min</span>(\n          <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">innerWidth</span> / canvas.<span class=\"hljs-property\">width</span>,\n          <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">innerHeight</span> / canvas.<span class=\"hljs-property\">height</span>\n        );\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable constant_\">INTEGER_SCALING</span>) {\n          scale = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>(scale);\n        }\n        canvas.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">width</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-built_in\">Math</span>.round(scale * canvas.width)}</span>px`</span>;\n        canvas.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">height</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-built_in\">Math</span>.round(scale * canvas.height)}</span>px`</span>;\n      }\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">drawRectangle</span>(<span class=\"hljs-params\">x, y, width, height, color</span>) {\n        ctx.<span class=\"hljs-property\">fillStyle</span> = color;\n        ctx.<span class=\"hljs-title function_\">fillRect</span>(\n          <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(x),\n          <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(y),\n          <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(width),\n          <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">round</span>(height)\n        );\n      }\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">gameLoop</span>(<span class=\"hljs-params\">now</span>) {\n        <span class=\"hljs-title function_\">draw</span>(now);\n        <span class=\"hljs-title function_\">requestAnimationFrame</span>(gameLoop);\n      }\n\n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">draw</span>(<span class=\"hljs-params\">t</span>) {\n        <span class=\"hljs-title function_\">drawRectangle</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, canvas.<span class=\"hljs-property\">width</span>, canvas.<span class=\"hljs-property\">height</span>, <span class=\"hljs-string\">\"#000\"</span>);\n\n        stars.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">star</span>) =></span> {\n          <span class=\"hljs-title function_\">drawRectangle</span>(star.<span class=\"hljs-property\">x</span>, star.<span class=\"hljs-property\">y</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, star.<span class=\"hljs-property\">fillStyle</span>);\n          star.<span class=\"hljs-property\">x</span> = (star.<span class=\"hljs-property\">x</span> - star.<span class=\"hljs-property\">color</span> / <span class=\"hljs-number\">5000</span> + canvas.<span class=\"hljs-property\">width</span>) % canvas.<span class=\"hljs-property\">width</span>;\n        });\n        <span class=\"hljs-title function_\">drawRectangle</span>(\n          canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">4</span>,\n          canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">4</span> + (canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">10</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">sin</span>(t / <span class=\"hljs-number\">500</span>),\n          canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">2</span>,\n          canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">2</span>,\n          <span class=\"hljs-string\">\"#008\"</span>\n        );\n        <span class=\"hljs-title function_\">drawRectangle</span>(\n          canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">2</span> + (canvas.<span class=\"hljs-property\">width</span> / <span class=\"hljs-number\">4</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">cos</span>(t / <span class=\"hljs-number\">1000</span>) - <span class=\"hljs-number\">4</span>,\n          canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">2</span> + (canvas.<span class=\"hljs-property\">height</span> / <span class=\"hljs-number\">4</span>) * <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">sin</span>(t / <span class=\"hljs-number\">1000</span>) - <span class=\"hljs-number\">4</span>,\n          <span class=\"hljs-number\">8</span>,\n          <span class=\"hljs-number\">8</span>,\n          <span class=\"hljs-string\">\"#00c\"</span>\n        );\n      }\n\n      <span class=\"hljs-title function_\">resizeCanvas</span>();\n      <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">\"resize\"</span>, resizeCanvas);\n      <span class=\"hljs-title function_\">gameLoop</span>();\n    </span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">script</span>></span>\n  <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">body</span>></span>\n<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">html</span>></span></span>\n</code></pre>\n<p>이제 기초가 마련되었습니다 - 브라우저에서 픽셀 완벽한 그래픽을 애니메이트할 수 있는 코드 조각이 있습니다! 다음에는 몇 가지 스프라이트를 애니메이션화할 것입니다!</p>\n</body>\n</html>\n"},"__N_SSG":true}