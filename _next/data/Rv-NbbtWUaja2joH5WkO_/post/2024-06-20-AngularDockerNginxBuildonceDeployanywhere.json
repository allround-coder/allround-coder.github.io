{"pageProps":{"post":{"title":"Angular, Docker, Nginx í•œ ë²ˆ ë¹Œë“œí•˜ê³  ì–´ë””ì„œë“  ë°°í¬í•˜ì„¸ìš”","description":"","date":"2024-06-20 05:31","slug":"2024-06-20-AngularDockerNginxBuildonceDeployanywhere","content":"\n\n<img src=\"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_0.png\" />\n\nGithub ì½”ë“œ: https://github.com/fbzz/angular-build-once-deploy-anywhere\n\nì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ê³¼ì •ì—ì„œ ê°ê¸° ë‹¤ë¥¸ ì„¤ì •ì„ ê°–ëŠ” ì—¬ëŸ¬ í™˜ê²½ì„ ë³´ìœ í•˜ëŠ” ê²ƒì€ ê½¤ í”í•©ë‹ˆë‹¤. AngularëŠ” í™˜ê²½ ë³€ìˆ˜ë¥¼ ê´€ë¦¬í•˜ëŠ” ë‚´ì¥ ì‹œìŠ¤í…œì„ ì œê³µí•˜ì—¬ ë¹Œë“œ ì‹œ íŒŒì¼ì„ êµì²´í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ì ‘ê·¼ ë°©ì‹ì€ ì¢…ì¢… ê° í™˜ê²½ë³„ë¡œ ë³„ë„ì˜ ë¹Œë“œë¥¼ ìƒì„±í•´ì•¼ í•˜ë¯€ë¡œ ì‹œê°„ì´ ì†Œëª¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì—…ê³„ì—ì„œëŠ” ê½¤ í”í•œ íŒ¨í„´ì´ ìˆìŠµë‹ˆë‹¤.\n\n## í•œ ë²ˆ ë¹Œë“œí•˜ê³  ì–´ë””ì—ë‚˜ ë°°í¬í•˜ì„¸ìš”â€¦\n\n<div class=\"content-ad\"></div>\n\nê·¸ë˜ì„œ, DEVì™€ PRODë¼ëŠ” ë‘ ê°€ì§€ í™˜ê²½ì´ ìˆëŠ” ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. í•˜ë‚˜ì˜ ë¹Œë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•©ë‹ˆë‹¤:\n\n- Angular â€” SPA ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.\n- Nginx â€” ì›¹ ì„œë²„ ë° ì—­ë°©í–¥ í”„ë¡ì‹œ ì„œë²„ì…ë‹ˆë‹¤.\n- Docker â€” ê°€ë³ê³  íœ´ëŒ€ ê°€ëŠ¥í•˜ë©° ë…ë¦½ì ì¸ í™˜ê²½ì¸ ì»¨í…Œì´ë„ˆì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œ, ë°°í¬ ë° ì‹¤í–‰í•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤.\n\n# 1 - Angular\n\nì„¸ ê°€ì§€ íŒŒì¼ì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ë“¤ì€ í™˜ê²½ì— ê¸°ë°˜í•œ ë‹¤ë¥¸ êµ¬ì„±ì„ ì²˜ë¦¬í•  ê²ƒì…ë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n`src\\config`\n\n- `app-config.dev.json` â€” ê°œë°œìš©.  \n- `app-config.prod.json` â€” í”„ë¡œë•ì…˜ìš©.\n\n`src\\`\n\n- `app-config.json` â€” ë¡œì»¬ ê°œë°œìš©ì´ë©°, í–¥í›„ ëŒ€ì²´ë  ì˜ˆì •ì…ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n```js\n//App êµ¬ì„±ì˜ ì˜ˆì‹œ, ê°„ë‹¨í•œ JSONì…ë‹ˆë‹¤.\n{\n  \"API_URL\": \"ë¡œì»¬ ê°œë°œìš©\",\n}\n```\n\nì´ì œ ë²ˆë“¤ì— í¬í•¨ì‹œì¼œ ë´…ì‹œë‹¤. Angular.json íŒŒì¼ì˜ ë¹Œë“œ ì„¹ì…˜ì—, config í´ë”ë¥¼ ìì‚°ì— ì¶”ê°€í•˜ì„¸ìš”.:\n\n```js\n  \"build\": {\n          \"builder\": \"@angular-devkit/build-angular:browser-esbuild\",\n            ...\n            \"assets\": [\n              \"src/favicon.ico\",\n              \"src/assets\",\n              \"src/app-config.json\",\n              \"src/config\", // ì—¬ê¸°\n            ],\n            ...\n}\n```\n\nnpm run buildë¥¼ ì‹¤í–‰í•˜ë©´ distì— config í´ë”ê°€ ìƒê¹ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n\n![Angular Docker Nginx BuildonceDeployanywhere](/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_1.png)\n\n1.2 - Angularì—ì„œëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ì „ì²´ì— ê±¸ì³ ë°ì´í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ì‹±ê¸€í†¤ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ì „ì²´ì—ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\nimport { Injectable } from '@angular/core';\nimport { firstValueFrom } from 'rxjs';\nimport { HttpClient, HttpBackend } from '@angular/common/http';\n\n//Move this type to a shared folder\nexport interface AppConfig {\n  API_URL: string;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConfigService {\n  //We create the configuration with default values in case anything fails\n  private configuration: AppConfig = {\n    API_URL: '/api',\n  };\n\n  private http: HttpClient;\n  constructor(private readonly httpHandler: HttpBackend) {\n    this.http = new HttpClient(this.httpHandler);\n  }\n\n  //This function will get the current config for the environment\n  setConfig(): Promise<void | AppConfig> {\n    return firstValueFrom(this.http.get<AppConfig>('./app-config.json'))\n      .then((config: AppConfig) => (this.configuration = config))\n      .catch(error => {\n        console.error(error);\n      });\n  }\n\n  //We're going to use this function to read the config.\n  readConfig(): AppConfig {\n    return this.configuration;\n  }\n}\n```\n\n1.3 - Angularì—ì„œëŠ” APP_INITIALIZERë¼ëŠ” DI í† í°ì„ ì œê³µí•˜ì—¬ í•˜ë‚˜ ì´ìƒì˜ ì´ˆê¸°í™” í•¨ìˆ˜ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ë¶€íŠ¸ìŠ¤íŠ¸ë© í”„ë¡œì„¸ìŠ¤ ì¤‘ì— ì‹¤í–‰ë˜ë©° ì‹œì‘í•  ë•Œ í•„ìš”í•œ ë°ì´í„°ê°€ ì‚¬ìš© ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.\n\n\n<div class=\"content-ad\"></div>\n\nNgModules:\n\n```typescript\n// Config Serviceë¥¼ ë°›ì•„ì™€ ì‚¬ìš©í•˜ì—¬ ì„¤ì • íŒŒì¼ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ê°€ ì—¬ê¸° ìˆìŠµë‹ˆë‹¤.\nexport function initConfig(appConfig: ConfigService) {\n  return () => appConfig.setConfig();\n}\n\n@NgModule({\n  imports: [BrowserModule],\n  declarations: [AppComponent],\n  bootstrap: [AppComponent],\n  providers: [\n    {\n      provide: APP_INITIALIZER,\n      useFactory: initConfig,\n      deps: [ConfigService], // Angularì—ê²Œ ì´ ì´ˆê¸°í™” í”„ë¡œê·¸ë¨ì´ ConfigServiceì— ì˜ì¡´í•œë‹¤ê³  ë§í•©ë‹ˆë‹¤.\n      // ë”°ë¼ì„œ config ì„œë¹„ìŠ¤ëŠ” init configì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.\n      multi: true,\n    },\n  ],\n})\n\nexport class AppModule {}\n```\n\nStandalone:\n\n```typescript\nimport { provideHttpClient } from \"@angular/common/http\";\nimport { APP_INITIALIZER } from \"@angular/core\";\nimport { bootstrapApplication } from \"@angular/platform-browser\";\nimport { ConfigService } from \"./core/services/config.service\";\n\nexport function initConfig(appConfig: ConfigService) {\n  return () => appConfig.setConfig();\n}\n\nbootstrapApplication(App, {\n  providers: [\n    provideHttpClient(),\n    {\n      provide: APP_INITIALIZER,\n      useFactory: initConfig,\n      multi: true,\n      deps: [ConfigService],\n    },\n  ],\n});\n```\n\n<div class=\"content-ad\"></div>\n\n1.4 - ì´ì œ, êµ¬ì„± ìš”ì†Œì—ì„œ ì†Œë¹„í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•©ë‹ˆë‹¤!\n\n```js\nimport { Component, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterOutlet } from '@angular/router';\nimport { ConfigService } from '../util/config.service';\n\n@Component({\n  selector: 'app-root',\n  standalone: true,\n  imports: [CommonModule, RouterOutlet],\n  templateUrl: './app.component.html',\n  //ì°¸ê³ : ìš°ë¦¬ê°€ ì´ë¯¸ ì œê³µí–ˆê¸° ë•Œë¬¸ì— providersì—ì„œ ì œê³µí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.\n  styleUrl: './app.component.scss',\n})\nexport class AppComponent {\n  //ì°¸ê³ : ì´ êµ¬ì„± ìš”ì†ŒëŠ” ë…ë¦½ ì‹¤í–‰í˜•ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©°, ngModulesì˜ ê²½ìš° module providersì—ì„œ ê°€ì ¸ì˜¤ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.\n  configService = inject(ConfigService);\n\n  apiUrl = this.configService.readConfig().API_URL;\n\n  constructor() {\n    console.log(this.configService.readConfig().API_URL);\n  }\n}\n```\n\n# 2 - Nginx êµ¬ì„± íŒŒì¼\n\ní”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ìì‚°ì„ ì œê³µí•˜ê¸° ìœ„í•œ ê°„ë‹¨í•œ êµ¬ì„± íŒŒì¼ì„ ì‘ì„±í•©ë‹ˆë‹¤. ì°¸ê³ : ê·€í•˜ì˜ êµ¬ì„±ì„ ììœ ë¡­ê²Œ í¬í•¨í•˜ì‹­ì‹œì˜¤.\n\n<div class=\"content-ad\"></div>\n\n\n```js\nserver {\n  listen 80;\n\n  gzip on;\n  gzip_http_version 1.1;\n  gzip_disable      \"MSIE [1-6]\\.\";\n  gzip_min_length   256;\n  gzip_vary         on;\n  gzip_proxied      expired no-cache no-store private auth;\n  gzip_types        text/plain text/css application/json application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript;\n  gzip_comp_level   9;\n  client_max_body_size 5M;\n  proxy_read_timeout 200s;\n\n  location / {\n    include /etc/nginx/mime.types;\n    root /usr/share/nginx/html;\n    add_header Cache-Control \"public, max-age=1M\";\n    try_files $uri $uri/ /index.html =404;\n  }\n\n  location /healthcheck {\n        access_log off;\n        add_header 'Content-Type' 'text/plain';\n        return 200 \"Healthy\\n\";\n    \n  }\n}\n```\n\n# 3 - Docker\n\nLetâ€™s containerize our application by creating the Dockerfile at the root of our project, inside of it we have all the steps for building our application.\n\n```js\n# Use official node image as the base image\nFROM node:lts as build\n\nADD ./package.json /tmp/package.json\nRUN cd /tmp && npm install\nRUN mkdir -p /usr/local/app && cp -a /tmp/node_modules /usr/local/app/\n\nWORKDIR /usr/local/app\n\n# Add the source code from the app to the container\nCOPY ./ /usr/local/app/\n\n# Generate the build of the application\nRUN npm run build\n\n# Stage 2: Serve app with nginx server\n# Use official nginx image as the base image\nFROM nginx:latest\n\n# Copy the build output to replace the default nginx contents.\nCOPY --from=build /usr/local/app/dist/build/browser /usr/share/nginx/html\n\n# This line is IMPORTANT, we will breakdown it on a minute.\nCOPY ./entrypoint.sh /usr/local/app/entrypoint.sh\n\n# Copy the nginx conf that we created to the container\nCOPY ./nginx.conf  /etc/nginx/conf.d/default.conf\n\n# Expose ports\nEXPOSE 80 443 6006 4200\n\nRUN chmod +x /usr/local/app/entrypoint.sh\nENTRYPOINT [ \"/usr/local/app/entrypoint.sh\" ]\n```\n\n\n<div class=\"content-ad\"></div>\n\nìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í˜„ì¬ ì»¨í…Œì´ë„ˆ ë‚´ì— ìº¡ìŠí™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì§€ì •ëœ ì•± êµ¬ì„±ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì‹¤í–‰ ì¤‘ì¸ ê¸°ê¸°ì—ëŠ” í˜„ì¬ í™˜ê²½ ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ë¥¼ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ entrypoint.shë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë™í•˜ëŠ” íŠ¹ì • í™˜ê²½ì— ê¸°ë°˜í•œ íŒŒì¼ êµì²´ë¥¼ ê²°ì •í•  ê²ƒì…ë‹ˆë‹¤.\n\n\"Entrypoint\"ëŠ” ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë  ë•Œ ì‹¤í–‰ë˜ëŠ” ì´ˆê¸° ëª…ë ¹ì–´ë¡œ, ë³¸ì§ˆì ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\n\nì°¸ê³ : íšŒì‚¬ì— ë”°ë¼ êµ¬ì²´ì ì¸ ì‚¬í•­ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì§€ë§Œ ê¸°ë³¸ì ì¸ ì»¨ì…‰ì€ ì ìš© ê°€ëŠ¥í•˜ë©° í”„ë¡œì íŠ¸ ìš”êµ¬ì— ë”°ë¼ ì ì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\n#!/bin/bash -e\n\n# ENVIRONMENT ë³€ìˆ˜ë¥¼ í™•ì¸í•˜ê³  í•´ë‹¹í•˜ëŠ” íŒŒì¼ë¡œ êµì²´í•©ë‹ˆë‹¤\nif [[ $ENVIRONMENT == \"Dev\" ]]; then\n   cp /usr/share/nginx/html/config/app-config.dev.json /usr/share/nginx/html/app-config.json\nfi\n\nif [[ $ENVIRONMENT == \"Production\" ]]; then\n   cp /usr/share/nginx/html/config/app-config.prod.json /usr/share/nginx/html/app-config.json\nfi\n\nnginx -g 'daemon off;'\n```\n\n<div class=\"content-ad\"></div>\n\n# 4 - ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°\n\n```js\n# ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  íƒœê·¸ë¥¼ í• ë‹¹í•˜ê³ , ë£¨íŠ¸ í´ë”ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤\ndocker build . -t angular-boda\n\n# ë¹Œë“œê°€ ì™„ë£Œë˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ê³  í¬íŠ¸ 8080ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n# ê²€ì‚¬ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” í™˜ê²½ì„ í”„ë¡œë•ì…˜ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ BODAê°€ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤\n# ë‹¤ë¥¸ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ENVIRONMENT=Devë¡œ ë³€ê²½í•˜ì‹­ì‹œì˜¤\ndocker run -p 8080:80 -e ENVIRONMENT=Production -t angular-boda\n```\n\nlocalhost:8080ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³¼ ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤: \n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_2.png)\n\n<div class=\"content-ad\"></div>\n\n# 5. ë§ˆë¬´ë¦¬\n\nì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ê¸€ì—ì„œ ìš°ë¦¬ëŠ” Angular, Docker ë° Nginxì˜ í˜ì„ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì›í™œí•˜ê²Œ ë°°í¬í•  ìˆ˜ ìˆëŠ” ë‹¤ì¬ë‹¤ëŠ¥í•œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ëŠ” ê°œë°œ í”„ë¡œì„¸ìŠ¤ë¥¼ ìµœì í™”í•  ë¿ë§Œ ì•„ë‹ˆë¼ CI/CD íŒŒì´í”„ë¼ì¸ì˜ íš¨ìœ¨ë„ ìµœì í™”í•©ë‹ˆë‹¤.\n\nGitHubì—ì„œ ì™„ì„±ëœ ì˜ˆì œë¥¼ ììœ ë¡­ê²Œ ì‚´í´ë³´ì„¸ìš”.\n\nìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”! ğŸ†ğŸ†","ogImage":{"url":"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_0.png"},"coverImage":"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_0.png","tag":["Tech"],"readingTime":9},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<img src=\"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_0.png\">\n<p>Github ì½”ë“œ: <a href=\"https://github.com/fbzz/angular-build-once-deploy-anywhere\" rel=\"nofollow\" target=\"_blank\">https://github.com/fbzz/angular-build-once-deploy-anywhere</a></p>\n<p>ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ê³¼ì •ì—ì„œ ê°ê¸° ë‹¤ë¥¸ ì„¤ì •ì„ ê°–ëŠ” ì—¬ëŸ¬ í™˜ê²½ì„ ë³´ìœ í•˜ëŠ” ê²ƒì€ ê½¤ í”í•©ë‹ˆë‹¤. AngularëŠ” í™˜ê²½ ë³€ìˆ˜ë¥¼ ê´€ë¦¬í•˜ëŠ” ë‚´ì¥ ì‹œìŠ¤í…œì„ ì œê³µí•˜ì—¬ ë¹Œë“œ ì‹œ íŒŒì¼ì„ êµì²´í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ì ‘ê·¼ ë°©ì‹ì€ ì¢…ì¢… ê° í™˜ê²½ë³„ë¡œ ë³„ë„ì˜ ë¹Œë“œë¥¼ ìƒì„±í•´ì•¼ í•˜ë¯€ë¡œ ì‹œê°„ì´ ì†Œëª¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì—…ê³„ì—ì„œëŠ” ê½¤ í”í•œ íŒ¨í„´ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<h2>í•œ ë²ˆ ë¹Œë“œí•˜ê³  ì–´ë””ì—ë‚˜ ë°°í¬í•˜ì„¸ìš”â€¦</h2>\n<div class=\"content-ad\"></div>\n<p>ê·¸ë˜ì„œ, DEVì™€ PRODë¼ëŠ” ë‘ ê°€ì§€ í™˜ê²½ì´ ìˆëŠ” ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. í•˜ë‚˜ì˜ ë¹Œë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>\n<ul>\n<li>Angular â€” SPA ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.</li>\n<li>Nginx â€” ì›¹ ì„œë²„ ë° ì—­ë°©í–¥ í”„ë¡ì‹œ ì„œë²„ì…ë‹ˆë‹¤.</li>\n<li>Docker â€” ê°€ë³ê³  íœ´ëŒ€ ê°€ëŠ¥í•˜ë©° ë…ë¦½ì ì¸ í™˜ê²½ì¸ ì»¨í…Œì´ë„ˆì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œ, ë°°í¬ ë° ì‹¤í–‰í•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤.</li>\n</ul>\n<h1>1 - Angular</h1>\n<p>ì„¸ ê°€ì§€ íŒŒì¼ì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ë“¤ì€ í™˜ê²½ì— ê¸°ë°˜í•œ ë‹¤ë¥¸ êµ¬ì„±ì„ ì²˜ë¦¬í•  ê²ƒì…ë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<p><code>src\\config</code></p>\n<ul>\n<li><code>app-config.dev.json</code> â€” ê°œë°œìš©.</li>\n<li><code>app-config.prod.json</code> â€” í”„ë¡œë•ì…˜ìš©.</li>\n</ul>\n<p><code>src\\</code></p>\n<ul>\n<li><code>app-config.json</code> â€” ë¡œì»¬ ê°œë°œìš©ì´ë©°, í–¥í›„ ëŒ€ì²´ë  ì˜ˆì •ì…ë‹ˆë‹¤.</li>\n</ul>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">//App êµ¬ì„±ì˜ ì˜ˆì‹œ, ê°„ë‹¨í•œ JSONì…ë‹ˆë‹¤.</span>\n{\n  <span class=\"hljs-string\">\"API_URL\"</span>: <span class=\"hljs-string\">\"ë¡œì»¬ ê°œë°œìš©\"</span>,\n}\n</code></pre>\n<p>ì´ì œ ë²ˆë“¤ì— í¬í•¨ì‹œì¼œ ë´…ì‹œë‹¤. Angular.json íŒŒì¼ì˜ ë¹Œë“œ ì„¹ì…˜ì—, config í´ë”ë¥¼ ìì‚°ì— ì¶”ê°€í•˜ì„¸ìš”.:</p>\n<pre><code class=\"hljs language-js\">  <span class=\"hljs-string\">\"build\"</span>: {\n          <span class=\"hljs-string\">\"builder\"</span>: <span class=\"hljs-string\">\"@angular-devkit/build-angular:browser-esbuild\"</span>,\n            ...\n            <span class=\"hljs-string\">\"assets\"</span>: [\n              <span class=\"hljs-string\">\"src/favicon.ico\"</span>,\n              <span class=\"hljs-string\">\"src/assets\"</span>,\n              <span class=\"hljs-string\">\"src/app-config.json\"</span>,\n              <span class=\"hljs-string\">\"src/config\"</span>, <span class=\"hljs-comment\">// ì—¬ê¸°</span>\n            ],\n            ...\n}\n</code></pre>\n<p>npm run buildë¥¼ ì‹¤í–‰í•˜ë©´ distì— config í´ë”ê°€ ìƒê¹ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_1.png\" alt=\"Angular Docker Nginx BuildonceDeployanywhere\"></p>\n<p>1.2 - Angularì—ì„œëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ì „ì²´ì— ê±¸ì³ ë°ì´í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ì‹±ê¸€í†¤ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ì „ì²´ì—ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Injectable</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@angular/core'</span>;\n<span class=\"hljs-keyword\">import</span> { firstValueFrom } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'rxjs'</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">HttpClient</span>, <span class=\"hljs-title class_\">HttpBackend</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@angular/common/http'</span>;\n\n<span class=\"hljs-comment\">//Move this type to a shared folder</span>\n<span class=\"hljs-keyword\">export</span> interface <span class=\"hljs-title class_\">AppConfig</span> {\n  <span class=\"hljs-attr\">API_URL</span>: string;\n}\n\n@<span class=\"hljs-title class_\">Injectable</span>({\n  <span class=\"hljs-attr\">providedIn</span>: <span class=\"hljs-string\">'root'</span>,\n})\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ConfigService</span> {\n  <span class=\"hljs-comment\">//We create the configuration with default values in case anything fails</span>\n  private <span class=\"hljs-attr\">configuration</span>: <span class=\"hljs-title class_\">AppConfig</span> = {\n    <span class=\"hljs-attr\">API_URL</span>: <span class=\"hljs-string\">'/api'</span>,\n  };\n\n  private <span class=\"hljs-attr\">http</span>: <span class=\"hljs-title class_\">HttpClient</span>;\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">private readonly httpHandler: HttpBackend</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">http</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HttpClient</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">httpHandler</span>);\n  }\n\n  <span class=\"hljs-comment\">//This function will get the current config for the environment</span>\n  <span class=\"hljs-title function_\">setConfig</span>(): <span class=\"hljs-title class_\">Promise</span>&#x3C;<span class=\"hljs-keyword\">void</span> | <span class=\"hljs-title class_\">AppConfig</span>> {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">firstValueFrom</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">http</span>.<span class=\"hljs-property\">get</span>&#x3C;<span class=\"hljs-title class_\">AppConfig</span>>(<span class=\"hljs-string\">'./app-config.json'</span>))\n      .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">config: AppConfig</span>) =></span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">configuration</span> = config))\n      .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =></span> {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(error);\n      });\n  }\n\n  <span class=\"hljs-comment\">//We're going to use this function to read the config.</span>\n  <span class=\"hljs-title function_\">readConfig</span>(): <span class=\"hljs-title class_\">AppConfig</span> {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">configuration</span>;\n  }\n}\n</code></pre>\n<p>1.3 - Angularì—ì„œëŠ” APP_INITIALIZERë¼ëŠ” DI í† í°ì„ ì œê³µí•˜ì—¬ í•˜ë‚˜ ì´ìƒì˜ ì´ˆê¸°í™” í•¨ìˆ˜ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ë¶€íŠ¸ìŠ¤íŠ¸ë© í”„ë¡œì„¸ìŠ¤ ì¤‘ì— ì‹¤í–‰ë˜ë©° ì‹œì‘í•  ë•Œ í•„ìš”í•œ ë°ì´í„°ê°€ ì‚¬ìš© ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>NgModules:</p>\n<pre><code class=\"hljs language-typescript\"><span class=\"hljs-comment\">// Config Serviceë¥¼ ë°›ì•„ì™€ ì‚¬ìš©í•˜ì—¬ ì„¤ì • íŒŒì¼ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ê°€ ì—¬ê¸° ìˆìŠµë‹ˆë‹¤.</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">initConfig</span>(<span class=\"hljs-params\">appConfig: ConfigService</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-function\">() =></span> appConfig.<span class=\"hljs-title function_\">setConfig</span>();\n}\n\n<span class=\"hljs-meta\">@NgModule</span>({\n  <span class=\"hljs-attr\">imports</span>: [<span class=\"hljs-title class_\">BrowserModule</span>],\n  <span class=\"hljs-attr\">declarations</span>: [<span class=\"hljs-title class_\">AppComponent</span>],\n  <span class=\"hljs-attr\">bootstrap</span>: [<span class=\"hljs-title class_\">AppComponent</span>],\n  <span class=\"hljs-attr\">providers</span>: [\n    {\n      <span class=\"hljs-attr\">provide</span>: <span class=\"hljs-variable constant_\">APP_INITIALIZER</span>,\n      <span class=\"hljs-attr\">useFactory</span>: initConfig,\n      <span class=\"hljs-attr\">deps</span>: [<span class=\"hljs-title class_\">ConfigService</span>], <span class=\"hljs-comment\">// Angularì—ê²Œ ì´ ì´ˆê¸°í™” í”„ë¡œê·¸ë¨ì´ ConfigServiceì— ì˜ì¡´í•œë‹¤ê³  ë§í•©ë‹ˆë‹¤.</span>\n      <span class=\"hljs-comment\">// ë”°ë¼ì„œ config ì„œë¹„ìŠ¤ëŠ” init configì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</span>\n      <span class=\"hljs-attr\">multi</span>: <span class=\"hljs-literal\">true</span>,\n    },\n  ],\n})\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AppModule</span> {}\n</code></pre>\n<p>Standalone:</p>\n<pre><code class=\"hljs language-typescript\"><span class=\"hljs-keyword\">import</span> { provideHttpClient } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@angular/common/http\"</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-variable constant_\">APP_INITIALIZER</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@angular/core\"</span>;\n<span class=\"hljs-keyword\">import</span> { bootstrapApplication } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@angular/platform-browser\"</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">ConfigService</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./core/services/config.service\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">initConfig</span>(<span class=\"hljs-params\">appConfig: ConfigService</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-function\">() =></span> appConfig.<span class=\"hljs-title function_\">setConfig</span>();\n}\n\n<span class=\"hljs-title function_\">bootstrapApplication</span>(<span class=\"hljs-title class_\">App</span>, {\n  <span class=\"hljs-attr\">providers</span>: [\n    <span class=\"hljs-title function_\">provideHttpClient</span>(),\n    {\n      <span class=\"hljs-attr\">provide</span>: <span class=\"hljs-variable constant_\">APP_INITIALIZER</span>,\n      <span class=\"hljs-attr\">useFactory</span>: initConfig,\n      <span class=\"hljs-attr\">multi</span>: <span class=\"hljs-literal\">true</span>,\n      <span class=\"hljs-attr\">deps</span>: [<span class=\"hljs-title class_\">ConfigService</span>],\n    },\n  ],\n});\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>1.4 - ì´ì œ, êµ¬ì„± ìš”ì†Œì—ì„œ ì†Œë¹„í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•©ë‹ˆë‹¤!</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Component</span>, inject } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@angular/core'</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CommonModule</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@angular/common'</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">RouterOutlet</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@angular/router'</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">ConfigService</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'../util/config.service'</span>;\n\n@<span class=\"hljs-title class_\">Component</span>({\n  <span class=\"hljs-attr\">selector</span>: <span class=\"hljs-string\">'app-root'</span>,\n  <span class=\"hljs-attr\">standalone</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">imports</span>: [<span class=\"hljs-title class_\">CommonModule</span>, <span class=\"hljs-title class_\">RouterOutlet</span>],\n  <span class=\"hljs-attr\">templateUrl</span>: <span class=\"hljs-string\">'./app.component.html'</span>,\n  <span class=\"hljs-comment\">//ì°¸ê³ : ìš°ë¦¬ê°€ ì´ë¯¸ ì œê³µí–ˆê¸° ë•Œë¬¸ì— providersì—ì„œ ì œê³µí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</span>\n  <span class=\"hljs-attr\">styleUrl</span>: <span class=\"hljs-string\">'./app.component.scss'</span>,\n})\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AppComponent</span> {\n  <span class=\"hljs-comment\">//ì°¸ê³ : ì´ êµ¬ì„± ìš”ì†ŒëŠ” ë…ë¦½ ì‹¤í–‰í˜•ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©°, ngModulesì˜ ê²½ìš° module providersì—ì„œ ê°€ì ¸ì˜¤ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.</span>\n  configService = <span class=\"hljs-title function_\">inject</span>(<span class=\"hljs-title class_\">ConfigService</span>);\n\n  apiUrl = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">configService</span>.<span class=\"hljs-title function_\">readConfig</span>().<span class=\"hljs-property\">API_URL</span>;\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">configService</span>.<span class=\"hljs-title function_\">readConfig</span>().<span class=\"hljs-property\">API_URL</span>);\n  }\n}\n</code></pre>\n<h1>2 - Nginx êµ¬ì„± íŒŒì¼</h1>\n<p>í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ìì‚°ì„ ì œê³µí•˜ê¸° ìœ„í•œ ê°„ë‹¨í•œ êµ¬ì„± íŒŒì¼ì„ ì‘ì„±í•©ë‹ˆë‹¤. ì°¸ê³ : ê·€í•˜ì˜ êµ¬ì„±ì„ ììœ ë¡­ê²Œ í¬í•¨í•˜ì‹­ì‹œì˜¤.</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">server {\n  listen <span class=\"hljs-number\">80</span>;\n\n  gzip on;\n  gzip_http_version <span class=\"hljs-number\">1.1</span>;\n  gzip_disable      <span class=\"hljs-string\">\"MSIE [1-6]\\.\"</span>;\n  gzip_min_length   <span class=\"hljs-number\">256</span>;\n  gzip_vary         on;\n  gzip_proxied      expired no-cache no-store private auth;\n  gzip_types        text/plain text/css application/json application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript;\n  gzip_comp_level   <span class=\"hljs-number\">9</span>;\n  client_max_body_size 5M;\n  proxy_read_timeout 200s;\n\n  location / {\n    include /etc/nginx/mime.<span class=\"hljs-property\">types</span>;\n    root /usr/share/nginx/html;\n    add_header <span class=\"hljs-title class_\">Cache</span>-<span class=\"hljs-title class_\">Control</span> <span class=\"hljs-string\">\"public, max-age=1M\"</span>;\n    try_files $uri $uri/ /index.<span class=\"hljs-property\">html</span> =<span class=\"hljs-number\">404</span>;\n  }\n\n  location /healthcheck {\n        access_log off;\n        add_header <span class=\"hljs-string\">'Content-Type'</span> <span class=\"hljs-string\">'text/plain'</span>;\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">200</span> <span class=\"hljs-string\">\"Healthy\\n\"</span>;\n    \n  }\n}\n</code></pre>\n<h1>3 - Docker</h1>\n<p>Letâ€™s containerize our application by creating the Dockerfile at the root of our project, inside of it we have all the steps for building our application.</p>\n<pre><code class=\"hljs language-js\"># <span class=\"hljs-title class_\">Use</span> official node image <span class=\"hljs-keyword\">as</span> the base image\n<span class=\"hljs-variable constant_\">FROM</span> <span class=\"hljs-attr\">node</span>:lts <span class=\"hljs-keyword\">as</span> build\n\n<span class=\"hljs-variable constant_\">ADD</span> ./package.<span class=\"hljs-property\">json</span> /tmp/package.<span class=\"hljs-property\">json</span>\n<span class=\"hljs-variable constant_\">RUN</span> cd /tmp &#x26;&#x26; npm install\n<span class=\"hljs-variable constant_\">RUN</span> mkdir -p /usr/local/app &#x26;&#x26; cp -a /tmp/node_modules /usr/local/app/\n\n<span class=\"hljs-variable constant_\">WORKDIR</span> /usr/local/app\n\n# <span class=\"hljs-title class_\">Add</span> the source code <span class=\"hljs-keyword\">from</span> the app to the container\n<span class=\"hljs-variable constant_\">COPY</span> ./ <span class=\"hljs-regexp\">/usr/</span>local/app/\n\n# <span class=\"hljs-title class_\">Generate</span> the build <span class=\"hljs-keyword\">of</span> the application\n<span class=\"hljs-variable constant_\">RUN</span> npm run build\n\n# <span class=\"hljs-title class_\">Stage</span> <span class=\"hljs-number\">2</span>: <span class=\"hljs-title class_\">Serve</span> app <span class=\"hljs-keyword\">with</span> nginx server\n# <span class=\"hljs-title class_\">Use</span> official nginx image <span class=\"hljs-keyword\">as</span> the base image\n<span class=\"hljs-variable constant_\">FROM</span> <span class=\"hljs-attr\">nginx</span>:latest\n\n# <span class=\"hljs-title class_\">Copy</span> the build output to replace the <span class=\"hljs-keyword\">default</span> nginx contents.\n<span class=\"hljs-variable constant_\">COPY</span> --<span class=\"hljs-keyword\">from</span>=build /usr/local/app/dist/build/browser /usr/share/nginx/html\n\n# <span class=\"hljs-title class_\">This</span> line is <span class=\"hljs-variable constant_\">IMPORTANT</span>, we will breakdown it on a minute.\n<span class=\"hljs-variable constant_\">COPY</span> ./entrypoint.<span class=\"hljs-property\">sh</span> /usr/local/app/entrypoint.<span class=\"hljs-property\">sh</span>\n\n# <span class=\"hljs-title class_\">Copy</span> the nginx conf that we created to the container\n<span class=\"hljs-variable constant_\">COPY</span> ./nginx.<span class=\"hljs-property\">conf</span>  /etc/nginx/conf.<span class=\"hljs-property\">d</span>/<span class=\"hljs-keyword\">default</span>.<span class=\"hljs-property\">conf</span>\n\n# <span class=\"hljs-title class_\">Expose</span> ports\n<span class=\"hljs-variable constant_\">EXPOSE</span> <span class=\"hljs-number\">80</span> <span class=\"hljs-number\">443</span> <span class=\"hljs-number\">6006</span> <span class=\"hljs-number\">4200</span>\n\n<span class=\"hljs-variable constant_\">RUN</span> chmod +x /usr/local/app/entrypoint.<span class=\"hljs-property\">sh</span>\n<span class=\"hljs-variable constant_\">ENTRYPOINT</span> [ <span class=\"hljs-string\">\"/usr/local/app/entrypoint.sh\"</span> ]\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>ìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í˜„ì¬ ì»¨í…Œì´ë„ˆ ë‚´ì— ìº¡ìŠí™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì§€ì •ëœ ì•± êµ¬ì„±ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì‹¤í–‰ ì¤‘ì¸ ê¸°ê¸°ì—ëŠ” í˜„ì¬ í™˜ê²½ ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ë¥¼ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ entrypoint.shë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë™í•˜ëŠ” íŠ¹ì • í™˜ê²½ì— ê¸°ë°˜í•œ íŒŒì¼ êµì²´ë¥¼ ê²°ì •í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<p>\"Entrypoint\"ëŠ” ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë  ë•Œ ì‹¤í–‰ë˜ëŠ” ì´ˆê¸° ëª…ë ¹ì–´ë¡œ, ë³¸ì§ˆì ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</p>\n<p>ì°¸ê³ : íšŒì‚¬ì— ë”°ë¼ êµ¬ì²´ì ì¸ ì‚¬í•­ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì§€ë§Œ ê¸°ë³¸ì ì¸ ì»¨ì…‰ì€ ì ìš© ê°€ëŠ¥í•˜ë©° í”„ë¡œì íŠ¸ ìš”êµ¬ì— ë”°ë¼ ì ì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\">#!<span class=\"hljs-regexp\">/bin/</span>bash -e\n\n# <span class=\"hljs-variable constant_\">ENVIRONMENT</span> ë³€ìˆ˜ë¥¼ í™•ì¸í•˜ê³  í•´ë‹¹í•˜ëŠ” íŒŒì¼ë¡œ êµì²´í•©ë‹ˆë‹¤\n<span class=\"hljs-keyword\">if</span> [[ $ENVIRONMENT == <span class=\"hljs-string\">\"Dev\"</span> ]]; then\n   cp /usr/share/nginx/html/config/app-config.<span class=\"hljs-property\">dev</span>.<span class=\"hljs-property\">json</span> /usr/share/nginx/html/app-config.<span class=\"hljs-property\">json</span>\nfi\n\n<span class=\"hljs-keyword\">if</span> [[ $ENVIRONMENT == <span class=\"hljs-string\">\"Production\"</span> ]]; then\n   cp /usr/share/nginx/html/config/app-config.<span class=\"hljs-property\">prod</span>.<span class=\"hljs-property\">json</span> /usr/share/nginx/html/app-config.<span class=\"hljs-property\">json</span>\nfi\n\nnginx -g <span class=\"hljs-string\">'daemon off;'</span>\n</code></pre>\n<div class=\"content-ad\"></div>\n<h1>4 - ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°</h1>\n<pre><code class=\"hljs language-js\"># ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  íƒœê·¸ë¥¼ í• ë‹¹í•˜ê³ , ë£¨íŠ¸ í´ë”ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤\ndocker build . -t angular-boda\n\n# ë¹Œë“œê°€ ì™„ë£Œë˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ê³  í¬íŠ¸ <span class=\"hljs-number\">8080</span>ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n# ê²€ì‚¬ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” í™˜ê²½ì„ í”„ë¡œë•ì…˜ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ <span class=\"hljs-variable constant_\">BODA</span>ê°€ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤\n# ë‹¤ë¥¸ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ <span class=\"hljs-variable constant_\">ENVIRONMENT</span>=<span class=\"hljs-title class_\">Dev</span>ë¡œ ë³€ê²½í•˜ì‹­ì‹œì˜¤\ndocker run -p <span class=\"hljs-number\">8080</span>:<span class=\"hljs-number\">80</span> -e <span class=\"hljs-variable constant_\">ENVIRONMENT</span>=<span class=\"hljs-title class_\">Production</span> -t angular-boda\n</code></pre>\n<p>localhost:8080ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³¼ ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-20-AngularDockerNginxBuildonceDeployanywhere_2.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<div class=\"content-ad\"></div>\n<h1>5. ë§ˆë¬´ë¦¬</h1>\n<p>ì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ê¸€ì—ì„œ ìš°ë¦¬ëŠ” Angular, Docker ë° Nginxì˜ í˜ì„ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì›í™œí•˜ê²Œ ë°°í¬í•  ìˆ˜ ìˆëŠ” ë‹¤ì¬ë‹¤ëŠ¥í•œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ëŠ” ê°œë°œ í”„ë¡œì„¸ìŠ¤ë¥¼ ìµœì í™”í•  ë¿ë§Œ ì•„ë‹ˆë¼ CI/CD íŒŒì´í”„ë¼ì¸ì˜ íš¨ìœ¨ë„ ìµœì í™”í•©ë‹ˆë‹¤.</p>\n<p>GitHubì—ì„œ ì™„ì„±ëœ ì˜ˆì œë¥¼ ììœ ë¡­ê²Œ ì‚´í´ë³´ì„¸ìš”.</p>\n<p>ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”! ğŸ†ğŸ†</p>\n</body>\n</html>\n"},"__N_SSG":true}