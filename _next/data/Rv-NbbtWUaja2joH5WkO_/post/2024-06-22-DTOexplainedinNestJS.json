{"pageProps":{"post":{"title":"NestJS에서 DTO 쉽게 이해하기","description":"","date":"2024-06-22 14:44","slug":"2024-06-22-DTOexplainedinNestJS","content":"\n\nDTO(Data Transfer Object) 패턴은 어플리케이션의 서로 다른 레이어 간에 데이터를 전송하는 데 일반적으로 사용되는 설계 패턴입니다. DTO 패턴의 주요 아이디어는 데이터를 캡슐화하고 어플리케이션의 서로 다른 부분 간에 데이터를 전송하는 표준화된 방법을 제공하는 것입니다.\n\n실무에서 DTO는 데이터를 포함하고 일부 유효성 검사 로직을 갖는 간단한 객체입니다. Domain 객체의 일부 또는 전체 데이터를 정의하지만 비즈니스 로직은 포함하지 않습니다. 주로 클라이언트와 서버 간 또는 서버 측 어플리케이션의 서로 다른 레이어 간에 데이터를 전송하는 데 사용됩니다. DTO 객체는 일반적으로 서버 측 코드에서 생성되며 데이터베이스 또는 기타 소스에서 데이터로 채워진 후 클라이언트로 전송됩니다. 클라이언트 측 코드는 그 후 DTO 객체를 사용하여 데이터를 사용자에게 표시하거나 처리를 위해 서버로 보낼 수 있습니다.\n\n<div class=\"content-ad\"></div>\n\n# 기본 사용법\n\nNestJS 애플리케이션에서 DTO를 사용하는 예제를 살펴보겠습니다:\n\n- DTO 클래스를 정의하세요:\n\n```js\nexport class CreateUserDto {\n  readonly name: string;\n  readonly email: string;\n  readonly password: string;\n}\n```\n\n<div class=\"content-ad\"></div>\n\n2. 당신의 DTO 클래스를 컨트롤러에서 사용하세요:\n\n```js\nimport { Controller, Post, Body } from ‘@nestjs/common’;\nimport { CreateUserDto } from ‘./create-user.dto’;\n@Controller('users')\nexport class UsersController {\n @Post()\n async create(@Body() createUserDto: CreateUserDto) {\n // 여기에 사용자 생성 로직을 작성하세요\n }\n}\n```\n\n# 적절한 사용법\n\nDTO는 서로 다른 도메인 객체에서 데이터를 구성하거나 도메인 객체의 일부 데이터만 가져오는 데 도움을 주도록 설계되었습니다. 또한 데이터 유효성 검사를 지원하거나 직렬화 논리의 캡슐화를 지원합니다.\n\n<div class=\"content-ad\"></div>\n\n아래는 DTO를 사용하여 데이터 일부만 사용하는 예시입니다:\n\n예를 들어, User 엔티티가 있다고 가정해 봅시다:\n\n<div class=\"content-ad\"></div>\n\n```js\r\nclass User {\n id: number;\n name: string;\n email: string;\n password: string;\n}\r\n```\n\n저희는 사용자 작업을 처리할 수 있는 서비스를 가지고 있어요:\n\n```js\r\nclass UserService {\n // 데이터베이스에서 사용자 객체 가져오기\n getUserById(userId: number): User {\n // 데이터베이스에서 사용자 데이터 가져오기\n // …\n return user;\n }\n}\r\n```\n\n이제 이름과 이메일 필드만을 가진 사용자 프로필을 만들고 싶다면 DTO를 정의할 수 있어요:\n\n<div class=\"content-ad\"></div>\n\n```js\n// 사용자 데이터의 하위 집합을 나타내는 DTO 클래스를 정의합니다\nclass UserProfileDto {\n  name: string;\n  email: string;\n}\n```\n\n그런 다음 API 요청을 처리하는 컨트롤러를 정의합니다. 이 컨트롤러에서는 서비스를 사용하여 사용자 엔티티를 가져오고 사용자 프로필의 데이터 하위 집합을 나타내는 DTO(UserProfileDto)를 사용합니다:\n\n```js\n@Controller('users')\nclass UsersController {\n  constructor(private userService: UserService) {}\n\n  // 사용자 데이터의 하위 집합을 반환하는 API 엔드포인트를 정의합니다\n  @Get(':id/profile')\n  getUserProfile(@Param('id') userId: number): UserProfileDto {\n    const user = this.userService.getUserById(userId);\n\n    // 이름과 이메일 속성만 포함하는 DTO 객체를 생성합니다\n    const userProfileDto = new UserProfileDto();\n    userProfileDto.name = user.name;\n    userProfileDto.email = user.email;\n\n    // API 응답으로 DTO 객체를 반환합니다\n    return userProfileDto;\n  }\n}\n```\n\n또 다른 예시로 하나의 DTO를 통해 여러 도메인 객체를 구성하는 데도 DTO를 사용할 수 있습니다:\n\n\n<div class=\"content-ad\"></div>\n\n만약 고객이 사용자의 최신 블로그 게시물을 요청한다면, 그리고 여러분은 다른 게시물 엔티티를 가지고 있다면:\n\n```js\nclass Post {\n  id: number;\n  title: string;\n  content: string;\n  userId: number;\n}\n```\n\n서비스가 필요합니다:\n\n```js\n// 사용자 및 게시물 작업을 처리하는 서비스 정의\nclass UserService {\n  // 데이터베이스에서 사용자 객체 및 최신 게시물을 가져오는 메서드\n  getUserWithLatestPost(userId: number): { user: User, latestPost: Post } {\n    // 데이터베이스에서 사용자 데이터 가져오기\n    // ...\n    \n    // 데이터베이스에서 사용자의 최신 게시물 데이터 가져오기\n    // ...\n\n    return { user, latestPost };\n  }\n}\n```\n\n<div class=\"content-ad\"></div>\n\n이제 UserWithLatestPostDto를 만들 수 있습니다:\n\n```js\nclass UserWithLatestPostDto {\n  name: string;\n  email: string;\n  latestPostTitle: string;\n  latestPostContent: string;\n}\n```\n\n컨트롤러에서는 다음과 같을 것입니다:\n\n```js\n// API 요청을 처리하는 컨트롤러 정의\n@Controller('users')\nclass UsersController {\n  constructor(private userService: UserService) {}\n\n  // 사용자 데이터와 최신 포스트를 반환하는 API 엔드포인트 정의\n  @Get(':id/with-latest-post')\n  getUserWithLatestPost(@Param('id') userId: number): UserWithLatestPostDto {\n    const { user, latestPost } = this.userService.getUserWithLatestPost(userId);\n\n    // 사용자 데이터와 최신 포스트를 포함하는 DTO 객체 생성\n    const userWithLatestPostDto = new UserWithLatestPostDto();\n    userWithLatestPostDto.name = user.name;\n    userWithLatestPostDto.email = user.email;\n    userWithLatestPostDto.latestPostTitle = latestPost.title;\n    userWithLatestPostDto.latestPostContent = latestPost.content;\n\n    // API 응답으로 DTO 객체 반환\n    return userWithLatestPostDto;\n  }\n}\n```\n\n<div class=\"content-ad\"></div>\n\n이 예시에서 DTO는 API 호출 횟수를 줄이고, 클라이언트가 필요로 하는 데이터만 전송할 수 있도록 도와줍니다.","ogImage":{"url":"/assets/img/2024-06-22-DTOexplainedinNestJS_0.png"},"coverImage":"/assets/img/2024-06-22-DTOexplainedinNestJS_0.png","tag":["Tech"],"readingTime":5},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>DTO(Data Transfer Object) 패턴은 어플리케이션의 서로 다른 레이어 간에 데이터를 전송하는 데 일반적으로 사용되는 설계 패턴입니다. DTO 패턴의 주요 아이디어는 데이터를 캡슐화하고 어플리케이션의 서로 다른 부분 간에 데이터를 전송하는 표준화된 방법을 제공하는 것입니다.</p>\n<p>실무에서 DTO는 데이터를 포함하고 일부 유효성 검사 로직을 갖는 간단한 객체입니다. Domain 객체의 일부 또는 전체 데이터를 정의하지만 비즈니스 로직은 포함하지 않습니다. 주로 클라이언트와 서버 간 또는 서버 측 어플리케이션의 서로 다른 레이어 간에 데이터를 전송하는 데 사용됩니다. DTO 객체는 일반적으로 서버 측 코드에서 생성되며 데이터베이스 또는 기타 소스에서 데이터로 채워진 후 클라이언트로 전송됩니다. 클라이언트 측 코드는 그 후 DTO 객체를 사용하여 데이터를 사용자에게 표시하거나 처리를 위해 서버로 보낼 수 있습니다.</p>\n<div class=\"content-ad\"></div>\n<h1>기본 사용법</h1>\n<p>NestJS 애플리케이션에서 DTO를 사용하는 예제를 살펴보겠습니다:</p>\n<ul>\n<li>DTO 클래스를 정의하세요:</li>\n</ul>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CreateUserDto</span> {\n  readonly <span class=\"hljs-attr\">name</span>: string;\n  readonly <span class=\"hljs-attr\">email</span>: string;\n  readonly <span class=\"hljs-attr\">password</span>: string;\n}\n</code></pre>\n<div class=\"content-ad\"></div>\n<ol start=\"2\">\n<li>당신의 DTO 클래스를 컨트롤러에서 사용하세요:</li>\n</ol>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Controller</span>, <span class=\"hljs-title class_\">Post</span>, <span class=\"hljs-title class_\">Body</span> } <span class=\"hljs-keyword\">from</span> ‘@nestjs/common’;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CreateUserDto</span> } <span class=\"hljs-keyword\">from</span> ‘./create-user.<span class=\"hljs-property\">dto</span>’;\n@<span class=\"hljs-title class_\">Controller</span>(<span class=\"hljs-string\">'users'</span>)\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UsersController</span> {\n @<span class=\"hljs-title class_\">Post</span>()\n <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">create</span>(<span class=\"hljs-params\">@Body() createUserDto: CreateUserDto</span>) {\n <span class=\"hljs-comment\">// 여기에 사용자 생성 로직을 작성하세요</span>\n }\n}\n</code></pre>\n<h1>적절한 사용법</h1>\n<p>DTO는 서로 다른 도메인 객체에서 데이터를 구성하거나 도메인 객체의 일부 데이터만 가져오는 데 도움을 주도록 설계되었습니다. 또한 데이터 유효성 검사를 지원하거나 직렬화 논리의 캡슐화를 지원합니다.</p>\n<div class=\"content-ad\"></div>\n<p>아래는 DTO를 사용하여 데이터 일부만 사용하는 예시입니다:</p>\n<p>예를 들어, User 엔티티가 있다고 가정해 봅시다:</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">User</span> {\n <span class=\"hljs-attr\">id</span>: number;\n <span class=\"hljs-attr\">name</span>: string;\n <span class=\"hljs-attr\">email</span>: string;\n <span class=\"hljs-attr\">password</span>: string;\n}\n</code></pre>\n<p>저희는 사용자 작업을 처리할 수 있는 서비스를 가지고 있어요:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserService</span> {\n <span class=\"hljs-comment\">// 데이터베이스에서 사용자 객체 가져오기</span>\n <span class=\"hljs-title function_\">getUserById</span>(<span class=\"hljs-attr\">userId</span>: number): <span class=\"hljs-title class_\">User</span> {\n <span class=\"hljs-comment\">// 데이터베이스에서 사용자 데이터 가져오기</span>\n <span class=\"hljs-comment\">// …</span>\n <span class=\"hljs-keyword\">return</span> user;\n }\n}\n</code></pre>\n<p>이제 이름과 이메일 필드만을 가진 사용자 프로필을 만들고 싶다면 DTO를 정의할 수 있어요:</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// 사용자 데이터의 하위 집합을 나타내는 DTO 클래스를 정의합니다</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserProfileDto</span> {\n  <span class=\"hljs-attr\">name</span>: string;\n  <span class=\"hljs-attr\">email</span>: string;\n}\n</code></pre>\n<p>그런 다음 API 요청을 처리하는 컨트롤러를 정의합니다. 이 컨트롤러에서는 서비스를 사용하여 사용자 엔티티를 가져오고 사용자 프로필의 데이터 하위 집합을 나타내는 DTO(UserProfileDto)를 사용합니다:</p>\n<pre><code class=\"hljs language-js\">@<span class=\"hljs-title class_\">Controller</span>(<span class=\"hljs-string\">'users'</span>)\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UsersController</span> {\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">private userService: UserService</span>) {}\n\n  <span class=\"hljs-comment\">// 사용자 데이터의 하위 집합을 반환하는 API 엔드포인트를 정의합니다</span>\n  @<span class=\"hljs-title class_\">Get</span>(<span class=\"hljs-string\">':id/profile'</span>)\n  <span class=\"hljs-title function_\">getUserProfile</span>(@<span class=\"hljs-title class_\">Param</span>(<span class=\"hljs-string\">'id'</span>) <span class=\"hljs-attr\">userId</span>: number): <span class=\"hljs-title class_\">UserProfileDto</span> {\n    <span class=\"hljs-keyword\">const</span> user = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">userService</span>.<span class=\"hljs-title function_\">getUserById</span>(userId);\n\n    <span class=\"hljs-comment\">// 이름과 이메일 속성만 포함하는 DTO 객체를 생성합니다</span>\n    <span class=\"hljs-keyword\">const</span> userProfileDto = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserProfileDto</span>();\n    userProfileDto.<span class=\"hljs-property\">name</span> = user.<span class=\"hljs-property\">name</span>;\n    userProfileDto.<span class=\"hljs-property\">email</span> = user.<span class=\"hljs-property\">email</span>;\n\n    <span class=\"hljs-comment\">// API 응답으로 DTO 객체를 반환합니다</span>\n    <span class=\"hljs-keyword\">return</span> userProfileDto;\n  }\n}\n</code></pre>\n<p>또 다른 예시로 하나의 DTO를 통해 여러 도메인 객체를 구성하는 데도 DTO를 사용할 수 있습니다:</p>\n<div class=\"content-ad\"></div>\n<p>만약 고객이 사용자의 최신 블로그 게시물을 요청한다면, 그리고 여러분은 다른 게시물 엔티티를 가지고 있다면:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Post</span> {\n  <span class=\"hljs-attr\">id</span>: number;\n  <span class=\"hljs-attr\">title</span>: string;\n  <span class=\"hljs-attr\">content</span>: string;\n  <span class=\"hljs-attr\">userId</span>: number;\n}\n</code></pre>\n<p>서비스가 필요합니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// 사용자 및 게시물 작업을 처리하는 서비스 정의</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserService</span> {\n  <span class=\"hljs-comment\">// 데이터베이스에서 사용자 객체 및 최신 게시물을 가져오는 메서드</span>\n  <span class=\"hljs-title function_\">getUserWithLatestPost</span>(<span class=\"hljs-attr\">userId</span>: number): { <span class=\"hljs-attr\">user</span>: <span class=\"hljs-title class_\">User</span>, <span class=\"hljs-attr\">latestPost</span>: <span class=\"hljs-title class_\">Post</span> } {\n    <span class=\"hljs-comment\">// 데이터베이스에서 사용자 데이터 가져오기</span>\n    <span class=\"hljs-comment\">// ...</span>\n    \n    <span class=\"hljs-comment\">// 데이터베이스에서 사용자의 최신 게시물 데이터 가져오기</span>\n    <span class=\"hljs-comment\">// ...</span>\n\n    <span class=\"hljs-keyword\">return</span> { user, latestPost };\n  }\n}\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>이제 UserWithLatestPostDto를 만들 수 있습니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UserWithLatestPostDto</span> {\n  <span class=\"hljs-attr\">name</span>: string;\n  <span class=\"hljs-attr\">email</span>: string;\n  <span class=\"hljs-attr\">latestPostTitle</span>: string;\n  <span class=\"hljs-attr\">latestPostContent</span>: string;\n}\n</code></pre>\n<p>컨트롤러에서는 다음과 같을 것입니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// API 요청을 처리하는 컨트롤러 정의</span>\n@<span class=\"hljs-title class_\">Controller</span>(<span class=\"hljs-string\">'users'</span>)\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">UsersController</span> {\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">private userService: UserService</span>) {}\n\n  <span class=\"hljs-comment\">// 사용자 데이터와 최신 포스트를 반환하는 API 엔드포인트 정의</span>\n  @<span class=\"hljs-title class_\">Get</span>(<span class=\"hljs-string\">':id/with-latest-post'</span>)\n  <span class=\"hljs-title function_\">getUserWithLatestPost</span>(@<span class=\"hljs-title class_\">Param</span>(<span class=\"hljs-string\">'id'</span>) <span class=\"hljs-attr\">userId</span>: number): <span class=\"hljs-title class_\">UserWithLatestPostDto</span> {\n    <span class=\"hljs-keyword\">const</span> { user, latestPost } = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">userService</span>.<span class=\"hljs-title function_\">getUserWithLatestPost</span>(userId);\n\n    <span class=\"hljs-comment\">// 사용자 데이터와 최신 포스트를 포함하는 DTO 객체 생성</span>\n    <span class=\"hljs-keyword\">const</span> userWithLatestPostDto = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserWithLatestPostDto</span>();\n    userWithLatestPostDto.<span class=\"hljs-property\">name</span> = user.<span class=\"hljs-property\">name</span>;\n    userWithLatestPostDto.<span class=\"hljs-property\">email</span> = user.<span class=\"hljs-property\">email</span>;\n    userWithLatestPostDto.<span class=\"hljs-property\">latestPostTitle</span> = latestPost.<span class=\"hljs-property\">title</span>;\n    userWithLatestPostDto.<span class=\"hljs-property\">latestPostContent</span> = latestPost.<span class=\"hljs-property\">content</span>;\n\n    <span class=\"hljs-comment\">// API 응답으로 DTO 객체 반환</span>\n    <span class=\"hljs-keyword\">return</span> userWithLatestPostDto;\n  }\n}\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>이 예시에서 DTO는 API 호출 횟수를 줄이고, 클라이언트가 필요로 하는 데이터만 전송할 수 있도록 도와줍니다.</p>\n</body>\n</html>\n"},"__N_SSG":true}