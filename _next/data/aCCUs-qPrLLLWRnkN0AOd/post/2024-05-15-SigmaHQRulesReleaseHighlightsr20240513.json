{"pageProps":{"post":{"title":"SigmaHQ Rules 릴리스 하이라이트  r2024-05-13","description":"","date":"2024-05-15 03:57","slug":"2024-05-15-SigmaHQRulesReleaseHighlightsr20240513","content":"\n\n\n![SigmaHQRulesReleaseHighlights](/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png)\n\n2024년 5월 13일 Sigma Rule Packages가 발표되었습니다. 이번 릴리즈에는 16개의 새로운 규칙, 7개의 규칙 업데이트 및 1개의 규칙 수정이 7명의 기여자에 의해 추가되었습니다.\n\n# 새로운 규칙\n\n새로운 규칙 중 일부 하이라이트는 다음과 같습니다. Wbadmin을 이용하여 민감한 파일을 덤프/복원하고 백업을 삭제하는 다양한 사례를 다루는 규칙입니다.\n\n\n\n```js\n제목: Wbadmin.EXE를 통한 파일 복구\n아이디: 6fe4aa1e-0531-4510-8be2-782154b73b48\n관련:\n    - 아이디: 84972c80-251c-4c3a-9079-4f00aad93938\n      유형: 파생\n상태: 실험적\n설명: |\n    \"wbadmin.exe\"를 통한 백업 파일로부터 파일 복구를 감지합니다.\n    공격자는 NTDS.DIT 또는 레지스트리 하이브와 같은 민감한 파일을 백업에서 복원하여 자격 증명을 뽑아낼 수 있습니다.\n참고:\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\n    - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/\n작성자: Nasreddine Bencherchali (Nextron Systems), frack113\n날짜: 2024/05/10\n태그:\n    - attack.impact\n    - attack.t1490\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - Image|endswith: '\\wbadmin.exe'\n        - OriginalFileName: 'WBADMIN.EXE'\n    선택 CLI:\n        CommandLine|contains|all:\n            - ' recovery'\n            - 'recoveryTarget'\n            - 'itemtype:File'\n    조건: 모두 선택_*\n거짓 양성:\n    - 알 수 없음\n수준: 중간\n```\n\n```js\n제목: Wbadmin.EXE를 통한 민감한 파일 덤프\n아이디: 8b93a509-1cb8-42e1-97aa-ee24224cdc15\n상태: 실험적\n설명: |\n    \"NTDS.DIT\" 및 \"SECURITY\" 하이브와 같은 고도로 민감한 파일의 덤프를 감지합니다.\n    공격자는 \"wbadmin\" 유틸리티를 활용하여 자격 증명이나 민감한 정보가 포함된 민감한 파일을 덤프할 수 있습니다.\n참고:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml\n    - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup\n작성자: Nasreddine Bencherchali (Nextron Systems), frack113\n날짜: 2024/05/10\n태그:\n    - attack.credential_access\n    - attack.t1003.003\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - Image|endswith: '\\wbadmin.exe'\n        - OriginalFileName: 'WBADMIN.EXE'\n    선택 백업:\n        CommandLine|contains:\n            - 'start'\n            - 'backup'\n    선택 경로:\n        CommandLine|contains:\n            - '\\config\\SAM'\n            - '\\config\\SECURITY'\n            - '\\config\\SYSTEM'\n            - '\\Windows\\NTDS\\NTDS.dit'\n    조건: 모두 선택_*\n거짓 양성:\n    - 허가된 관리자에 의한 합법적인 백업 작업. 일치 사항은 감사하고 사안별로 허용되어야 합니다.\n수준: 높음\n```\n\n파워셸 cmdlet인 “Start-NetEventSession\" 및 “New-NetFirewallRule\" 사용을 다루는 새로운 규칙을 소개하였습니다. 공격자가 패킷을 캡처하거나 새 방화벽 규칙을 생성하는 데 사용할 수 있습니다.\n\n```js\n제목: New-NetFirewallRule Cmdlet을 통한 새 Windows 방화벽 규칙 추가 - ScriptBlock\n아이디: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264\n관련:\n    - 아이디: 51483085-0cba-46a8-837e-4416496d6971\n      유형: 유사\n상태: 실험적\n설명: |\n    PowerShell 스크립트에 \"New-NetFirewallRule\" cmdlet 호출이 포함되어 있어 \"허용\" 동작을 하는 새 방화벽 규칙이 추가될 때 감지합니다.\n참고:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule\n    - https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170\n    - https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/\n작성자: frack113\n날짜: 2024/05/10\n태그:\n    - attack.defense_evasion\n    - attack.t1562.004\n    - detection.threat_hunting\n로그 소스:\n    제품: windows\n    카테고리: ps_script\n    정의: '요구 사항: 스크립트 블록 로깅이 활성화되어 있어야 함'\n감지:\n    선택:\n        ScriptBlockText|contains: 'New-NetFirewallRule*-Action*Allow'\n    조건: 선택\n거짓 양성:\n    - 관리자 스크립트\n수준: 낮음\n```\n\n\n\n```yaml\ntitle: \"Start-NetEventSession를 통한 잠재적인 패킷 캡처 활동 - 스크립트 블록\"\nid: da34e323-1e65-42db-83be-a6725ac2caa3\nstatus: experimental\ndescription: |\n    \"Start-NetEventSession\" cmdlet을 호출하는 PowerShell 스크립트 실행을 감지합니다. 이를 통해 공격자는 네트워크 이벤트 세션에 이벤트 및 패킷 캡처를 시작할 수 있습니다.\n    이 기술을 통해 수행 중인 작업의 정보를 수집하기 위해 공격자가 네트워크를 캡처하려 할 수 있습니다.\n    이 기술을 통해 캡처된 데이터에는 특히 안전하지 않고 암호화되지 않은 프로토콜을 통해 전송된 사용자 자격 증명이 포함될 수 있습니다.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing\n    - https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md\n    - https://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13\nauthor: frack113\ndate: 2024/05/12\ntags:\n    - attack.credential_access\n    - attack.discovery\n    - attack.t1040\nlogsource:\n    product: windows\n    category: ps_script\n    definition: 'Script Block Logging이 활성화되어 있어야 함'\ndetection:\n    selection:\n        ScriptBlockText|contains: 'Start-NetEventSession'\n    condition: selection\nfalsepositives:\n    - 적절한 네트워크 진단 스크립트.\nlevel: medium\n```\n\n또한 \"KeyScrambler.exe\"의 잠재적으로 의심스러운 자식 프로세스를 보와하는 새로운 규칙이 추가되었습니다.\n\n```yaml\ntitle: \"KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스\"\nid: ca5583e9-8f80-46ac-ab91-7f314d13b984\nrelated:\n    - id: d2451be2-b582-4e15-8701-4196ac180260\n      type: similar\nstatus: experimental\ndescription: KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스를 감지합니다.\nreferences:\n    - https://twitter.com/DTCERT/status/1712785421845790799\nauthor: Swachchhanda Shrawan Poudel\ndate: 2024/05/13\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1203\n    - attack.t1574.002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_parent:\n        ParentImage|endswith: '\\KeyScrambler.exe'\n    selection_binaries:\n        - Image|endswith:\n              - '\\cmd.exe'\n              - '\\cscript.exe'\n              - '\\mshta.exe'\n              - '\\powershell.exe'\n              - '\\pwsh.exe'\n              - '\\regsvr32.exe'\n              - '\\rundll32.exe'\n              - '\\wscript.exe'\n        - OriginalFileName:\n              - 'Cmd.Exe'\n              - 'cscript.exe'\n              - 'mshta.exe'\n              - 'PowerShell.EXE'\n              - 'pwsh.dll'\n              - 'regsvr32.exe'\n              - 'RUNDLL32.EXE'\n              - 'wscript.exe'\n    condition: all of selection_*\nfalsepositives:\n    - 알 수 없음\nlevel: medium\n```  \n\n모든 새로운 규칙 목록의 전체 릴리스 변경 로그를 확인하세요.\n\n\n\n\n# 새로운 업데이트\n\n일부 이전 규칙들이 커버리지 및 메타데이터에서 개선되었습니다.\n\n우선, \"Microsoft-Windows-Windows Firewall With Advanced Security\"를 활용하는 몇 가지 규칙에서는 커버리지를 늘리기 위해 EID 2097이 추가되었습니다.\n\n```js\ntitle: 잠재적으로 의심스러운 응용 프로그램을 위한 Windows 방화벽 예외 목록에 새로운 방화벽 규칙이 추가되었습니다.\nid: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e\nrelated:\n    - id: cde0a575-7d3d-4a49-9817-b8004a7bf105\n      type: derived\nstatus: experimental\ndescription: 잠재적으로 의심스러운 위치에 있는 응용 프로그램에 대한 Windows 방화벽 예외 목록에 새로운 규칙이 추가되는 것을 탐지합니다.\nreferences:\n    - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\n    - https://app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#\nauthor: frack113\ndate: 2023/02/26\nmodified: 2024/05/10\ntags:\n    - attack.defense_evasion\n    - attack.t1562.004\nlogsource:\n    product: windows\n    service: firewall-as\ndetection:\n    selection:\n        EventID:\n            - 2004 # Windows Defender 방화벽 예외 목록에 규칙이 추가되었습니다. (Windows 10)\n            - 2071 # Windows Defender 방화벽 예외 목록에 규칙이 추가되었습니다. (Windows 11)\n            - 2097\n        ApplicationPath|contains:\n            - ':\\PerfLogs\\'\n            - ':\\Temp\\'\n            - ':\\Tmp\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\Tasks\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n    filter_main_block:\n        Action: 2 # 차단\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - 알 수 없음\nlevel: 높음\n```\n\n\n\n```js\ntitle: Windows 방화벽 예외 목록에 추가된 새로운 드문한 방화벽 규칙\nid: cde0a575-7d3d-4a49-9817-b8004a7bf105\nstatus: experimental\ndescription: Windows 방화벽 예외 목록에 규칙이 추가된 것을 감지합니다\nreferences:\n    - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\nauthor: frack113\ndate: 2022/02/19\nmodified: 2024/05/10\ntags:\n    - attack.defense_evasion\n    - attack.t1562.004\nlogsource:\n    product: windows\n    service: firewall-as\ndetection:\n    selection:\n        EventID:\n            - 2004 # Windows Defender 방화벽 예외 목록에 규칙이 추가됨\n            - 2071 # Windows Defender 방화벽 예외 목록에 규칙이 추가됨. (Windows 11)\n            - 2097\n    filter_main_block:\n        Action: 2 # 차단\n    filter_main_generic:\n        ApplicationPath|contains:\n            - ':\\Program Files (x86)\\'\n            - ':\\Program Files\\'\n            - ':\\Windows\\System32\\'\n            - ':\\Windows\\SysWOW64\\'\n            - ':\\Windows\\WinSxS\\'\n    filter_optional_msmpeng:\n        ModifyingApplication|contains|all:\n            - ':\\ProgramData\\Microsoft\\Windows Defender\\Platform\\'\n            - '\\MsMpEng.exe'\n    filter_main_covered_paths:\n        # 이 필터는 9e2575e7-2cb9-4da1-adc8-ed94221dca5e로부터의 중복 경고 방지를 위해 추가되었습니다\n        ApplicationPath|contains:\n            - ':\\PerfLogs\\'\n            - ':\\Temp\\'\n            - ':\\Tmp\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\Tasks\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nlevel: medium\n```\n\n`PDQDeployRunner`를 사용하여 추가 경로 및 프로세스가 규칙에 추가되었습니다. 이는 악의적인 랜섬웨어 위협 행위자들이 환경 전체로 악성 소프트웨어를 배포하기 위해 종종 사용하는 유틸리티입니다.\n\n```js\ntitle: PDQDeployRunner의 잠재적으로 의심스러운 실행\nid: 12b8e9f5-96b2-41e1-9a42-8c6779a5c184\nrelated:\n    - id: d679950c-abb7-43a6-80fb-2a480c4fc450\n      type: 비슷함\nstatus: 테스트\ndescription: \"PDQDeployRunner\"의 의심스러운 실행을 감지합니다. 이는 원격 장치에서 명령과 패키지를 실행하는 PDQDeploy 서비스 스택의 일부입니다\nreferences:\n    - https://twitter.com/malmoeb/status/1550483085472432128\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/07/22\nmodified: 2024/05/02\ntags:\n    - 공격.실행\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_parent:\n        ParentImage|contains: '\\PDQDeployRunner-'\n    selection_child:\n        # 다른 의심스러운 프로세스, 명령줄 또는 경로 추가하여 이 섹션을 개선\n        - Image|endswith:\n              # 다음 프로세스 중 하나를 정상적으로 사용할 경우 주석 처리\n              - '\\bash.exe'\n              - '\\certutil.exe'\n              - '\\cmd.exe'\n              - '\\csc.exe'\n              - '\\cscript.exe'\n              - '\\dllhost.exe'\n              - '\\mshta.exe'\n              - '\\msiexec.exe'\n              - '\\regsvr32.exe'\n              - '\\rundll32.exe'\n              - '\\scriptrunner.exe'\n              - '\\wmic.exe'\n              - '\\wscript.exe'\n              - '\\wsl.exe'\n        - Image|contains:\n              - ':\\ProgramData\\'\n              - ':\\Users\\Public\\'\n              - ':\\Windows\\TEMP\\'\n              - '\\AppData\\Local\\Temp'\n        - CommandLine|contains:\n              - ' -decode '\n              - ' -enc '\n              - ' -encodedcommand '\n              - ' -w hidden'\n              - 'DownloadString'\n              - 'FromBase64String'\n              - 'http'\n              - 'iex '\n              - 'Invoke-'\n    condition: all of selection_*\nfalsepositives:\n    - PDQDeploy 도구를 사용하여 이러한 명령을 실행하는 것이 정당할 경우\nlevel: medium\n```\n\n모든 업데이트 목록을 확인하려면 전체 릴리스 변경 로그를 확인하세요.\n\n\n\n\n# 수정 사항\n\n이 릴리스에서는 \"Forest Blizzard APT - 프로세스 생성 활동\" 규칙이 작동하지 않도록 만드는 누락된 수정 자를 처리한 것을 확인할 수 있었습니다.\n\n변경 사항 및 추가 사항의 전체 변경 로그를 확인하려면 아래 릴리스 페이지를 참조해주세요.\n\n# 기여자\n\n\n\n이 릴리스는 Sigma 커뮤니티 기여자 여러분 덕분에 가능해 졌어요. 다음 분들께 큰 감사를 전합니다.\n\n- @ahmedfarou22\n- @frack113\n- @hasselj\n- @joshnck\n- @nasbench\n- @pratinavchandra\n- @swachchhanda000","ogImage":{"url":"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png"},"coverImage":"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png","tag":["Tech"],"readingTime":12},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p><img src=\"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png\" alt=\"SigmaHQRulesReleaseHighlights\"></p>\n<p>2024년 5월 13일 Sigma Rule Packages가 발표되었습니다. 이번 릴리즈에는 16개의 새로운 규칙, 7개의 규칙 업데이트 및 1개의 규칙 수정이 7명의 기여자에 의해 추가되었습니다.</p>\n<h1>새로운 규칙</h1>\n<p>새로운 규칙 중 일부 하이라이트는 다음과 같습니다. Wbadmin을 이용하여 민감한 파일을 덤프/복원하고 백업을 삭제하는 다양한 사례를 다루는 규칙입니다.</p>\n<pre><code class=\"hljs language-js\">제목: <span class=\"hljs-title class_\">Wbadmin</span>.<span class=\"hljs-property\">EXE</span>를 통한 파일 복구\n아이디: 6fe4aa1e-<span class=\"hljs-number\">0531</span>-<span class=\"hljs-number\">4510</span>-8be2-782154b73b48\n관련:\n    - 아이디: 84972c80-251c-4c3a-<span class=\"hljs-number\">9079</span>-4f00aad93938\n      유형: 파생\n상태: 실험적\n설명: |\n    <span class=\"hljs-string\">\"wbadmin.exe\"</span>를 통한 백업 파일로부터 파일 복구를 감지합니다.\n    공격자는 <span class=\"hljs-variable constant_\">NTDS</span>.<span class=\"hljs-property\">DIT</span> 또는 레지스트리 하이브와 같은 민감한 파일을 백업에서 복원하여 자격 증명을 뽑아낼 수 있습니다.\n참고:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//lolbas-project.github.io/lolbas/Binaries/Wbadmin/</span>\n작성자: <span class=\"hljs-title class_\">Nasreddine</span> <span class=\"hljs-title class_\">Bencherchali</span> (<span class=\"hljs-title class_\">Nextron</span> <span class=\"hljs-title class_\">Systems</span>), frack113\n날짜: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">10</span>\n태그:\n    - attack.<span class=\"hljs-property\">impact</span>\n    - attack.<span class=\"hljs-property\">t1490</span>\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - <span class=\"hljs-title class_\">Image</span>|<span class=\"hljs-attr\">endswith</span>: <span class=\"hljs-string\">'\\wbadmin.exe'</span>\n        - <span class=\"hljs-title class_\">OriginalFileName</span>: <span class=\"hljs-string\">'WBADMIN.EXE'</span>\n    선택 <span class=\"hljs-attr\">CLI</span>:\n        <span class=\"hljs-title class_\">CommandLine</span>|contains|<span class=\"hljs-attr\">all</span>:\n            - <span class=\"hljs-string\">' recovery'</span>\n            - <span class=\"hljs-string\">'recoveryTarget'</span>\n            - <span class=\"hljs-string\">'itemtype:File'</span>\n    조건: 모두 선택_*\n거짓 양성:\n    - 알 수 없음\n수준: 중간\n</code></pre>\n<pre><code class=\"hljs language-js\">제목: <span class=\"hljs-title class_\">Wbadmin</span>.<span class=\"hljs-property\">EXE</span>를 통한 민감한 파일 덤프\n아이디: 8b93a509-1cb8-<span class=\"hljs-number\">42e1</span>-97aa-ee24224cdc15\n상태: 실험적\n설명: |\n    <span class=\"hljs-string\">\"NTDS.DIT\"</span> 및 <span class=\"hljs-string\">\"SECURITY\"</span> 하이브와 같은 고도로 민감한 파일의 덤프를 감지합니다.\n    공격자는 <span class=\"hljs-string\">\"wbadmin\"</span> 유틸리티를 활용하여 자격 증명이나 민감한 정보가 포함된 민감한 파일을 덤프할 수 있습니다.\n참고:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//lolbas-project.github.io/lolbas/Binaries/Wbadmin/</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup</span>\n작성자: <span class=\"hljs-title class_\">Nasreddine</span> <span class=\"hljs-title class_\">Bencherchali</span> (<span class=\"hljs-title class_\">Nextron</span> <span class=\"hljs-title class_\">Systems</span>), frack113\n날짜: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">10</span>\n태그:\n    - attack.<span class=\"hljs-property\">credential_access</span>\n    - attack.<span class=\"hljs-property\">t1003</span><span class=\"hljs-number\">.003</span>\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - <span class=\"hljs-title class_\">Image</span>|<span class=\"hljs-attr\">endswith</span>: <span class=\"hljs-string\">'\\wbadmin.exe'</span>\n        - <span class=\"hljs-title class_\">OriginalFileName</span>: <span class=\"hljs-string\">'WBADMIN.EXE'</span>\n    선택 백업:\n        <span class=\"hljs-title class_\">CommandLine</span>|<span class=\"hljs-attr\">contains</span>:\n            - <span class=\"hljs-string\">'start'</span>\n            - <span class=\"hljs-string\">'backup'</span>\n    선택 경로:\n        <span class=\"hljs-title class_\">CommandLine</span>|<span class=\"hljs-attr\">contains</span>:\n            - <span class=\"hljs-string\">'\\config\\SAM'</span>\n            - <span class=\"hljs-string\">'\\config\\SECURITY'</span>\n            - <span class=\"hljs-string\">'\\config\\SYSTEM'</span>\n            - <span class=\"hljs-string\">'\\Windows\\NTDS\\NTDS.dit'</span>\n    조건: 모두 선택_*\n거짓 양성:\n    - 허가된 관리자에 의한 합법적인 백업 작업. 일치 사항은 감사하고 사안별로 허용되어야 합니다.\n수준: 높음\n</code></pre>\n<p>파워셸 cmdlet인 “Start-NetEventSession\" 및 “New-NetFirewallRule\" 사용을 다루는 새로운 규칙을 소개하였습니다. 공격자가 패킷을 캡처하거나 새 방화벽 규칙을 생성하는 데 사용할 수 있습니다.</p>\n<pre><code class=\"hljs language-js\">제목: <span class=\"hljs-title class_\">New</span>-<span class=\"hljs-title class_\">NetFirewallRule</span> <span class=\"hljs-title class_\">Cmdlet</span>을 통한 새 <span class=\"hljs-title class_\">Windows</span> 방화벽 규칙 추가 - <span class=\"hljs-title class_\">ScriptBlock</span>\n아이디: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264\n관련:\n    - 아이디: <span class=\"hljs-number\">51483085</span>-0cba-46a8-837e-4416496d6971\n      유형: 유사\n상태: 실험적\n설명: |\n    <span class=\"hljs-title class_\">PowerShell</span> 스크립트에 <span class=\"hljs-string\">\"New-NetFirewallRule\"</span> cmdlet 호출이 포함되어 있어 <span class=\"hljs-string\">\"허용\"</span> 동작을 하는 새 방화벽 규칙이 추가될 때 감지합니다.\n참고:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//cybersecuritynews.com/rhysida-ransomware-attacking-windows/</span>\n작성자: frack113\n날짜: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">10</span>\n태그:\n    - attack.<span class=\"hljs-property\">defense_evasion</span>\n    - attack.<span class=\"hljs-property\">t1562</span><span class=\"hljs-number\">.004</span>\n    - detection.<span class=\"hljs-property\">threat_hunting</span>\n로그 소스:\n    제품: windows\n    카테고리: ps_script\n    정의: <span class=\"hljs-string\">'요구 사항: 스크립트 블록 로깅이 활성화되어 있어야 함'</span>\n감지:\n    선택:\n        <span class=\"hljs-title class_\">ScriptBlockText</span>|<span class=\"hljs-attr\">contains</span>: <span class=\"hljs-string\">'New-NetFirewallRule*-Action*Allow'</span>\n    조건: 선택\n거짓 양성:\n    - 관리자 스크립트\n수준: 낮음\n</code></pre>\n<pre><code class=\"hljs language-yaml\"><span class=\"hljs-attr\">title:</span> <span class=\"hljs-string\">\"Start-NetEventSession를 통한 잠재적인 패킷 캡처 활동 - 스크립트 블록\"</span>\n<span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">da34e323-1e65-42db-83be-a6725ac2caa3</span>\n<span class=\"hljs-attr\">status:</span> <span class=\"hljs-string\">experimental</span>\n<span class=\"hljs-attr\">description:</span> <span class=\"hljs-string\">|\n    \"Start-NetEventSession\" cmdlet을 호출하는 PowerShell 스크립트 실행을 감지합니다. 이를 통해 공격자는 네트워크 이벤트 세션에 이벤트 및 패킷 캡처를 시작할 수 있습니다.\n    이 기술을 통해 수행 중인 작업의 정보를 수집하기 위해 공격자가 네트워크를 캡처하려 할 수 있습니다.\n    이 기술을 통해 캡처된 데이터에는 특히 안전하지 않고 암호화되지 않은 프로토콜을 통해 전송된 사용자 자격 증명이 포함될 수 있습니다.\n</span><span class=\"hljs-attr\">references:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">https://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">https://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13</span>\n<span class=\"hljs-attr\">author:</span> <span class=\"hljs-string\">frack113</span>\n<span class=\"hljs-attr\">date:</span> <span class=\"hljs-number\">2024</span><span class=\"hljs-string\">/05/12</span>\n<span class=\"hljs-attr\">tags:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.credential_access</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.discovery</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.t1040</span>\n<span class=\"hljs-attr\">logsource:</span>\n    <span class=\"hljs-attr\">product:</span> <span class=\"hljs-string\">windows</span>\n    <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">ps_script</span>\n    <span class=\"hljs-attr\">definition:</span> <span class=\"hljs-string\">'Script Block Logging이 활성화되어 있어야 함'</span>\n<span class=\"hljs-attr\">detection:</span>\n    <span class=\"hljs-attr\">selection:</span>\n        <span class=\"hljs-string\">ScriptBlockText|contains:</span> <span class=\"hljs-string\">'Start-NetEventSession'</span>\n    <span class=\"hljs-attr\">condition:</span> <span class=\"hljs-string\">selection</span>\n<span class=\"hljs-attr\">falsepositives:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">적절한</span> <span class=\"hljs-string\">네트워크</span> <span class=\"hljs-string\">진단</span> <span class=\"hljs-string\">스크립트.</span>\n<span class=\"hljs-attr\">level:</span> <span class=\"hljs-string\">medium</span>\n</code></pre>\n<p>또한 \"KeyScrambler.exe\"의 잠재적으로 의심스러운 자식 프로세스를 보와하는 새로운 규칙이 추가되었습니다.</p>\n<pre><code class=\"hljs language-yaml\"><span class=\"hljs-attr\">title:</span> <span class=\"hljs-string\">\"KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스\"</span>\n<span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">ca5583e9-8f80-46ac-ab91-7f314d13b984</span>\n<span class=\"hljs-attr\">related:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">d2451be2-b582-4e15-8701-4196ac180260</span>\n      <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">similar</span>\n<span class=\"hljs-attr\">status:</span> <span class=\"hljs-string\">experimental</span>\n<span class=\"hljs-attr\">description:</span> <span class=\"hljs-string\">KeyScrambler.exe의</span> <span class=\"hljs-string\">잠재적으로</span> <span class=\"hljs-string\">의심스러운</span> <span class=\"hljs-string\">자식</span> <span class=\"hljs-string\">프로세스를</span> <span class=\"hljs-string\">감지합니다.</span>\n<span class=\"hljs-attr\">references:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">https://twitter.com/DTCERT/status/1712785421845790799</span>\n<span class=\"hljs-attr\">author:</span> <span class=\"hljs-string\">Swachchhanda</span> <span class=\"hljs-string\">Shrawan</span> <span class=\"hljs-string\">Poudel</span>\n<span class=\"hljs-attr\">date:</span> <span class=\"hljs-number\">2024</span><span class=\"hljs-string\">/05/13</span>\n<span class=\"hljs-attr\">tags:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.execution</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.defense_evasion</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.privilege_escalation</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.t1203</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">attack.t1574.002</span>\n<span class=\"hljs-attr\">logsource:</span>\n    <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">process_creation</span>\n    <span class=\"hljs-attr\">product:</span> <span class=\"hljs-string\">windows</span>\n<span class=\"hljs-attr\">detection:</span>\n    <span class=\"hljs-attr\">selection_parent:</span>\n        <span class=\"hljs-string\">ParentImage|endswith:</span> <span class=\"hljs-string\">'\\KeyScrambler.exe'</span>\n    <span class=\"hljs-attr\">selection_binaries:</span>\n        <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">Image|endswith:</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\cmd.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\cscript.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\mshta.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\powershell.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\pwsh.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\regsvr32.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\rundll32.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'\\wscript.exe'</span>\n        <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">OriginalFileName:</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'Cmd.Exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'cscript.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'mshta.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'PowerShell.EXE'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'pwsh.dll'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'regsvr32.exe'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'RUNDLL32.EXE'</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">'wscript.exe'</span>\n    <span class=\"hljs-attr\">condition:</span> <span class=\"hljs-string\">all</span> <span class=\"hljs-string\">of</span> <span class=\"hljs-string\">selection_*</span>\n<span class=\"hljs-attr\">falsepositives:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">알</span> <span class=\"hljs-string\">수</span> <span class=\"hljs-string\">없음</span>\n<span class=\"hljs-attr\">level:</span> <span class=\"hljs-string\">medium</span>\n</code></pre>\n<p>모든 새로운 규칙 목록의 전체 릴리스 변경 로그를 확인하세요.</p>\n<h1>새로운 업데이트</h1>\n<p>일부 이전 규칙들이 커버리지 및 메타데이터에서 개선되었습니다.</p>\n<p>우선, \"Microsoft-Windows-Windows Firewall With Advanced Security\"를 활용하는 몇 가지 규칙에서는 커버리지를 늘리기 위해 EID 2097이 추가되었습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">title</span>: 잠재적으로 의심스러운 응용 프로그램을 위한 <span class=\"hljs-title class_\">Windows</span> 방화벽 예외 목록에 새로운 방화벽 규칙이 추가되었습니다.\n<span class=\"hljs-attr\">id</span>: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e\n<span class=\"hljs-attr\">related</span>:\n    - <span class=\"hljs-attr\">id</span>: cde0a575-7d3d-4a49-<span class=\"hljs-number\">9817</span>-b8004a7bf105\n      <span class=\"hljs-attr\">type</span>: derived\n<span class=\"hljs-attr\">status</span>: experimental\n<span class=\"hljs-attr\">description</span>: 잠재적으로 의심스러운 위치에 있는 응용 프로그램에 대한 <span class=\"hljs-title class_\">Windows</span> 방화벽 예외 목록에 새로운 규칙이 추가되는 것을 탐지합니다.\n<span class=\"hljs-attr\">references</span>:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)</span>\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#</span>\n<span class=\"hljs-attr\">author</span>: frack113\n<span class=\"hljs-attr\">date</span>: <span class=\"hljs-number\">2023</span>/<span class=\"hljs-number\">02</span>/<span class=\"hljs-number\">26</span>\n<span class=\"hljs-attr\">modified</span>: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">10</span>\n<span class=\"hljs-attr\">tags</span>:\n    - attack.<span class=\"hljs-property\">defense_evasion</span>\n    - attack.<span class=\"hljs-property\">t1562</span><span class=\"hljs-number\">.004</span>\n<span class=\"hljs-attr\">logsource</span>:\n    <span class=\"hljs-attr\">product</span>: windows\n    <span class=\"hljs-attr\">service</span>: firewall-<span class=\"hljs-keyword\">as</span>\n<span class=\"hljs-attr\">detection</span>:\n    <span class=\"hljs-attr\">selection</span>:\n        <span class=\"hljs-title class_\">EventID</span>:\n            - <span class=\"hljs-number\">2004</span> # <span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-title class_\">Defender</span> 방화벽 예외 목록에 규칙이 추가되었습니다. (<span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-number\">10</span>)\n            - <span class=\"hljs-number\">2071</span> # <span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-title class_\">Defender</span> 방화벽 예외 목록에 규칙이 추가되었습니다. (<span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-number\">11</span>)\n            - <span class=\"hljs-number\">2097</span>\n        <span class=\"hljs-title class_\">ApplicationPath</span>|<span class=\"hljs-attr\">contains</span>:\n            - <span class=\"hljs-string\">':\\PerfLogs\\'\n            - '</span>:\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Tmp</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Users</span>\\<span class=\"hljs-title class_\">Public</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">Tasks</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n            - '</span>\\<span class=\"hljs-title class_\">AppData</span>\\<span class=\"hljs-title class_\">Local</span>\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n    filter_main_block:\n        Action: 2 # 차단\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - 알 수 없음\nlevel: 높음\n</span></code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">title</span>: <span class=\"hljs-title class_\">Windows</span> 방화벽 예외 목록에 추가된 새로운 드문한 방화벽 규칙\n<span class=\"hljs-attr\">id</span>: cde0a575-7d3d-4a49-<span class=\"hljs-number\">9817</span>-b8004a7bf105\n<span class=\"hljs-attr\">status</span>: experimental\n<span class=\"hljs-attr\">description</span>: <span class=\"hljs-title class_\">Windows</span> 방화벽 예외 목록에 규칙이 추가된 것을 감지합니다\n<span class=\"hljs-attr\">references</span>:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)</span>\n<span class=\"hljs-attr\">author</span>: frack113\n<span class=\"hljs-attr\">date</span>: <span class=\"hljs-number\">2022</span>/<span class=\"hljs-number\">02</span>/<span class=\"hljs-number\">19</span>\n<span class=\"hljs-attr\">modified</span>: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">10</span>\n<span class=\"hljs-attr\">tags</span>:\n    - attack.<span class=\"hljs-property\">defense_evasion</span>\n    - attack.<span class=\"hljs-property\">t1562</span><span class=\"hljs-number\">.004</span>\n<span class=\"hljs-attr\">logsource</span>:\n    <span class=\"hljs-attr\">product</span>: windows\n    <span class=\"hljs-attr\">service</span>: firewall-<span class=\"hljs-keyword\">as</span>\n<span class=\"hljs-attr\">detection</span>:\n    <span class=\"hljs-attr\">selection</span>:\n        <span class=\"hljs-title class_\">EventID</span>:\n            - <span class=\"hljs-number\">2004</span> # <span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-title class_\">Defender</span> 방화벽 예외 목록에 규칙이 추가됨\n            - <span class=\"hljs-number\">2071</span> # <span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-title class_\">Defender</span> 방화벽 예외 목록에 규칙이 추가됨. (<span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-number\">11</span>)\n            - <span class=\"hljs-number\">2097</span>\n    <span class=\"hljs-attr\">filter_main_block</span>:\n        <span class=\"hljs-title class_\">Action</span>: <span class=\"hljs-number\">2</span> # 차단\n    <span class=\"hljs-attr\">filter_main_generic</span>:\n        <span class=\"hljs-title class_\">ApplicationPath</span>|<span class=\"hljs-attr\">contains</span>:\n            - <span class=\"hljs-string\">':\\Program Files (x86)\\'\n            - '</span>:\\<span class=\"hljs-title class_\">Program</span> <span class=\"hljs-title class_\">Files</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">System32</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">SysWOW64</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">WinSxS</span>\\<span class=\"hljs-string\">'\n    filter_optional_msmpeng:\n        ModifyingApplication|contains|all:\n            - '</span>:\\<span class=\"hljs-title class_\">ProgramData</span>\\<span class=\"hljs-title class_\">Microsoft</span>\\<span class=\"hljs-title class_\">Windows</span> <span class=\"hljs-title class_\">Defender</span>\\<span class=\"hljs-title class_\">Platform</span>\\<span class=\"hljs-string\">'\n            - '</span>\\<span class=\"hljs-title class_\">MsMpEng</span>.<span class=\"hljs-property\">exe</span><span class=\"hljs-string\">'\n    filter_main_covered_paths:\n        # 이 필터는 9e2575e7-2cb9-4da1-adc8-ed94221dca5e로부터의 중복 경고 방지를 위해 추가되었습니다\n        ApplicationPath|contains:\n            - '</span>:\\<span class=\"hljs-title class_\">PerfLogs</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Tmp</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Users</span>\\<span class=\"hljs-title class_\">Public</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">Tasks</span>\\<span class=\"hljs-string\">'\n            - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n            - '</span>\\<span class=\"hljs-title class_\">AppData</span>\\<span class=\"hljs-title class_\">Local</span>\\<span class=\"hljs-title class_\">Temp</span>\\<span class=\"hljs-string\">'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nlevel: medium\n</span></code></pre>\n<p><code>PDQDeployRunner</code>를 사용하여 추가 경로 및 프로세스가 규칙에 추가되었습니다. 이는 악의적인 랜섬웨어 위협 행위자들이 환경 전체로 악성 소프트웨어를 배포하기 위해 종종 사용하는 유틸리티입니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">title</span>: <span class=\"hljs-title class_\">PDQDeployRunner</span>의 잠재적으로 의심스러운 실행\n<span class=\"hljs-attr\">id</span>: 12b8e9f5-96b2-<span class=\"hljs-number\">41e1</span>-9a42-8c6779a5c184\n<span class=\"hljs-attr\">related</span>:\n    - <span class=\"hljs-attr\">id</span>: d679950c-abb7-43a6-80fb-2a480c4fc450\n      <span class=\"hljs-attr\">type</span>: 비슷함\n<span class=\"hljs-attr\">status</span>: 테스트\n<span class=\"hljs-attr\">description</span>: <span class=\"hljs-string\">\"PDQDeployRunner\"</span>의 의심스러운 실행을 감지합니다. 이는 원격 장치에서 명령과 패키지를 실행하는 <span class=\"hljs-title class_\">PDQDeploy</span> 서비스 스택의 일부입니다\n<span class=\"hljs-attr\">references</span>:\n    - <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//twitter.com/malmoeb/status/1550483085472432128</span>\n<span class=\"hljs-attr\">author</span>: <span class=\"hljs-title class_\">Nasreddine</span> <span class=\"hljs-title class_\">Bencherchali</span> (<span class=\"hljs-title class_\">Nextron</span> <span class=\"hljs-title class_\">Systems</span>)\n<span class=\"hljs-attr\">date</span>: <span class=\"hljs-number\">2022</span>/<span class=\"hljs-number\">07</span>/<span class=\"hljs-number\">22</span>\n<span class=\"hljs-attr\">modified</span>: <span class=\"hljs-number\">2024</span>/<span class=\"hljs-number\">05</span>/<span class=\"hljs-number\">02</span>\n<span class=\"hljs-attr\">tags</span>:\n    - 공격.실행\n<span class=\"hljs-attr\">logsource</span>:\n    <span class=\"hljs-attr\">category</span>: process_creation\n    <span class=\"hljs-attr\">product</span>: windows\n<span class=\"hljs-attr\">detection</span>:\n    <span class=\"hljs-attr\">selection_parent</span>:\n        <span class=\"hljs-title class_\">ParentImage</span>|<span class=\"hljs-attr\">contains</span>: <span class=\"hljs-string\">'\\PDQDeployRunner-'</span>\n    <span class=\"hljs-attr\">selection_child</span>:\n        # 다른 의심스러운 프로세스, 명령줄 또는 경로 추가하여 이 섹션을 개선\n        - <span class=\"hljs-title class_\">Image</span>|<span class=\"hljs-attr\">endswith</span>:\n              # 다음 프로세스 중 하나를 정상적으로 사용할 경우 주석 처리\n              - <span class=\"hljs-string\">'\\bash.exe'</span>\n              - <span class=\"hljs-string\">'\\certutil.exe'</span>\n              - <span class=\"hljs-string\">'\\cmd.exe'</span>\n              - <span class=\"hljs-string\">'\\csc.exe'</span>\n              - <span class=\"hljs-string\">'\\cscript.exe'</span>\n              - <span class=\"hljs-string\">'\\dllhost.exe'</span>\n              - <span class=\"hljs-string\">'\\mshta.exe'</span>\n              - <span class=\"hljs-string\">'\\msiexec.exe'</span>\n              - <span class=\"hljs-string\">'\\regsvr32.exe'</span>\n              - <span class=\"hljs-string\">'\\rundll32.exe'</span>\n              - <span class=\"hljs-string\">'\\scriptrunner.exe'</span>\n              - <span class=\"hljs-string\">'\\wmic.exe'</span>\n              - <span class=\"hljs-string\">'\\wscript.exe'</span>\n              - <span class=\"hljs-string\">'\\wsl.exe'</span>\n        - <span class=\"hljs-title class_\">Image</span>|<span class=\"hljs-attr\">contains</span>:\n              - <span class=\"hljs-string\">':\\ProgramData\\'\n              - '</span>:\\<span class=\"hljs-title class_\">Users</span>\\<span class=\"hljs-title class_\">Public</span>\\<span class=\"hljs-string\">'\n              - '</span>:\\<span class=\"hljs-title class_\">Windows</span>\\<span class=\"hljs-variable constant_\">TEMP</span>\\<span class=\"hljs-string\">'\n              - '</span>\\<span class=\"hljs-title class_\">AppData</span>\\<span class=\"hljs-title class_\">Local</span>\\<span class=\"hljs-title class_\">Temp</span><span class=\"hljs-string\">'\n        - CommandLine|contains:\n              - '</span> -decode <span class=\"hljs-string\">'\n              - '</span> -enc <span class=\"hljs-string\">'\n              - '</span> -encodedcommand <span class=\"hljs-string\">'\n              - '</span> -w hidden<span class=\"hljs-string\">'\n              - '</span><span class=\"hljs-title class_\">DownloadString</span><span class=\"hljs-string\">'\n              - '</span><span class=\"hljs-title class_\">FromBase64String</span><span class=\"hljs-string\">'\n              - '</span>http<span class=\"hljs-string\">'\n              - '</span>iex <span class=\"hljs-string\">'\n              - '</span><span class=\"hljs-title class_\">Invoke</span>-<span class=\"hljs-string\">'\n    condition: all of selection_*\nfalsepositives:\n    - PDQDeploy 도구를 사용하여 이러한 명령을 실행하는 것이 정당할 경우\nlevel: medium\n</span></code></pre>\n<p>모든 업데이트 목록을 확인하려면 전체 릴리스 변경 로그를 확인하세요.</p>\n<h1>수정 사항</h1>\n<p>이 릴리스에서는 \"Forest Blizzard APT - 프로세스 생성 활동\" 규칙이 작동하지 않도록 만드는 누락된 수정 자를 처리한 것을 확인할 수 있었습니다.</p>\n<p>변경 사항 및 추가 사항의 전체 변경 로그를 확인하려면 아래 릴리스 페이지를 참조해주세요.</p>\n<h1>기여자</h1>\n<p>이 릴리스는 Sigma 커뮤니티 기여자 여러분 덕분에 가능해 졌어요. 다음 분들께 큰 감사를 전합니다.</p>\n<ul>\n<li>@ahmedfarou22</li>\n<li>@frack113</li>\n<li>@hasselj</li>\n<li>@joshnck</li>\n<li>@nasbench</li>\n<li>@pratinavchandra</li>\n<li>@swachchhanda000</li>\n</ul>\n</body>\n</html>\n"},"__N_SSG":true}