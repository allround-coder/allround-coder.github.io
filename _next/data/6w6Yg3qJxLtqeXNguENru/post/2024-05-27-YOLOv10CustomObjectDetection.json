{"pageProps":{"post":{"title":"YOLOv10 Custom Object Detection","description":"","date":"2024-05-27 18:31","slug":"2024-05-27-YOLOv10CustomObjectDetection","content":"\n\nYOLOv10 및 사용자 지정 데이터로 모델 학습 개요\n\n![YOLOv10CustomObjectDetection_0.png](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_0.png)\n\n## 개요\n\nUltralytics Python 패키지를 사용하여 개발된 YOLOv10은 실시간 객체 검출을 위한 새로운 접근 방식을 제공합니다. Qinghua 대학 연구원들이 개발한 이 모델은 모델 아키텍처 개선과 non-maximum suppression (NMS) 제거를 통해 성능을 향상시켰습니다. 이러한 최적화로 인해 더 낮은 계산 요구사항으로 최신 기술 성능을 제공합니다. YOLOv10은 다양한 모델 규모에 대해 우수한 정확도-대기간 교환을 제공하는 것으로 실험 결과 보여졌습니다.\n\n<div class=\"content-ad\"></div>\n\n내 이전 기사를 읽은 사람들은 알겠지만, YOLO 모델을 사용한 다양한 프로젝트를 공유해 왔습니다. 사전 학습된 모델 중에서 성능과 효율성 면에서 두드러지는 YOLO 모델입니다. 그러나 실시간 객체 감지는 비최대 억제 (NMS)와 구조적 비효율성에 의해 도전을 겪어왔습니다. YOLOv10은 이러한 문제를 해결하기 위해 NMS를 제거하고 효율성과 정확도 양쪽을 모두 고려한 설계 전략을 채택했습니다.\n\n## 구조\n\n![YOLOv10CustomObjectDetection_1](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_1.png)\n\n- 백본: 특징 추출을 담당하는 백본은 CSPNet (Cross Stage Partial Network)의 향상된 버전을 사용하여 기울기 흐름을 개선하고 계산 중복성을 줄였습니다.\n- 넥: 다양한 스케일의 특징을 집계하고 헤드로 전달하는 넥은 효과적인 다중 스케일 특징 퓨전을 위해 PAN (Path Aggregation Network) 레이어를 포함하고 있습니다.\n- One-to-Many 헤드: 훈련 중 하나의 객체에 대해 여러 예측을 생성하여 풍부한 지도 신호를 제공하고 학습 정확도를 향상시킵니다.\n- One-to-One 헤드: 추론 중 하나의 객체에 대해 최상의 예측을 생성하여 NMS의 필요성을 제거하고 지연 시간을 줄이며 효율성을 향상시킵니다.\n\n<div class=\"content-ad\"></div>\n\n## 모델 변형과 성능\n\nYOLOv10은 여섯 가지 모델로 제공됩니다:\n\n- YOLOv10-N: 매우 자원이 제한된 환경을 위한 나노 버전.\n- YOLOv10-S: 속도와 정확도를 균형있게 유지한 작은 버전.\n- YOLOv10-M: 일반적인 용도를 위한 중간 버전.\n- YOLOv10-B: 정확도를 높이기 위해 넓이를 증가시킨 균형잡힌 버전.\n- YOLOv10-L: 컴퓨팅 자원을 늘리는 대가로 더 높은 정확도를 가진 대형 버전.\n- YOLOv10-X: 최대 정확도와 성능을 위한 초대형 버전\n\n![이미지](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_2.png)\n\n<div class=\"content-ad\"></div>\n\n## 비교\n\n서로 다른 모델 간의 지연 시간과 정확도에 대한 비교를 살펴봅시다. 이는 COCO와 같은 표준 벤치마크에서 테스트되었습니다.\n\n![Image 1](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_3.png)\n\n![Image 2](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_4.png)\n\n<div class=\"content-ad\"></div>\n\nYOLOv10은 실시간 객체 검출 애플리케이션에 대한 첨단 기술로, 더 적은 매개변수로 더 높은 정확도와 속도 성능을 제공합니다.\n\n## 사용자 정의 객체 검출을 위한 YOLOv10 훈련\n\n먼저, 공식 YOLOv10 GitHub 저장소를 복제하여 필요한 yolov10n 모델을 다운로드하세요.\n\n```js\n!pip install -q git+https://github.com/THU-MIG/yolov10.git\n\n!wget -P -q https://github.com/jameslahm/yolov10/releases/download/v1.0/yolov10n.pt\n```\n\n<div class=\"content-ad\"></div>\n\n로보플로 유니버스에서 원하는 사용자 정의 프로젝트를 실험하고, 직접 데이터셋을 생성하며, 인텔이 후원하는 RF100 데이터셋을 사용할 수 있어요. 이 게시물에서는 X-레이 이미지에서 위험한 항목을 감지하기 위해 준비된 데이터셋을 사용할 거에요.\n\n로보플로 API를 사용하여 YOLOv8 형식으로 모델을 다운로드하세요.\n\n```python\n!pip install -q roboflow\nfrom roboflow import Roboflow\nrf = Roboflow(api_key=\"your-api-key\")\nproject = rf.workspace(\"vladutc\").project(\"x-ray-baggage\")\nversion = project.version(3)\ndataset = version.download(\"yolov8\")\n```\n\n매개변수와 파일 경로를 지정한 다음, 모델 훈련을 시작하세요.\n\n<div class=\"content-ad\"></div>\n\n```md\n!yolo task=detect mode=train epochs=25 batch=32 plots=True \\\nmodel='/content/-q/yolov10n.pt' \\\ndata='/content/X-Ray-Baggage-3/data.yaml'\n```\n\n예시 data.yaml 파일\n\n```md\nnames:\n- Gun\n- Knife\n- Pliers\n- Scissors\n- Wrench\n\nnc: 5\n\nroboflow:\n  license: CC BY 4.0\n  project: x-ray-baggage\n  url: https://universe.roboflow.com/vladutc/x-ray-baggage/dataset/3\n  version: 3\n  workspace: vladutc\n\ntest: /content/X-Ray-Baggage-3/test/images\ntrain: /content/X-Ray-Baggage-3/train/images\nval: /content/X-Ray-Baggage-3/valid/images\n```\n\n결과를 살펴봅시다.\n \n\n<div class=\"content-ad\"></div>\n\nmd\n![Training results](/content/runs/detect/train/results.png){width=1000}\n\n![Prediction results](/assets/img/2024-05-27-YOLOv10CustomObjectDetection_5.png)\n\n테스트 데이터를 예측하고 결과를 5x2 그리드로 표시합니다.\n\n```python\nfrom ultralytics import YOLOv10\n\nmodel_path = '/content/runs/detect/train/weights/best.pt'\nmodel = YOLOv10(model_path)\nresults = model(source='/content/X-Ray-Baggage-3/test/images', conf=0.25, save=True)\n```\n\n\n<div class=\"content-ad\"></div>\n\n```js\nimport glob\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\n\nimages = glob.glob('/content/runs/detect/predict/*.jpg')\n\nimages_to_display = images[:10]\n\nfig, axes = plt.subplots(2, 5, figsize=(20, 10))\n\nfor i, ax in enumerate(axes.flat):\n    if i < len(images_to_display):\n        img = mpimg.imread(images_to_display[i])\n        ax.imshow(img)\n        ax.axis('off')  \n    else:\n        ax.axis('off')  \n\nplt.tight_layout()\nplt.show()\n```\n\n<img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_6.png\" />\n\n## 결론 및 권장 사항\n\n- 이 글을 작성하는 동안 여러 데이터셋에서 YOLOv10n 모델을 학습하여 Colab의 15GB 무료 T4 GPU 한도를 고갈시켰습니다. Colab 환경에서 모델을 학습할 때 한도를 초과하면 T4 GPU에 제한이 있습니다. 이 문제를 해결하기 위해 다른 구글 계정으로 로그인할 수 있습니다.\n- 기술이 빠르게 발전함에 따라 컴퓨터 비전과 대형 언어 모델 양쪽에서 단일 기술에 갇히지 않고 주요 개념을 배우는 것이 유익하다고 생각됩니다. 이를 적응하기 위해 이러한 기술의 개발자들로부터 배우는 것이 도움이 됩니다. Ultralytics와 Roboflow의 콘텐츠는 이 분야에서 매우 가치 있으며, 그들을 팔로우하는 것이 바람직합니다.\n\n\n<div class=\"content-ad\"></div>\n\n## 참고 자료\n\n- 공식 레포: https://github.com/THU-MIG/yolov10\n- 울트라리틱스 (Ultralytics)\n- 로보플로우 (Roboflow)\n\n```js\n@article{THU-MIGyolov10,\n  title={YOLOv10: 실시간 엔드 투 엔드 객체 검출},\n  author={Ao Wang, Hui Chen, Lihao Liu 등},\n  journal={arXiv 사전 인쇄 arXiv:2405.14458},\n  year={2024},\n  institution={Tsinghua University},\n  license={AGPL-3.0}\n}\n```\n\n```js\n@misc{\nx-ray-baggage_dataset,\ntitle={X-레이 수하물 데이터셋},\ntype={오픈 소스 데이터셋},\nauthor={vladutc},\nhowpublished={\\url{ https://universe.roboflow.com/vladutc/x-ray-baggage }},\nurl={https://universe.roboflow.com/vladutc/x-ray-baggage},\njournal={Roboflow Universe},\npublisher={Roboflow},\nyear={2024},\nmonth={5},\nnote={방문일: 2024년 5월 26일},\n}\n```\n\n<div class=\"content-ad\"></div>\n\n저는 청화 대학교의 연구원들, Ultralytics와 Roboflow 팀, 그리고 오픈 소스 커뮤니티의 모든 기여자들에게 감사드립니다.","ogImage":{"url":"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_0.png"},"coverImage":"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_0.png","tag":["Tech"],"readingTime":6},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>YOLOv10 및 사용자 지정 데이터로 모델 학습 개요</p>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_0.png\" alt=\"YOLOv10CustomObjectDetection_0.png\"></p>\n<h2>개요</h2>\n<p>Ultralytics Python 패키지를 사용하여 개발된 YOLOv10은 실시간 객체 검출을 위한 새로운 접근 방식을 제공합니다. Qinghua 대학 연구원들이 개발한 이 모델은 모델 아키텍처 개선과 non-maximum suppression (NMS) 제거를 통해 성능을 향상시켰습니다. 이러한 최적화로 인해 더 낮은 계산 요구사항으로 최신 기술 성능을 제공합니다. YOLOv10은 다양한 모델 규모에 대해 우수한 정확도-대기간 교환을 제공하는 것으로 실험 결과 보여졌습니다.</p>\n<p>내 이전 기사를 읽은 사람들은 알겠지만, YOLO 모델을 사용한 다양한 프로젝트를 공유해 왔습니다. 사전 학습된 모델 중에서 성능과 효율성 면에서 두드러지는 YOLO 모델입니다. 그러나 실시간 객체 감지는 비최대 억제 (NMS)와 구조적 비효율성에 의해 도전을 겪어왔습니다. YOLOv10은 이러한 문제를 해결하기 위해 NMS를 제거하고 효율성과 정확도 양쪽을 모두 고려한 설계 전략을 채택했습니다.</p>\n<h2>구조</h2>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_1.png\" alt=\"YOLOv10CustomObjectDetection_1\"></p>\n<ul>\n<li>백본: 특징 추출을 담당하는 백본은 CSPNet (Cross Stage Partial Network)의 향상된 버전을 사용하여 기울기 흐름을 개선하고 계산 중복성을 줄였습니다.</li>\n<li>넥: 다양한 스케일의 특징을 집계하고 헤드로 전달하는 넥은 효과적인 다중 스케일 특징 퓨전을 위해 PAN (Path Aggregation Network) 레이어를 포함하고 있습니다.</li>\n<li>One-to-Many 헤드: 훈련 중 하나의 객체에 대해 여러 예측을 생성하여 풍부한 지도 신호를 제공하고 학습 정확도를 향상시킵니다.</li>\n<li>One-to-One 헤드: 추론 중 하나의 객체에 대해 최상의 예측을 생성하여 NMS의 필요성을 제거하고 지연 시간을 줄이며 효율성을 향상시킵니다.</li>\n</ul>\n<h2>모델 변형과 성능</h2>\n<p>YOLOv10은 여섯 가지 모델로 제공됩니다:</p>\n<ul>\n<li>YOLOv10-N: 매우 자원이 제한된 환경을 위한 나노 버전.</li>\n<li>YOLOv10-S: 속도와 정확도를 균형있게 유지한 작은 버전.</li>\n<li>YOLOv10-M: 일반적인 용도를 위한 중간 버전.</li>\n<li>YOLOv10-B: 정확도를 높이기 위해 넓이를 증가시킨 균형잡힌 버전.</li>\n<li>YOLOv10-L: 컴퓨팅 자원을 늘리는 대가로 더 높은 정확도를 가진 대형 버전.</li>\n<li>YOLOv10-X: 최대 정확도와 성능을 위한 초대형 버전</li>\n</ul>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_2.png\" alt=\"이미지\"></p>\n<h2>비교</h2>\n<p>서로 다른 모델 간의 지연 시간과 정확도에 대한 비교를 살펴봅시다. 이는 COCO와 같은 표준 벤치마크에서 테스트되었습니다.</p>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_3.png\" alt=\"Image 1\"></p>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_4.png\" alt=\"Image 2\"></p>\n<p>YOLOv10은 실시간 객체 검출 애플리케이션에 대한 첨단 기술로, 더 적은 매개변수로 더 높은 정확도와 속도 성능을 제공합니다.</p>\n<h2>사용자 정의 객체 검출을 위한 YOLOv10 훈련</h2>\n<p>먼저, 공식 YOLOv10 GitHub 저장소를 복제하여 필요한 yolov10n 모델을 다운로드하세요.</p>\n<pre><code class=\"hljs language-js\">!pip install -q git+<span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//github.com/THU-MIG/yolov10.git</span>\n\n!wget -P -q <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//github.com/jameslahm/yolov10/releases/download/v1.0/yolov10n.pt</span>\n</code></pre>\n<p>로보플로 유니버스에서 원하는 사용자 정의 프로젝트를 실험하고, 직접 데이터셋을 생성하며, 인텔이 후원하는 RF100 데이터셋을 사용할 수 있어요. 이 게시물에서는 X-레이 이미지에서 위험한 항목을 감지하기 위해 준비된 데이터셋을 사용할 거에요.</p>\n<p>로보플로 API를 사용하여 YOLOv8 형식으로 모델을 다운로드하세요.</p>\n<pre><code class=\"hljs language-python\">!pip install -q roboflow\n<span class=\"hljs-keyword\">from</span> roboflow <span class=\"hljs-keyword\">import</span> Roboflow\nrf = Roboflow(api_key=<span class=\"hljs-string\">\"your-api-key\"</span>)\nproject = rf.workspace(<span class=\"hljs-string\">\"vladutc\"</span>).project(<span class=\"hljs-string\">\"x-ray-baggage\"</span>)\nversion = project.version(<span class=\"hljs-number\">3</span>)\ndataset = version.download(<span class=\"hljs-string\">\"yolov8\"</span>)\n</code></pre>\n<p>매개변수와 파일 경로를 지정한 다음, 모델 훈련을 시작하세요.</p>\n<pre><code class=\"hljs language-md\">!yolo task=detect mode=train epochs=25 batch=32 plots=True \\\nmodel='/content/-q/yolov10n.pt' \\\ndata='/content/X-Ray-Baggage-3/data.yaml'\n</code></pre>\n<p>예시 data.yaml 파일</p>\n<pre><code class=\"hljs language-md\">names:\n<span class=\"hljs-bullet\">-</span> Gun\n<span class=\"hljs-bullet\">-</span> Knife\n<span class=\"hljs-bullet\">-</span> Pliers\n<span class=\"hljs-bullet\">-</span> Scissors\n<span class=\"hljs-bullet\">-</span> Wrench\n\nnc: 5\n\nroboflow:\n  license: CC BY 4.0\n  project: x-ray-baggage\n  url: https://universe.roboflow.com/vladutc/x-ray-baggage/dataset/3\n  version: 3\n  workspace: vladutc\n\ntest: /content/X-Ray-Baggage-3/test/images\ntrain: /content/X-Ray-Baggage-3/train/images\nval: /content/X-Ray-Baggage-3/valid/images\n</code></pre>\n<p>결과를 살펴봅시다.</p>\n<p>md\n<img src=\"/content/runs/detect/train/results.png\" alt=\"Training results\">{width=1000}</p>\n<p><img src=\"/assets/img/2024-05-27-YOLOv10CustomObjectDetection_5.png\" alt=\"Prediction results\"></p>\n<p>테스트 데이터를 예측하고 결과를 5x2 그리드로 표시합니다.</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-keyword\">from</span> ultralytics <span class=\"hljs-keyword\">import</span> YOLOv10\n\nmodel_path = <span class=\"hljs-string\">'/content/runs/detect/train/weights/best.pt'</span>\nmodel = YOLOv10(model_path)\nresults = model(source=<span class=\"hljs-string\">'/content/X-Ray-Baggage-3/test/images'</span>, conf=<span class=\"hljs-number\">0.25</span>, save=<span class=\"hljs-literal\">True</span>)\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> glob\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">pyplot</span> <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">image</span> <span class=\"hljs-keyword\">as</span> mpimg\n\nimages = glob.<span class=\"hljs-title function_\">glob</span>(<span class=\"hljs-string\">'/content/runs/detect/predict/*.jpg'</span>)\n\nimages_to_display = images[:<span class=\"hljs-number\">10</span>]\n\nfig, axes = plt.<span class=\"hljs-title function_\">subplots</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">5</span>, figsize=(<span class=\"hljs-number\">20</span>, <span class=\"hljs-number\">10</span>))\n\n<span class=\"hljs-keyword\">for</span> i, ax <span class=\"hljs-keyword\">in</span> <span class=\"hljs-title function_\">enumerate</span>(axes.<span class=\"hljs-property\">flat</span>):\n    <span class=\"hljs-keyword\">if</span> i &#x3C; <span class=\"hljs-title function_\">len</span>(images_to_display):\n        img = mpimg.<span class=\"hljs-title function_\">imread</span>(images_to_display[i])\n        ax.<span class=\"hljs-title function_\">imshow</span>(img)\n        ax.<span class=\"hljs-title function_\">axis</span>(<span class=\"hljs-string\">'off'</span>)  \n    <span class=\"hljs-attr\">else</span>:\n        ax.<span class=\"hljs-title function_\">axis</span>(<span class=\"hljs-string\">'off'</span>)  \n\nplt.<span class=\"hljs-title function_\">tight_layout</span>()\nplt.<span class=\"hljs-title function_\">show</span>()\n</code></pre>\n<h2>결론 및 권장 사항</h2>\n<ul>\n<li>이 글을 작성하는 동안 여러 데이터셋에서 YOLOv10n 모델을 학습하여 Colab의 15GB 무료 T4 GPU 한도를 고갈시켰습니다. Colab 환경에서 모델을 학습할 때 한도를 초과하면 T4 GPU에 제한이 있습니다. 이 문제를 해결하기 위해 다른 구글 계정으로 로그인할 수 있습니다.</li>\n<li>기술이 빠르게 발전함에 따라 컴퓨터 비전과 대형 언어 모델 양쪽에서 단일 기술에 갇히지 않고 주요 개념을 배우는 것이 유익하다고 생각됩니다. 이를 적응하기 위해 이러한 기술의 개발자들로부터 배우는 것이 도움이 됩니다. Ultralytics와 Roboflow의 콘텐츠는 이 분야에서 매우 가치 있으며, 그들을 팔로우하는 것이 바람직합니다.</li>\n</ul>\n<h2>참고 자료</h2>\n<ul>\n<li>공식 레포: <a href=\"https://github.com/THU-MIG/yolov10\" rel=\"nofollow\" target=\"_blank\">https://github.com/THU-MIG/yolov10</a></li>\n<li>울트라리틱스 (Ultralytics)</li>\n<li>로보플로우 (Roboflow)</li>\n</ul>\n<pre><code class=\"hljs language-js\">@article{<span class=\"hljs-variable constant_\">THU</span>-<span class=\"hljs-title class_\">MIGyolov10</span>,\n  title={<span class=\"hljs-title class_\">YOLOv10</span>: 실시간 엔드 투 엔드 객체 검출},\n  author={<span class=\"hljs-title class_\">Ao</span> <span class=\"hljs-title class_\">Wang</span>, <span class=\"hljs-title class_\">Hui</span> <span class=\"hljs-title class_\">Chen</span>, <span class=\"hljs-title class_\">Lihao</span> <span class=\"hljs-title class_\">Liu</span> 등},\n  journal={arXiv 사전 인쇄 <span class=\"hljs-attr\">arXiv</span>:<span class=\"hljs-number\">2405.14458</span>},\n  year={<span class=\"hljs-number\">2024</span>},\n  institution={<span class=\"hljs-title class_\">Tsinghua</span> <span class=\"hljs-title class_\">University</span>},\n  license={<span class=\"hljs-variable constant_\">AGPL</span>-<span class=\"hljs-number\">3.0</span>}\n}\n</code></pre>\n<pre><code class=\"hljs language-js\">@misc{\nx-ray-baggage_dataset,\ntitle={X-레이 수하물 데이터셋},\ntype={오픈 소스 데이터셋},\nauthor={vladutc},\nhowpublished={\\url{ <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//universe.roboflow.com/vladutc/x-ray-baggage }},</span>\nurl={<span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//universe.roboflow.com/vladutc/x-ray-baggage},</span>\njournal={<span class=\"hljs-title class_\">Roboflow</span> <span class=\"hljs-title class_\">Universe</span>},\npublisher={<span class=\"hljs-title class_\">Roboflow</span>},\nyear={<span class=\"hljs-number\">2024</span>},\nmonth={<span class=\"hljs-number\">5</span>},\nnote={방문일: <span class=\"hljs-number\">2024</span>년 <span class=\"hljs-number\">5</span>월 <span class=\"hljs-number\">26</span>일},\n}\n</code></pre>\n<p>저는 청화 대학교의 연구원들, Ultralytics와 Roboflow 팀, 그리고 오픈 소스 커뮤니티의 모든 기여자들에게 감사드립니다.</p>\n</body>\n</html>\n"},"__N_SSG":true}