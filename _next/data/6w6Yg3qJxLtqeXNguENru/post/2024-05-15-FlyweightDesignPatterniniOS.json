{"pageProps":{"post":{"title":"iOS에서의 Flyweight 디자인 패턴","description":"","date":"2024-05-15 15:39","slug":"2024-05-15-FlyweightDesignPatterniniOS","content":"\n\n<img src=\"/assets/img/2024-05-15-FlyweightDesignPatterniniOS_0.png\" />\n\nFlyweight는 여러 객체의 메모리 사용량을 줄일 수 있는 구조적 디자인 패턴입니다. 이 패턴은 몇 가지 속성 또는 상태를 완벽히 외부로 공유하는 객체들의 메모리 사용을 줄일 수 있게 해줍니다.\n\n# 구현\n\n우선, 먼저 다음 두 가지 개념, 내재 상태와 외재 상태를 이해하는 것이 필요합니다.\n\n\n\n## 내재 상태\n\n내재 상태란 물체의 속성 중에서 불변인 것들을 말합니다. 즉, 이들은 시간이 지나도 변하지 않는 속성들로 운전 면허증 사용자의 출생 날짜나 국적 등이 이에 해당합니다.\n\n## 외재 상태\n\n반면, 외재 상태는 모두 가변 속성을 의미합니다. 즉, 언젠가는 변할 속성들로 여권의 만료 날짜나 발급 장소 등이 이에 해당합니다.\n\n\n\n이 패턴을 구현하려면 객체의 본질적 상태와 외부적 상태를 구분하기 위해 식별해야 합니다.\n\n예를 들어 기관이나 정부 의존성은 운전 면허증 정보를 모두 기록할 수 있고 다른 종속성은 모든 여권 정보를 가질 수 있습니다.\n\n```js\nimport Foundation\n\nenum State: String { ... }\nenum Nationality: String { ... }\nenum BloodType: String { ... }\n\nstruct Address: Identifiable {\n  let mainStreet: String\n  let number: String\n  let zipCode: String\n  // ...\n}\n\nclass DriverLincense {\n  let nationalID: UUID\n  let name: String\n  let surname: String\n  let birthDate: Date\n  let nationality: Nationality\n  let bloodType: BloodType\n  var state: State\n  var expedition: Date\n  var expiration: Date\n  var address: Address\n  // ...\n}\n\n//... 다른 종속성\n\nenum StateCode: String { ... }\n\nclass PassportInfo {\n  let passportID: UUID\n  let nationalID: UUID\n  let name: String\n  let surname: String\n  let birthDate: Date\n  let birthPlace: String\n  let nationality: Nationality\n  let bloodType: BloodType\n  var expedition: Date\n  var expiration: Date\n  var stateCode: StateCode\n}\n```\n\n이 예시에서, 특정 정보가 반복될 수 있고 변경되지 않을 때 추출하여 사용할 수 있음을 알 수 있습니다. 이를 내적(본질적) 상태라고 합니다.\n\n\n\n```js\n// 내재 상태\nclass PersonalInfo {\n  let nationalID: UUID\n  let name: String\n  let surname: String\n  let birthDate: Date\n  let birthPlace: String\n  let nationality: Nationality\n  let bloodType: BloodType\n}\n```\n\n이렇게 함으로써, 실제 유형은 메모리에 두 번 저장하는 대신 단일 내재 상태를 가리킬 수 있습니다.\n\n```js\nclass DriverLincense {\n  let personalInfo: PersonalInfo\n\n  // 외부 상태\n  var state: State\n  var expedition: Date\n  var expiration: Date\n  var address: Address\n}\n\nclass PassportInfo {\n  let personalInfo: PersonalInfo\n\n  // 외부 상태\n  let stateCode: StateCode\n  var expedition: Date\n  var expiration: Date\n}\n```\n\n그리고 이제 이러한 객체들은 동일한 불변 상태를 공유하고 메모리를 절약할 수 있습니다.\n\n\n\n\n```js\n// 공유 정보\nlet myInfo = PersonalInfo( ... )\n\nlet myDriverLicense = DriverLicense(personalInfo: myInfo, ... )\nlet myPassportInfo = PassportInfo(personalInfo: myInfo, ... )\n```\n\n## 장점\n\n이 구조적 패턴은 동시에 로딩하는 데 시간이 많이 걸리거나 여러 인스턴스를 관리할 때 리소스를 절약하는 데 중점을 둡니다.\n\n- 메모리 사용량을 절약합니다. 공통 상태를 공유하므로 메모리 사용량이 줄어듭니다. 해당 상태는 변경되지 않습니다.```\n\n\n\n## 일반적인 실수\n\n- 동일한 속성과 값으로 동일한 객체의 여러 내재 상태를 사용하는 것입니다. 이 문제를 회피하려면 싱글톤 또는 플라이웨이트 팩토리를 이용하여 각 객체가 하나씩만 있도록 합니다.\n\n# 결론\n\n이 패턴은 여러 객체가 공통 데이터를 공유하며 개별적으로 처리될 때 정말 유용해집니다. 예를 들어 비디오 게임은 여러 객체를 렌더링하기 위해 일괄적으로 로드해야 하지만, 텍스처는 메모리를 절약하기 위해 한 번만 로드되고, 필요할 때 객체를 표시할 모든 인스턴스에서 공유될 것입니다.","ogImage":{"url":"/assets/img/2024-05-15-FlyweightDesignPatterniniOS_0.png"},"coverImage":"/assets/img/2024-05-15-FlyweightDesignPatterniniOS_0.png","tag":["Tech"],"readingTime":3},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>Flyweight는 여러 객체의 메모리 사용량을 줄일 수 있는 구조적 디자인 패턴입니다. 이 패턴은 몇 가지 속성 또는 상태를 완벽히 외부로 공유하는 객체들의 메모리 사용을 줄일 수 있게 해줍니다.</p>\n<h1>구현</h1>\n<p>우선, 먼저 다음 두 가지 개념, 내재 상태와 외재 상태를 이해하는 것이 필요합니다.</p>\n<h2>내재 상태</h2>\n<p>내재 상태란 물체의 속성 중에서 불변인 것들을 말합니다. 즉, 이들은 시간이 지나도 변하지 않는 속성들로 운전 면허증 사용자의 출생 날짜나 국적 등이 이에 해당합니다.</p>\n<h2>외재 상태</h2>\n<p>반면, 외재 상태는 모두 가변 속성을 의미합니다. 즉, 언젠가는 변할 속성들로 여권의 만료 날짜나 발급 장소 등이 이에 해당합니다.</p>\n<p>이 패턴을 구현하려면 객체의 본질적 상태와 외부적 상태를 구분하기 위해 식별해야 합니다.</p>\n<p>예를 들어 기관이나 정부 의존성은 운전 면허증 정보를 모두 기록할 수 있고 다른 종속성은 모든 여권 정보를 가질 수 있습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Foundation</span>\n\nenum <span class=\"hljs-title class_\">State</span>: <span class=\"hljs-title class_\">String</span> { ... }\nenum <span class=\"hljs-title class_\">Nationality</span>: <span class=\"hljs-title class_\">String</span> { ... }\nenum <span class=\"hljs-title class_\">BloodType</span>: <span class=\"hljs-title class_\">String</span> { ... }\n\nstruct <span class=\"hljs-title class_\">Address</span>: <span class=\"hljs-title class_\">Identifiable</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">mainStreet</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">number</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">zipCode</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DriverLincense</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationalID</span>: <span class=\"hljs-variable constant_\">UUID</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">name</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">surname</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">birthDate</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationality</span>: <span class=\"hljs-title class_\">Nationality</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">bloodType</span>: <span class=\"hljs-title class_\">BloodType</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">state</span>: <span class=\"hljs-title class_\">State</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expedition</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expiration</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">address</span>: <span class=\"hljs-title class_\">Address</span>\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-comment\">//... 다른 종속성</span>\n\nenum <span class=\"hljs-title class_\">StateCode</span>: <span class=\"hljs-title class_\">String</span> { ... }\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">PassportInfo</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">passportID</span>: <span class=\"hljs-variable constant_\">UUID</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationalID</span>: <span class=\"hljs-variable constant_\">UUID</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">name</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">surname</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">birthDate</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">birthPlace</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationality</span>: <span class=\"hljs-title class_\">Nationality</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">bloodType</span>: <span class=\"hljs-title class_\">BloodType</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expedition</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expiration</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">stateCode</span>: <span class=\"hljs-title class_\">StateCode</span>\n}\n</code></pre>\n<p>이 예시에서, 특정 정보가 반복될 수 있고 변경되지 않을 때 추출하여 사용할 수 있음을 알 수 있습니다. 이를 내적(본질적) 상태라고 합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// 내재 상태</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">PersonalInfo</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationalID</span>: <span class=\"hljs-variable constant_\">UUID</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">name</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">surname</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">birthDate</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">birthPlace</span>: <span class=\"hljs-title class_\">String</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">nationality</span>: <span class=\"hljs-title class_\">Nationality</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">bloodType</span>: <span class=\"hljs-title class_\">BloodType</span>\n}\n</code></pre>\n<p>이렇게 함으로써, 실제 유형은 메모리에 두 번 저장하는 대신 단일 내재 상태를 가리킬 수 있습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DriverLincense</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">personalInfo</span>: <span class=\"hljs-title class_\">PersonalInfo</span>\n\n  <span class=\"hljs-comment\">// 외부 상태</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">state</span>: <span class=\"hljs-title class_\">State</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expedition</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expiration</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">address</span>: <span class=\"hljs-title class_\">Address</span>\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">PassportInfo</span> {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">personalInfo</span>: <span class=\"hljs-title class_\">PersonalInfo</span>\n\n  <span class=\"hljs-comment\">// 외부 상태</span>\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">stateCode</span>: <span class=\"hljs-title class_\">StateCode</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expedition</span>: <span class=\"hljs-title class_\">Date</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-attr\">expiration</span>: <span class=\"hljs-title class_\">Date</span>\n}\n</code></pre>\n<p>그리고 이제 이러한 객체들은 동일한 불변 상태를 공유하고 메모리를 절약할 수 있습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// 공유 정보</span>\n<span class=\"hljs-keyword\">let</span> myInfo = <span class=\"hljs-title class_\">PersonalInfo</span>( ... )\n\n<span class=\"hljs-keyword\">let</span> myDriverLicense = <span class=\"hljs-title class_\">DriverLicense</span>(<span class=\"hljs-attr\">personalInfo</span>: myInfo, ... )\n<span class=\"hljs-keyword\">let</span> myPassportInfo = <span class=\"hljs-title class_\">PassportInfo</span>(<span class=\"hljs-attr\">personalInfo</span>: myInfo, ... )\n</code></pre>\n<h2>장점</h2>\n<p>이 구조적 패턴은 동시에 로딩하는 데 시간이 많이 걸리거나 여러 인스턴스를 관리할 때 리소스를 절약하는 데 중점을 둡니다.</p>\n<ul>\n<li>메모리 사용량을 절약합니다. 공통 상태를 공유하므로 메모리 사용량이 줄어듭니다. 해당 상태는 변경되지 않습니다.```</li>\n</ul>\n<h2>일반적인 실수</h2>\n<ul>\n<li>동일한 속성과 값으로 동일한 객체의 여러 내재 상태를 사용하는 것입니다. 이 문제를 회피하려면 싱글톤 또는 플라이웨이트 팩토리를 이용하여 각 객체가 하나씩만 있도록 합니다.</li>\n</ul>\n<h1>결론</h1>\n<p>이 패턴은 여러 객체가 공통 데이터를 공유하며 개별적으로 처리될 때 정말 유용해집니다. 예를 들어 비디오 게임은 여러 객체를 렌더링하기 위해 일괄적으로 로드해야 하지만, 텍스처는 메모리를 절약하기 위해 한 번만 로드되고, 필요할 때 객체를 표시할 모든 인스턴스에서 공유될 것입니다.</p>\n</body>\n</html>\n"},"__N_SSG":true}