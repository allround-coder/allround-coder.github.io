{"pageProps":{"post":{"title":"Nextjs ì•±ì— Stripe ê²°ì œ ì¶”ê°€í•˜ëŠ” ë°©ë²•","description":"","date":"2024-05-14 16:09","slug":"2024-05-14-HowtoaddStripepaymentstoyourNextjsapp","content":"\n\n<img src=\"/assets/img/2024-05-14-HowtoaddStripepaymentstoyourNextjsapp_0.png\" />\n\nì™€! ë‚´ ë§¤ì²´ ì•”í˜¸ë¥¼ ì°¾ì•˜ì–´ìš”!\n\nì´ì œ, ë‚´ ì²« ë²ˆì§¸ ê¸°ì‚¬ì—ì„œ Stripeë¥¼ Next.js ì•±ì— í†µí•©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ë ¤ê³  í•´ìš”.\n\nì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë„ˆë¬´ ë³µì¡í•œ ê²ƒì„ ë§Œë“œëŠ” ë° ì£¼ì˜ë¥¼ ê¸°ìš¸ì´ì§€ ì•Šì„ ê±°ì—ìš”. ëŒ€ì‹ ì— ìš°ë¦¬ëŠ” ê°„í¸í•œ Next.js 13.4 ì•±ì„ ê°œë°œí•˜ì—¬ ì¼íšŒì„± Stripe ê²°ì œë¥¼ ê°€ëŠ¥í•˜ê²Œ í•  ê±°ì—ìš”.\n\n\n\n## ì„¤ì •í•˜ê¸°\n\ní„°ë¯¸ë„ì„ ì—´ê³  ë‚˜ì˜ ê²½ìš°ì—ëŠ” Workspace ì•ˆì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.\n\n```js\nnpx create-next-app@latest\n```\n\nìœ„ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ \"create-next-app@13.4.1\"ì„ ì„¤ì¹˜í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©° ëª‡ ê°€ì§€ ì§ˆë¬¸ì´ ìˆì„ ê²ë‹ˆë‹¤.\n\n\n\n- í”„ë¡œì íŠ¸ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”? stripe-nextjs\n- TypeScriptë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤\n- ESLintë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤\n- ì´ í”„ë¡œì íŠ¸ì— Tailwind CSSë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ì•„ë‹ˆìš”, ìŠ¤íƒ€ì¼ ì‘ì—…ì„ í•˜ì§€ ì•Šì„ ì˜ˆì •ì´ê¸° ë•Œë¬¸ì—\n- `src/` ë””ë ‰í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤\n- App Routerë¥¼ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë„¤\n- ê¸°ë³¸ import ë³„ì¹­ì„ ì‚¬ìš©ì ì •ì˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì•„ë‹ˆìš”\n\nì§ˆë¬¸ì— ëª¨ë‘ ë‹µí–ˆë‹¤ë©´, ì„¤ì¹˜ê°€ ì‹œì‘ë©ë‹ˆë‹¤!\n\nì´ì œ ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ì‹¤ì œë¡œ Next.js ì•±ì„ ë³´ë ¤ë©´ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. Next.js ì•± ë‚´ë¶€ì— ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n```js\nyarn run dev\n```\n\n\n\në” ë‚˜ì•„ê°€ê¸° ì „ì—, Stripe ê³„ì •ì„ ìƒì„±í•˜ê³  API í‚¤ë¥¼ ë°›ì•„ë´ìš”.\n\nStripe ê³„ì •ì„ ë§Œë“  í›„ì—, dashboard.stripe.com/test/apikeysë¡œ ì´ë™í•´ì„œ API í‚¤ë¥¼ ë°›ì•„ìš”.\n\n## í™˜ê²½ íŒŒì¼ ì„¤ì •í•˜ê¸°\n\në£¨íŠ¸ ë””ë ‰í† ë¦¬ ì•ˆì—, .env.localì´ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”.\n\n\n\n.env.local íŒŒì¼ ì•ˆì— ë‹¤ìŒì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:\n\n```js\nNEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=\"\"\nSTRIPE_SECRET_KEY=\"\"\n```\n\nì—¬ê¸°ì„œ ê¸°ì–µí•´ì•¼ í•  ì¤‘ìš”í•œ ì ì´ ëª‡ ê°€ì§€ ìˆì–´ìš”. ë¨¼ì €, \"\"\"ë¥¼ Stripe í‚¤ë¡œ ëŒ€ì²´í•´ì•¼ í•©ë‹ˆë‹¤. ë‘˜ì§¸ë¡œ, ë‘ ë³€ìˆ˜ ê°„ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í•˜ë‚˜ëŠ” \"NEXT_PUBLIC\"ì„ í¬í•¨í•˜ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°„ë‹¨íˆ ë§í•´ì„œ, \"NEXT_PUBLIC\"ì„ ì‚¬ìš©í•˜ì—¬ STRIPE_PUBLISHABLE_KEYë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ê²ƒì€ ê´œì°®ì§€ë§Œ ì‹œí¬ë¦¿ í‚¤ëŠ” ì ˆëŒ€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì— ë…¸ì¶œë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.\n\nì•Œì•˜ì–´ìš”, ì´í•´í–ˆì–´ìš”? ê·¸ëŸ¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ì‹œë‹¤!\n\n\n\n## í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜í•˜ê¸°\n\në‹¹ì‹ ì˜ Next.js ì•± ë‚´ë¶€ì— ë‹¤ìŒ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ë³´ì„¸ìš”:\n\n```js\n@stripe/react-stripe-js @stripe/stripe-js stripe axios\n```\n\n## ë°±ì—”ë“œ ì‘ì—…ì„ ì‹œì‘í•´ë´…ì‹œë‹¤\n\n\n\nìš°ë¦¬ ì•± í´ë” ì•ˆì— apië¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”. ì´ê³³ì— ëª¨ë“  ë°±ì—”ë“œ ì½”ë“œê°€ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤.\n\napi í´ë” ì•ˆì— create-payment-intentë¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ê³ , ê·¸ ì•ˆì— route.ts ë¼ëŠ” íŒŒì¼ì„ ìƒì„±í•´ì£¼ì„¸ìš”.\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-14-HowtoaddStripepaymentstoyourNextjsapp_1.png)\n\n\"create-payment-intent\" í´ë” ì•ˆì— \"route\"ë¼ëŠ” íŒŒì¼ì„ ë§Œë“œëŠ” ì´ìœ ëŠ” Next.jsì— API ìš”ì²­ì„ ë‹¤ë£¨ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë¦¬ëŠ” ê²ƒì…ë‹ˆë‹¤. ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´, routeëŠ” ë¼ìš°íŒ…ì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ìˆ˜ì¤€ìœ¼ë¡œ, í˜ì´ì§€ê°€ í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë ˆì´ì•„ì›ƒì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ íƒìƒ‰ì— ì˜í–¥ì„ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. \"route.ts\" íŒŒì¼ì´ \"page.ts\" íŒŒì¼ì´ ìˆëŠ” ê³³ì— ì¡´ì¬í•  ìˆ˜ ì—†ë‹¤ëŠ” ì ì„ ëª…ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.\n\n\n\nì—¬ê¸°ëŠ” route.ts íŒŒì¼ì˜ ì½”ë“œì…ë‹ˆë‹¤:\n\n```js\nimport { NextResponse, NextRequest } from \"next/server\";\nimport Stripe from \"stripe\";\n\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {\n  typescript: true,\n  apiVersion: \"2022-11-15\",\n});\n\nexport async function POST(req: NextRequest) {\n  const { data } = await req.json();\n  const { amount } = data;\n  try {\n    const paymentIntent = await stripe.paymentIntents.create({\n      amount: Number(amount) * 100,\n      currency: \"USD\",\n    });\n\n    return new NextResponse(paymentIntent.client_secret, { status: 200 });\n  } catch (error: any) {\n    return new NextResponse(error, {\n      status: 400,\n    });\n  }\n}\n```\n\nì´ê²ƒì„ ìì„¸íˆ ì‚´í´ë³´ê³  ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€ ì´í•´í•´ ë´…ì‹œë‹¤.\n\nì²«ì§¸ë¡œ, ìš°ë¦¬ëŠ” íƒ€ì…ê³¼ stripeë¥¼ import í•©ë‹ˆë‹¤:\n\n\n\n```js\nimport { NextResponse, NextRequest } from \"next/server\";\nimport Stripe from \"stripe\";\n```\n\në‹¤ìŒìœ¼ë¡œ stripe ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤:\n\n```js\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {\n  typescript: true,\n  apiVersion: \"2022-11-15\",\n});\n```\n\nìš°ë¦¬ì˜ Stripe ì¸ìŠ¤í„´ìŠ¤ëŠ” env.local íŒŒì¼ì—ì„œ Stripe ë¹„ë°€í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë” ë‚˜ì•„ê°€, ìš°ë¦¬ëŠ” Stripe ì¸ìŠ¤í„´ìŠ¤ì— TypeScriptë¥¼ í™œì„±í™”í•˜ê³  ì¸ìŠ¤í„´ìŠ¤ìš© Stripe API ë²„ì „ì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\n\n\n\nê³„ì† ì§„í–‰í•˜ê¸° ì „ì— Next.js 13.4ì—ì„œ API ê²½ë¡œë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ ë´…ì‹œë‹¤.\n\nì•„ë§ˆ ì´ë¯¸ ì£¼ëª©í–ˆì„ ê²ƒì´ì§€ë§Œ, í•¨ìˆ˜ì˜ ì œëª©ì´ \"POST\"ì™€ ê°™ì´ ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ë„¤ì´ë° ê·œì¹™ì€ Next.jsê°€ ì‹¤í–‰í•  í•´ë‹¹ HTTP ë©”ì†Œë“œë¥¼ ê²°ì •í•˜ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, GET ìš”ì²­ì„ ìˆ˜í–‰í•˜ë ¤ë©´ í•¨ìˆ˜ì˜ ì œëª©ì„ \"GET\"ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•˜ë©°, ìˆ˜í–‰í•˜ë ¤ëŠ” ë‹¤ë¥¸ ì‘ì—…ì— ëŒ€í•´ì„œë„ ìœ ì‚¬í•˜ê²Œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.\n\nì•Œê² ìŠµë‹ˆë‹¤, ì´í•´í–ˆìŠµë‹ˆë‹¤, ì¢‹ì•„ìš”! ê³„ì† ì§„í–‰í•©ì‹œë‹¤!\n\nìš°ë¦¬ í•¨ìˆ˜ ë‚´ì—ì„œëŠ” ìš”ì²­ì—ì„œ ë°ì´í„°ë¥¼ ë¹„êµ¬ì¡°í™”í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤. ê·¸ í›„ì—ëŠ” ë°ì´í„° ê°ì²´ì—ì„œ ê¸ˆì•¡ì„ ë”ìš± ì„¸ë¶„í™”í•©ë‹ˆë‹¤.\n\n\n\n```js\nconst { data } = await req.json();\nconst { amount } = data;\n```\n\nì´ì œ ëª¨ë“  í¥ë¯¸ë¡œìš´ ë¡œì§ì´ ë°œìƒí•˜ëŠ” trycatch ë¸”ë¡ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤!\n\níŒŒê³ ë“¤ì–´ ë´…ì‹œë‹¤.\n\n```js\nconst paymentIntent = await stripe.paymentIntents.create({\n      amount: Number(price) * 100,\n      currency: \"USD\",\n    });\n\n    return new NextResponse(paymentIntent.client_secret, { status: 200 });\n```\n\n\n\nìš°ë¦¬ì˜ try ë¸”ë¡ ì•ˆì—ì„œ, ê²°ì œ ì¸í…íŠ¸ë¥¼ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤. ê²°ì œ ì¸í…íŠ¸ì— ëŒ€í•´ ì˜ ëª¨ë¥´ì‹ ë‹¤ë©´ ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”. ê±°ë˜ì— ê´€í•œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆì£ . ì§€ì›ë˜ëŠ” ê²°ì œ ë°©ë²•, ì§•ìˆ˜í•  ê¸ˆì•¡, ê·¸ë¦¬ê³  í¬ë§í•˜ëŠ” í†µí™”ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\në§ˆì§€ë§‰ìœ¼ë¡œ, Stripeë¡œë¶€í„° ì–»ì€ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿ì„ í¬í•¨í•œ ì‘ë‹µì„ ë°˜í™˜í•  ê²ƒì…ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ìš°ë¦¬ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ Stripeê°€ ê²°ì œë¥¼ í™•ì¸í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿ì„ í™œìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì´ì£ .\n\n```js\n    return new NextResponse(error, {\n      status: 400,\n    });\n```\n\nìš°ë¦¬ì˜ catch ë¸”ë¡ ì•ˆì—ì„œëŠ” ê°„ë‹¨íˆ ì˜¤ë¥˜ë¥¼ í¬í•¨í•œ ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤.\n\n\n\nì´ ì‹œì ì—ì„œ ë°±ì—”ë“œ ê°œë°œì€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ìƒˆë¡œ ë§Œë“  ì—”ë“œí¬ì¸íŠ¸ì™€ ìƒí˜¸ ì‘ìš©í•  í´ë¼ì´ì–¸íŠ¸ ì¸¡ìœ¼ë¡œ ì´ë™í•´ ë´…ì‹œë‹¤.\n\n## í”„ë¡ íŠ¸ì—”ë“œ\n\në§ˆë²•ì„ ì‹œì‘í•˜ê¸° ì „ì— ì •ë¦¬í•´ ë´…ì‹œë‹¤!\n\nlayout.tsx íŒŒì¼ì—ì„œ global.cssë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤„ì„ ì‚­ì œí•˜ì„¸ìš”. ìŠ¤íƒ€ì¼ì— ëŒ€í•´ì„œëŠ” ë‹¤ë£¨ì§€ ì•Šì„ ê±°ì—ìš”.\n\n\n\nì•±.tsx íŒŒì¼ì—ì„œ `main` íƒœê·¸ ë‚´ë¶€ì˜ ëª¨ë“  ë‚´ìš©ì„ ì‚­ì œí•˜ê³ , Image ì»´í¬ë„ŒíŠ¸ import êµ¬ë¬¸ì„ ì‚­ì œí•´ì£¼ì„¸ìš”.\n\nì¢‹ì•„ìš”, ì´ ì‹œì ì—ì„œ layout.tsx íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤:\n\n```js\nimport { Inter } from \"next/font/google\";\n\nconst inter = Inter({ subsets: [\"latin\"] });\n\nexport const metadata = {\n  title: \"Create Next App\",\n  description: \"Generated by create next app\",\n};\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <html lang=\"en\">\n      <body className={inter.className}>{children}</body>\n    </html>\n  );\n}\n```\n\nê·¸ë¦¬ê³  app.tsx íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤:\n\n\n\n```js\nexport default function Home() {\n  return (\n    <></>\n  );\n}\n```\n\nì—¬ê¸° ë©‹ì§„ ê³³ì—ìš”, ê²°ì œ ì–‘ì‹ì„ ì„¤ì •í•´ ë´…ì‹œë‹¤!\n\n\"src\" í´ë”ì—ì„œ \"components\"ë¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. \"components\" í´ë” ì•ˆì— \"PaymentForm\"ì´ë¼ëŠ” ë˜ ë‹¤ë¥¸ í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. \"PaymentForm\" í´ë” ì•ˆì— \"PaymentForm.tsx\"ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. ê±°ê¸°ì— ìš°ë¦¬ì˜ ê²°ì œ ì–‘ì‹ì´ ìœ„ì¹˜í•˜ê³  ëŒ€ë¶€ë¶„ì˜ ë¡œì§ì´ ì—¬ê¸°ì„œ ì‹¤í–‰ë  ê±°ì—ìš”.\n\nì‹œì‘í•´ ë´…ì‹œë‹¤!\n\n\n\nìš°ë¦¬ê°€ ì»´í¬ë„ŒíŠ¸ ì‘ì„±ì„ ì‹œì‘í•˜ê¸° ì „ì—, Next.jsì—ê²Œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹Œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ë£¨ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ì–´ì•¼ í•´ìš”.\n\nPaymentForm.tsx íŒŒì¼ì˜ ë§¨ ìœ„ì— ë‹¤ìŒì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:\n\n```js\n\"use client\";\n```\n\nê·¸ ë‹¤ìŒì— ë‹¤ìŒê³¼ ê°™ì€ import ë¬¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:\n\n\n\n```js\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\nimport React from \"react\";\n```\n\nì´ì œ ë¹ˆ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•´ë´…ì‹œë‹¤:\n\n```js\nexport default function PaymentForm() {\n  return <></>;\n}\n```\n\nì§€ê¸ˆê¹Œì§€ì˜ íŒŒì¼ì€ ì´ë ‡ê²Œ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤:\n\n\n\n```js\n\"ì‚¬ìš©ììš©\";\n\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\nimport React from \"react\";\n\nexport default function PaymentForm() {\n  return <></>;\n}\n```\n\nìš°ë¦¬ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì²˜ìŒìœ¼ë¡œ í•´ì•¼ í•  ì¼ì€ Stripe í›…ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì¸ë°, ìš°ë¦¬ê°€ ì‚¬ìš©í•  í›…ì€ useStripeì™€ useElements ì…ë‹ˆë‹¤.\n\n```js\n  const stripe = useStripe();\n  const elements = useElements();\n```\n\nfromì„ ì œì¶œí•  ìˆ˜ ìˆëŠ” onSubmitì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤.```\n\n\n\n```js\n  const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {}\n```\n\nonSubmit í•¨ìˆ˜ ì•ˆì—ì„œ e.preventDefault(); ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ ë™ì‘ì„ ë§‰ì•„ì¤ì‹œë‹¤.\n\në‹¤ìŒìœ¼ë¡œ, stripe ì¹´ë“œ ì—˜ë¦¬ë¨¼íŠ¸ì— ë‹¤ìŒ ìŠ¤ë‹ˆí«ì„ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\n    const cardElement = elements?.getElement(\"card\");\n```\n\n\n\nì§€ê¸ˆë¶€í„° ì‹¤ì œ ë§ˆë²•ì„ ì‹œë„í•´ ë´…ì‹œë‹¤!\n\ntry-catch ë¸”ë¡ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. try ë¸”ë¡ ì•ˆì—ëŠ” stripeì™€ cardElementì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ì¡°ê±´ë¬¸ì„ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤. ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ëˆ„ë½ëœ ê²½ìš°, onSubmit í•¨ìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì¤‘ë‹¨ì‹œí‚¤ê³  ë” ì´ìƒì˜ ì‘ì—…ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ nullì„ ë°˜í™˜í•  ê²ƒì…ë‹ˆë‹¤.\n\ncatch ë¸”ë¡ì—ì„œëŠ” ë‹¨ìˆœíˆ errorë¥¼ console.log í•˜ë©´ ë©ë‹ˆë‹¤.\n\në‹¤ìŒì€ ì½”ë“œ ì¡°ê°ì…ë‹ˆë‹¤:\n\n\n\n```js\n    try {\n      if (!stripe || !cardElement) return null;\n    } catch (error) {\n      console.log(error);\n    }\n```\n\nì•ˆë…•í•˜ì„¸ìš” ì—¬ëŸ¬ë¶„, ì§€ê¸ˆ ì¢‹ì€ ìœ„ì¹˜ì— ìˆì–´ìš”. ê³„ì† ì§„í–‰í•˜ì£ .\n\nStripeì™€ cardElementê°€ ëª¨ë‘ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•œ í›„ì—, ì´ì „ì— ë°±ì—”ë“œì—ì„œ ì„¤ì •í•œ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ì˜ë„ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIì— ì „ë‹¬í•  ë°ì´í„°ëŠ” ê¸ˆì•¡ì´ í¬í•¨ë˜ë©°, ì €ì˜ ê²½ìš°ì—ëŠ” 89ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ìš”.\n\n```js\n    const { data } = await axios.post(\"/api/create-payment-intent\", {\n        data: { amount: 89 },\n      });\n```\n\n\n\nì‘ë‹µì„ clientSecretë¼ëŠ” ë³€ìˆ˜ì— í• ë‹¹í•´ë³´ì„¸ìš”.\n\n```js\nconst clientSecret = data;\n```\n\në§ˆì§€ë§‰ìœ¼ë¡œ ìš°ë¦¬ê°€ í•´ì•¼ í•  ì¼ì€ stripeì—ì„œ ì œê³µí•˜ëŠ” confirmCardPayment ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ëŠ” ì˜ˆì‹œ ì½”ë“œ ì¡°ê°ì…ë‹ˆë‹¤:\n\n```js\nawait stripe?.confirmCardPayment(clientSecret, {\n  payment_method: { card: cardElement },\n});\n```\n\n\n\nì§€ê¸ˆê¹Œì§€ onSubmit í•¨ìˆ˜ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.\n\nìš°ë¦¬ì˜ ì»´í¬ë„ŒíŠ¸ê°€ stripeì—ì„œ ì œê³µí•˜ëŠ” CardElement ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” í¼ì„ ë°˜í™˜í•˜ë„ë¡ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.\n\n```js\n    <form onSubmit={onSubmit}>\n      <CardElement />\n      <button type=\"submit\">ì œì¶œí•˜ê¸°</button>\n    </form>\n```\n\nìµœì¢… ê²°ê³¼:\n\n\n\n```js\n\"ì‚¬ìš©ì ì‚¬ìš©\";\n\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\nimport React from \"react\";\n\nexport default function PaymentForm() {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const cardElement = elements?.getElement(\"card\");\n\n    try {\n      if (!stripe || !cardElement) return null;\n      const { data } = await axios.post(\"/api/create-payment-intent\", {\n        data: { amount: 89 },\n      });\n      const clientSecret = data;\n\n      await stripe?.confirmCardPayment(clientSecret, {\n        payment_method: { card: cardElement },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return (\n    <form onSubmit={onSubmit}>\n      <CardElement />\n      <button type=\"submit\">ì œì¶œ</button>\n    </form>\n  );\n}\n```\n\nì¢‹ì€ ì†Œì‹ì…ë‹ˆë‹¤! ìš°ë¦¬ì˜ PaymentForm ì»´í¬ë„ŒíŠ¸ê°€ ì´ì œ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ë§Œì„¸! ì´ì œ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì„œ, ìƒˆë¡­ê²Œ ìƒì„±ëœ PaymentForm ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì•±ì˜ app.tsx íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\nPaymentForm ì»´í¬ë„ŒíŠ¸ê°€ app.tsx ì•ˆì—ì„œ ì‚¬ìš©ë˜ê¸° ì „ì—, ëª‡ ê°€ì§€ë¥¼ importí•˜ê³  stripeë¥¼ ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\n\"ì‚¬ìš©ì ì‚¬ìš©\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport PaymentForm from \"@/components/PaymentForm/PaymentForm\";\n```\n\n\n\nstripeë¥¼ ë¶ˆëŸ¬ì™€ë³´ê² ìŠµë‹ˆë‹¤:\n\n```js\nconst stripePromise = loadStripe(\n  process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY!\n);\n```\n\nstripeë¥¼ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì—ì„œ ë¡œë“œí•˜ëŠ” ê²ƒì„ í™•ì¸í•´ì£¼ì„¸ìš”. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ stripeê°€ ë§¤ë²ˆ ë Œë”ë§ë˜ì–´ ì›í•˜ì§€ ì•ŠëŠ” ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në§ˆì§€ë§‰ìœ¼ë¡œ, return ë¬¸ ì•ˆì—ì„œ ìš°ë¦¬ì—ê²Œ ì œê³µëœ Element ê³µê¸‰ìë¥¼ í™œìš©í•´ë´…ì‹œë‹¤. PaymentForm ì»´í¬ë„ŒíŠ¸ë¥¼ í•´ë‹¹ ê³µê¸‰ìë¡œ ê°ì‹¸ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤:\n\n\n\nì—¬ê¸° ì™„ì„±ëœ ê²°ê³¼ì…ë‹ˆë‹¤:\n\n```js\n\"use client\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport PaymentForm from \"@/components/PaymentForm/PaymentForm\";\n// ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œì— `Stripe` ê°ì²´ë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´\n// `loadStripe`ë¥¼ ì»´í¬ë„ŒíŠ¸ ë°–ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•´ì£¼ì„¸ìš”.\nconst stripePromise = loadStripe(\n  process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY!\n);\n\nexport default function Home() {\n  return (\n    <Elements stripe={stripePromise}>\n      <PaymentForm />\n    </Elements>\n  );\n}\n```\n\nì™€! Stripeë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ í¼ì„ ë§Œë“¤ì—ˆë„¤ìš”. ì˜ í–ˆì–´ìš”!\n\n\n\nì´ ê¸€ì´ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ì–´ìš”! ì•ìœ¼ë¡œ ì—¬ê¸°ì„œ ë” í™œë°œí•˜ê²Œ í™œë™í•  ê±°ì—ìš”. ê¸°ëŒ€ë¼ìš” ğŸ¤”\n\nì—¬ê¸° git ë ˆí¬ì§€í† ë¦¬ ë§í¬ì—ìš”. ì¦ê²¨ë³´ì„¸ìš”!","ogImage":{"url":"/assets/img/2024-05-14-HowtoaddStripepaymentstoyourNextjsapp_0.png"},"coverImage":"/assets/img/2024-05-14-HowtoaddStripepaymentstoyourNextjsapp_0.png","tag":["Tech"],"readingTime":10},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>ì™€! ë‚´ ë§¤ì²´ ì•”í˜¸ë¥¼ ì°¾ì•˜ì–´ìš”!</p>\n<p>ì´ì œ, ë‚´ ì²« ë²ˆì§¸ ê¸°ì‚¬ì—ì„œ Stripeë¥¼ Next.js ì•±ì— í†µí•©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ë ¤ê³  í•´ìš”.</p>\n<p>ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë„ˆë¬´ ë³µì¡í•œ ê²ƒì„ ë§Œë“œëŠ” ë° ì£¼ì˜ë¥¼ ê¸°ìš¸ì´ì§€ ì•Šì„ ê±°ì—ìš”. ëŒ€ì‹ ì— ìš°ë¦¬ëŠ” ê°„í¸í•œ Next.js 13.4 ì•±ì„ ê°œë°œí•˜ì—¬ ì¼íšŒì„± Stripe ê²°ì œë¥¼ ê°€ëŠ¥í•˜ê²Œ í•  ê±°ì—ìš”.</p>\n<h2>ì„¤ì •í•˜ê¸°</h2>\n<p>í„°ë¯¸ë„ì„ ì—´ê³  ë‚˜ì˜ ê²½ìš°ì—ëŠ” Workspace ì•ˆì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.</p>\n<pre><code class=\"hljs language-js\">npx create-next-app@latest\n</code></pre>\n<p>ìœ„ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ \"create-next-app@13.4.1\"ì„ ì„¤ì¹˜í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©° ëª‡ ê°€ì§€ ì§ˆë¬¸ì´ ìˆì„ ê²ë‹ˆë‹¤.</p>\n<ul>\n<li>í”„ë¡œì íŠ¸ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”? stripe-nextjs</li>\n<li>TypeScriptë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤</li>\n<li>ESLintë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤</li>\n<li>ì´ í”„ë¡œì íŠ¸ì— Tailwind CSSë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ì•„ë‹ˆìš”, ìŠ¤íƒ€ì¼ ì‘ì—…ì„ í•˜ì§€ ì•Šì„ ì˜ˆì •ì´ê¸° ë•Œë¬¸ì—</li>\n<li><code>src/</code> ë””ë ‰í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”? ë„¤</li>\n<li>App Routerë¥¼ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë„¤</li>\n<li>ê¸°ë³¸ import ë³„ì¹­ì„ ì‚¬ìš©ì ì •ì˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì•„ë‹ˆìš”</li>\n</ul>\n<p>ì§ˆë¬¸ì— ëª¨ë‘ ë‹µí–ˆë‹¤ë©´, ì„¤ì¹˜ê°€ ì‹œì‘ë©ë‹ˆë‹¤!</p>\n<p>ì´ì œ ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ì‹¤ì œë¡œ Next.js ì•±ì„ ë³´ë ¤ë©´ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. Next.js ì•± ë‚´ë¶€ì— ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>\n<pre><code class=\"hljs language-js\">yarn run dev\n</code></pre>\n<p>ë” ë‚˜ì•„ê°€ê¸° ì „ì—, Stripe ê³„ì •ì„ ìƒì„±í•˜ê³  API í‚¤ë¥¼ ë°›ì•„ë´ìš”.</p>\n<p>Stripe ê³„ì •ì„ ë§Œë“  í›„ì—, dashboard.stripe.com/test/apikeysë¡œ ì´ë™í•´ì„œ API í‚¤ë¥¼ ë°›ì•„ìš”.</p>\n<h2>í™˜ê²½ íŒŒì¼ ì„¤ì •í•˜ê¸°</h2>\n<p>ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ì•ˆì—, .env.localì´ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”.</p>\n<p>.env.local íŒŒì¼ ì•ˆì— ë‹¤ìŒì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-variable constant_\">NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY</span>=<span class=\"hljs-string\">\"\"</span>\n<span class=\"hljs-variable constant_\">STRIPE_SECRET_KEY</span>=<span class=\"hljs-string\">\"\"</span>\n</code></pre>\n<p>ì—¬ê¸°ì„œ ê¸°ì–µí•´ì•¼ í•  ì¤‘ìš”í•œ ì ì´ ëª‡ ê°€ì§€ ìˆì–´ìš”. ë¨¼ì €, \"\"\"ë¥¼ Stripe í‚¤ë¡œ ëŒ€ì²´í•´ì•¼ í•©ë‹ˆë‹¤. ë‘˜ì§¸ë¡œ, ë‘ ë³€ìˆ˜ ê°„ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í•˜ë‚˜ëŠ” \"NEXT_PUBLIC\"ì„ í¬í•¨í•˜ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°„ë‹¨íˆ ë§í•´ì„œ, \"NEXT_PUBLIC\"ì„ ì‚¬ìš©í•˜ì—¬ STRIPE_PUBLISHABLE_KEYë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ê²ƒì€ ê´œì°®ì§€ë§Œ ì‹œí¬ë¦¿ í‚¤ëŠ” ì ˆëŒ€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì— ë…¸ì¶œë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.</p>\n<p>ì•Œì•˜ì–´ìš”, ì´í•´í–ˆì–´ìš”? ê·¸ëŸ¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ì‹œë‹¤!</p>\n<h2>í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜í•˜ê¸°</h2>\n<p>ë‹¹ì‹ ì˜ Next.js ì•± ë‚´ë¶€ì— ë‹¤ìŒ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ë³´ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\">@stripe/react-stripe-js @stripe/stripe-js stripe axios\n</code></pre>\n<h2>ë°±ì—”ë“œ ì‘ì—…ì„ ì‹œì‘í•´ë´…ì‹œë‹¤</h2>\n<p>ìš°ë¦¬ ì•± í´ë” ì•ˆì— apië¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”. ì´ê³³ì— ëª¨ë“  ë°±ì—”ë“œ ì½”ë“œê°€ ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<p>api í´ë” ì•ˆì— create-payment-intentë¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ê³ , ê·¸ ì•ˆì— route.ts ë¼ëŠ” íŒŒì¼ì„ ìƒì„±í•´ì£¼ì„¸ìš”.</p>\n<p><img src=\"/assets/img/2024-05-14-HowtoaddStripepaymentstoyourNextjsapp_1.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>\"create-payment-intent\" í´ë” ì•ˆì— \"route\"ë¼ëŠ” íŒŒì¼ì„ ë§Œë“œëŠ” ì´ìœ ëŠ” Next.jsì— API ìš”ì²­ì„ ë‹¤ë£¨ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë¦¬ëŠ” ê²ƒì…ë‹ˆë‹¤. ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´, routeëŠ” ë¼ìš°íŒ…ì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ìˆ˜ì¤€ìœ¼ë¡œ, í˜ì´ì§€ê°€ í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë ˆì´ì•„ì›ƒì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ íƒìƒ‰ì— ì˜í–¥ì„ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. \"route.ts\" íŒŒì¼ì´ \"page.ts\" íŒŒì¼ì´ ìˆëŠ” ê³³ì— ì¡´ì¬í•  ìˆ˜ ì—†ë‹¤ëŠ” ì ì„ ëª…ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.</p>\n<p>ì—¬ê¸°ëŠ” route.ts íŒŒì¼ì˜ ì½”ë“œì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">NextResponse</span>, <span class=\"hljs-title class_\">NextRequest</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"next/server\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Stripe</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"stripe\"</span>;\n\n<span class=\"hljs-keyword\">const</span> stripe = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Stripe</span>(process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">STRIPE_SECRET_KEY</span>!, {\n  <span class=\"hljs-attr\">typescript</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">apiVersion</span>: <span class=\"hljs-string\">\"2022-11-15\"</span>,\n});\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">POST</span>(<span class=\"hljs-params\">req: NextRequest</span>) {\n  <span class=\"hljs-keyword\">const</span> { data } = <span class=\"hljs-keyword\">await</span> req.<span class=\"hljs-title function_\">json</span>();\n  <span class=\"hljs-keyword\">const</span> { amount } = data;\n  <span class=\"hljs-keyword\">try</span> {\n    <span class=\"hljs-keyword\">const</span> paymentIntent = <span class=\"hljs-keyword\">await</span> stripe.<span class=\"hljs-property\">paymentIntents</span>.<span class=\"hljs-title function_\">create</span>({\n      <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-title class_\">Number</span>(amount) * <span class=\"hljs-number\">100</span>,\n      <span class=\"hljs-attr\">currency</span>: <span class=\"hljs-string\">\"USD\"</span>,\n    });\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">NextResponse</span>(paymentIntent.<span class=\"hljs-property\">client_secret</span>, { <span class=\"hljs-attr\">status</span>: <span class=\"hljs-number\">200</span> });\n  } <span class=\"hljs-keyword\">catch</span> (<span class=\"hljs-attr\">error</span>: any) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">NextResponse</span>(error, {\n      <span class=\"hljs-attr\">status</span>: <span class=\"hljs-number\">400</span>,\n    });\n  }\n}\n</code></pre>\n<p>ì´ê²ƒì„ ìì„¸íˆ ì‚´í´ë³´ê³  ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€ ì´í•´í•´ ë´…ì‹œë‹¤.</p>\n<p>ì²«ì§¸ë¡œ, ìš°ë¦¬ëŠ” íƒ€ì…ê³¼ stripeë¥¼ import í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">NextResponse</span>, <span class=\"hljs-title class_\">NextRequest</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"next/server\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Stripe</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"stripe\"</span>;\n</code></pre>\n<p>ë‹¤ìŒìœ¼ë¡œ stripe ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> stripe = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Stripe</span>(process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">STRIPE_SECRET_KEY</span>!, {\n  <span class=\"hljs-attr\">typescript</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">apiVersion</span>: <span class=\"hljs-string\">\"2022-11-15\"</span>,\n});\n</code></pre>\n<p>ìš°ë¦¬ì˜ Stripe ì¸ìŠ¤í„´ìŠ¤ëŠ” env.local íŒŒì¼ì—ì„œ Stripe ë¹„ë°€í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë” ë‚˜ì•„ê°€, ìš°ë¦¬ëŠ” Stripe ì¸ìŠ¤í„´ìŠ¤ì— TypeScriptë¥¼ í™œì„±í™”í•˜ê³  ì¸ìŠ¤í„´ìŠ¤ìš© Stripe API ë²„ì „ì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.</p>\n<p>ê³„ì† ì§„í–‰í•˜ê¸° ì „ì— Next.js 13.4ì—ì„œ API ê²½ë¡œë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ ë´…ì‹œë‹¤.</p>\n<p>ì•„ë§ˆ ì´ë¯¸ ì£¼ëª©í–ˆì„ ê²ƒì´ì§€ë§Œ, í•¨ìˆ˜ì˜ ì œëª©ì´ \"POST\"ì™€ ê°™ì´ ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ë„¤ì´ë° ê·œì¹™ì€ Next.jsê°€ ì‹¤í–‰í•  í•´ë‹¹ HTTP ë©”ì†Œë“œë¥¼ ê²°ì •í•˜ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, GET ìš”ì²­ì„ ìˆ˜í–‰í•˜ë ¤ë©´ í•¨ìˆ˜ì˜ ì œëª©ì„ \"GET\"ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•˜ë©°, ìˆ˜í–‰í•˜ë ¤ëŠ” ë‹¤ë¥¸ ì‘ì—…ì— ëŒ€í•´ì„œë„ ìœ ì‚¬í•˜ê²Œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ì•Œê² ìŠµë‹ˆë‹¤, ì´í•´í–ˆìŠµë‹ˆë‹¤, ì¢‹ì•„ìš”! ê³„ì† ì§„í–‰í•©ì‹œë‹¤!</p>\n<p>ìš°ë¦¬ í•¨ìˆ˜ ë‚´ì—ì„œëŠ” ìš”ì²­ì—ì„œ ë°ì´í„°ë¥¼ ë¹„êµ¬ì¡°í™”í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤. ê·¸ í›„ì—ëŠ” ë°ì´í„° ê°ì²´ì—ì„œ ê¸ˆì•¡ì„ ë”ìš± ì„¸ë¶„í™”í•©ë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> { data } = <span class=\"hljs-keyword\">await</span> req.<span class=\"hljs-title function_\">json</span>();\n<span class=\"hljs-keyword\">const</span> { amount } = data;\n</code></pre>\n<p>ì´ì œ ëª¨ë“  í¥ë¯¸ë¡œìš´ ë¡œì§ì´ ë°œìƒí•˜ëŠ” trycatch ë¸”ë¡ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤!</p>\n<p>íŒŒê³ ë“¤ì–´ ë´…ì‹œë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> paymentIntent = <span class=\"hljs-keyword\">await</span> stripe.<span class=\"hljs-property\">paymentIntents</span>.<span class=\"hljs-title function_\">create</span>({\n      <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-title class_\">Number</span>(price) * <span class=\"hljs-number\">100</span>,\n      <span class=\"hljs-attr\">currency</span>: <span class=\"hljs-string\">\"USD\"</span>,\n    });\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">NextResponse</span>(paymentIntent.<span class=\"hljs-property\">client_secret</span>, { <span class=\"hljs-attr\">status</span>: <span class=\"hljs-number\">200</span> });\n</code></pre>\n<p>ìš°ë¦¬ì˜ try ë¸”ë¡ ì•ˆì—ì„œ, ê²°ì œ ì¸í…íŠ¸ë¥¼ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤. ê²°ì œ ì¸í…íŠ¸ì— ëŒ€í•´ ì˜ ëª¨ë¥´ì‹ ë‹¤ë©´ ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”. ê±°ë˜ì— ê´€í•œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆì£ . ì§€ì›ë˜ëŠ” ê²°ì œ ë°©ë²•, ì§•ìˆ˜í•  ê¸ˆì•¡, ê·¸ë¦¬ê³  í¬ë§í•˜ëŠ” í†µí™”ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, Stripeë¡œë¶€í„° ì–»ì€ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿ì„ í¬í•¨í•œ ì‘ë‹µì„ ë°˜í™˜í•  ê²ƒì…ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ìš°ë¦¬ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ Stripeê°€ ê²°ì œë¥¼ í™•ì¸í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿ì„ í™œìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì´ì£ .</p>\n<pre><code class=\"hljs language-js\">    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">NextResponse</span>(error, {\n      <span class=\"hljs-attr\">status</span>: <span class=\"hljs-number\">400</span>,\n    });\n</code></pre>\n<p>ìš°ë¦¬ì˜ catch ë¸”ë¡ ì•ˆì—ì„œëŠ” ê°„ë‹¨íˆ ì˜¤ë¥˜ë¥¼ í¬í•¨í•œ ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p>\n<p>ì´ ì‹œì ì—ì„œ ë°±ì—”ë“œ ê°œë°œì€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ìƒˆë¡œ ë§Œë“  ì—”ë“œí¬ì¸íŠ¸ì™€ ìƒí˜¸ ì‘ìš©í•  í´ë¼ì´ì–¸íŠ¸ ì¸¡ìœ¼ë¡œ ì´ë™í•´ ë´…ì‹œë‹¤.</p>\n<h2>í”„ë¡ íŠ¸ì—”ë“œ</h2>\n<p>ë§ˆë²•ì„ ì‹œì‘í•˜ê¸° ì „ì— ì •ë¦¬í•´ ë´…ì‹œë‹¤!</p>\n<p>layout.tsx íŒŒì¼ì—ì„œ global.cssë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤„ì„ ì‚­ì œí•˜ì„¸ìš”. ìŠ¤íƒ€ì¼ì— ëŒ€í•´ì„œëŠ” ë‹¤ë£¨ì§€ ì•Šì„ ê±°ì—ìš”.</p>\n<p>ì•±.tsx íŒŒì¼ì—ì„œ <code>main</code> íƒœê·¸ ë‚´ë¶€ì˜ ëª¨ë“  ë‚´ìš©ì„ ì‚­ì œí•˜ê³ , Image ì»´í¬ë„ŒíŠ¸ import êµ¬ë¬¸ì„ ì‚­ì œí•´ì£¼ì„¸ìš”.</p>\n<p>ì¢‹ì•„ìš”, ì´ ì‹œì ì—ì„œ layout.tsx íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Inter</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"next/font/google\"</span>;\n\n<span class=\"hljs-keyword\">const</span> inter = <span class=\"hljs-title class_\">Inter</span>({ <span class=\"hljs-attr\">subsets</span>: [<span class=\"hljs-string\">\"latin\"</span>] });\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> metadata = {\n  <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">\"Create Next App\"</span>,\n  <span class=\"hljs-attr\">description</span>: <span class=\"hljs-string\">\"Generated by create next app\"</span>,\n};\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">RootLayout</span>(<span class=\"hljs-params\">{\n  children,\n}: {\n  children: React.ReactNode;\n}</span>) {\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">html</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">\"en\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">body</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">{inter.className}</span>></span>{children}<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">body</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">html</span>></span></span>\n  );\n}\n</code></pre>\n<p>ê·¸ë¦¬ê³  app.tsx íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">Home</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;></span><span class=\"hljs-tag\">&#x3C;/></span></span>\n  );\n}\n</code></pre>\n<p>ì—¬ê¸° ë©‹ì§„ ê³³ì—ìš”, ê²°ì œ ì–‘ì‹ì„ ì„¤ì •í•´ ë´…ì‹œë‹¤!</p>\n<p>\"src\" í´ë”ì—ì„œ \"components\"ë¼ëŠ” ìƒˆ í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. \"components\" í´ë” ì•ˆì— \"PaymentForm\"ì´ë¼ëŠ” ë˜ ë‹¤ë¥¸ í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. \"PaymentForm\" í´ë” ì•ˆì— \"PaymentForm.tsx\"ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. ê±°ê¸°ì— ìš°ë¦¬ì˜ ê²°ì œ ì–‘ì‹ì´ ìœ„ì¹˜í•˜ê³  ëŒ€ë¶€ë¶„ì˜ ë¡œì§ì´ ì—¬ê¸°ì„œ ì‹¤í–‰ë  ê±°ì—ìš”.</p>\n<p>ì‹œì‘í•´ ë´…ì‹œë‹¤!</p>\n<p>ìš°ë¦¬ê°€ ì»´í¬ë„ŒíŠ¸ ì‘ì„±ì„ ì‹œì‘í•˜ê¸° ì „ì—, Next.jsì—ê²Œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹Œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ë£¨ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ì–´ì•¼ í•´ìš”.</p>\n<p>PaymentForm.tsx íŒŒì¼ì˜ ë§¨ ìœ„ì— ë‹¤ìŒì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-string\">\"use client\"</span>;\n</code></pre>\n<p>ê·¸ ë‹¤ìŒì— ë‹¤ìŒê³¼ ê°™ì€ import ë¬¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CardElement</span>, useElements, useStripe } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/react-stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> axios <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"axios\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">React</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"react\"</span>;\n</code></pre>\n<p>ì´ì œ ë¹ˆ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•´ë´…ì‹œë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">PaymentForm</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;></span><span class=\"hljs-tag\">&#x3C;/></span></span>;\n}\n</code></pre>\n<p>ì§€ê¸ˆê¹Œì§€ì˜ íŒŒì¼ì€ ì´ë ‡ê²Œ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-string\">\"ì‚¬ìš©ììš©\"</span>;\n\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CardElement</span>, useElements, useStripe } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/react-stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> axios <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"axios\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">React</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"react\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">PaymentForm</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;></span><span class=\"hljs-tag\">&#x3C;/></span></span>;\n}\n</code></pre>\n<p>ìš°ë¦¬ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì²˜ìŒìœ¼ë¡œ í•´ì•¼ í•  ì¼ì€ Stripe í›…ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì¸ë°, ìš°ë¦¬ê°€ ì‚¬ìš©í•  í›…ì€ useStripeì™€ useElements ì…ë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\">  <span class=\"hljs-keyword\">const</span> stripe = <span class=\"hljs-title function_\">useStripe</span>();\n  <span class=\"hljs-keyword\">const</span> elements = <span class=\"hljs-title function_\">useElements</span>();\n</code></pre>\n<p>fromì„ ì œì¶œí•  ìˆ˜ ìˆëŠ” onSubmitì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤.```</p>\n<pre><code class=\"hljs language-js\">  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">onSubmit</span> = <span class=\"hljs-keyword\">async</span> (<span class=\"hljs-params\">e: React.FormEvent&#x3C;HTMLFormElement></span>) => {}\n</code></pre>\n<p>onSubmit í•¨ìˆ˜ ì•ˆì—ì„œ e.preventDefault(); ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ ë™ì‘ì„ ë§‰ì•„ì¤ì‹œë‹¤.</p>\n<p>ë‹¤ìŒìœ¼ë¡œ, stripe ì¹´ë“œ ì—˜ë¦¬ë¨¼íŠ¸ì— ë‹¤ìŒ ìŠ¤ë‹ˆí«ì„ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">    <span class=\"hljs-keyword\">const</span> cardElement = elements?.<span class=\"hljs-title function_\">getElement</span>(<span class=\"hljs-string\">\"card\"</span>);\n</code></pre>\n<p>ì§€ê¸ˆë¶€í„° ì‹¤ì œ ë§ˆë²•ì„ ì‹œë„í•´ ë´…ì‹œë‹¤!</p>\n<p>try-catch ë¸”ë¡ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. try ë¸”ë¡ ì•ˆì—ëŠ” stripeì™€ cardElementì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ì¡°ê±´ë¬¸ì„ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤. ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ëˆ„ë½ëœ ê²½ìš°, onSubmit í•¨ìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì¤‘ë‹¨ì‹œí‚¤ê³  ë” ì´ìƒì˜ ì‘ì—…ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ nullì„ ë°˜í™˜í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<p>catch ë¸”ë¡ì—ì„œëŠ” ë‹¨ìˆœíˆ errorë¥¼ console.log í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<p>ë‹¤ìŒì€ ì½”ë“œ ì¡°ê°ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">    <span class=\"hljs-keyword\">try</span> {\n      <span class=\"hljs-keyword\">if</span> (!stripe || !cardElement) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n    } <span class=\"hljs-keyword\">catch</span> (error) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(error);\n    }\n</code></pre>\n<p>ì•ˆë…•í•˜ì„¸ìš” ì—¬ëŸ¬ë¶„, ì§€ê¸ˆ ì¢‹ì€ ìœ„ì¹˜ì— ìˆì–´ìš”. ê³„ì† ì§„í–‰í•˜ì£ .</p>\n<p>Stripeì™€ cardElementê°€ ëª¨ë‘ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•œ í›„ì—, ì´ì „ì— ë°±ì—”ë“œì—ì„œ ì„¤ì •í•œ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ì˜ë„ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIì— ì „ë‹¬í•  ë°ì´í„°ëŠ” ê¸ˆì•¡ì´ í¬í•¨ë˜ë©°, ì €ì˜ ê²½ìš°ì—ëŠ” 89ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ìš”.</p>\n<pre><code class=\"hljs language-js\">    <span class=\"hljs-keyword\">const</span> { data } = <span class=\"hljs-keyword\">await</span> axios.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">\"/api/create-payment-intent\"</span>, {\n        <span class=\"hljs-attr\">data</span>: { <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-number\">89</span> },\n      });\n</code></pre>\n<p>ì‘ë‹µì„ clientSecretë¼ëŠ” ë³€ìˆ˜ì— í• ë‹¹í•´ë³´ì„¸ìš”.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> clientSecret = data;\n</code></pre>\n<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ìš°ë¦¬ê°€ í•´ì•¼ í•  ì¼ì€ stripeì—ì„œ ì œê³µí•˜ëŠ” confirmCardPayment ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ëŠ” ì˜ˆì‹œ ì½”ë“œ ì¡°ê°ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">await</span> stripe?.<span class=\"hljs-title function_\">confirmCardPayment</span>(clientSecret, {\n  <span class=\"hljs-attr\">payment_method</span>: { <span class=\"hljs-attr\">card</span>: cardElement },\n});\n</code></pre>\n<p>ì§€ê¸ˆê¹Œì§€ onSubmit í•¨ìˆ˜ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.</p>\n<p>ìš°ë¦¬ì˜ ì»´í¬ë„ŒíŠ¸ê°€ stripeì—ì„œ ì œê³µí•˜ëŠ” CardElement ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” í¼ì„ ë°˜í™˜í•˜ë„ë¡ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\">    &#x3C;form onSubmit={onSubmit}>\n      <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">CardElement</span> /></span></span>\n      <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"submit\"</span>></span>ì œì¶œí•˜ê¸°<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">button</span>></span></span>\n    &#x3C;/form>\n</code></pre>\n<p>ìµœì¢… ê²°ê³¼:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-string\">\"ì‚¬ìš©ì ì‚¬ìš©\"</span>;\n\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CardElement</span>, useElements, useStripe } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/react-stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> axios <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"axios\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">React</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"react\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">PaymentForm</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> stripe = <span class=\"hljs-title function_\">useStripe</span>();\n  <span class=\"hljs-keyword\">const</span> elements = <span class=\"hljs-title function_\">useElements</span>();\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">onSubmit</span> = <span class=\"hljs-keyword\">async</span> (<span class=\"hljs-params\">e: React.FormEvent&#x3C;HTMLFormElement></span>) => {\n    e.<span class=\"hljs-title function_\">preventDefault</span>();\n    <span class=\"hljs-keyword\">const</span> cardElement = elements?.<span class=\"hljs-title function_\">getElement</span>(<span class=\"hljs-string\">\"card\"</span>);\n\n    <span class=\"hljs-keyword\">try</span> {\n      <span class=\"hljs-keyword\">if</span> (!stripe || !cardElement) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n      <span class=\"hljs-keyword\">const</span> { data } = <span class=\"hljs-keyword\">await</span> axios.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">\"/api/create-payment-intent\"</span>, {\n        <span class=\"hljs-attr\">data</span>: { <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-number\">89</span> },\n      });\n      <span class=\"hljs-keyword\">const</span> clientSecret = data;\n\n      <span class=\"hljs-keyword\">await</span> stripe?.<span class=\"hljs-title function_\">confirmCardPayment</span>(clientSecret, {\n        <span class=\"hljs-attr\">payment_method</span>: { <span class=\"hljs-attr\">card</span>: cardElement },\n      });\n    } <span class=\"hljs-keyword\">catch</span> (error) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(error);\n    }\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">onSubmit</span>=<span class=\"hljs-string\">{onSubmit}</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">CardElement</span> /></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"submit\"</span>></span>ì œì¶œ<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">button</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">form</span>></span></span>\n  );\n}\n</code></pre>\n<p>ì¢‹ì€ ì†Œì‹ì…ë‹ˆë‹¤! ìš°ë¦¬ì˜ PaymentForm ì»´í¬ë„ŒíŠ¸ê°€ ì´ì œ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ë§Œì„¸! ì´ì œ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì„œ, ìƒˆë¡­ê²Œ ìƒì„±ëœ PaymentForm ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì•±ì˜ app.tsx íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<p>PaymentForm ì»´í¬ë„ŒíŠ¸ê°€ app.tsx ì•ˆì—ì„œ ì‚¬ìš©ë˜ê¸° ì „ì—, ëª‡ ê°€ì§€ë¥¼ importí•˜ê³  stripeë¥¼ ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-string\">\"ì‚¬ìš©ì ì‚¬ìš©\"</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Elements</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/react-stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> { loadStripe } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">PaymentForm</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@/components/PaymentForm/PaymentForm\"</span>;\n</code></pre>\n<p>stripeë¥¼ ë¶ˆëŸ¬ì™€ë³´ê² ìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> stripePromise = <span class=\"hljs-title function_\">loadStripe</span>(\n  process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY</span>!\n);\n</code></pre>\n<p>stripeë¥¼ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì—ì„œ ë¡œë“œí•˜ëŠ” ê²ƒì„ í™•ì¸í•´ì£¼ì„¸ìš”. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ stripeê°€ ë§¤ë²ˆ ë Œë”ë§ë˜ì–´ ì›í•˜ì§€ ì•ŠëŠ” ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, return ë¬¸ ì•ˆì—ì„œ ìš°ë¦¬ì—ê²Œ ì œê³µëœ Element ê³µê¸‰ìë¥¼ í™œìš©í•´ë´…ì‹œë‹¤. PaymentForm ì»´í¬ë„ŒíŠ¸ë¥¼ í•´ë‹¹ ê³µê¸‰ìë¡œ ê°ì‹¸ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤:</p>\n<p>ì—¬ê¸° ì™„ì„±ëœ ê²°ê³¼ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-string\">\"use client\"</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Elements</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/react-stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> { loadStripe } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@stripe/stripe-js\"</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">PaymentForm</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"@/components/PaymentForm/PaymentForm\"</span>;\n<span class=\"hljs-comment\">// ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œì— `Stripe` ê°ì²´ë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´</span>\n<span class=\"hljs-comment\">// `loadStripe`ë¥¼ ì»´í¬ë„ŒíŠ¸ ë°–ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•´ì£¼ì„¸ìš”.</span>\n<span class=\"hljs-keyword\">const</span> stripePromise = <span class=\"hljs-title function_\">loadStripe</span>(\n  process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY</span>!\n);\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">Home</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">Elements</span> <span class=\"hljs-attr\">stripe</span>=<span class=\"hljs-string\">{stripePromise}</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">PaymentForm</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">Elements</span>></span></span>\n  );\n}\n</code></pre>\n<p>ì™€! Stripeë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ í¼ì„ ë§Œë“¤ì—ˆë„¤ìš”. ì˜ í–ˆì–´ìš”!</p>\n<p>ì´ ê¸€ì´ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ì–´ìš”! ì•ìœ¼ë¡œ ì—¬ê¸°ì„œ ë” í™œë°œí•˜ê²Œ í™œë™í•  ê±°ì—ìš”. ê¸°ëŒ€ë¼ìš” ğŸ¤”</p>\n<p>ì—¬ê¸° git ë ˆí¬ì§€í† ë¦¬ ë§í¬ì—ìš”. ì¦ê²¨ë³´ì„¸ìš”!</p>\n</body>\n</html>\n"},"__N_SSG":true}