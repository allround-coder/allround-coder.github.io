{"pageProps":{"post":{"title":"제트팩 컴포즈에서 WebView 사용하기","description":"","date":"2024-05-02 00:21","slug":"2024-05-02-UsingWebViewinJetpackCompose","content":"\n\n<img src=\"/assets/img/2024-05-02-UsingWebViewinJetpackCompose_0.png\" />\n\n웹뷰는 앱 개발에서 자주 사용하는 구성 요소로, 동적 HTML 페이지를 표시하는 데 사용할 수 있습니다. Android View 시스템에서는 XML에 직접 WebView 구성 요소를 추가하여 사용할 수 있지만, Jetpack Compose에는 직접 사용할 수 있는 WebView 구성 요소가 없습니다. 그렇다면 Compose에서 WebView를 어떻게 사용해야 할까요?\n\n이 기사에서는 Jetpack Compose에서 WebView를 사용하는 방법과 기본 기능을 활용하는 방법에 대해 소개하겠습니다.\n\n# 권한\n\n<div class=\"content-ad\"></div>\n\n먼저 Android Manifest에 권한을 추가해야 합니다:\n\n```js\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\">\n\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n\n    <application\n        android:usesCleartextTraffic=\"true\">\n    </application>\n\n</manifest>\n```\n\n# AndroidView\n\n그런 다음 웹 페이지를 표시하는 Composable 컴포넌트를 만들어야 합니다.\n\n<div class=\"content-ad\"></div>\n\n```js\n@Composable\nfun WebView(){\n  \n    // URL을 포함한 문자열 선언\n    val mUrl = \"https://www.google.com\"\n  \n    // AndroidView 내에 WebView를 추가\n    // 전체 화면 레이아웃\n    AndroidView(factory = {\n        WebView(it).apply {\n            layoutParams = ViewGroup.LayoutParams(\n                ViewGroup.LayoutParams.MATCH_PARENT,\n                ViewGroup.LayoutParams.MATCH_PARENT\n            )\n        }\n    }, update = {\n        it.loadUrl(mUrl)\n    })\n}\n```\n\n우리는 AndroidView를 사용하여 WebView 구성 요소를 래핑했습니다. factory 메서드에서는 AndroidX WebView를 디스플레이 구성 요소로 생성하고 그의 layoutParams를 설정합니다. 마지막으로 update 메서드에서 loadUrl 메서드를 사용하여 URL을 로드합니다.\n\n# WebViewClient\n\n특정 URL을 가로채야 할 때는 어떻게 할까요? View와 유사하게 WebViewClient를 사용자 정의하고 shouldOverrideUrlLoading 메서드를 재정의하면 됩니다.\n\n<div class=\"content-ad\"></div>\n\n```java\n@Composable\nfun WebView(){\n  \n    // URL을 포함하는 문자열 선언\n    val mUrl = \"https://www.google.com\"\n  \n    // 전체 화면 레이아웃의 AndroidView 내부에 WebView 추가\n    AndroidView(factory = {\n        WebView(it).apply {\n            this.layoutParams = ViewGroup.LayoutParams(\n                ViewGroup.LayoutParams.MATCH_PARENT,\n                ViewGroup.LayoutParams.MATCH_PARENT\n            )\n            this.webViewClient = CustomWebViewClient()\n        }\n    }, update = {\n        it.loadUrl(mUrl)\n    })\n}\n\nclass CustomWebViewClient: WebViewClient(){\n    override fun shouldOverrideUrlLoading(view: WebView?, url: String?): Boolean {\n        if(url != null && url.startsWith(\"https://google.com\")){\n            return true\n        }\n        return false\n    }\n}\n```\n\n# WebChromeClient\n\n더불어, 특정 웹 이벤트를 수신하기 위해 WebChromeClient를 사용자 정의할 수 있습니다:\n\n```java\n@Composable\nfun WebView(){\n  \n    // URL을 포함하는 문자열 선언\n    val mUrl = \"https://www.google.com\"\n  \n    // 전체 화면 레이아웃의 AndroidView 내부에 WebView 추가\n    AndroidView(factory = {\n        WebView(it).apply {\n            this.layoutParams = ViewGroup.LayoutParams(\n                ViewGroup.LayoutParams.MATCH_PARENT,\n                ViewGroup.LayoutParams.MATCH_PARENT\n            )\n            this.webChromeClient = CustomWebChromeClient()\n        }\n    }, update = {\n        it.loadUrl(mUrl)\n    })\n}\n\nclass CustomWebChromeClient : WebChromeClient() {\n    override fun onCloseWindow(window: WebView?) {}\n    \n    override fun onConsoleMessage(consoleMessage: ConsoleMessage?): Boolean {}\n}\n```\n\n<div class=\"content-ad\"></div>\n\n# 라이브러리\n\n그러나 이 방법은 상태가없는 단일 로드에만 적용됩니다. 만약 우리가 웹페이지의 제목, 로딩 상태 및 현재로드된 URL을 얻어야한다면 어떻게 될까요?\n\n비슷하게, 웹페이지에서 새 링크의 앞뒤로 넘기기 및 로딩을 제어해야하는 경우도 있습니다. 더 복잡한 것은 HTML 코드의 로드를 지원해야하는 경우입니다.\n\n다행히도 이미 이러한 기능을 제공하는 라이브러리가 있었습니다. Compose 내에서 직접 사용할 수있는 WebView 구성 요소를 제공하여 개발자가 WebView의 캡슐화 논리를 직접 작성할 필요가 없게합니다. 또한 웹 페이지 속성을 가져 오고 로딩 상태를 수신하는 기능과 같은 기능을 제공하여, 모두 사용 가능합니다.\n\n<div class=\"content-ad\"></div>\n\n기본적인 사용법은 아래와 같이 매우 간단합니다. URL을 로드하고 표시하는 데 사용할 수 있습니다.\n\n```js\nval state = rememberWebViewState(\"https://example.com\")\n\nWebView(\n    state\n)\n```\n\n자세한 사용 방법은 다음 기사를 참조해 주세요:\n\n# 이어서 읽을 내용","ogImage":{"url":"/assets/img/2024-05-02-UsingWebViewinJetpackCompose_0.png"},"coverImage":"/assets/img/2024-05-02-UsingWebViewinJetpackCompose_0.png","tag":["Tech"],"readingTime":4},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h1: \"h1\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(\"img\", {\n      src: \"/assets/img/2024-05-02-UsingWebViewinJetpackCompose_0.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"웹뷰는 앱 개발에서 자주 사용하는 구성 요소로, 동적 HTML 페이지를 표시하는 데 사용할 수 있습니다. Android View 시스템에서는 XML에 직접 WebView 구성 요소를 추가하여 사용할 수 있지만, Jetpack Compose에는 직접 사용할 수 있는 WebView 구성 요소가 없습니다. 그렇다면 Compose에서 WebView를 어떻게 사용해야 할까요?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 기사에서는 Jetpack Compose에서 WebView를 사용하는 방법과 기본 기능을 활용하는 방법에 대해 소개하겠습니다.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"권한\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"먼저 Android Manifest에 권한을 추가해야 합니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"<?xml version=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"1.0\\\"\"\n        }), \" encoding=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"utf-8\\\"\"\n        }), \"?>\\n\", _jsxs(_components.span, {\n          className: \"xml\",\n          children: [_jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"manifest\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"xmlns:android\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"http://schemas.android.com/apk/res/android\\\"\"\n            }), \"\\n    \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"xmlns:tools\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"http://schemas.android.com/tools\\\"\"\n            }), \">\"]\n          }), \"\\n\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"uses-permission\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"android:name\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"android.permission.INTERNET\\\"\"\n            }), \" />\"]\n          }), \"\\n\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"application\"\n            }), \"\\n        \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"android:usesCleartextTraffic\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"true\\\"\"\n            }), \">\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"application\"\n            }), \">\"]\n          }), \"\\n\\n\", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"manifest\"\n            }), \">\"]\n          })]\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"AndroidView\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"그런 다음 웹 페이지를 표시하는 Composable 컴포넌트를 만들어야 합니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"@\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Composable\"\n        }), \"\\nfun \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"WebView\"\n        }), \"(){\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// URL을 포함한 문자열 선언\"\n        }), \"\\n    val mUrl = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"https://www.google.com\\\"\"\n        }), \"\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// AndroidView 내에 WebView를 추가\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// 전체 화면 레이아웃\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"AndroidView\"\n        }), \"(factory = {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"WebView\"\n        }), \"(it).\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"apply\"\n        }), \" {\\n            layoutParams = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ViewGroup\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"LayoutParams\"\n        }), \"(\\n                \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ViewGroup\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"LayoutParams\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"MATCH_PARENT\"\n        }), \",\\n                \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ViewGroup\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"LayoutParams\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"MATCH_PARENT\"\n        }), \"\\n            )\\n        }\\n    }, update = {\\n        it.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"loadUrl\"\n        }), \"(mUrl)\\n    })\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"우리는 AndroidView를 사용하여 WebView 구성 요소를 래핑했습니다. factory 메서드에서는 AndroidX WebView를 디스플레이 구성 요소로 생성하고 그의 layoutParams를 설정합니다. 마지막으로 update 메서드에서 loadUrl 메서드를 사용하여 URL을 로드합니다.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"WebViewClient\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"특정 URL을 가로채야 할 때는 어떻게 할까요? View와 유사하게 WebViewClient를 사용자 정의하고 shouldOverrideUrlLoading 메서드를 재정의하면 됩니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-java\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-meta\",\n          children: \"@Composable\"\n        }), \"\\nfun \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"WebView\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"()\"\n        }), \"{\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// URL을 포함하는 문자열 선언\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"val\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable\",\n          children: \"mUrl\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"https://www.google.com\\\"\"\n        }), \"\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// 전체 화면 레이아웃의 AndroidView 내부에 WebView 추가\"\n        }), \"\\n    AndroidView(factory = {\\n        WebView(it).apply {\\n            \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"this\"\n        }), \".layoutParams = ViewGroup.LayoutParams(\\n                ViewGroup.LayoutParams.MATCH_PARENT,\\n                ViewGroup.LayoutParams.MATCH_PARENT\\n            )\\n            \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"this\"\n        }), \".webViewClient = CustomWebViewClient()\\n        }\\n    }, update = {\\n        it.loadUrl(mUrl)\\n    })\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CustomWebViewClient\"\n        }), \": WebViewClient(){\\n    override fun \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"shouldOverrideUrlLoading\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"(view: WebView?, url: String?)\"\n        }), \": Boolean {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \"(url != \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"null\"\n        }), \" && url.startsWith(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"https://google.com\\\"\"\n        }), \")){\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"true\"\n        }), \"\\n        }\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"false\"\n        }), \"\\n    }\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"WebChromeClient\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"더불어, 특정 웹 이벤트를 수신하기 위해 WebChromeClient를 사용자 정의할 수 있습니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-java\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-meta\",\n          children: \"@Composable\"\n        }), \"\\nfun \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"WebView\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"()\"\n        }), \"{\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// URL을 포함하는 문자열 선언\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"val\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable\",\n          children: \"mUrl\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"https://www.google.com\\\"\"\n        }), \"\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// 전체 화면 레이아웃의 AndroidView 내부에 WebView 추가\"\n        }), \"\\n    AndroidView(factory = {\\n        WebView(it).apply {\\n            \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"this\"\n        }), \".layoutParams = ViewGroup.LayoutParams(\\n                ViewGroup.LayoutParams.MATCH_PARENT,\\n                ViewGroup.LayoutParams.MATCH_PARENT\\n            )\\n            \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"this\"\n        }), \".webChromeClient = CustomWebChromeClient()\\n        }\\n    }, update = {\\n        it.loadUrl(mUrl)\\n    })\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CustomWebChromeClient\"\n        }), \" : WebChromeClient() {\\n    override fun \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"onCloseWindow\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"(window: WebView?)\"\n        }), \" {}\\n    \\n    override fun \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"onConsoleMessage\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"(consoleMessage: ConsoleMessage?)\"\n        }), \": Boolean {}\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"라이브러리\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"그러나 이 방법은 상태가없는 단일 로드에만 적용됩니다. 만약 우리가 웹페이지의 제목, 로딩 상태 및 현재로드된 URL을 얻어야한다면 어떻게 될까요?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"비슷하게, 웹페이지에서 새 링크의 앞뒤로 넘기기 및 로딩을 제어해야하는 경우도 있습니다. 더 복잡한 것은 HTML 코드의 로드를 지원해야하는 경우입니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"다행히도 이미 이러한 기능을 제공하는 라이브러리가 있었습니다. Compose 내에서 직접 사용할 수있는 WebView 구성 요소를 제공하여 개발자가 WebView의 캡슐화 논리를 직접 작성할 필요가 없게합니다. 또한 웹 페이지 속성을 가져 오고 로딩 상태를 수신하는 기능과 같은 기능을 제공하여, 모두 사용 가능합니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"기본적인 사용법은 아래와 같이 매우 간단합니다. URL을 로드하고 표시하는 데 사용할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"val state = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"rememberWebViewState\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"https://example.com\\\"\"\n        }), \")\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"WebView\"\n        }), \"(\\n    state\\n)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"자세한 사용 방법은 다음 기사를 참조해 주세요:\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"이어서 읽을 내용\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true}