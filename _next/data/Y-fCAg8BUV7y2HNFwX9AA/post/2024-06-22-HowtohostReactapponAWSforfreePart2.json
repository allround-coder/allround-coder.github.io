{"pageProps":{"post":{"title":"React 앱을 AWS에서 무료로 호스팅하는 방법 2부","description":"","date":"2024-06-22 14:27","slug":"2024-06-22-HowtohostReactapponAWSforfreePart2","content":"\n\n이 기사는 React 앱을 AWS에 무료로 호스팅하는 방법 시리즈의 연재물입니다. Part 1\n\nPart 1에서 우리가 이룬 것을 간단히 요약해 보면, 우리는 Ant Design 라이브러리를 사용하는 React 앱을 만들었고, 현재 시간으로 설정된 타임 피커를 보여주는 페이지를 만들었습니다. 이를 공개적으로 접근할 수 없는 S3 버킷에 배포했습니다. 그리고 HTTPS 액세스가 가능한 CloudFront를 구성하여 이를 S3 버킷과 연결했습니다.\n\n이 장에서는 백엔드 서비스 Lambda를 추가하고 API Gateway 서비스로 앱을 개선할 것입니다. \n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_0.png)\n\n<div class=\"content-ad\"></div>\n\n위의 다이어그램에서 보시다시피 S3 버킷이 람다와 통신하지 않습니다. 실제로 사용자가 브라우저에서 리액트 앱에 접속하면 앱(HTML, CSS, JS, 이미지 등)이 다운로드되어 사용자의 PC에서 브라우저 내에서 실행됩니다. 앱이 서버에서 데이터를 가져와야 할 때(우리의 경우 람다와 통신해야 할 때) — API 엔드포인트로 HTTP 요청을 보냅니다.\n\n그래서 먼저, 람다 함수를 만들어 봅시다 —\n\n![Lambda function](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_1.png)\n\n기본적으로 다음과 같이 보일 것입니다:\n\n<div class=\"content-ad\"></div>\n\n\n![How to host React app on AWS for free - Part 2](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_2.png)\n\n람다를 공개적으로 호출하기 위해서는 기능적인 URL을 생성해야 합니다.\n\n![How to host React app on AWS for free - Part 2](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_3.png)\n\n기능적 URL은 API 게이트웨이에서 쉽게 사용할 수 있는 인증, 요청 변환, 모니터링, 쓸 수 있는 등 여러 단점이 있습니다. 그러나 직접 람다 함수 URL을 사용하는 경우에는 이러한 기능을 수동으로 처리해야 합니다. 우리 데모 프로젝트와 같이 작은 프로젝트의 경우 빠르고 간단한 해결책입니다.\n\n\n<div class=\"content-ad\"></div>\n\nURL이 생성되면 브라우저에서 람다를 호출할 수 있어요:\n\n![Lambda Code](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_4.png)\n\n람다 코드를 변경해서 현재 타임스탬프를 반환해봐요:\n\n```js\nexport const handler = async (event) => {\n    // 현재 날짜와 시간 가져오기\n    const currentDate = new Date();\n    \n    // 날짜를 ISO 문자열로 포맷팅\n    const currentISODate = currentDate.toISOString();\n\n    // 현재 시간을 JSON 응답으로 반환\n    return {\n        statusCode: 200,\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ currentTime: currentISODate }),\n    };\n};\n```\n\n<div class=\"content-ad\"></div>\n\n\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_5.png\" />\n\n그리고 우리의 리액트 앱을 채택하여 함수 URL로 요청을 보내고 응답에서 타임스탬프를 사용합니다:\n\n```js\nimport React, { useEffect, useState } from 'react';\nimport { TimePicker } from 'antd';\nimport moment from 'moment';\n\nconst App = () => {\n  const [defaultValue, setDefaultValue] = useState();\n\n  useEffect(() => {\n    fetch(`https://dbzyybb3ij4lsr2bdd3g6i5i4e0ggpyc.lambda-url.us-east-2.on.aws/`)\n    .then(response => response.json())\n    .then(data => {\n      const currentTime = moment(data.currentTime);\n      setDefaultValue(currentTime)\n    });\n  }, [])\n\n  return (\n    <div>\n      <TimePicker value={defaultValue} />\n    </div>\n  );\n};\n\nexport default App;\n```\n\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_6.png\" />\n\n\n<div class=\"content-ad\"></div>\n\n멋지네요. 페이지를 열면 HTTP 요청이 전송되어 람다 함수를 트리거하고 응답으로 현재 타임스탬프를 받게 되어 UI에 업데이트될 겁니다.\n\n이제 프로젝트를 개선하고 API Gateway를 추가해봅시다. 이렇게 하면 리액트 앱이 람다 함수 URL을 통해 직접 통신하는 대신 API Gateway를 통해 통신하게 됩니다.\n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_7.png)\n\nHTTP API를 생성하세요. 기본 설정으로 유지하세요. 대부분의 경우 REST API 대신 HTTP API를 선택해야 합니다. 이유는 더 비용 효율적이고 가벼우며, 서버리스용으로 설계되어 성능이 우수하며 지연 시간이 짧기 때문입니다.\n\n<div class=\"content-ad\"></div>\n\nRoutes 아래에 새로운 라우트를 만들어주세요.\n\n```js\nGET /timestamp\n```\n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_8.png)\n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_9.png)\n\n<div class=\"content-ad\"></div>\n\n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_10.png)\n\nCORS 설정을 업데이트하세요:\n\n![이미지](/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_11.png)\n\nStages에서 API의 URL을 찾으세요:\n\n\n<div class=\"content-ad\"></div>\n\n\"다음 표를 Markdown 형식으로 변경하십시오.\n\n그리고 예상대로 작동하는지 확인하십시오:\n\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_13.png\" />\n\nReact 앱을 새 API에서 가져오도록 업데이트하고 여기까지입니다. S3 버킷에 배포된 프론트엔드와 람다에 배포된 백엔드가 완전히 서버리스인 웹 앱이 준비되었습니다.\"\n\n<div class=\"content-ad\"></div>\n\n다음 장에서는 관계형 데이터베이스를 소개하고 인증을 추가할 예정입니다.","ogImage":{"url":"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_0.png"},"coverImage":"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_0.png","tag":["Tech"],"readingTime":4},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>이 기사는 React 앱을 AWS에 무료로 호스팅하는 방법 시리즈의 연재물입니다. Part 1</p>\n<p>Part 1에서 우리가 이룬 것을 간단히 요약해 보면, 우리는 Ant Design 라이브러리를 사용하는 React 앱을 만들었고, 현재 시간으로 설정된 타임 피커를 보여주는 페이지를 만들었습니다. 이를 공개적으로 접근할 수 없는 S3 버킷에 배포했습니다. 그리고 HTTPS 액세스가 가능한 CloudFront를 구성하여 이를 S3 버킷과 연결했습니다.</p>\n<p>이 장에서는 백엔드 서비스 Lambda를 추가하고 API Gateway 서비스로 앱을 개선할 것입니다.</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_0.png\" alt=\"이미지\"></p>\n<div class=\"content-ad\"></div>\n<p>위의 다이어그램에서 보시다시피 S3 버킷이 람다와 통신하지 않습니다. 실제로 사용자가 브라우저에서 리액트 앱에 접속하면 앱(HTML, CSS, JS, 이미지 등)이 다운로드되어 사용자의 PC에서 브라우저 내에서 실행됩니다. 앱이 서버에서 데이터를 가져와야 할 때(우리의 경우 람다와 통신해야 할 때) — API 엔드포인트로 HTTP 요청을 보냅니다.</p>\n<p>그래서 먼저, 람다 함수를 만들어 봅시다 —</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_1.png\" alt=\"Lambda function\"></p>\n<p>기본적으로 다음과 같이 보일 것입니다:</p>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_2.png\" alt=\"How to host React app on AWS for free - Part 2\"></p>\n<p>람다를 공개적으로 호출하기 위해서는 기능적인 URL을 생성해야 합니다.</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_3.png\" alt=\"How to host React app on AWS for free - Part 2\"></p>\n<p>기능적 URL은 API 게이트웨이에서 쉽게 사용할 수 있는 인증, 요청 변환, 모니터링, 쓸 수 있는 등 여러 단점이 있습니다. 그러나 직접 람다 함수 URL을 사용하는 경우에는 이러한 기능을 수동으로 처리해야 합니다. 우리 데모 프로젝트와 같이 작은 프로젝트의 경우 빠르고 간단한 해결책입니다.</p>\n<div class=\"content-ad\"></div>\n<p>URL이 생성되면 브라우저에서 람다를 호출할 수 있어요:</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_4.png\" alt=\"Lambda Code\"></p>\n<p>람다 코드를 변경해서 현재 타임스탬프를 반환해봐요:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handler</span> = <span class=\"hljs-keyword\">async</span> (<span class=\"hljs-params\">event</span>) => {\n    <span class=\"hljs-comment\">// 현재 날짜와 시간 가져오기</span>\n    <span class=\"hljs-keyword\">const</span> currentDate = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Date</span>();\n    \n    <span class=\"hljs-comment\">// 날짜를 ISO 문자열로 포맷팅</span>\n    <span class=\"hljs-keyword\">const</span> currentISODate = currentDate.<span class=\"hljs-title function_\">toISOString</span>();\n\n    <span class=\"hljs-comment\">// 현재 시간을 JSON 응답으로 반환</span>\n    <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">statusCode</span>: <span class=\"hljs-number\">200</span>,\n        <span class=\"hljs-attr\">headers</span>: {\n            <span class=\"hljs-string\">'Content-Type'</span>: <span class=\"hljs-string\">'application/json'</span>,\n        },\n        <span class=\"hljs-attr\">body</span>: <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>({ <span class=\"hljs-attr\">currentTime</span>: currentISODate }),\n    };\n};\n</code></pre>\n<div class=\"content-ad\"></div>\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_5.png\">\n<p>그리고 우리의 리액트 앱을 채택하여 함수 URL로 요청을 보내고 응답에서 타임스탬프를 사용합니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">React</span>, { useEffect, useState } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'react'</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">TimePicker</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'antd'</span>;\n<span class=\"hljs-keyword\">import</span> moment <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'moment'</span>;\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">App</span> = (<span class=\"hljs-params\"></span>) => {\n  <span class=\"hljs-keyword\">const</span> [defaultValue, setDefaultValue] = <span class=\"hljs-title function_\">useState</span>();\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =></span> {\n    <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">`https://dbzyybb3ij4lsr2bdd3g6i5i4e0ggpyc.lambda-url.us-east-2.on.aws/`</span>)\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">response</span> =></span> response.<span class=\"hljs-title function_\">json</span>())\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">data</span> =></span> {\n      <span class=\"hljs-keyword\">const</span> currentTime = <span class=\"hljs-title function_\">moment</span>(data.<span class=\"hljs-property\">currentTime</span>);\n      <span class=\"hljs-title function_\">setDefaultValue</span>(currentTime)\n    });\n  }, [])\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">div</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">TimePicker</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{defaultValue}</span> /></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">div</span>></span></span>\n  );\n};\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-title class_\">App</span>;\n</code></pre>\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_6.png\">\n<div class=\"content-ad\"></div>\n<p>멋지네요. 페이지를 열면 HTTP 요청이 전송되어 람다 함수를 트리거하고 응답으로 현재 타임스탬프를 받게 되어 UI에 업데이트될 겁니다.</p>\n<p>이제 프로젝트를 개선하고 API Gateway를 추가해봅시다. 이렇게 하면 리액트 앱이 람다 함수 URL을 통해 직접 통신하는 대신 API Gateway를 통해 통신하게 됩니다.</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_7.png\" alt=\"이미지\"></p>\n<p>HTTP API를 생성하세요. 기본 설정으로 유지하세요. 대부분의 경우 REST API 대신 HTTP API를 선택해야 합니다. 이유는 더 비용 효율적이고 가벼우며, 서버리스용으로 설계되어 성능이 우수하며 지연 시간이 짧기 때문입니다.</p>\n<div class=\"content-ad\"></div>\n<p>Routes 아래에 새로운 라우트를 만들어주세요.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-variable constant_\">GET</span> /timestamp\n</code></pre>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_8.png\" alt=\"이미지\"></p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_9.png\" alt=\"이미지\"></p>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_10.png\" alt=\"이미지\"></p>\n<p>CORS 설정을 업데이트하세요:</p>\n<p><img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_11.png\" alt=\"이미지\"></p>\n<p>Stages에서 API의 URL을 찾으세요:</p>\n<div class=\"content-ad\"></div>\n<p>\"다음 표를 Markdown 형식으로 변경하십시오.</p>\n<p>그리고 예상대로 작동하는지 확인하십시오:</p>\n<img src=\"/assets/img/2024-06-22-HowtohostReactapponAWSforfreePart2_13.png\">\n<p>React 앱을 새 API에서 가져오도록 업데이트하고 여기까지입니다. S3 버킷에 배포된 프론트엔드와 람다에 배포된 백엔드가 완전히 서버리스인 웹 앱이 준비되었습니다.\"</p>\n<div class=\"content-ad\"></div>\n<p>다음 장에서는 관계형 데이터베이스를 소개하고 인증을 추가할 예정입니다.</p>\n</body>\n</html>\n"},"__N_SSG":true}