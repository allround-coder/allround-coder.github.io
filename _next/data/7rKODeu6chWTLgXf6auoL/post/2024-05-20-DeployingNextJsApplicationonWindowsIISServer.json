{"pageProps":{"post":{"title":"윈도우 IIS 서버에 NextJs 애플리케이션을 배포하는 방법","description":"","date":"2024-05-20 22:10","slug":"2024-05-20-DeployingNextJsApplicationonWindowsIISServer","content":"\n\n\n![Deploying Next.js Application on Windows IIS Server](/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_0.png)\n\nNextJS는 단일 페이지 애플리케이션을 만들기 위한 서버 측 렌더링된 React 기반 프레임워크입니다. 서버 측 렌더링 기능으로 인해 매우 인기가 높습니다. NextJS를 사용하여 다음 애플리케이션을 작성하는 것은 매우 간단합니다. NextJS를 사용하기 위해 명시적으로 구성할 필요가 없습니다. npm run dev를 실행하고 애플리케이션을 구축하기 시작하면 됩니다.\n\n# 서버 측 렌더링이란?\n\n서버 측 렌더링(SSR)은 프런트엔드 프레임워크가 웹페이지를 준비하기 위해 사용자별 데이터를 서버 측에서 가져와 사용자 화면으로 보내는 능력입니다. 사용자에게 표시하기 위해 클라이언트 측에서 웹페이지를 준비하는 대신에 서버 측에서 웹페이지를 준비합니다.\n \n\n<div class=\"content-ad\"></div>\n\nNextJS에서는 서버에서 페이지를 렌더링하거나 일반적인 create-react-app SPA처럼 클라이언트 측에서 렌더링할 수 있는 옵션이 있습니다.\n\n서버 측 렌더링의 장점은 분명히 있습니다. 그래서 NextJS 프레임워크가 인기를 얻은 이유이기도 합니다. SSR 덕분에 초기 페이지 로딩이 빨라져 최종 사용자에게 더 나은 상호작용을 제공합니다. 또한 검색 엔진이 사이트를 크롤링하여 더 나은 검색 엔진 최적화를 제공하는데 도움이 됩니다.\n\n# 만약 NextJS가 프론트엔드 프레임워크라면, 이 프레임워크는 어떻게 서버에서 웹 페이지를 준비하는 것일까요?\n\nNextJS 프레임워크는 NodeJS 기반으로 만들어졌습니다. 아시다시피, NodeJS는 서버 측에서 페이지를 준비하기 위해 사용되는 NextJS 애플리케이션에 강력함을 제공하는 백엔드 JavaScript 런타임 환경입니다.\n\n<div class=\"content-ad\"></div>\n\n# NextJS 애플리케이션 배포하기\n\nWindows IIS에서 Next.js 애플리케이션을 호스팅하는 방법을 여러 곳에서 찾아보았어요. 괜찮은 튜토리얼을 몇 개 찾았지만 제 문제를 해결해 주지는 못했어요. Vercel과 Netlify, Heroku 등과 같은 유사한 플랫폼에 호스팅하는 것이 이상적일 것 같아요. 하지만 제 애플리케이션을 로컬에서 호스팅하고 싶어요. 왜냐하면 내 애플리케이션에 대중이 접근하는 것을 원하지 않기 때문이에요. 그건 제 개인적인 용도로 사용할 거거든요. 그래서 여러분이 구글에서 시간을 낭비하지 않고 필요한 정보를 찾을 수 있도록, 간단한 가이드를 제공해 드리겠어요.\n\n하지만 그 전에, 사용하려는 것에 대해 간단히 설명해볼게요.\n\n저희는 iisnode을 사용하려고 해요. iisnode은 C++로 작성된 오픈 소스 네이티브 IIS 모듈로, Node.js를 Windows IIS 내에서 실행할 수 있게 해줘요. 저희는 IIS 서버 배포 방식으로 Node.js를 사용할 거에요. 그러려면 Server.js와 web.config 두 파일이 필요하답니다.\n\n<div class=\"content-ad\"></div>\n\n지금 application의 진입점인 server.js를 만들어보겠습니다:\n\n```js\nconst { createServer } = require(\"http\");\nconst { parse } = require(\"url\");\nconst next = require(\"next\");\n\nconst dev = process.env.NODE_ENV !== \"production\";\n\nconst port = process.env.PORT || 3000; // 포트를 IIS가 실행 중인 포트로 변경하세요. 기본값은 80이고 개발 중이면 3000입니다.\nconst hostname = \"localhost\";\nconst app = next({ dev, hostname, port });\nconst handle = app.getRequestHandler();\n\napp.prepare().then(() => {\n  createServer(async (req, res) => {\n    try {\n      const parsedUrl = parse(req.url, true);\n      const { pathname, query } = parsedUrl;\n\n      if (pathname === \"/a\") {\n        await app.render(req, res, \"/a\", query);\n      } else if (pathname === \"/b\") {\n        await app.render(req, res, \"/b\", query);\n      } else {\n        await handle(req, res, parsedUrl);\n      }\n    } catch (err) {\n      console.error(\"Error occurred handling\", req.url, err);\n      res.statusCode = 500;\n      res.end(\"internal server error\");\n    }\n  })\n    .once(\"error\", (err) => {\n      console.error(err);\n      process.exit(1);\n    })\n    .listen(port, async () => {\n      console.log(`> Ready on http://localhost:${port}`);\n    });\n});\n```\n\n웹 구성 파일인 web.config은 IIS 및 ASP.NET Core Module이 응용 프로그램을 구성하는 데 사용하는 파일입니다. 그래서 여기에 우리의 web.config 파일이 있습니다:\n\n```js\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!--\n     이 구성 파일은 iisnode를 사용하여 IIS 또는 IIS Express에서 노드 프로세스를 실행하는 경우 필요합니다.\n     자세한 내용은 다음을 참조하십시오:\n\n     https://github.com/tjanczuk/iisnode/blob/master/src/samples/configuration/web.config\n-->\n\n<configuration>\n  <system.webServer>\n    <!-- WebSocket 지원에 대한 자세한 정보는 http://blogs.msdn.com/b/windowsazure/archive/2013/11/14/introduction-to-websockets-on-windows-azure-web-sites.aspx에서 확인할 수 있습니다 -->\n    <webSocket enabled=\"false\" />\n    <handlers>\n      <!-- server.js 파일이 iisnode 모듈에 의해 처리되는 node.js 사이트임을 나타냄 -->\n      <add name=\"iisnode\" path=\"server.js\" verb=\"*\" modules=\"iisnode\"/>\n    </handlers>\n    <rewrite>\n      <rules>\n        <!-- node-inspector 디버깅을 위한 요청 방해하지 않음 -->\n        <rule name=\"NodeInspector\" patternSyntax=\"ECMAScript\" stopProcessing=\"true\">\n          <match url=\"^server.js\\/debug[\\/]?\" />\n        </rule>\n\n        <!-- 먼저 /public 폴더의 물리적 파일과 일치하는 들어오는 URL을 고려 -->\n        <rule name=\"StaticContent\">\n          <action type=\"Rewrite\" url=\"public{REQUEST_URI}\"/>\n        </rule>\n\n        <!-- 모든 다른 URL은 node.js 사이트 진입점으로 매핑됨 -->\n        <rule name=\"DynamicContent\">\n          <conditions>\n            <add input=\"{REQUEST_FILENAME}\" matchType=\"IsFile\" negate=\"True\"/>\n          </conditions>\n          <action type=\"Rewrite\" url=\"server.js\"/>\n        </rule>\n      </rules>\n    </rewrite>\n    \n    <!-- 'bin' 디렉토리는 node.js에서 특별한 의미가 없으며, 앱을 그 안에 배치할 수 있음 -->\n    <security>\n      <requestFiltering>\n        <hiddenSegments>\n          <add segment=\"node_modules\"/>\n        </hiddenSegments>\n      </requestFiltering>\n    </security>\n\n    <!-- 오류 응답을 변경하지 않도록 함 -->\n    <httpErrors existingResponse=\"PassThrough\" />\n    <iisnode node_env=\"production\"/>\n\n    <!--\n      다음 옵션을 사용하여 IIS 내에서 Node를 호스트하는 방법을 제어할 수 있습니다:\n        * watchedFiles: 변경 사항을 감지하여 서버를 다시 시작할 파일 목록\n        * node_env: NODE_ENV 환경 변수로 전달될 값\n        * debuggingEnabled - 기본 디버거가 활성화되는지 여부\n\n      모든 옵션 목록은 https://github.com/tjanczuk/iisnode/blob/master/src/samples/configuration/web.config에서 확인 가능합니다\n    -->\n    <!--<iisnode watchedFiles=\"web.config;*.js\"/>-->\n  </system.webServer>\n</configuration>\n```\n\n<div class=\"content-ad\"></div>\n\n웹 구성 파일을 추가한 후에는 package.json을 약간 변경해야 합니다. npm run start가 서버를 시작하도록 설정되어야 하며 next start를 사용하지 않아야 합니다. 다음은 package.json 스크립트가 보이는 방식입니다:\n\n```js\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"next build\",\n    \"start\": \"node server.js\",\n    \"lint\": \"next lint\"\n  },\n```\n\nserver.js를 추가하고 web.config를 추가한 후 npm run build를 실행하면 애플리케이션의 루트 폴더가 다음과 같이 보입니다.\n\n![애플리케이션 루트 폴더](/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_1.png)\n\n<div class=\"content-ad\"></div>\n\n# IIS에서 NextJS 애플리케이션을 배포하는 방법\n\n배포를 설정하기 전에 IISNode와 URLRewrite를 설치해야 합니다. 그 후, IIS에 새 웹 사이트를 생성하고 물리적 경로를 .next, node_modules, server.js 및 web.config가 포함된 폴더로 지정하세요. 권한 문제나 다른 가능한 문제를 피하려면 해당 폴더를 Windows Server의 루트 사용자 폴더 안에 배치하세요.\n\nIIS에서 웹 서버를 시작하면 자동으로 iisnode이라는 새 폴더가 생성됩니다.\n\n만약 배포 폴더가 C:/ 드라이브의 wwwroot에 있다면 전체 폴더에 대해 IIS_Users에게 읽기/쓰기 권한을 명시적으로 부여해야 할 수 있습니다. 다른 예상치 못한 오류가 발생하는 경우, 댓글을 남기거나 내 Discord @pallepadehat을 추가해주세요. 도와드릴게요!\n\n<div class=\"content-ad\"></div>\n\n이 Github Repo에서 소스 코드를 확인할 수 있어요.","ogImage":{"url":"/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_0.png"},"coverImage":"/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_0.png","tag":["Tech"],"readingTime":7},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    img: \"img\",\n    h1: \"h1\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_0.png\",\n        alt: \"Deploying Next.js Application on Windows IIS Server\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"NextJS는 단일 페이지 애플리케이션을 만들기 위한 서버 측 렌더링된 React 기반 프레임워크입니다. 서버 측 렌더링 기능으로 인해 매우 인기가 높습니다. NextJS를 사용하여 다음 애플리케이션을 작성하는 것은 매우 간단합니다. NextJS를 사용하기 위해 명시적으로 구성할 필요가 없습니다. npm run dev를 실행하고 애플리케이션을 구축하기 시작하면 됩니다.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"서버 측 렌더링이란?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"서버 측 렌더링(SSR)은 프런트엔드 프레임워크가 웹페이지를 준비하기 위해 사용자별 데이터를 서버 측에서 가져와 사용자 화면으로 보내는 능력입니다. 사용자에게 표시하기 위해 클라이언트 측에서 웹페이지를 준비하는 대신에 서버 측에서 웹페이지를 준비합니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"NextJS에서는 서버에서 페이지를 렌더링하거나 일반적인 create-react-app SPA처럼 클라이언트 측에서 렌더링할 수 있는 옵션이 있습니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"서버 측 렌더링의 장점은 분명히 있습니다. 그래서 NextJS 프레임워크가 인기를 얻은 이유이기도 합니다. SSR 덕분에 초기 페이지 로딩이 빨라져 최종 사용자에게 더 나은 상호작용을 제공합니다. 또한 검색 엔진이 사이트를 크롤링하여 더 나은 검색 엔진 최적화를 제공하는데 도움이 됩니다.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"만약 NextJS가 프론트엔드 프레임워크라면, 이 프레임워크는 어떻게 서버에서 웹 페이지를 준비하는 것일까요?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"NextJS 프레임워크는 NodeJS 기반으로 만들어졌습니다. 아시다시피, NodeJS는 서버 측에서 페이지를 준비하기 위해 사용되는 NextJS 애플리케이션에 강력함을 제공하는 백엔드 JavaScript 런타임 환경입니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"NextJS 애플리케이션 배포하기\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Windows IIS에서 Next.js 애플리케이션을 호스팅하는 방법을 여러 곳에서 찾아보았어요. 괜찮은 튜토리얼을 몇 개 찾았지만 제 문제를 해결해 주지는 못했어요. Vercel과 Netlify, Heroku 등과 같은 유사한 플랫폼에 호스팅하는 것이 이상적일 것 같아요. 하지만 제 애플리케이션을 로컬에서 호스팅하고 싶어요. 왜냐하면 내 애플리케이션에 대중이 접근하는 것을 원하지 않기 때문이에요. 그건 제 개인적인 용도로 사용할 거거든요. 그래서 여러분이 구글에서 시간을 낭비하지 않고 필요한 정보를 찾을 수 있도록, 간단한 가이드를 제공해 드리겠어요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"하지만 그 전에, 사용하려는 것에 대해 간단히 설명해볼게요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"저희는 iisnode을 사용하려고 해요. iisnode은 C++로 작성된 오픈 소스 네이티브 IIS 모듈로, Node.js를 Windows IIS 내에서 실행할 수 있게 해줘요. 저희는 IIS 서버 배포 방식으로 Node.js를 사용할 거에요. 그러려면 Server.js와 web.config 두 파일이 필요하답니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"지금 application의 진입점인 server.js를 만들어보겠습니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" { createServer } = \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"require\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"http\\\"\"\n        }), \");\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" { parse } = \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"require\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"url\\\"\"\n        }), \");\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" next = \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"require\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"next\\\"\"\n        }), \");\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" dev = process.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"env\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"NODE_ENV\"\n        }), \" !== \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"production\\\"\"\n        }), \";\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" port = process.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"env\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"PORT\"\n        }), \" || \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3000\"\n        }), \"; \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// 포트를 IIS가 실행 중인 포트로 변경하세요. 기본값은 80이고 개발 중이면 3000입니다.\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" hostname = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"localhost\\\"\"\n        }), \";\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" app = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"next\"\n        }), \"({ dev, hostname, port });\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" handle = app.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"getRequestHandler\"\n        }), \"();\\n\\napp.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"prepare\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"then\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-function\",\n          children: \"() =>\"\n        }), \" {\\n  \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"createServer\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"async\"\n        }), \" (req, res) => {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"try\"\n        }), \" {\\n      \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" parsedUrl = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parse\"\n        }), \"(req.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"url\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"true\"\n        }), \");\\n      \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" { pathname, query } = parsedUrl;\\n\\n      \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (pathname === \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"/a\\\"\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"await\"\n        }), \" app.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"render\"\n        }), \"(req, res, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"/a\\\"\"\n        }), \", query);\\n      } \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (pathname === \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"/b\\\"\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"await\"\n        }), \" app.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"render\"\n        }), \"(req, res, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"/b\\\"\"\n        }), \", query);\\n      } \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \" {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"await\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"handle\"\n        }), \"(req, res, parsedUrl);\\n      }\\n    } \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"catch\"\n        }), \" (err) {\\n      \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"console\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"error\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Error occurred handling\\\"\"\n        }), \", req.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"url\"\n        }), \", err);\\n      res.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"statusCode\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"500\"\n        }), \";\\n      res.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"end\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"internal server error\\\"\"\n        }), \");\\n    }\\n  })\\n    .\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"once\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"error\\\"\"\n        }), \", \", _jsxs(_components.span, {\n          className: \"hljs-function\",\n          children: [\"(\", _jsx(_components.span, {\n            className: \"hljs-params\",\n            children: \"err\"\n          }), \") =>\"]\n        }), \" {\\n      \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"console\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"error\"\n        }), \"(err);\\n      process.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    })\\n    .\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"listen\"\n        }), \"(port, \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"async\"\n        }), \" () => {\\n      \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"console\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"log\"\n        }), \"(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"`> Ready on http://localhost:\", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"${port}\"\n          }), \"`\"]\n        }), \");\\n    });\\n});\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"웹 구성 파일인 web.config은 IIS 및 ASP.NET Core Module이 응용 프로그램을 구성하는 데 사용하는 파일입니다. 그래서 여기에 우리의 web.config 파일이 있습니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"<?xml version=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"1.0\\\"\"\n        }), \" encoding=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"utf-8\\\"\"\n        }), \"?>\\n<!--\\n     이 구성 파일은 iisnode를 사용하여 \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"IIS\"\n        }), \" 또는 \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"IIS\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Express\"\n        }), \"에서 노드 프로세스를 실행하는 경우 필요합니다.\\n     자세한 내용은 다음을 참조하십시오:\\n\\n     \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"https\"\n        }), \":\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//github.com/tjanczuk/iisnode/blob/master/src/samples/configuration/web.config\"\n        }), \"\\n-->\\n\\n\", _jsxs(_components.span, {\n          className: \"xml\",\n          children: [_jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"configuration\"\n            }), \">\"]\n          }), \"\\n  \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"system.webServer\"\n            }), \">\"]\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- WebSocket 지원에 대한 자세한 정보는 http://blogs.msdn.com/b/windowsazure/archive/2013/11/14/introduction-to-websockets-on-windows-azure-web-sites.aspx에서 확인할 수 있습니다 -->\"\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"webSocket\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"enabled\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"false\\\"\"\n            }), \" />\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"handlers\"\n            }), \">\"]\n          }), \"\\n      \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- server.js 파일이 iisnode 모듈에 의해 처리되는 node.js 사이트임을 나타냄 -->\"\n          }), \"\\n      \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"add\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"name\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"iisnode\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"path\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"server.js\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"verb\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"*\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"modules\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"iisnode\\\"\"\n            }), \"/>\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"handlers\"\n            }), \">\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rewrite\"\n            }), \">\"]\n          }), \"\\n      \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rules\"\n            }), \">\"]\n          }), \"\\n        \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- node-inspector 디버깅을 위한 요청 방해하지 않음 -->\"\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"name\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"NodeInspector\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"patternSyntax\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"ECMAScript\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"stopProcessing\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"true\\\"\"\n            }), \">\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"match\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"url\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"^server.js\\\\/debug[\\\\/]?\\\"\"\n            }), \" />\"]\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \">\"]\n          }), \"\\n\\n        \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- 먼저 /public 폴더의 물리적 파일과 일치하는 들어오는 URL을 고려 -->\"\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"name\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"StaticContent\\\"\"\n            }), \">\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"action\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"type\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"Rewrite\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"url\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"public{REQUEST_URI}\\\"\"\n            }), \"/>\"]\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \">\"]\n          }), \"\\n\\n        \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- 모든 다른 URL은 node.js 사이트 진입점으로 매핑됨 -->\"\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"name\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"DynamicContent\\\"\"\n            }), \">\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"conditions\"\n            }), \">\"]\n          }), \"\\n            \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"add\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"input\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"{REQUEST_FILENAME}\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"matchType\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"IsFile\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"negate\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"True\\\"\"\n            }), \"/>\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"conditions\"\n            }), \">\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"action\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"type\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"Rewrite\\\"\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"url\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"server.js\\\"\"\n            }), \"/>\"]\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rule\"\n            }), \">\"]\n          }), \"\\n      \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rules\"\n            }), \">\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"rewrite\"\n            }), \">\"]\n          }), \"\\n    \\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- 'bin' 디렉토리는 node.js에서 특별한 의미가 없으며, 앱을 그 안에 배치할 수 있음 -->\"\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"security\"\n            }), \">\"]\n          }), \"\\n      \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"requestFiltering\"\n            }), \">\"]\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"hiddenSegments\"\n            }), \">\"]\n          }), \"\\n          \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"add\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"segment\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"node_modules\\\"\"\n            }), \"/>\"]\n          }), \"\\n        \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"hiddenSegments\"\n            }), \">\"]\n          }), \"\\n      \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"requestFiltering\"\n            }), \">\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"security\"\n            }), \">\"]\n          }), \"\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!-- 오류 응답을 변경하지 않도록 함 -->\"\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"httpErrors\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"existingResponse\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"PassThrough\\\"\"\n            }), \" />\"]\n          }), \"\\n    \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"<\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"iisnode\"\n            }), \" \", _jsx(_components.span, {\n              className: \"hljs-attr\",\n              children: \"node_env\"\n            }), \"=\", _jsx(_components.span, {\n              className: \"hljs-string\",\n              children: \"\\\"production\\\"\"\n            }), \"/>\"]\n          }), \"\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!--\\n      다음 옵션을 사용하여 IIS 내에서 Node를 호스트하는 방법을 제어할 수 있습니다:\\n        * watchedFiles: 변경 사항을 감지하여 서버를 다시 시작할 파일 목록\\n        * node_env: NODE_ENV 환경 변수로 전달될 값\\n        * debuggingEnabled - 기본 디버거가 활성화되는지 여부\\n\\n      모든 옵션 목록은 https://github.com/tjanczuk/iisnode/blob/master/src/samples/configuration/web.config에서 확인 가능합니다\\n    -->\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"<!--<iisnode watchedFiles=\\\"web.config;*.js\\\"/>-->\"\n          }), \"\\n  \", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"system.webServer\"\n            }), \">\"]\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"hljs-tag\",\n            children: [\"</\", _jsx(_components.span, {\n              className: \"hljs-name\",\n              children: \"configuration\"\n            }), \">\"]\n          })]\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"웹 구성 파일을 추가한 후에는 package.json을 약간 변경해야 합니다. npm run start가 서버를 시작하도록 설정되어야 하며 next start를 사용하지 않아야 합니다. 다음은 package.json 스크립트가 보이는 방식입니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"  \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"scripts\\\"\"\n        }), \": {\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"dev\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"node server.js\\\"\"\n        }), \",\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"build\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"next build\\\"\"\n        }), \",\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"start\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"node server.js\\\"\"\n        }), \",\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"lint\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"next lint\\\"\"\n        }), \"\\n  },\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"server.js를 추가하고 web.config를 추가한 후 npm run build를 실행하면 애플리케이션의 루트 폴더가 다음과 같이 보입니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-DeployingNextJsApplicationonWindowsIISServer_1.png\",\n        alt: \"애플리케이션 루트 폴더\"\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"IIS에서 NextJS 애플리케이션을 배포하는 방법\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"배포를 설정하기 전에 IISNode와 URLRewrite를 설치해야 합니다. 그 후, IIS에 새 웹 사이트를 생성하고 물리적 경로를 .next, node_modules, server.js 및 web.config가 포함된 폴더로 지정하세요. 권한 문제나 다른 가능한 문제를 피하려면 해당 폴더를 Windows Server의 루트 사용자 폴더 안에 배치하세요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"IIS에서 웹 서버를 시작하면 자동으로 iisnode이라는 새 폴더가 생성됩니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"만약 배포 폴더가 C:/ 드라이브의 wwwroot에 있다면 전체 폴더에 대해 IIS_Users에게 읽기/쓰기 권한을 명시적으로 부여해야 할 수 있습니다. 다른 예상치 못한 오류가 발생하는 경우, 댓글을 남기거나 내 Discord @pallepadehat을 추가해주세요. 도와드릴게요!\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 Github Repo에서 소스 코드를 확인할 수 있어요.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true}