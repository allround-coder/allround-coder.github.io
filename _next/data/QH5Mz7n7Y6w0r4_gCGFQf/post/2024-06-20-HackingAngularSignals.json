{"pageProps":{"post":{"title":"ì•µê·¤ëŸ¬ ì‹œê·¸ë„ í•´í‚¹í•˜ê¸°","description":"","date":"2024-06-20 05:43","slug":"2024-06-20-HackingAngularSignals","content":"\n\nì•µê·¤ëŸ¬ ì‹œê·¸ë„ì´ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³´ê³ , ê¸°ëŠ¥ì„ í™•ì¥í•˜ê³  ë””ë²„ê¹…í•˜ëŠ” ë° ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.\n\n## ì•µê·¤ëŸ¬ ì‹œê·¸ë„ì´ë€\n\nì•µê·¤ëŸ¬ ì‹œê·¸ë„ì€ ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œê°€ ìˆëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤:\n\n```js\nconst $val = signal(0);\n\n// í•¨ìˆ˜:\nconst value = $val();\n\n// ê°ì²´:\n$val.set(4);\n$val.update((v) => v * 2);\n```\n\n<div class=\"content-ad\"></div>\n\nì–´ë–»ê²Œ ê°€ëŠ¥í•œ ê±¸ê¹Œìš”? JavaScriptì—ì„œëŠ” í•¨ìˆ˜ê°€ ê°ì²´ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤:\n\n```js\n// í•¨ìˆ˜ ì„ ì–¸\nconst double = (val: number) => val * 2;\n\n// ë©”ì†Œë“œ ì¶”ê°€\ndouble.isEven = (number: number) => number % 2 === 0;\n\n// ê°ì²´ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°\ndouble.isEven(15) // false\n\n// í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°\ndouble(8) // 16\n```\n\nì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?\n\nìš°ë¦¬ëŠ” ê°€ëŠ¥í•©ë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n- ìƒˆë¡œìš´ ë©”ì„œë“œ ì¶”ê°€í•˜ê¸°\n- ìˆ˜ì • ì‚¬í•­ì„ ê°€ë¡œì±Œ ìˆ˜ ìˆë„ë¡ set() ë° update() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ê¸°\n- ì‹ í˜¸ì˜ ë‚´ë¶€ ìƒíƒœ ë³€ìˆ˜ ë° ë©”ì„œë“œ ì½ê¸°\n- ì½ê¸°ë¥¼ ê°€ë¡œì±Œ í”„ë¡ì‹œ ì‹ í˜¸ ìƒì„±í•˜ê¸°\n\n## ì‹ í˜¸ í™•ì¥í•˜ê¸°\n\nê°€ë” ë³€ìˆ˜ë¥¼ ì‹ í˜¸ë¡œ ì‚¬ìš©í•´ì•¼ í•˜ì§€ë§Œ ì½”ë“œì˜ ì¼ë¶€ëŠ” ëŒ€ì‹  Observableë¡œ ì‚¬ìš©í•˜ë ¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në‹¤í–‰íˆë„ ì‹ í˜¸ ë° Observableì˜ ì¸í„°í˜ì´ìŠ¤ëŠ” ë©”ì„œë“œ ì´ë¦„ì—ì„œ ì¶©ëŒì´ ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‹ˆ í•˜ì´ë¸Œë¦¬ë“œë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n```typescript\n// ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœíˆ ê¸°ì¡´ ê°ì²´ì— ìƒˆë¡œìš´ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\në˜ëŠ” Proxy ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ìš”ì²­ëœ ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì€ Signalì— ëŒ€í•´ì„œë§Œ Observableì˜ ë©”ì„œë“œë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\nexport function toObservableSignal<T>(s: Signal<T>) {\n\n  const obs = toObservable(s, options); \n   \n  return new Proxy(s, {\n    get(_, prop) {\n      if (prop in s) {\n        return (s as any)[prop];\n      }\n      return (obs as any)[prop];\n    }\n  });\n}\n\n<div class=\"content-ad\"></div>\n\nì•„ë˜ëŠ” ì‚¬ìš© ì˜ˆì‹œì…ë‹ˆë‹¤:\n\n@Component({\n  //...\n  template: `\n    <h4>Signal A: { a() }</h4>\n    <h4>Observable A: {a|async}</h4>\n    <h4>Signal C (computed() A*3): {c()}</h4>\n\n    {quote()}\n  `,\n})\nexport class App {\n  a = toObservableSignal(signal<number>(1));\n\n  // use as Observable\n  b = this.a.pipe(\n    debounceTime(500),\n    distinctUntilChanged(),\n    switchMap((v) => this.http.get('https://dummyjson.com/quotes/' + v))\n  );\n\n  // use as Signal\n  c = computed(() => this.a() * 3);\n\n  quote = toSignal(this.b);\n\n  increment() {\n    // \"a\" will not stop being a Signal after \n    // we used it as an Observable\n    this.a.update((v) => v + 1);\n  }\n\n  decrement() {\n    this.a.update((v) => Math.max(1, v - 1));\n  }\n}\n\nNG Extension Platformì—ì„œ ì´ ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. \n\nì›í•˜ëŠ” í•¨ìˆ˜ë¡œ Signalì„ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ìƒìƒë ¥ì—ëŠ” ê±°ì˜ ì œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë‹¨, set, update, asReadonlyë¼ëŠ” ì´ë¦„ì€ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”.\n\n<div class=\"content-ad\"></div>\n\n## ê¸°ì¡´ ë©”ì„œë“œ ì¬ì •ì˜\n\nì €í¬ Signalì— ê°’ì„ ì…ë ¥ ë³€í™˜í•˜ê±°ë‚˜ ë‹¤ë¥¸ ê³³ì— ì •ë³´ë¥¼ ë³µì œí•˜ê±°ë‚˜ ë””ë²„ê¹…ì„ ìœ„í•´ ì“°ê¸°ë¥¼ ì¤‘ê°„ì—ì„œ ê°€ë¡œì±„ê³  ì‹¶ë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.\n\nfunction skipNonEvenNumbers(s: WritableSignal<number>) {\n  const srcSet = s.set; // ì¬ê·€ë¥¼ í”¼í•˜ê¸° ìœ„í•´ ì†ŒìŠ¤ ë©”ì„œë“œê°€ í•„ìš”í•©ë‹ˆë‹¤\n\n  s.set = (value: number) => {\n    if (value % 2 !== 0) {\n      console.warn('[set] skipping:', value);\n      return;\n    }\n    console.log('[set]:', value);\n    srcSet(value);\n  };\n  s.update = (updateFn: (value: number) => number) => {\n    const value = updateFn(s());\n    if (value % 2 !== 0) {\n      console.warn('[update] skipping:', value);\n      return;\n    }\n    console.log('[update]:', value);\n    srcSet(value);\n  };\n}\n\nì‚¬ìš© ì˜ˆì‹œ:\n\n<div class=\"content-ad\"></div>\n\nì´ ê¸°ë²•ì€ Reactive Storage: getWritableSignal()ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\n## ì‹œê·¸ë„ ë‚´ë¶€\n\nAngular ì‹œê·¸ë„ì€ ë‹¨ìˆœíˆ í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼ ê°ì²´ì…ë‹ˆë‹¤. ì´ ê°ì²´ì—ëŠ” í¥ë¯¸ë¡œìš´ ë°ì´í„°ì™€ í•¨ìˆ˜ê°€ ë‹´ê¸´ ìˆ¨ê²¨ì§„ í•„ë“œ SIGNALì´ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì„ ê°€ì§€ê³  ìˆì–´ì„œ ì¢‹ê³ , ë‚¨ìš©í•˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ ìœ„ì˜ ê¸°ë²•ë“¤ì€ \"ì•½ê°„ ê¼¼ìˆ˜ì \"ì´ì—ˆê³ , ì•„ë˜ì˜ ê¸°ë²•ë“¤ì€ ë””ë²„ê¹…, ê°œë°œ ë„êµ¬ ìƒì„±, ì¬ë¯¸ë¥¼ ìœ„í•´ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nëª¨ë“  Angular ì‹œê·¸ë„ì€ ReactiveNodeë¥¼ í™•ì¥í•©ë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n// packages/core/primitives/signals/src/graph.ts\n\nexport const REACTIVE_NODE: ReactiveNode = {\n  version: 0 as Version,\n  lastCleanEpoch: 0 as Version,\n  dirty: false,\n  producerNode: undefined,\n  producerLastReadVersion: undefined,\n  producerIndexOfThis: undefined,\n  nextProducerIndex: 0,\n  liveConsumerNode: undefined,\n  liveConsumerIndexOfThis: undefined,\n  consumerAllowSignalWrites: false,\n  consumerIsAlwaysLive: false,\n  producerMustRecompute: () => false,\n  producerRecomputeValue: () => {},\n  consumerMarkedDirty: () => {},\n  consumerOnSignalRead: () => {},\n};\n\nì´ë ‡ê²Œ:\n\n// packages/core/primitives/signals/src/signal.ts\n\nexport const SIGNAL_NODE = {\n  ...REACTIVE_NODE,\n  equal: defaultEquals,\n  value: undefined,\n}\n\ní•˜ì§€ë§Œ ì‹¤ì œë¡œ Signal ê°ì²´ê°€ ì¸ìŠ¤í„´ìŠ¤í™”ë˜ë©´ ì´ë“¤ì´ ëª¨ë‘ ì§ì ‘ì ìœ¼ë¡œ í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë‘ Symbolì„ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í•„ë“œ ì•„ë˜ì— ìˆ¨ê²¨ì ¸ ìˆìŠµë‹ˆë‹¤:\n```\n\n<div class=\"content-ad\"></div>\n\n```js\n// packages/core/primitives/signals/src/signal.ts\n\nexport function createSignal<T>(initialValue: T): SignalGetter<T> {\n  const node: SignalNode<T> = Object.create(SIGNAL_NODE);\n  node.value = initialValue;\n  const getter = (() => {\n                   producerAccessed(node);\n                   return node.value;\n                 }) as SignalGetter<T>;\n\n  // ë‹¤ìŒ ì¤„ì€ SIGNAL í•„ë“œì— SignalNodeë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:\n  (getter as any)[SIGNAL] = node;\n  return getter;\n}\n```\n\nê·¸ë˜ì„œ signal $valueë¥¼ ê°€ì§€ê³  ìˆê³  SIGNAL í•„ë“œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²½ìš°, SIGNAL_NODEê°€ ê°€ì§€ê³  ìˆëŠ” ëª¨ë“  í•„ë“œë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.\n\nì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?\n\nìš°ë¦¬ëŠ” í•„ë“œë¥¼ ì½ê³  ì•¡ì„¸ìŠ¤ë¥¼ ê°€ë¡œì±„ì–´ ë””ë²„ê¹…ì— ì‚¬ìš©í•˜ê±°ë‚˜ Signal ë‚´ë¶€ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ë¥¼ ì„¤ëª…í•˜ëŠ” ë©‹ì§„ ë„êµ¬ë¥¼ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¢…ì†ì„± ê·¸ë˜í”„ë¥¼ ë Œë”ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\n<div class=\"content-ad\"></div>\n\nì‹¬ì§€ì–´ ì¼ë¶€ í•„ë“œë¥¼ ì—‘ì„¸ì„œë¡œ ë³€í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:\n\n```js\nfunction getSignalVersion<T>(s: WritableSignal<T>): Signal<number> {\n  const node = s[SIGNAL];\n  const $version = signal(0);\n\n  Object.defineProperty(node, 'version', {\n    get: () => {\n      const v = untracked($version);\n      console.log('ğŸŸ¢ reading:', v);\n      return v;\n    },\n    set: (v) => {\n      untracked(() => $version.set(v));\n      console.log('ğŸ”´ writing:', v);\n    },\n  });\n\n  return $version.asReadonly();\n}\n```\n\nStackBlitz:\n\në˜ëŠ” `effect()` ì—†ì´ Signal ì½ê¸°ë¥¼ ê°ì‹œí•  ìˆ˜ ìˆëŠ” í”„ë¡ì‹œë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n```js\nfunction watchSignalReads<T, M extends Signal<T> | WritableSignal<T>>(s: M): M {\n  const node = s[SIGNAL];\n  const newGetter = () => {\n    const value = s();\n    console.log('Read:', value);\n    return value;\n  };\n  (newGetter as any)[SIGNAL] = node;\n  if (s.hasOwnProperty('set')) {\n    const w = s as WritableSignal<T>;\n    newGetter.set = w.set;\n    newGetter.update = w.update;\n    newGetter.asReadonly = w.asReadonly;\n  }\n\n  return newGetter as M;\n}\n```\n\nì‚¬ìš© ì˜ˆì‹œ:\n\në‹¤ì‹œ ë§í•˜ì§€ë§Œ, ì´ë¥¼ \"ë°°í¬ í™˜ê²½\"ì—ì„œ ì‚¬ìš©í•˜ì§€ ë§ê³ , ëŒ€ì‹ ì— ë©‹ì§„ ë„êµ¬ë¥¼ ë§Œë“¤ê³  ì¸ì •ì„ ë°›ì•„ Angular ìƒíƒœê³„ë¥¼ í’ìš”ë¡­ê²Œ í•˜ëŠ” ë° í™œìš©í•˜ê¸¸ ë°”ë˜ìš” ğŸ˜","ogImage":{"url":"/assets/img/2024-06-20-HackingAngularSignals_0.png"},"coverImage":"/assets/img/2024-06-20-HackingAngularSignals_0.png","tag":["Tech"],"readingTime":6},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>ì•µê·¤ëŸ¬ ì‹œê·¸ë„ì´ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³´ê³ , ê¸°ëŠ¥ì„ í™•ì¥í•˜ê³  ë””ë²„ê¹…í•˜ëŠ” ë° ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.</p>\n<h2>ì•µê·¤ëŸ¬ ì‹œê·¸ë„ì´ë€</h2>\n<p>ì•µê·¤ëŸ¬ ì‹œê·¸ë„ì€ ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œê°€ ìˆëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> $val = <span class=\"hljs-title function_\">signal</span>(<span class=\"hljs-number\">0</span>);\n\n<span class=\"hljs-comment\">// í•¨ìˆ˜:</span>\n<span class=\"hljs-keyword\">const</span> value = $val();\n\n<span class=\"hljs-comment\">// ê°ì²´:</span>\n$val.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-number\">4</span>);\n$val.<span class=\"hljs-title function_\">update</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">v</span>) =></span> v * <span class=\"hljs-number\">2</span>);\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>ì–´ë–»ê²Œ ê°€ëŠ¥í•œ ê±¸ê¹Œìš”? JavaScriptì—ì„œëŠ” í•¨ìˆ˜ê°€ ê°ì²´ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// í•¨ìˆ˜ ì„ ì–¸</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">double</span> = (<span class=\"hljs-params\">val: number</span>) => val * <span class=\"hljs-number\">2</span>;\n\n<span class=\"hljs-comment\">// ë©”ì†Œë“œ ì¶”ê°€</span>\ndouble.<span class=\"hljs-property\">isEven</span> = <span class=\"hljs-function\">(<span class=\"hljs-params\">number: number</span>) =></span> number % <span class=\"hljs-number\">2</span> === <span class=\"hljs-number\">0</span>;\n\n<span class=\"hljs-comment\">// ê°ì²´ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°</span>\ndouble.<span class=\"hljs-title function_\">isEven</span>(<span class=\"hljs-number\">15</span>) <span class=\"hljs-comment\">// false</span>\n\n<span class=\"hljs-comment\">// í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°</span>\n<span class=\"hljs-title function_\">double</span>(<span class=\"hljs-number\">8</span>) <span class=\"hljs-comment\">// 16</span>\n</code></pre>\n<p>ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<p>ìš°ë¦¬ëŠ” ê°€ëŠ¥í•©ë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<ul>\n<li>ìƒˆë¡œìš´ ë©”ì„œë“œ ì¶”ê°€í•˜ê¸°</li>\n<li>ìˆ˜ì • ì‚¬í•­ì„ ê°€ë¡œì±Œ ìˆ˜ ìˆë„ë¡ set() ë° update() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ê¸°</li>\n<li>ì‹ í˜¸ì˜ ë‚´ë¶€ ìƒíƒœ ë³€ìˆ˜ ë° ë©”ì„œë“œ ì½ê¸°</li>\n<li>ì½ê¸°ë¥¼ ê°€ë¡œì±Œ í”„ë¡ì‹œ ì‹ í˜¸ ìƒì„±í•˜ê¸°</li>\n</ul>\n<h2>ì‹ í˜¸ í™•ì¥í•˜ê¸°</h2>\n<p>ê°€ë” ë³€ìˆ˜ë¥¼ ì‹ í˜¸ë¡œ ì‚¬ìš©í•´ì•¼ í•˜ì§€ë§Œ ì½”ë“œì˜ ì¼ë¶€ëŠ” ëŒ€ì‹  Observableë¡œ ì‚¬ìš©í•˜ë ¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë‹¤í–‰íˆë„ ì‹ í˜¸ ë° Observableì˜ ì¸í„°í˜ì´ìŠ¤ëŠ” ë©”ì„œë“œ ì´ë¦„ì—ì„œ ì¶©ëŒì´ ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‹ˆ í•˜ì´ë¸Œë¦¬ë“œë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-typescript\"><span class=\"hljs-comment\">// ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœíˆ ê¸°ì¡´ ê°ì²´ì— ìƒˆë¡œìš´ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤.</span>\n\në˜ëŠ” <span class=\"hljs-title class_\">Proxy</span> ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ìš”ì²­ëœ ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì€ <span class=\"hljs-title class_\">Signal</span>ì— ëŒ€í•´ì„œë§Œ <span class=\"hljs-title class_\">Observable</span>ì˜ ë©”ì„œë“œë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> toObservableSignal&#x3C;T>(<span class=\"hljs-attr\">s</span>: <span class=\"hljs-title class_\">Signal</span>&#x3C;T>) {\n\n  <span class=\"hljs-keyword\">const</span> obs = <span class=\"hljs-title function_\">toObservable</span>(s, options); \n   \n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Proxy</span>(s, {\n    <span class=\"hljs-title function_\">get</span>(<span class=\"hljs-params\">_, prop</span>) {\n      <span class=\"hljs-keyword\">if</span> (prop <span class=\"hljs-keyword\">in</span> s) {\n        <span class=\"hljs-keyword\">return</span> (s <span class=\"hljs-keyword\">as</span> <span class=\"hljs-built_in\">any</span>)[prop];\n      }\n      <span class=\"hljs-keyword\">return</span> (obs <span class=\"hljs-keyword\">as</span> <span class=\"hljs-built_in\">any</span>)[prop];\n    }\n  });\n}\n\n&#x3C;div <span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">\"content-ad\"</span>>&#x3C;/div>\n\nì•„ë˜ëŠ” ì‚¬ìš© ì˜ˆì‹œì…ë‹ˆë‹¤:\n\n<span class=\"hljs-meta\">@Component</span>({\n  <span class=\"hljs-comment\">//...</span>\n  <span class=\"hljs-attr\">template</span>: <span class=\"hljs-string\">`\n    &#x3C;h4>Signal A: { a() }&#x3C;/h4>\n    &#x3C;h4>Observable A: {a|async}&#x3C;/h4>\n    &#x3C;h4>Signal C (computed() A*3): {c()}&#x3C;/h4>\n\n    {quote()}\n  `</span>,\n})\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">App</span> {\n  a = <span class=\"hljs-title function_\">toObservableSignal</span>(signal&#x3C;<span class=\"hljs-built_in\">number</span>>(<span class=\"hljs-number\">1</span>));\n\n  <span class=\"hljs-comment\">// use as Observable</span>\n  b = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">a</span>.<span class=\"hljs-title function_\">pipe</span>(\n    <span class=\"hljs-title function_\">debounceTime</span>(<span class=\"hljs-number\">500</span>),\n    <span class=\"hljs-title function_\">distinctUntilChanged</span>(),\n    <span class=\"hljs-title function_\">switchMap</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">v</span>) =></span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">http</span>.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">'https://dummyjson.com/quotes/'</span> + v))\n  );\n\n  <span class=\"hljs-comment\">// use as Signal</span>\n  c = <span class=\"hljs-title function_\">computed</span>(<span class=\"hljs-function\">() =></span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">a</span>() * <span class=\"hljs-number\">3</span>);\n\n  quote = <span class=\"hljs-title function_\">toSignal</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">b</span>);\n\n  <span class=\"hljs-title function_\">increment</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-comment\">// \"a\" will not stop being a Signal after </span>\n    <span class=\"hljs-comment\">// we used it as an Observable</span>\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">a</span>.<span class=\"hljs-title function_\">update</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">v</span>) =></span> v + <span class=\"hljs-number\">1</span>);\n  }\n\n  <span class=\"hljs-title function_\">decrement</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">a</span>.<span class=\"hljs-title function_\">update</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">v</span>) =></span> <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">max</span>(<span class=\"hljs-number\">1</span>, v - <span class=\"hljs-number\">1</span>));\n  }\n}\n\n<span class=\"hljs-variable constant_\">NG</span> <span class=\"hljs-title class_\">Extension</span> <span class=\"hljs-title class_\">Platform</span>ì—ì„œ ì´ ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. \n\nì›í•˜ëŠ” í•¨ìˆ˜ë¡œ <span class=\"hljs-title class_\">Signal</span>ì„ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ìƒìƒë ¥ì—ëŠ” ê±°ì˜ ì œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë‹¨, set, update, asReadonlyë¼ëŠ” ì´ë¦„ì€ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”.\n\n&#x3C;div <span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">\"content-ad\"</span>>&#x3C;/div>\n\n## ê¸°ì¡´ ë©”ì„œë“œ ì¬ì •ì˜\n\nì €í¬ <span class=\"hljs-title class_\">Signal</span>ì— ê°’ì„ ì…ë ¥ ë³€í™˜í•˜ê±°ë‚˜ ë‹¤ë¥¸ ê³³ì— ì •ë³´ë¥¼ ë³µì œí•˜ê±°ë‚˜ ë””ë²„ê¹…ì„ ìœ„í•´ ì“°ê¸°ë¥¼ ì¤‘ê°„ì—ì„œ ê°€ë¡œì±„ê³  ì‹¶ë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">skipNonEvenNumbers</span>(<span class=\"hljs-params\">s: WritableSignal&#x3C;<span class=\"hljs-built_in\">number</span>></span>) {\n  <span class=\"hljs-keyword\">const</span> srcSet = s.<span class=\"hljs-property\">set</span>; <span class=\"hljs-comment\">// ì¬ê·€ë¥¼ í”¼í•˜ê¸° ìœ„í•´ ì†ŒìŠ¤ ë©”ì„œë“œê°€ í•„ìš”í•©ë‹ˆë‹¤</span>\n\n  s.<span class=\"hljs-property\">set</span> = <span class=\"hljs-function\">(<span class=\"hljs-params\">value: <span class=\"hljs-built_in\">number</span></span>) =></span> {\n    <span class=\"hljs-keyword\">if</span> (value % <span class=\"hljs-number\">2</span> !== <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">warn</span>(<span class=\"hljs-string\">'[set] skipping:'</span>, value);\n      <span class=\"hljs-keyword\">return</span>;\n    }\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'[set]:'</span>, value);\n    <span class=\"hljs-title function_\">srcSet</span>(value);\n  };\n  s.<span class=\"hljs-property\">update</span> = <span class=\"hljs-function\">(<span class=\"hljs-params\">updateFn: (value: <span class=\"hljs-built_in\">number</span>) => <span class=\"hljs-built_in\">number</span></span>) =></span> {\n    <span class=\"hljs-keyword\">const</span> value = <span class=\"hljs-title function_\">updateFn</span>(<span class=\"hljs-title function_\">s</span>());\n    <span class=\"hljs-keyword\">if</span> (value % <span class=\"hljs-number\">2</span> !== <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">warn</span>(<span class=\"hljs-string\">'[update] skipping:'</span>, value);\n      <span class=\"hljs-keyword\">return</span>;\n    }\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'[update]:'</span>, value);\n    <span class=\"hljs-title function_\">srcSet</span>(value);\n  };\n}\n\nì‚¬ìš© ì˜ˆì‹œ:\n\n<span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"content-ad\"</span>></span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">div</span>></span></span>\n\nì´ ê¸°ë²•ì€ <span class=\"hljs-title class_\">Reactive</span> <span class=\"hljs-title class_\">Storage</span>: <span class=\"hljs-title function_\">getWritableSignal</span>()ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\n## ì‹œê·¸ë„ ë‚´ë¶€\n\n<span class=\"hljs-title class_\">Angular</span> ì‹œê·¸ë„ì€ ë‹¨ìˆœíˆ í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼ ê°ì²´ì…ë‹ˆë‹¤. ì´ ê°ì²´ì—ëŠ” í¥ë¯¸ë¡œìš´ ë°ì´í„°ì™€ í•¨ìˆ˜ê°€ ë‹´ê¸´ ìˆ¨ê²¨ì§„ í•„ë“œ <span class=\"hljs-variable constant_\">SIGNAL</span>ì´ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì„ ê°€ì§€ê³  ìˆì–´ì„œ ì¢‹ê³ , ë‚¨ìš©í•˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ ìœ„ì˜ ê¸°ë²•ë“¤ì€ <span class=\"hljs-string\">\"ì•½ê°„ ê¼¼ìˆ˜ì \"</span>ì´ì—ˆê³ , ì•„ë˜ì˜ ê¸°ë²•ë“¤ì€ ë””ë²„ê¹…, ê°œë°œ ë„êµ¬ ìƒì„±, ì¬ë¯¸ë¥¼ ìœ„í•´ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nëª¨ë“  <span class=\"hljs-title class_\">Angular</span> ì‹œê·¸ë„ì€ <span class=\"hljs-title class_\">ReactiveNode</span>ë¥¼ í™•ì¥í•©ë‹ˆë‹¤:\n\n<span class=\"xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"content-ad\"</span>></span><span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">div</span>></span></span>\n\n<span class=\"hljs-comment\">// packages/core/primitives/signals/src/graph.ts</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">REACTIVE_NODE</span>: <span class=\"hljs-title class_\">ReactiveNode</span> = {\n  <span class=\"hljs-attr\">version</span>: <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">Version</span>,\n  <span class=\"hljs-attr\">lastCleanEpoch</span>: <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">Version</span>,\n  <span class=\"hljs-attr\">dirty</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">producerNode</span>: <span class=\"hljs-literal\">undefined</span>,\n  <span class=\"hljs-attr\">producerLastReadVersion</span>: <span class=\"hljs-literal\">undefined</span>,\n  <span class=\"hljs-attr\">producerIndexOfThis</span>: <span class=\"hljs-literal\">undefined</span>,\n  <span class=\"hljs-attr\">nextProducerIndex</span>: <span class=\"hljs-number\">0</span>,\n  <span class=\"hljs-attr\">liveConsumerNode</span>: <span class=\"hljs-literal\">undefined</span>,\n  <span class=\"hljs-attr\">liveConsumerIndexOfThis</span>: <span class=\"hljs-literal\">undefined</span>,\n  <span class=\"hljs-attr\">consumerAllowSignalWrites</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">consumerIsAlwaysLive</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">producerMustRecompute</span>: <span class=\"hljs-function\">() =></span> <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">producerRecomputeValue</span>: <span class=\"hljs-function\">() =></span> {},\n  <span class=\"hljs-attr\">consumerMarkedDirty</span>: <span class=\"hljs-function\">() =></span> {},\n  <span class=\"hljs-attr\">consumerOnSignalRead</span>: <span class=\"hljs-function\">() =></span> {},\n};\n\nì´ë ‡ê²Œ:\n\n<span class=\"hljs-comment\">// packages/core/primitives/signals/src/signal.ts</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">SIGNAL_NODE</span> = {\n  ...<span class=\"hljs-variable constant_\">REACTIVE_NODE</span>,\n  <span class=\"hljs-attr\">equal</span>: defaultEquals,\n  <span class=\"hljs-attr\">value</span>: <span class=\"hljs-literal\">undefined</span>,\n}\n\ní•˜ì§€ë§Œ ì‹¤ì œë¡œ <span class=\"hljs-title class_\">Signal</span> ê°ì²´ê°€ ì¸ìŠ¤í„´ìŠ¤í™”ë˜ë©´ ì´ë“¤ì´ ëª¨ë‘ ì§ì ‘ì ìœ¼ë¡œ í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë‘ <span class=\"hljs-title class_\">Symbol</span>ì„ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í•„ë“œ ì•„ë˜ì— ìˆ¨ê²¨ì ¸ ìˆìŠµë‹ˆë‹¤:\n</code></pre>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// packages/core/primitives/signals/src/signal.ts</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> createSignal&#x3C;T>(<span class=\"hljs-attr\">initialValue</span>: T): <span class=\"hljs-title class_\">SignalGetter</span>&#x3C;T> {\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">node</span>: <span class=\"hljs-title class_\">SignalNode</span>&#x3C;T> = <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">create</span>(<span class=\"hljs-variable constant_\">SIGNAL_NODE</span>);\n  node.<span class=\"hljs-property\">value</span> = initialValue;\n  <span class=\"hljs-keyword\">const</span> getter = (<span class=\"hljs-function\">() =></span> {\n                   <span class=\"hljs-title function_\">producerAccessed</span>(node);\n                   <span class=\"hljs-keyword\">return</span> node.<span class=\"hljs-property\">value</span>;\n                 }) <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">SignalGetter</span>&#x3C;T>;\n\n  <span class=\"hljs-comment\">// ë‹¤ìŒ ì¤„ì€ SIGNAL í•„ë“œì— SignalNodeë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:</span>\n  (getter <span class=\"hljs-keyword\">as</span> any)[<span class=\"hljs-variable constant_\">SIGNAL</span>] = node;\n  <span class=\"hljs-keyword\">return</span> getter;\n}\n</code></pre>\n<p>ê·¸ë˜ì„œ signal $valueë¥¼ ê°€ì§€ê³  ìˆê³  SIGNAL í•„ë“œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²½ìš°, SIGNAL_NODEê°€ ê°€ì§€ê³  ìˆëŠ” ëª¨ë“  í•„ë“œë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.</p>\n<p>ì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<p>ìš°ë¦¬ëŠ” í•„ë“œë¥¼ ì½ê³  ì•¡ì„¸ìŠ¤ë¥¼ ê°€ë¡œì±„ì–´ ë””ë²„ê¹…ì— ì‚¬ìš©í•˜ê±°ë‚˜ Signal ë‚´ë¶€ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ë¥¼ ì„¤ëª…í•˜ëŠ” ë©‹ì§„ ë„êµ¬ë¥¼ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¢…ì†ì„± ê·¸ë˜í”„ë¥¼ ë Œë”ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>ì‹¬ì§€ì–´ ì¼ë¶€ í•„ë“œë¥¼ ì—‘ì„¸ì„œë¡œ ë³€í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> getSignalVersion&#x3C;T>(<span class=\"hljs-attr\">s</span>: <span class=\"hljs-title class_\">WritableSignal</span>&#x3C;T>): <span class=\"hljs-title class_\">Signal</span>&#x3C;number> {\n  <span class=\"hljs-keyword\">const</span> node = s[<span class=\"hljs-variable constant_\">SIGNAL</span>];\n  <span class=\"hljs-keyword\">const</span> $version = <span class=\"hljs-title function_\">signal</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">defineProperty</span>(node, <span class=\"hljs-string\">'version'</span>, {\n    <span class=\"hljs-attr\">get</span>: <span class=\"hljs-function\">() =></span> {\n      <span class=\"hljs-keyword\">const</span> v = <span class=\"hljs-title function_\">untracked</span>($version);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'ğŸŸ¢ reading:'</span>, v);\n      <span class=\"hljs-keyword\">return</span> v;\n    },\n    <span class=\"hljs-attr\">set</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">v</span>) =></span> {\n      <span class=\"hljs-title function_\">untracked</span>(<span class=\"hljs-function\">() =></span> $version.<span class=\"hljs-title function_\">set</span>(v));\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'ğŸ”´ writing:'</span>, v);\n    },\n  });\n\n  <span class=\"hljs-keyword\">return</span> $version.<span class=\"hljs-title function_\">asReadonly</span>();\n}\n</code></pre>\n<p>StackBlitz:</p>\n<p>ë˜ëŠ” <code>effect()</code> ì—†ì´ Signal ì½ê¸°ë¥¼ ê°ì‹œí•  ìˆ˜ ìˆëŠ” í”„ë¡ì‹œë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> watchSignalReads&#x3C;T, M <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">Signal</span>&#x3C;T> | <span class=\"hljs-title class_\">WritableSignal</span>&#x3C;T>>(<span class=\"hljs-attr\">s</span>: M): M {\n  <span class=\"hljs-keyword\">const</span> node = s[<span class=\"hljs-variable constant_\">SIGNAL</span>];\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">newGetter</span> = (<span class=\"hljs-params\"></span>) => {\n    <span class=\"hljs-keyword\">const</span> value = <span class=\"hljs-title function_\">s</span>();\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Read:'</span>, value);\n    <span class=\"hljs-keyword\">return</span> value;\n  };\n  (newGetter <span class=\"hljs-keyword\">as</span> any)[<span class=\"hljs-variable constant_\">SIGNAL</span>] = node;\n  <span class=\"hljs-keyword\">if</span> (s.<span class=\"hljs-title function_\">hasOwnProperty</span>(<span class=\"hljs-string\">'set'</span>)) {\n    <span class=\"hljs-keyword\">const</span> w = s <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">WritableSignal</span>&#x3C;T>;\n    newGetter.<span class=\"hljs-property\">set</span> = w.<span class=\"hljs-property\">set</span>;\n    newGetter.<span class=\"hljs-property\">update</span> = w.<span class=\"hljs-property\">update</span>;\n    newGetter.<span class=\"hljs-property\">asReadonly</span> = w.<span class=\"hljs-property\">asReadonly</span>;\n  }\n\n  <span class=\"hljs-keyword\">return</span> newGetter <span class=\"hljs-keyword\">as</span> M;\n}\n</code></pre>\n<p>ì‚¬ìš© ì˜ˆì‹œ:</p>\n<p>ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, ì´ë¥¼ \"ë°°í¬ í™˜ê²½\"ì—ì„œ ì‚¬ìš©í•˜ì§€ ë§ê³ , ëŒ€ì‹ ì— ë©‹ì§„ ë„êµ¬ë¥¼ ë§Œë“¤ê³  ì¸ì •ì„ ë°›ì•„ Angular ìƒíƒœê³„ë¥¼ í’ìš”ë¡­ê²Œ í•˜ëŠ” ë° í™œìš©í•˜ê¸¸ ë°”ë˜ìš” ğŸ˜</p>\n</body>\n</html>\n"},"__N_SSG":true}