<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>앵귤러 서비스를 활용한 깔끔한 코드 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-06-20-CleanCodeUsingAngularServices" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="앵귤러 서비스를 활용한 깔끔한 코드 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="앵귤러 서비스를 활용한 깔끔한 코드 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-06-20-CleanCodeUsingAngularServices" data-gatsby-head="true"/><meta name="twitter:title" content="앵귤러 서비스를 활용한 깔끔한 코드 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-20 05:42" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/t9N7vwmpvBMQnO2PSctoH/_buildManifest.js" defer=""></script><script src="/_next/static/t9N7vwmpvBMQnO2PSctoH/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">앵귤러 서비스를 활용한 깔끔한 코드</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="앵귤러 서비스를 활용한 깔끔한 코드" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 20, 2024</span><span class="posts_reading_time__f7YPP">6<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-20-CleanCodeUsingAngularServices&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>서비스/추상화 계층 패턴을 추가하여 복잡성을 줄입니다.</p>
<p><img src="/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png" alt="이미지"></p>
<p>앵귤러 애플리케이션이 초기화되기 전에 Keycloak 세부 정보를 가져오기 위해 APP_INITIALIZER를 구성합니다.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">APP_INITIALIZER</span>, <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./keycloak.service'</span>;

@<span class="hljs-title class_">Injectable</span>({
  <span class="hljs-attr">providedIn</span>: <span class="hljs-string">'root'</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppInitializer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">private keycloakService: KeycloakService</span>) {}

  <span class="hljs-title function_">initializeKeycloak</span>(): <span class="hljs-function">() =></span> <span class="hljs-title class_">Promise</span>&#x3C;any> {
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =></span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">keycloakService</span>.<span class="hljs-title function_">init</span>();
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initializeApp</span>(<span class="hljs-params">appInitializer: AppInitializer</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =></span> appInitializer.<span class="hljs-title function_">initializeKeycloak</span>();
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> appInitializerProviders = [
  <span class="hljs-title class_">AppInitializer</span>,
  { <span class="hljs-attr">provide</span>: <span class="hljs-variable constant_">APP_INITIALIZER</span>, 
    <span class="hljs-attr">useFactory</span>: initializeApp, 
    <span class="hljs-attr">deps</span>: [<span class="hljs-title class_">AppInitializer</span>], 
    <span class="hljs-attr">multi</span>: <span class="hljs-literal">true</span> 
  }
];
</code></pre>
<p>나쁜 코드 예시:</p>
<p><img src="/assets/img/2024-06-20-CleanCodeUsingAngularServices_1.png" alt="이미지"></p>
<p>모든 컴포넌트에 Keycloak DI를 추가하여 사용자가 버튼을 표시할 권한이 있는지 확인합니다. 기본 예제를 살펴보았지만 역할에 따라 숨겨질 수 있는 템플릿 부분이거나 제한된 로그인 사용자가 지정된 역할을 가지고 있지 않을 때 API 호출에 기반한 것이어야 합니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 테스트 A 컴포넌트</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'keycloak-angular'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Role</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./role.enum'</span>;

@<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-component-a'</span>,
  <span class="hljs-attr">template</span>: <span class="hljs-string">`&#x3C;button *ngIf="showAdminButton">Admin Button&#x3C;/button>`</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAComponent</span> implements <span class="hljs-title class_">OnInit</span> {
  showAdminButton = <span class="hljs-literal">false</span>;
  <span class="hljs-attr">userRoles</span>: string[];

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">private keycloakService: KeycloakService</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">keycloakService</span>.<span class="hljs-title function_">getUserRoles</span>();
  }

  <span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showAdminButton</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">Role</span>.<span class="hljs-property">Admin</span>);
  }
}

<span class="hljs-comment">// 테스트 B 컴포넌트</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'keycloak-angular'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Role</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./role.enum'</span>;

@<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-component-b'</span>,
  <span class="hljs-attr">template</span>: <span class="hljs-string">`&#x3C;button *ngIf="showProviderButton">Provider Button&#x3C;/button>`</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBComponent</span> implements <span class="hljs-title class_">OnInit</span> {
  showUserButton = <span class="hljs-literal">false</span>;
  <span class="hljs-attr">userRoles</span>: string[];

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">private keycloakService: KeycloakService</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">keycloakService</span>.<span class="hljs-title function_">getUserRoles</span>();
  }

  <span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showUserButton</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">Role</span>.<span class="hljs-property">Provider</span>);
  }
}
</code></pre>
<p>이 방식은 컴포넌트 내에서 인증 세부 정보에 직접 액세스하여 모범 사례를 위반합니다.</p>
<p>제가 매우 기본적인 예제를 제공하고 있지만 중대형 프로젝트에서는 복잡한 로직을 처리하고 사용자 역할에 따라 기능 액세스를 부여해야 하는 경우가 있습니다. 인터페이스를 단순화하기 위한 래퍼 서비스 또는 패싸드 레이어를 사용하는 것이 매우 유익할 것입니다. 이를 통해 복잡성을 줄이고 유연성을 높일 수 있습니다.</p>
<p>나쁜 코드의 문제점</p>
<ul>
<li>강한 결합: 컴포넌트에 직접 서드 파티 서비스를 주입하는 것은 해당 종속성과 강하게 결합될 수 있습니다.</li>
<li>코드 중복: 각 컴포넌트가 사용자 역할을 가져오고 역할에 따라 권한을 확인하기 위해 각각 서드 파티 서비스를 주입하면 불필요한 중복이 발생합니다.</li>
<li>테스트: 새로운 종속성을 주입하는 것은 컴포넌트를 테스트하려는 복잡도를 추가하므로 컴포넌트를 분리하고 단위 테스트를 위해 종속성을 모의로 처리하기가 어려워집니다. 각 단위 테스트에서 Keycloak 서비스와 메서드를 모의 처리해야 하므로 결국 더 많은 보일러플레이트 코드가 생성됩니다.</li>
<li>SRP 원칙 위반: 인증 논리를 처리하는 여러 컴포넌트로 인해 각 컴포넌트가 다중 로직을 처리하기 때문에 관리가 어려워지고 유지 보수가 더 어려워집니다.</li>
<li>확장성: 비즈니스 로직을 업데이트하거나 특정 기능에 역할을 추가해야 하는 경우 해당 변경 사항이 필요한 모든 컴포넌트에서 업데이트해야 합니다.</li>
<li>유연성: 다른 인증 공급자로 전환하려는 경우, 각 컴포넌트에 인증이 구현되어 있기 때문에 전환하기 어려우며 더 많은 작업이 필요합니다.</li>
</ul>
<p>따라서 공통 인터페이스를 제공하고 단일 서비스 DI를 사용하는 공유 서비스 레이어를 소개하면, 로직을 1개의 레이어로 유지할 수 있으며, 더 나아가 SRP, 캡슐화 및 Keycloak에서 역할 로직을 가져오는 추상화 소프트웨어 원칙을 준수하는 데 도움이 됩니다. 예를 들어 각 구성 요소에서 Wrapper 메서드 대신 내부 구현 방식에 따라 역할을 가져오기 위해 구성 요소에서 역할 로직을 가져오지 않아야 합니다. 이렇게 하면 구성 요소는 역할을 어떻게 가져오는지 알 필요가 없습니다.</p>
<p>좋은 코드 예시:</p>
<p><img src="/assets/img/2024-06-20-CleanCodeUsingAngularServices_2.png" alt="CleanCodeUsingAngularServices_2"></p>
<p>사용자 권한 서비스</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./keycloak.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Role</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./role.enum'</span>;

<span class="hljs-meta">@Injectable</span>({
  <span class="hljs-attr">providedIn</span>: <span class="hljs-string">'root'</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserAuthorizationService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">userRoles</span>: <span class="hljs-built_in">string</span>[];

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> keycloakService: KeycloakService</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">keycloakService</span>.<span class="hljs-title function_">getUserRoles</span>();
  }

  <span class="hljs-title function_">hasRoleAdmin</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">Role</span>.<span class="hljs-property">Admin</span>);
  }

  <span class="hljs-title function_">hasRoleUser</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">Role</span>.<span class="hljs-property">User</span>);
  }
}
</code></pre>
<p>의존성 주입 서비스.</p>
<pre><code class="hljs language-ts"><span class="hljs-comment">// 테스트 A 컴포넌트</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'keycloak-angular'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Role</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./role.enum'</span>;

<span class="hljs-meta">@Component</span>({
  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-component-a'</span>,
  <span class="hljs-attr">template</span>: <span class="hljs-string">`&#x3C;button *ngIf="showAdminButton">Admin Button&#x3C;/button>`</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAComponent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnInit</span> {
  showAdminButton = <span class="hljs-literal">false</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userAuthorizationService: UserAuthorizationService</span>) {}

  <span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showAdminButton</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userAuthorizationService</span>.<span class="hljs-title function_">hasRoleAdmin</span>()
  }
}

<span class="hljs-comment">// 테스트 B 컴포넌트</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeycloakService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'keycloak-angular'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Role</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./role.enum'</span>;

<span class="hljs-meta">@Component</span>({
  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-component-b'</span>,
  <span class="hljs-attr">template</span>: <span class="hljs-string">`&#x3C;button *ngIf="showUserButton">User Button&#x3C;/button>`</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBComponent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnInit</span> {
  showUserButton = <span class="hljs-literal">false</span>;

 <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userAuthorizationService: UserAuthorizationService</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userRoles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userAuthorizationService</span>.<span class="hljs-title function_">getUserRoles</span>();
  }

  <span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showUserButton</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userAuthorizationService</span>.<span class="hljs-title function_">hasRoleUser</span>()
  }
}
</code></pre>
<p>서비스 계층 또는 추상화 계층을 추가하면 모든 컴포넌트로 중복하는 로직을 간단하게 만들 수 있습니다. 이제 서비스가 권한 로직을 처리하고 컴포넌트는 서비스를 사용하여 권한을 확인하므로 권한을 가져오고 할당하는 데 명확한 (SoC)이 생깁니다. 컴포넌트는 비즈니스 로직을 분리하는 뿐만 아니라 테스트 관점에서도 도움이 됩니다. 모든 기본적인 작업이 제거되며, 이제 서비스는 독립적으로 테스트할 수 있습니다.</p>
<h1>결론</h1>
<p>이 블로그는 외부 라이브러리를 사용할 때 일부 추상화 계층에 대해 고려하는 좋은 실천 가이드를 안내합니다. 이 방법은 코드를 유지하는 데 도움이 되는 것뿐만 아니라 External library와 상호 작용하는 복잡성을 캡슐화합니다. 이 접근 방식은 Angular 애플리케이션 내에서 코드 조직, 유지 관리 및 유연성을 향상시킵니다.</p>
<p>만약 이 글이 도움이 되었거나 새로운 것을 배웠다면, 좋은 독자의 박수를 얻는 것을 정말로 감사히 생각할 것입니다 👏 몇 초만 투자하면 됩니다.</p>
<p>지원을 계속해 주시고 계속 배우세요. 🙏</p>
<p>저를 응원해 주시면 커피 한 잔 사주시는 방법이 있어요. ☕</p>
<p>감사합니다 :)</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"앵귤러 서비스를 활용한 깔끔한 코드","description":"","date":"2024-06-20 05:42","slug":"2024-06-20-CleanCodeUsingAngularServices","content":"\n\n서비스/추상화 계층 패턴을 추가하여 복잡성을 줄입니다.\n\n![이미지](/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png)\n\n앵귤러 애플리케이션이 초기화되기 전에 Keycloak 세부 정보를 가져오기 위해 APP_INITIALIZER를 구성합니다.\n\n```js\nimport { APP_INITIALIZER, Injectable } from '@angular/core';\nimport { KeycloakService } from './keycloak.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AppInitializer {\n  constructor(private keycloakService: KeycloakService) {}\n\n  initializeKeycloak(): () =\u003e Promise\u003cany\u003e {\n    return () =\u003e this.keycloakService.init();\n  }\n}\n\nexport function initializeApp(appInitializer: AppInitializer) {\n  return () =\u003e appInitializer.initializeKeycloak();\n}\n\nexport const appInitializerProviders = [\n  AppInitializer,\n  { provide: APP_INITIALIZER, \n    useFactory: initializeApp, \n    deps: [AppInitializer], \n    multi: true \n  }\n];\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n나쁜 코드 예시:\n\n![이미지](/assets/img/2024-06-20-CleanCodeUsingAngularServices_1.png)\n\n모든 컴포넌트에 Keycloak DI를 추가하여 사용자가 버튼을 표시할 권한이 있는지 확인합니다. 기본 예제를 살펴보았지만 역할에 따라 숨겨질 수 있는 템플릿 부분이거나 제한된 로그인 사용자가 지정된 역할을 가지고 있지 않을 때 API 호출에 기반한 것이어야 합니다.\n\n```js\n// 테스트 A 컴포넌트\n\nimport { Component, OnInit } from '@angular/core';\nimport { KeycloakService } from 'keycloak-angular';\nimport { Role } from './role.enum';\n\n@Component({\n  selector: 'app-component-a',\n  template: `\u003cbutton *ngIf=\"showAdminButton\"\u003eAdmin Button\u003c/button\u003e`\n})\nexport class TestAComponent implements OnInit {\n  showAdminButton = false;\n  userRoles: string[];\n\n  constructor(private keycloakService: KeycloakService) {\n    this.userRoles = this.keycloakService.getUserRoles();\n  }\n\n  ngOnInit() {\n    this.showAdminButton = this.userRoles.includes(Role.Admin);\n  }\n}\n\n// 테스트 B 컴포넌트\n\nimport { Component, OnInit } from '@angular/core';\nimport { KeycloakService } from 'keycloak-angular';\nimport { Role } from './role.enum';\n\n@Component({\n  selector: 'app-component-b',\n  template: `\u003cbutton *ngIf=\"showProviderButton\"\u003eProvider Button\u003c/button\u003e`\n})\nexport class TestBComponent implements OnInit {\n  showUserButton = false;\n  userRoles: string[];\n\n  constructor(private keycloakService: KeycloakService) {\n    this.userRoles = this.keycloakService.getUserRoles();\n  }\n\n  ngOnInit() {\n    this.showUserButton = this.userRoles.includes(Role.Provider);\n  }\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이 방식은 컴포넌트 내에서 인증 세부 정보에 직접 액세스하여 모범 사례를 위반합니다.\n\n제가 매우 기본적인 예제를 제공하고 있지만 중대형 프로젝트에서는 복잡한 로직을 처리하고 사용자 역할에 따라 기능 액세스를 부여해야 하는 경우가 있습니다. 인터페이스를 단순화하기 위한 래퍼 서비스 또는 패싸드 레이어를 사용하는 것이 매우 유익할 것입니다. 이를 통해 복잡성을 줄이고 유연성을 높일 수 있습니다.\n\n나쁜 코드의 문제점\n\n- 강한 결합: 컴포넌트에 직접 서드 파티 서비스를 주입하는 것은 해당 종속성과 강하게 결합될 수 있습니다.\n- 코드 중복: 각 컴포넌트가 사용자 역할을 가져오고 역할에 따라 권한을 확인하기 위해 각각 서드 파티 서비스를 주입하면 불필요한 중복이 발생합니다.\n- 테스트: 새로운 종속성을 주입하는 것은 컴포넌트를 테스트하려는 복잡도를 추가하므로 컴포넌트를 분리하고 단위 테스트를 위해 종속성을 모의로 처리하기가 어려워집니다. 각 단위 테스트에서 Keycloak 서비스와 메서드를 모의 처리해야 하므로 결국 더 많은 보일러플레이트 코드가 생성됩니다.\n- SRP 원칙 위반: 인증 논리를 처리하는 여러 컴포넌트로 인해 각 컴포넌트가 다중 로직을 처리하기 때문에 관리가 어려워지고 유지 보수가 더 어려워집니다.\n- 확장성: 비즈니스 로직을 업데이트하거나 특정 기능에 역할을 추가해야 하는 경우 해당 변경 사항이 필요한 모든 컴포넌트에서 업데이트해야 합니다.\n- 유연성: 다른 인증 공급자로 전환하려는 경우, 각 컴포넌트에 인증이 구현되어 있기 때문에 전환하기 어려우며 더 많은 작업이 필요합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n따라서 공통 인터페이스를 제공하고 단일 서비스 DI를 사용하는 공유 서비스 레이어를 소개하면, 로직을 1개의 레이어로 유지할 수 있으며, 더 나아가 SRP, 캡슐화 및 Keycloak에서 역할 로직을 가져오는 추상화 소프트웨어 원칙을 준수하는 데 도움이 됩니다. 예를 들어 각 구성 요소에서 Wrapper 메서드 대신 내부 구현 방식에 따라 역할을 가져오기 위해 구성 요소에서 역할 로직을 가져오지 않아야 합니다. 이렇게 하면 구성 요소는 역할을 어떻게 가져오는지 알 필요가 없습니다.\n\n좋은 코드 예시:\n\n![CleanCodeUsingAngularServices_2](/assets/img/2024-06-20-CleanCodeUsingAngularServices_2.png)\n\n사용자 권한 서비스\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```ts\nimport { Injectable } from '@angular/core';\nimport { KeycloakService } from './keycloak.service';\nimport { Role } from './role.enum';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserAuthorizationService {\n  private userRoles: string[];\n\n  constructor(private keycloakService: KeycloakService) {\n    this.userRoles = this.keycloakService.getUserRoles();\n  }\n\n  hasRoleAdmin(): boolean {\n    return this.userRoles.includes(Role.Admin);\n  }\n\n  hasRoleUser(): boolean {\n    return this.userRoles.includes(Role.User);\n  }\n}\n```\n\n의존성 주입 서비스.\n\n```ts\n// 테스트 A 컴포넌트\n\nimport { Component, OnInit } from '@angular/core';\nimport { KeycloakService } from 'keycloak-angular';\nimport { Role } from './role.enum';\n\n@Component({\n  selector: 'app-component-a',\n  template: `\u003cbutton *ngIf=\"showAdminButton\"\u003eAdmin Button\u003c/button\u003e`\n})\nexport class TestAComponent implements OnInit {\n  showAdminButton = false;\n\n  constructor(private userAuthorizationService: UserAuthorizationService) {}\n\n  ngOnInit() {\n    this.showAdminButton = this.userAuthorizationService.hasRoleAdmin()\n  }\n}\n\n// 테스트 B 컴포넌트\n\nimport { Component, OnInit } from '@angular/core';\nimport { KeycloakService } from 'keycloak-angular';\nimport { Role } from './role.enum';\n\n@Component({\n  selector: 'app-component-b',\n  template: `\u003cbutton *ngIf=\"showUserButton\"\u003eUser Button\u003c/button\u003e`\n})\nexport class TestBComponent implements OnInit {\n  showUserButton = false;\n\n constructor(private userAuthorizationService: UserAuthorizationService) {\n    this.userRoles = this.userAuthorizationService.getUserRoles();\n  }\n\n  ngOnInit() {\n    this.showUserButton = this.userAuthorizationService.hasRoleUser()\n  }\n}\n```\n\n서비스 계층 또는 추상화 계층을 추가하면 모든 컴포넌트로 중복하는 로직을 간단하게 만들 수 있습니다. 이제 서비스가 권한 로직을 처리하고 컴포넌트는 서비스를 사용하여 권한을 확인하므로 권한을 가져오고 할당하는 데 명확한 (SoC)이 생깁니다. 컴포넌트는 비즈니스 로직을 분리하는 뿐만 아니라 테스트 관점에서도 도움이 됩니다. 모든 기본적인 작업이 제거되며, 이제 서비스는 독립적으로 테스트할 수 있습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 결론\n\n이 블로그는 외부 라이브러리를 사용할 때 일부 추상화 계층에 대해 고려하는 좋은 실천 가이드를 안내합니다. 이 방법은 코드를 유지하는 데 도움이 되는 것뿐만 아니라 External library와 상호 작용하는 복잡성을 캡슐화합니다. 이 접근 방식은 Angular 애플리케이션 내에서 코드 조직, 유지 관리 및 유연성을 향상시킵니다.\n\n만약 이 글이 도움이 되었거나 새로운 것을 배웠다면, 좋은 독자의 박수를 얻는 것을 정말로 감사히 생각할 것입니다 👏 몇 초만 투자하면 됩니다.\n\n지원을 계속해 주시고 계속 배우세요. 🙏\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n저를 응원해 주시면 커피 한 잔 사주시는 방법이 있어요. ☕\n\n감사합니다 :)","ogImage":{"url":"/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png"},"coverImage":"/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png","tag":["Tech"],"readingTime":6},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e서비스/추상화 계층 패턴을 추가하여 복잡성을 줄입니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-CleanCodeUsingAngularServices_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e앵귤러 애플리케이션이 초기화되기 전에 Keycloak 세부 정보를 가져오기 위해 APP_INITIALIZER를 구성합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-variable constant_\"\u003eAPP_INITIALIZER\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eInjectable\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./keycloak.service'\u003c/span\u003e;\n\n@\u003cspan class=\"hljs-title class_\"\u003eInjectable\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eprovidedIn\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'root'\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAppInitializer\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprivate keycloakService: KeycloakService\u003c/span\u003e) {}\n\n  \u003cspan class=\"hljs-title function_\"\u003einitializeKeycloak\u003c/span\u003e(): \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e\u0026#x3C;any\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekeycloakService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einit\u003c/span\u003e();\n  }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003einitializeApp\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eappInitializer: AppInitializer\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e appInitializer.\u003cspan class=\"hljs-title function_\"\u003einitializeKeycloak\u003c/span\u003e();\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e appInitializerProviders = [\n  \u003cspan class=\"hljs-title class_\"\u003eAppInitializer\u003c/span\u003e,\n  { \u003cspan class=\"hljs-attr\"\u003eprovide\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eAPP_INITIALIZER\u003c/span\u003e, \n    \u003cspan class=\"hljs-attr\"\u003euseFactory\u003c/span\u003e: initializeApp, \n    \u003cspan class=\"hljs-attr\"\u003edeps\u003c/span\u003e: [\u003cspan class=\"hljs-title class_\"\u003eAppInitializer\u003c/span\u003e], \n    \u003cspan class=\"hljs-attr\"\u003emulti\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \n  }\n];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e나쁜 코드 예시:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-CleanCodeUsingAngularServices_1.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e모든 컴포넌트에 Keycloak DI를 추가하여 사용자가 버튼을 표시할 권한이 있는지 확인합니다. 기본 예제를 살펴보았지만 역할에 따라 숨겨질 수 있는 템플릿 부분이거나 제한된 로그인 사용자가 지정된 역할을 가지고 있지 않을 때 API 호출에 기반한 것이어야 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 테스트 A 컴포넌트\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'keycloak-angular'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./role.enum'\u003c/span\u003e;\n\n@\u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eselector\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'app-component-a'\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e`\u0026#x3C;button *ngIf=\"showAdminButton\"\u003eAdmin Button\u0026#x3C;/button\u003e`\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTestAComponent\u003c/span\u003e implements \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e {\n  showAdminButton = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003euserRoles\u003c/span\u003e: string[];\n\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprivate keycloakService: KeycloakService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekeycloakService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetUserRoles\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003engOnInit\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eshowAdminButton\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAdmin\u003c/span\u003e);\n  }\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 테스트 B 컴포넌트\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'keycloak-angular'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./role.enum'\u003c/span\u003e;\n\n@\u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eselector\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'app-component-b'\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e`\u0026#x3C;button *ngIf=\"showProviderButton\"\u003eProvider Button\u0026#x3C;/button\u003e`\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTestBComponent\u003c/span\u003e implements \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e {\n  showUserButton = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003euserRoles\u003c/span\u003e: string[];\n\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprivate keycloakService: KeycloakService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekeycloakService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetUserRoles\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003engOnInit\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eshowUserButton\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eProvider\u003c/span\u003e);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이 방식은 컴포넌트 내에서 인증 세부 정보에 직접 액세스하여 모범 사례를 위반합니다.\u003c/p\u003e\n\u003cp\u003e제가 매우 기본적인 예제를 제공하고 있지만 중대형 프로젝트에서는 복잡한 로직을 처리하고 사용자 역할에 따라 기능 액세스를 부여해야 하는 경우가 있습니다. 인터페이스를 단순화하기 위한 래퍼 서비스 또는 패싸드 레이어를 사용하는 것이 매우 유익할 것입니다. 이를 통해 복잡성을 줄이고 유연성을 높일 수 있습니다.\u003c/p\u003e\n\u003cp\u003e나쁜 코드의 문제점\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e강한 결합: 컴포넌트에 직접 서드 파티 서비스를 주입하는 것은 해당 종속성과 강하게 결합될 수 있습니다.\u003c/li\u003e\n\u003cli\u003e코드 중복: 각 컴포넌트가 사용자 역할을 가져오고 역할에 따라 권한을 확인하기 위해 각각 서드 파티 서비스를 주입하면 불필요한 중복이 발생합니다.\u003c/li\u003e\n\u003cli\u003e테스트: 새로운 종속성을 주입하는 것은 컴포넌트를 테스트하려는 복잡도를 추가하므로 컴포넌트를 분리하고 단위 테스트를 위해 종속성을 모의로 처리하기가 어려워집니다. 각 단위 테스트에서 Keycloak 서비스와 메서드를 모의 처리해야 하므로 결국 더 많은 보일러플레이트 코드가 생성됩니다.\u003c/li\u003e\n\u003cli\u003eSRP 원칙 위반: 인증 논리를 처리하는 여러 컴포넌트로 인해 각 컴포넌트가 다중 로직을 처리하기 때문에 관리가 어려워지고 유지 보수가 더 어려워집니다.\u003c/li\u003e\n\u003cli\u003e확장성: 비즈니스 로직을 업데이트하거나 특정 기능에 역할을 추가해야 하는 경우 해당 변경 사항이 필요한 모든 컴포넌트에서 업데이트해야 합니다.\u003c/li\u003e\n\u003cli\u003e유연성: 다른 인증 공급자로 전환하려는 경우, 각 컴포넌트에 인증이 구현되어 있기 때문에 전환하기 어려우며 더 많은 작업이 필요합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e따라서 공통 인터페이스를 제공하고 단일 서비스 DI를 사용하는 공유 서비스 레이어를 소개하면, 로직을 1개의 레이어로 유지할 수 있으며, 더 나아가 SRP, 캡슐화 및 Keycloak에서 역할 로직을 가져오는 추상화 소프트웨어 원칙을 준수하는 데 도움이 됩니다. 예를 들어 각 구성 요소에서 Wrapper 메서드 대신 내부 구현 방식에 따라 역할을 가져오기 위해 구성 요소에서 역할 로직을 가져오지 않아야 합니다. 이렇게 하면 구성 요소는 역할을 어떻게 가져오는지 알 필요가 없습니다.\u003c/p\u003e\n\u003cp\u003e좋은 코드 예시:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-CleanCodeUsingAngularServices_2.png\" alt=\"CleanCodeUsingAngularServices_2\"\u003e\u003c/p\u003e\n\u003cp\u003e사용자 권한 서비스\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eInjectable\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./keycloak.service'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./role.enum'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Injectable\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eprovidedIn\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'root'\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUserAuthorizationService\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003euserRoles\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e[];\n\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e keycloakService: KeycloakService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekeycloakService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetUserRoles\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003ehasRoleAdmin\u003c/span\u003e(): \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAdmin\u003c/span\u003e);\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003ehasRoleUser\u003c/span\u003e(): \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eUser\u003c/span\u003e);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e의존성 주입 서비스.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 테스트 A 컴포넌트\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'keycloak-angular'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./role.enum'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eselector\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'app-component-a'\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e`\u0026#x3C;button *ngIf=\"showAdminButton\"\u003eAdmin Button\u0026#x3C;/button\u003e`\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTestAComponent\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e {\n  showAdminButton = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e userAuthorizationService: UserAuthorizationService\u003c/span\u003e) {}\n\n  \u003cspan class=\"hljs-title function_\"\u003engOnInit\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eshowAdminButton\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserAuthorizationService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ehasRoleAdmin\u003c/span\u003e()\n  }\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 테스트 B 컴포넌트\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'@angular/core'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eKeycloakService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'keycloak-angular'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRole\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./role.enum'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eselector\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'app-component-b'\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e`\u0026#x3C;button *ngIf=\"showUserButton\"\u003eUser Button\u0026#x3C;/button\u003e`\u003c/span\u003e\n})\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTestBComponent\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eOnInit\u003c/span\u003e {\n  showUserButton = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n\n \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e userAuthorizationService: UserAuthorizationService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserRoles\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserAuthorizationService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetUserRoles\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003engOnInit\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eshowUserButton\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserAuthorizationService\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ehasRoleUser\u003c/span\u003e()\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e서비스 계층 또는 추상화 계층을 추가하면 모든 컴포넌트로 중복하는 로직을 간단하게 만들 수 있습니다. 이제 서비스가 권한 로직을 처리하고 컴포넌트는 서비스를 사용하여 권한을 확인하므로 권한을 가져오고 할당하는 데 명확한 (SoC)이 생깁니다. 컴포넌트는 비즈니스 로직을 분리하는 뿐만 아니라 테스트 관점에서도 도움이 됩니다. 모든 기본적인 작업이 제거되며, 이제 서비스는 독립적으로 테스트할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003e이 블로그는 외부 라이브러리를 사용할 때 일부 추상화 계층에 대해 고려하는 좋은 실천 가이드를 안내합니다. 이 방법은 코드를 유지하는 데 도움이 되는 것뿐만 아니라 External library와 상호 작용하는 복잡성을 캡슐화합니다. 이 접근 방식은 Angular 애플리케이션 내에서 코드 조직, 유지 관리 및 유연성을 향상시킵니다.\u003c/p\u003e\n\u003cp\u003e만약 이 글이 도움이 되었거나 새로운 것을 배웠다면, 좋은 독자의 박수를 얻는 것을 정말로 감사히 생각할 것입니다 👏 몇 초만 투자하면 됩니다.\u003c/p\u003e\n\u003cp\u003e지원을 계속해 주시고 계속 배우세요. 🙏\u003c/p\u003e\n\u003cp\u003e저를 응원해 주시면 커피 한 잔 사주시는 방법이 있어요. ☕\u003c/p\u003e\n\u003cp\u003e감사합니다 :)\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-20-CleanCodeUsingAngularServices"},"buildId":"t9N7vwmpvBMQnO2PSctoH","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>