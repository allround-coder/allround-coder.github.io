<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨ | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨ | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨ | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation" data-gatsby-head="true"/><meta name="twitter:title" content="íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨ | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-15 10:33" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cd012fc8787133d0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cd012fc8787133d0.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/551-3069cf29fe274aab.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-985df180e46efe53.js" defer=""></script><script src="/_next/static/K-h7XvEVBqnNx_uXMgZoe/_buildManifest.js" defer=""></script><script src="/_next/static/K-h7XvEVBqnNx_uXMgZoe/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/assets/profile.jpg"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 15, 2024</span><span class="posts_reading_time__f7YPP">40<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><h2>C/C++, CUDA, ë° Pythonì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê³ ìœ ì˜ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ êµ¬ì¶•í•´ ë³´ì„¸ìš”. GPU ì§€ì›ê³¼ ìë™ ë¯¸ë¶„ì„ ì œê³µí•©ë‹ˆë‹¤</h2>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png" alt="image"/></p>
<h1>ì†Œê°œ</h1>
<p>ì—¬ëŸ¬ í•´ ë™ì•ˆ PyTorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³  í›ˆë ¨í•´ ì™”ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³ , ê·¸ ë¬¸ë²•ê³¼ ê·œì¹™ì„ ìµíˆê³ ë„, ì œ ê¶ê¸ˆì¦ì„ ìê·¹í•˜ë˜ ê²ƒì´ ìˆì—ˆìŠµë‹ˆë‹¤: ì´ëŸ¬í•œ ì‘ì—… ì¤‘ì— ë‚´ë¶€ì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ” ê±¸ê¹Œìš”? ì´ ëª¨ë“  ê²ƒì´ ì–´ë–»ê²Œ ì‘ë™í• ê¹Œìš”?</p>
<p>ì—¬ê¸°ê¹Œì§€ ì˜¤ì…¨ë‹¤ë©´, ì•„ë§ˆë„ ë¹„ìŠ·í•œ ì§ˆë¬¸ì„ ê°€ì§€ê³  ê³„ì‹¤ ê²ƒì…ë‹ˆë‹¤. íŒŒì´í† ì¹˜(PyTorch)ì—ì„œ ëª¨ë¸ì„ ìƒì„±í•˜ê³  í›ˆë ¨í•˜ëŠ” ë°©ë²•ì„ ë¬¼ì–´ë³¸ë‹¤ë©´ ì•„ë§ˆë„ ì•„ë˜ ì½”ë“œì™€ ë¹„ìŠ·í•œ ê²ƒì„ ìƒê°í•´ë³¼ ê²ƒì…ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.<span class="hljs-property">nn</span> <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.<span class="hljs-property">optim</span> <span class="hljs-keyword">as</span> optim

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.<span class="hljs-property">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self):
        <span class="hljs-variable language_">super</span>(<span class="hljs-title class_">MyModel</span>, self).<span class="hljs-title function_">__init__</span>()
        self.<span class="hljs-property">fc1</span> = nn.<span class="hljs-title class_">Linear</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)
        self.<span class="hljs-property">sigmoid</span> = nn.<span class="hljs-title class_">Sigmoid</span>()
        self.<span class="hljs-property">fc2</span> = nn.<span class="hljs-title class_">Linear</span>(<span class="hljs-number">10</span>, <span class="hljs-number">1</span>)

    def <span class="hljs-title function_">forward</span>(self, x):
        out = self.<span class="hljs-title function_">fc1</span>(x)
        out = self.<span class="hljs-title function_">sigmoid</span>(out)
        out = self.<span class="hljs-title function_">fc2</span>(out)
        
        <span class="hljs-keyword">return</span> out

...

model = <span class="hljs-title class_">MyModel</span>().<span class="hljs-title function_">to</span>(device)
criterion = nn.<span class="hljs-title class_">MSELoss</span>()
optimizer = optim.<span class="hljs-title function_">SGD</span>(model.<span class="hljs-title function_">parameters</span>(), lr=<span class="hljs-number">0.001</span>)

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(epochs):
    <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> ...
        
        x = x.<span class="hljs-title function_">to</span>(device)
        y = y.<span class="hljs-title function_">to</span>(device)

        outputs = <span class="hljs-title function_">model</span>(x)
        loss = <span class="hljs-title function_">criterion</span>(outputs, y)
        
        optimizer.<span class="hljs-title function_">zero_grad</span>()
        loss.<span class="hljs-title function_">backward</span>()
        optimizer.<span class="hljs-title function_">step</span>()
</code></pre>
<p>í•˜ì§€ë§Œ ì´ë²ˆì— ì—­ì „íŒŒ(backward) ë‹¨ê³„ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ë¬¼ì–´ë³¸ë‹¤ë©´ ì–´ë–¨ê¹Œìš”? ë˜ëŠ” ì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•  ë•Œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ìš”? ë‚´ë¶€ì—ì„œ ë°ì´í„°ê°€ ì¬ë°°ì¹˜ë˜ë‚˜ìš”? ê·¸ëŸ° ì¼ì´ ì–´ë–»ê²Œ ì¼ì–´ë‚˜ë‚˜ìš”? ì™œ PyTorchëŠ” ë¹ ë¥¸ê°€ìš”? PyTorchê°€ GPU ì—°ì‚°ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ìš”? ì´ëŸ° ì§ˆë¬¸ë“¤ì´ í•­ìƒ ì €ë¥¼ í˜¸ê¸°ì‹¬ ê°€ë“í•˜ê²Œ ë§Œë“¤ì—ˆê³ , ì—¬ëŸ¬ë¶„ë„ ë§ˆì°¬ê°€ì§€ë¡œ í˜¸ê¸°ì‹¬ì´ ë“œì‹¤ ê²ƒì´ë¼ê³  ìƒìƒí•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ëŸ¬í•œ ê°œë…ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ ìŠ¤ìŠ¤ë¡œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì²˜ìŒë¶€í„° êµ¬ì¶•í•´ë³´ëŠ” ê²ƒì´ ë¬´ì—‡ë³´ë‹¤ ì¢‹ì„ê¹Œìš”? ì´ ê¸€ì—ì„œ ì—¬ëŸ¬ë¶„ì´ ë°°ìš°ê²Œ ë  ê²ƒì´ ë°”ë¡œ ê·¸ê²ë‹ˆë‹¤!</p>
<h2>#1 â€” í…ì„œ</h2>
<p>í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ê°€ì¥ ë¨¼ì € ì•Œì•„ì•¼ í•  ê°œë…ì€ ë¬´ì—‡ì´ í…ì„œì¸ì§€ì— ëŒ€í•œ ëª…ë°±í•œ ê°œë…ì…ë‹ˆë‹¤.</p>
<p>í…ì„œëŠ” ëª‡ ê°€ì§€ ìˆ«ìë¥¼ í¬í•¨í•˜ëŠ” nì°¨ì› ë°ì´í„° êµ¬ì¡°ì˜ ìˆ˜í•™ì  ê°œë…ì´ë¼ëŠ” ì§ê´€ì ì¸ ìƒê°ì„ ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ê¸°ì„œëŠ” ì´ ë°ì´í„° êµ¬ì¡°ë¥¼ ê³„ì‚°ì  ê´€ì ì—ì„œ ì–´ë–»ê²Œ ëª¨ë¸ë§í• ì§€ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤. í…ì„œëŠ” ë°ì´í„° ìì²´ë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ì–‘ì´ë‚˜ í…ì„œê°€ ìˆëŠ” ì¥ì¹˜(ì˜ˆ: CPU ë©”ëª¨ë¦¬, GPU ë©”ëª¨ë¦¬)ì™€ ê°™ì€ ì¸¡ë©´ì„ ì„¤ëª…í•˜ëŠ” ë©”íƒ€ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>í…ì„œì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ëŠ” ë° ë§¤ìš° ì¤‘ìš”í•œ ê°œë…ì¸ strideë¼ëŠ” ì˜ ì•Œë ¤ì§€ì§€ ì•Šì€ ë©”íƒ€ë°ì´í„°ë„ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í…ì„œ ë°ì´í„° ì¬ë°°ì—´ì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ ì•½ê°„ ë” ì´ì— ëŒ€í•´ ë…¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>2-D í…ì„œì˜ ëª¨ì–‘ì´ [4, 8]ì¸ ê²½ìš°ë¥¼ ìƒìƒí•´ë³´ì„¸ìš”.</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_2.png" alt="í…ì„œ"/></p>
<p>í…ì„œì˜ ë°ì´í„°(ì¦‰, ë¶€ë™ ì†Œìˆ˜ì  ìˆ˜)ëŠ” ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ì— 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_3.png" alt="ë°ì´í„°"/></p>
<p>ê·¸ëŸ¬ë©´ ì´ 1ì°¨ì› ë°°ì—´ì„ Nì°¨ì› í…ì„œë¡œ ë‚˜íƒ€ë‚´ë ¤ë©´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>4í–‰ 8ì—´ì˜ í–‰ë ¬ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ í–‰ë ¬ì˜ ëª¨ë“  ì›ì†Œê°€ 1ì°¨ì› ë°°ì—´ì˜ í–‰ì— ì˜í•´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ, ìœ„ì¹˜ [2, 3]ì˜ ê°’ì„ ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ 2í–‰(ê° í–‰ì— 8ê°œì˜ ìš”ì†Œ)ì„ íš¡ë‹¨í•´ì•¼ í•˜ë©° ì¶”ê°€ë¡œ 3ê°œì˜ ìœ„ì¹˜ë¥¼ ì§€ë‚˜ì•¼ í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ 1ì°¨ì› ë°°ì—´ì—ì„œ 3 + 2 * 8 ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ë”°ë¼ì„œ, &#x27;8&#x27;ì€ ë‘ ë²ˆì§¸ ì°¨ì›ì˜ ìŠ¤íŠ¸ë¼ì´ë“œì…ë‹ˆë‹¤. ì´ ê²½ìš°, ë°°ì—´ì—ì„œ ë‹¤ë¥¸ ìœ„ì¹˜ë¡œ &quot;ì í”„&quot;í•˜ê¸° ìœ„í•´ ëª‡ ê°œì˜ ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ë³´ì…ë‹ˆë‹¤.</p>
<p>ë”°ë¼ì„œ, ëª¨ì–‘ì´ [shape_0, shape_1]ì¸ 2ì°¨ì› í…ì„œì˜ ìš”ì†Œ [i, j]ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´, ê¸°ë³¸ì ìœ¼ë¡œ j + i * shape_1 ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ì´ì œ 3ì°¨ì› í…ì„œë¥¼ ìƒìƒí•´ë³´ê² ìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_5.png" alt="image"/></p>
<p>ì´ 3ì°¨ì› í…ì„œë¥¼ í–‰ë ¬ì˜ ì‹œí€€ìŠ¤ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ [5, 4, 8] í…ì„œë¥¼ [4, 8] ëª¨ì–‘ì˜ 5ê°œ í–‰ë ¬ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ [1, 3, 7] ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•´ [4,8] í˜•íƒœì˜ í–‰ë ¬ì„ 1ê°œ ì™„ì „íˆ íš¡ë‹¨í•˜ê³ , [8] í˜•íƒœì˜ í–‰ì„ 2ê°œ, [1] í˜•íƒœì˜ ì—´ì„ 7ê°œ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ 1ì°¨ì› ë°°ì—´ì—ì„œ (1 * 4 * 8) + (2 * 8) + (7 * 1) ìœ„ì¹˜ë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_6.png" alt="image"/></p>
<p>ë”°ë¼ì„œ, [shape_0, shape_1, shape_2] ëª¨ì–‘ì˜ 3ì°¨ì› í…ì„œì—ì„œ 1ì°¨ì› ë°ì´í„° ë°°ì—´ì—ì„œ [i][j][k] ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_7.png" alt="image"/></p>
<p>ì´ shape_1 * shape_2ê°€ ì²« ë²ˆì§¸ ì°¨ì›ì˜ strideì´ê³ , shape_2ëŠ” ë‘ ë²ˆì§¸ ì°¨ì›ì˜ strideì´ë©° 1ì€ ì„¸ ë²ˆì§¸ ì°¨ì›ì˜ strideì…ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ° ë‹¤ìŒ, ì¼ë°˜í™”í•˜ê¸° ìœ„í•´ì„œëŠ”:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_8.png" alt="image"/></p>
<p>ê° ì°¨ì›ì˜ strideëŠ” ë‹¤ìŒ ì°¨ì› í…ì„œ ëª¨ì–‘ì˜ ê³±ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_9.png"/>
<p>ê·¸ëŸ° ë‹¤ìŒ stride[n-1] = 1ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<p>ìš°ë¦¬ì˜ í˜•íƒœì˜ í…ì„œ ì˜ˆì œ [5, 4, 8]ì—ì„œ strides = [4*8, 8, 1] = [32, 8, 1]ì¼ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ì—¬ëŸ¬ë¶„ë“¤ë„ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆì–´ìš”:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> torch

torch.<span class="hljs-title function_">rand</span>([<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>]).<span class="hljs-title function_">stride</span>()
#(<span class="hljs-number">32</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>)
</code></pre>
<p>ì•Œê² ì–´ìš”, ê·¸ëŸ°ë° ì™œ ëª¨ì–‘ê³¼ ìŠ¤íŠ¸ë¼ì´ë“œê°€ í•„ìš”í•œ ê±´ê°€ìš”? Nì°¨ì› í…ì„œì˜ ìš”ì†Œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë„˜ì–´, ì´ ê°œë…ì€ í…ì„œ ë°°ì—´ì„ ë§¤ìš° ì‰½ê²Œ ì¡°ì‘í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆì–´ìš”.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•˜ë ¤ë©´ ìƒˆë¡œìš´ ëª¨ì–‘ì„ ì„¤ì •í•˜ê³  ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ê³„ì‚°í•˜ë©´ ë©ë‹ˆë‹¤! (ìƒˆë¡œìš´ ëª¨ì–‘ì€ ë™ì¼í•œ ìš”ì†Œ ìˆ˜ë¥¼ ë³´ì¥í•˜ë¯€ë¡œ)</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> torch

t = torch.<span class="hljs-title function_">rand</span>([<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>])

<span class="hljs-title function_">print</span>(t.<span class="hljs-property">shape</span>)
# [<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>]

<span class="hljs-title function_">print</span>(t.<span class="hljs-title function_">stride</span>())
# [<span class="hljs-number">32</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>]

new_t = t.<span class="hljs-title function_">reshape</span>([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>])

<span class="hljs-title function_">print</span>(new_t.<span class="hljs-property">shape</span>)
# [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>]

<span class="hljs-title function_">print</span>(new_t.<span class="hljs-title function_">stride</span>())
# [<span class="hljs-number">40</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]
</code></pre>
<p>í…ì„œ ë‚´ë¶€ì—ì„œëŠ” ì—¬ì „íˆ ë™ì¼í•œ 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤. reshape ë©”ì„œë“œëŠ” ë°°ì—´ ë‚´ ìš”ì†Œì˜ ìˆœì„œë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤! ëŒ€ë‹¨í•˜ì§€ ì•Šë‚˜ìš”? ğŸ˜</p>
<p>ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ PyTorchì—ì„œ ë‚´ë¶€ 1ì°¨ì› ë°°ì—´ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> ctypes

def <span class="hljs-title function_">print_internal</span>(<span class="hljs-attr">t</span>: torch.<span class="hljs-property">Tensor</span>):
    <span class="hljs-title function_">print</span>(
        torch.<span class="hljs-title function_">frombuffer</span>(
            ctypes.<span class="hljs-title function_">string_at</span>(t.<span class="hljs-title function_">data_ptr</span>(), t.<span class="hljs-title function_">storage</span>().<span class="hljs-title function_">nbytes</span>()), dtype=t.<span class="hljs-property">dtype</span>
        )
    )

<span class="hljs-title function_">print_internal</span>(t)
# [<span class="hljs-number">0.0752</span>, <span class="hljs-number">0.5898</span>, <span class="hljs-number">0.3930</span>, <span class="hljs-number">0.9577</span>, <span class="hljs-number">0.2276</span>, <span class="hljs-number">0.9786</span>, <span class="hljs-number">0.1009</span>, <span class="hljs-number">0.138</span>, ...

<span class="hljs-title function_">print_internal</span>(new_t)
# [<span class="hljs-number">0.0752</span>, <span class="hljs-number">0.5898</span>, <span class="hljs-number">0.3930</span>, <span class="hljs-number">0.9577</span>, <span class="hljs-number">0.2276</span>, <span class="hljs-number">0.9786</span>, <span class="hljs-number">0.1009</span>, <span class="hljs-number">0.138</span>, ...
</code></pre>
<p>ì˜ˆë¥¼ ë“¤ì–´ ë‘ ì¶•ì„ ì „ì¹˜í•˜ë ¤ë©´ ë‚´ë¶€ì ìœ¼ë¡œ í•´ë‹¹ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ë‹¨ìˆœíˆ ë°”ê¾¸ì–´ ì£¼ë©´ ë©ë‹ˆë‹¤!</p>
<pre><code class="hljs language-js">t = torch.<span class="hljs-title function_">arange</span>(<span class="hljs-number">0</span>, <span class="hljs-number">24</span>).<span class="hljs-title function_">reshape</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
<span class="hljs-title function_">print</span>(t)
# [[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
#   [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
#   [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>]],
 
#  [[<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>],
#   [<span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>],
#   [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]]]

<span class="hljs-title function_">print</span>(t.<span class="hljs-property">shape</span>)
# [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]

<span class="hljs-title function_">print</span>(t.<span class="hljs-title function_">stride</span>())
# [<span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>]

new_t = t.<span class="hljs-title function_">transpose</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
<span class="hljs-title function_">print</span>(new_t)
# [[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
#   [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]],

#  [[ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
#   [<span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]],

#  [[ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>],
#   [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]]]

<span class="hljs-title function_">print</span>(new_t.<span class="hljs-property">shape</span>)
# [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]

<span class="hljs-title function_">print</span>(new_t.<span class="hljs-title function_">stride</span>())
# [<span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>]
</code></pre>
<p>ë‚´ë¶€ ë°°ì—´ì„ ì¶œë ¥í•˜ë©´ ë‘ ê°’ ëª¨ë‘ ë™ì¼í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">print_internal</span>(t)
# [ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]

<span class="hljs-title function_">print_internal</span>(new_t)
# [ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]
</code></pre>
<p>ê·¸ëŸ¬ë‚˜ new_tì˜ ìŠ¤íŠ¸ë¼ì´ë“œëŠ” ì´ì œ ìœ„ì˜ ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ê²ƒì€ í…ì„œê°€ ì´ì œ ì—°ì†ì ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤. ì¦‰, ë‚´ë¶€ ë°°ì—´ì€ ë™ì¼í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ ë‚´ì˜ ê°’ì˜ ìˆœì„œê°€ í…ì„œì˜ ì‹¤ì œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.```</p>
<pre><code class="hljs language-js">t.<span class="hljs-title function_">is_contiguous</span>()
# <span class="hljs-title class_">True</span>

new_t.<span class="hljs-title function_">is_contiguous</span>()
# <span class="hljs-title class_">False</span>
</code></pre>
<p>ì´ëŠ” ì—°ì†ë˜ì§€ ì•ŠëŠ” ìš”ì†Œì— ì—°ì†ì ìœ¼ë¡œ ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤ (ì‹¤ì œ í…ì„œ ìš”ì†ŒëŠ” ë©”ëª¨ë¦¬ ìƒì—ì„œ ìˆœì„œëŒ€ë¡œ ì •ë ¬ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤). ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">new_t_contiguous = new_t.<span class="hljs-title function_">contiguous</span>()

<span class="hljs-title function_">print</span>(new_t_contiguous.<span class="hljs-title function_">is_contiguous</span>())
# <span class="hljs-title class_">True</span>
</code></pre>
<p>ë‚´ë¶€ ë°°ì—´ì„ ë¶„ì„í•˜ë©´ ì´ì œ ìˆœì„œê°€ ì‹¤ì œ í…ì„œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì—¬ ë” ë‚˜ì€ ë©”ëª¨ë¦¬ ì•¡ì„¸ìŠ¤ íš¨ìœ¨ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:```</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">print</span>(new_t)
# [[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
#   [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]],

#  [[ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
#   [<span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]],

#  [[ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>],
#   [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]]]

<span class="hljs-title function_">print_internal</span>(new_t)
# [ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]

<span class="hljs-title function_">print_internal</span>(new_t_contiguous)
# [ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>]
</code></pre>
<p>ì´ì œ ìš°ë¦¬ëŠ” í…ì„œê°€ ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€ ì´í•´í–ˆìœ¼ë‹ˆ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„±ì„ ì‹œì‘í•´ ë´…ì‹œë‹¤!</p>
<p>ë‚´ê°€ ë§Œë“¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ì€ Norchì…ë‹ˆë‹¤. PyTorchê°€ ì•„ë‹Œ (NOT PyTorch)ì„ ì˜ë¯¸í•˜ë©°, ì„±(Nogueira)ì„ ì•”ì‹œí•˜ê¸°ë„ í•©ë‹ˆë‹¤. ğŸ˜</p>
<p>ì²« ë²ˆì§¸ë¡œ ì•Œì•„ì•¼ í•  ê²ƒì€ PyTorchê°€ Pythonì„ í†µí•´ ì‚¬ìš©ë˜ì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” C/C++ë¡œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë¨¼ì € ë‚´ë¶€ C/C++ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ë¨¼ì € í…ì„œë¥¼ ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¡œ ì •ì˜í•˜ê³  ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ í•¨ìˆ˜ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

#include &lt;stdio.<span class="hljs-property">h</span>&gt;
#include &lt;stdlib.<span class="hljs-property">h</span>&gt;
#include &lt;string.<span class="hljs-property">h</span>&gt;
#include &lt;math.<span class="hljs-property">h</span>&gt;

typedef struct {
    float* data;
    int* strides;
    int* shape;
    int ndim;
    int size;
    char* device;
} <span class="hljs-title class_">Tensor</span>;

<span class="hljs-title class_">Tensor</span>* <span class="hljs-title function_">create_tensor</span>(<span class="hljs-params">float* data, int* shape, int ndim</span>) {
    
    <span class="hljs-title class_">Tensor</span>* tensor = (<span class="hljs-title class_">Tensor</span>*)<span class="hljs-title function_">malloc</span>(<span class="hljs-title function_">sizeof</span>(<span class="hljs-title class_">Tensor</span>));
    <span class="hljs-keyword">if</span> (tensor == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }
    tensor-&gt;data = data;
    tensor-&gt;shape = shape;
    tensor-&gt;ndim = ndim;

    tensor-&gt;size = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; ndim; i++) {
        tensor-&gt;size *= shape[i];
    }

    tensor-&gt;strides = (int*)<span class="hljs-title function_">malloc</span>(ndim * <span class="hljs-title function_">sizeof</span>(int));
    <span class="hljs-keyword">if</span> (tensor-&gt;strides == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }
    int stride = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (int i = ndim - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        tensor-&gt;strides[i] = stride;
        stride *= shape[i];
    }
    
    <span class="hljs-keyword">return</span> tensor;
}
</code></pre>
<p>ì¼ë¶€ ìš”ì†Œì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” ì•ì„œ ë°°ì› ë˜ ìŠ¤íŠ¸ë¼ì´ë“œ(strides)ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

float <span class="hljs-title function_">get_item</span>(<span class="hljs-params">Tensor* tensor, int* indices</span>) {
    int index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; tensor-&gt;ndim; i++) {
        index += indices[i] * tensor-&gt;strides[i];
    }

    float result;
    result = tensor-&gt;data[index];

    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>ì´ì œ í…ì„œ ì‘ì—…ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª‡ ê°€ì§€ ì˜ˆì œë¥¼ ë³´ì—¬ë“œë¦¬ê² ê³ , ì´ ê¸€ ëì— ë§í¬ëœ ì €ì¥ì†Œì—ì„œ ì™„ì „í•œ ë²„ì „ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/cpu.cpp</span>

<span class="hljs-keyword">void</span> <span class="hljs-title function_">add_tensor_cpu</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2, float* result_data</span>) {
    
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; tensor1-&gt;size; i++) {
        result_data[i] = tensor1-&gt;data[i] + tensor2-&gt;data[i];
    }
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">sub_tensor_cpu</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2, float* result_data</span>) {
    
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; tensor1-&gt;size; i++) {
        result_data[i] = tensor1-&gt;data[i] - tensor2-&gt;data[i];
    }
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">elementwise_mul_tensor_cpu</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2, float* result_data</span>) {
    
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; tensor1-&gt;size; i++) {
        result_data[i] = tensor1-&gt;data[i] * tensor2-&gt;data[i];
    }
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">assign_tensor_cpu</span>(<span class="hljs-params">Tensor* tensor, float* result_data</span>) {

    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; tensor-&gt;size; i++) {
        result_data[i] = tensor-&gt;data[i];
    }
}

...
</code></pre>
<p>ê·¸ ë‹¤ìŒì—, ì´ëŸ¬í•œ ì‘ì—…ë“¤ì„ í˜¸ì¶œí•  í…ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

<span class="hljs-title class_">Tensor</span>* <span class="hljs-title function_">add_tensor</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2</span>) {
    <span class="hljs-keyword">if</span> (tensor1-&gt;ndim != tensor2-&gt;ndim) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d\n&quot;</span>, tensor1-&gt;ndim, tensor2-&gt;ndim);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    int ndim = tensor1-&gt;ndim;
    int* shape = (int*)<span class="hljs-title function_">malloc</span>(ndim * <span class="hljs-title function_">sizeof</span>(int));
    <span class="hljs-keyword">if</span> (shape == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; ndim; i++) {
        <span class="hljs-keyword">if</span> (tensor1-&gt;shape[i] != tensor2-&gt;shape[i]) {
            <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d ì¸ë±ìŠ¤ %dì—ì„œ\n&quot;</span>, tensor1-&gt;shape[i], tensor2-&gt;shape[i], i);
            <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
        }
        shape[i] = tensor1-&gt;shape[i];
    }        
    float* result_data = (float*)<span class="hljs-title function_">malloc</span>(tensor1-&gt;size * <span class="hljs-title function_">sizeof</span>(float));
    <span class="hljs-keyword">if</span> (result_data == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }
    <span class="hljs-title function_">add_tensor_cpu</span>(tensor1, tensor2, result_data);
    
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">create_tensor</span>(result_data, shape, ndim, device);
}
</code></pre>
<p>ì´ì „ì— ì–¸ê¸‰í•œ ëŒ€ë¡œ, í…ì„œ ì¬êµ¬ì„±ì€ ë‚´ë¶€ ë°ì´í„° ë°°ì—´ì„ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

<span class="hljs-title class_">Tensor</span>* <span class="hljs-title function_">reshape_tensor</span>(<span class="hljs-params">Tensor* tensor, int* new_shape, int new_ndim</span>) {

    int ndim = new_ndim;
    int* shape = (int*)<span class="hljs-title function_">malloc</span>(ndim * <span class="hljs-title function_">sizeof</span>(int));
    <span class="hljs-keyword">if</span> (shape == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; ndim; i++) {
        shape[i] = new_shape[i];
    }

    <span class="hljs-comment">// ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ ê³„ì‚°</span>
    int size = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; new_ndim; i++) {
        size *= shape[i];
    }

    <span class="hljs-comment">// ì´ ìš”ì†Œ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸</span>
    <span class="hljs-keyword">if</span> (size != tensor-&gt;size) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;í…ì„œë¥¼ ì¬êµ¬ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    float* result_data = (float*)<span class="hljs-title function_">malloc</span>(tensor-&gt;size * <span class="hljs-title function_">sizeof</span>(float));
    <span class="hljs-keyword">if</span> (result_data == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }
    <span class="hljs-title function_">assign_tensor_cpu</span>(tensor, result_data);
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">create_tensor</span>(result_data, shape, ndim, device);
}
</code></pre>
<p>ì´ì œ ì¼ë¶€ í…ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì§€ë§Œ, ëˆ„êµ¬ë‚˜ C/C++ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ì´ì œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤!</p>
<p>Pythonì„ ì‚¬ìš©í•˜ì—¬ C/C++ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. Pybind11ê³¼ Cython ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì˜ˆì‹œì—ì„œëŠ” ctypesë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ì•„ë˜ëŠ” ctypesì˜ ê¸°ë³¸ì ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//C ì½”ë“œ</span>
#include &lt;stdio.<span class="hljs-property">h</span>&gt;

float <span class="hljs-title function_">add_floats</span>(<span class="hljs-params">float a, float b</span>) {
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<pre><code class="hljs language-js"># ì»´íŒŒì¼
gcc -shared -o add_floats.<span class="hljs-property">so</span> -fPIC add_floats.<span class="hljs-property">c</span>
</code></pre>
<pre><code class="hljs language-js"># <span class="hljs-title class_">Python</span> ì½”ë“œ
<span class="hljs-keyword">import</span> ctypes

# ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ
lib = ctypes.<span class="hljs-title function_">CDLL</span>(<span class="hljs-string">&#x27;./add_floats.so&#x27;</span>)

# í•¨ìˆ˜ì˜ ì¸ìì™€ ë°˜í™˜ ìœ í˜• ì •ì˜
lib.<span class="hljs-property">add_floats</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-property">c_float</span>, ctypes.<span class="hljs-property">c_float</span>]
lib.<span class="hljs-property">add_floats</span>.<span class="hljs-property">restype</span> = ctypes.<span class="hljs-property">c_float</span>

# íŒŒì´ì¬ float ê°’ì„ c_float ìœ í˜•ìœ¼ë¡œ ë³€í™˜
a = ctypes.<span class="hljs-title function_">c_float</span>(<span class="hljs-number">3.5</span>)
b = ctypes.<span class="hljs-title function_">c_float</span>(<span class="hljs-number">2.2</span>)

# C í•¨ìˆ˜ í˜¸ì¶œ
result = lib.<span class="hljs-title function_">add_floats</span>(a, b)
<span class="hljs-title function_">print</span>(result)
# <span class="hljs-number">5.7</span>
</code></pre>
<p>ë³´ì‹œë‹¤ì‹œí”¼ ë§¤ìš° ì§ê´€ì ì…ë‹ˆë‹¤. C/C++ ì½”ë“œë¥¼ ì»´íŒŒì¼í•œ í›„ Pythonì—ì„œ ctypesë¥¼ ì‚¬ìš©í•˜ë©´ ë§¤ìš° ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ ë° ë°˜í™˜ c_typesë¥¼ ì •ì˜í•˜ê³ , ë³€ìˆ˜ë¥¼ í•´ë‹¹ c_typesë¡œ ë³€í™˜í•˜ê³  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ë°°ì—´(ë¶€ë™ ì†Œìˆ˜ì  ëª©ë¡)ê³¼ ê°™ì€ ë³´ë‹¤ ë³µì¡í•œ ìœ í˜•ì˜ ê²½ìš° í¬ì¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">data = [<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>]
data_ctype = (ctypes.<span class="hljs-property">c_float</span> * <span class="hljs-title function_">len</span>(data))(*data)

lib.<span class="hljs-property">some_array_func</span>.<span class="hljs-property">argstypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_float</span>)]

...

lib.<span class="hljs-title function_">some_array_func</span>(data)
</code></pre>
<p>ê·¸ë¦¬ê³  êµ¬ì¡°ì²´ ìœ í˜•ì˜ ê²½ìš° ì§ì ‘ c_typeì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomType</span>(ctypes.<span class="hljs-property">Structure</span>):
    _fields_ = [
        (<span class="hljs-string">&#x27;field1&#x27;</span>, ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_float</span>)),
        (<span class="hljs-string">&#x27;field2&#x27;</span>, ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>)),
        (<span class="hljs-string">&#x27;field3&#x27;</span>, ctypes.<span class="hljs-property">c_int</span>),
    ]

# ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CustomType</span>)ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</code></pre>
<p>ê°„ë‹¨íˆ ì„¤ëª…í•˜ê³ , í…ì„œ C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìœ„í•œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤!</p>
<pre><code class="hljs language-js"># norch/tensor.<span class="hljs-property">py</span>

<span class="hljs-keyword">import</span> ctypes

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CTensor</span>(ctypes.<span class="hljs-property">Structure</span>):
    _fields_ = [
        (<span class="hljs-string">&#x27;data&#x27;</span>, ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_float</span>)),
        (<span class="hljs-string">&#x27;strides&#x27;</span>, ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>)),
        (<span class="hljs-string">&#x27;shape&#x27;</span>, ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>)),
        (<span class="hljs-string">&#x27;ndim&#x27;</span>, ctypes.<span class="hljs-property">c_int</span>),
        (<span class="hljs-string">&#x27;size&#x27;</span>, ctypes.<span class="hljs-property">c_int</span>),
    ]

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Tensor</span>:
    os.<span class="hljs-property">path</span>.<span class="hljs-title function_">abspath</span>(os.<span class="hljs-property">curdir</span>)
    _C = ctypes.<span class="hljs-title function_">CDLL</span>(<span class="hljs-string">&quot;COMPILED_LIB.so&quot;</span>)

    def <span class="hljs-title function_">__init__</span>(self):
        
        data, shape = self.<span class="hljs-title function_">flatten</span>(data)
        self.<span class="hljs-property">data_ctype</span> = (ctypes.<span class="hljs-property">c_float</span> * <span class="hljs-title function_">len</span>(data))(*data)
        self.<span class="hljs-property">shape_ctype</span> = (ctypes.<span class="hljs-property">c_int</span> * <span class="hljs-title function_">len</span>(shape))(*shape)
        self.<span class="hljs-property">ndim_ctype</span> = ctypes.<span class="hljs-title function_">c_int</span>(<span class="hljs-title function_">len</span>(shape))
       
        self.<span class="hljs-property">shape</span> = shape
        self.<span class="hljs-property">ndim</span> = <span class="hljs-title function_">len</span>(shape)

        <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">create_tensor</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_float</span>), ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>), ctypes.<span class="hljs-property">c_int</span>]
        <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">create_tensor</span>.<span class="hljs-property">restype</span> = ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>)

        self.<span class="hljs-property">tensor</span> = <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-title function_">create_tensor</span>(
            self.<span class="hljs-property">data_ctype</span>,
            self.<span class="hljs-property">shape_ctype</span>,
            self.<span class="hljs-property">ndim_ctype</span>,
        )
        
    def <span class="hljs-title function_">flatten</span>(self, nested_list):
        <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
        This method simply convert a list type tensor to a flatten tensor with its shape
        
        Example:
        
        Arguments:  
            nested_list: [[1, 2, 3], [-5, 2, 0]]
        Return:
            flat_data: [1, 2, 3, -5, 2, 0]
            shape: [2, 3]
        &quot;</span><span class="hljs-string">&quot;&quot;</span>
        def <span class="hljs-title function_">flatten_recursively</span>(nested_list):
            flat_data = []
            shape = []
            <span class="hljs-keyword">if</span> <span class="hljs-title function_">isinstance</span>(nested_list, list):
                <span class="hljs-keyword">for</span> sublist <span class="hljs-keyword">in</span> <span class="hljs-attr">nested_list</span>:
                    inner_data, inner_shape = <span class="hljs-title function_">flatten_recursively</span>(sublist)
                    flat_data.<span class="hljs-title function_">extend</span>(inner_data)
                shape.<span class="hljs-title function_">append</span>(<span class="hljs-title function_">len</span>(nested_list))
                shape.<span class="hljs-title function_">extend</span>(inner_shape)
            <span class="hljs-attr">else</span>:
                flat_data.<span class="hljs-title function_">append</span>(nested_list)
            <span class="hljs-keyword">return</span> flat_data, shape
        
        flat_data, shape = <span class="hljs-title function_">flatten_recursively</span>(nested_list)
        <span class="hljs-keyword">return</span> flat_data, shape
</code></pre>
<p>ì´ì œ Python í…ì„œ ì‘ì—…ì„ í¬í•¨í•˜ì—¬ C/C++ ì‘ì—…ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"># norch/tensor.<span class="hljs-property">py</span>

def <span class="hljs-title function_">__getitem__</span>(self, indices):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    index í…ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ í…ì„œì— ì•¡ì„¸ìŠ¤ tensor[i, j, k...]
    &quot;</span><span class="hljs-string">&quot;&quot;</span>

    <span class="hljs-keyword">if</span> <span class="hljs-title function_">len</span>(indices) != self.<span class="hljs-property">ndim</span>:
        raise <span class="hljs-title class_">ValueError</span>(<span class="hljs-string">&quot;ì¸ë±ìŠ¤ ìˆ˜ê°€ ì°¨ì› ìˆ˜ì™€ ì¼ì¹˜í•´ì•¼ í•¨&quot;</span>)
    
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">get_item</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>), ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>)]
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">get_item</span>.<span class="hljs-property">restype</span> = ctypes.<span class="hljs-property">c_float</span>
                                       
    indices = (ctypes.<span class="hljs-property">c_int</span> * <span class="hljs-title function_">len</span>(indices))(*indices)
    value = <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-title function_">get_item</span>(self.<span class="hljs-property">tensor</span>, indices)  
    
    <span class="hljs-keyword">return</span> value

def <span class="hljs-title function_">reshape</span>(self, new_shape):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    í…ì„œë¥¼ ì¬êµ¬ì„±í•©ë‹ˆë‹¤
    result = tensor.reshape([1,2])
    &quot;</span><span class="hljs-string">&quot;&quot;</span>
    new_shape_ctype = (ctypes.<span class="hljs-property">c_int</span> * <span class="hljs-title function_">len</span>(new_shape))(*new_shape)
    new_ndim_ctype = ctypes.<span class="hljs-title function_">c_int</span>(<span class="hljs-title function_">len</span>(new_shape))
    
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">reshape_tensor</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>), ctypes.<span class="hljs-title function_">POINTER</span>(ctypes.<span class="hljs-property">c_int</span>), ctypes.<span class="hljs-property">c_int</span>]
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">reshape_tensor</span>.<span class="hljs-property">restype</span> = ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>)
    result_tensor_ptr = <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-title function_">reshape_tensor</span>(self.<span class="hljs-property">tensor</span>, new_shape_ctype, new_ndim_ctype)   

    result_data = <span class="hljs-title class_">Tensor</span>()
    result_data.<span class="hljs-property">tensor</span> = result_tensor_ptr
    result_data.<span class="hljs-property">shape</span> = new_shape.<span class="hljs-title function_">copy</span>()
    result_data.<span class="hljs-property">ndim</span> = <span class="hljs-title function_">len</span>(new_shape)
    result_data.<span class="hljs-property">device</span> = self.<span class="hljs-property">device</span>

    <span class="hljs-keyword">return</span> result_data

def <span class="hljs-title function_">__add__</span>(self, other):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    í…ì„œë¥¼ ë”í•©ë‹ˆë‹¤
    result = tensor1 + tensor2
    &quot;</span><span class="hljs-string">&quot;&quot;</span>
  
    <span class="hljs-keyword">if</span> self.<span class="hljs-property">shape</span> != other.<span class="hljs-property">shape</span>:
        raise <span class="hljs-title class_">ValueError</span>(<span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œë“¤ì€ ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•¨&quot;</span>)
    
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">add_tensor</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>), ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>)]
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">add_tensor</span>.<span class="hljs-property">restype</span> = ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>)

    result_tensor_ptr = <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-title function_">add_tensor</span>(self.<span class="hljs-property">tensor</span>, other.<span class="hljs-property">tensor</span>)

    result_data = <span class="hljs-title class_">Tensor</span>()
    result_data.<span class="hljs-property">tensor</span> = result_tensor_ptr
    result_data.<span class="hljs-property">shape</span> = self.<span class="hljs-property">shape</span>.<span class="hljs-title function_">copy</span>()
    result_data.<span class="hljs-property">ndim</span> = self.<span class="hljs-property">ndim</span>
    result_data.<span class="hljs-property">device</span> = self.<span class="hljs-property">device</span>

    <span class="hljs-keyword">return</span> result_data

# ê¸°íƒ€ ì—°ì‚° í¬í•¨:
# __str__
# __sub__ (-)
# __mul__ (*)
# __matmul__ (@)
# __pow__ (**)
# __truediv__ (/)
# log
# ...
</code></pre>
<p>ì—¬ê¸°ê¹Œì§€ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ì´ì œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  í…ì„œ ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì´ ìƒê²¼ìŠµë‹ˆë‹¤!</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> norch

tensor1 = norch.<span class="hljs-title class_">Tensor</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]])
tensor2 = norch.<span class="hljs-title class_">Tensor</span>([[<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]])

result = tensor1 + tensor2
<span class="hljs-title function_">print</span>(result[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
# <span class="hljs-number">4</span> 
</code></pre>
<h1>#2 â€” GPU ì§€ì›</h1>
<p>ìš°ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë§Œë“  í›„, ì´ì œ ìƒˆë¡œìš´ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì–´ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ GPUë¡œ ì „ì†¡í•˜ê³  ìˆ˜í•™ ì—°ì‚°ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ <code>.to(&quot;cuda&quot;)</code>ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ ì˜ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. CUDAê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê¸°ë³¸ ì§€ì‹ì´ ìˆì„ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤ë§Œ, ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° ë‹¤ë¥¸ ê¸°ì‚¬ì¸ &#x27;CUDA íŠœí† ë¦¬ì–¼&#x27;ì„ ì½ì–´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ê¸°ë‹¤ë¦´ê²Œìš”. ğŸ˜Š</p>
<p>...</p>
<p>ê¸‰í•œ ì‚¬ëŒë“¤ì„ ìœ„í•´, ê°„ë‹¨í•œ ì†Œê°œê°€ ì—¬ê¸° ìˆì–´ìš”:</p>
<p>ê¸°ë³¸ì ìœ¼ë¡œ, ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë“  ì½”ë“œëŠ” CPU ë©”ëª¨ë¦¬ì—ì„œ ì‹¤í–‰ë˜ê³  ìˆì–´ìš”. í•˜ë‚˜ì˜ ì‘ì—…ì— ëŒ€í•´ì„œëŠ” CPUê°€ ë¹ ë¥´ì§€ë§Œ, GPUì˜ ì¥ì ì€ ë³‘ë ¬í™” ëŠ¥ë ¥ì— ìˆì–´ìš”. CPU ë””ìì¸ì€ ì—°ì‚°(ìŠ¤ë ˆë“œ)ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•œ ë°˜ë©´, GPU ë””ìì¸ì€ ìˆ˜ë°±ë§Œ ê°œì˜ ì—°ì‚°ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•´ìš” (ê°œë³„ ìŠ¤ë ˆë“œì˜ ì„±ëŠ¥ì„ í¬ìƒí•˜ë©°).</p>
<p>ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì´ ëŠ¥ë ¥ì„ í™œìš©í•˜ì—¬ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ìš”. ì˜ˆë¥¼ ë“¤ì–´, ë°±ë§Œ ê°œì˜ ìš”ì†Œë¡œ êµ¬ì„±ëœ í…ì„œë¥¼ ì¶”ê°€í•  ë•Œ, ë°˜ë³µë¬¸ ë‚´ì—ì„œ ê° ìƒ‰ì¸ì˜ ìš”ì†Œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ , GPUë¥¼ ì‚¬ìš©í•˜ì—¬ í•œêº¼ë²ˆì— ëª¨ë‘ë¥¼ ë³‘ë ¬ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”. ì´ë¥¼ ìœ„í•´ NVIDIAì—ì„œ ê°œë°œí•œ ê°œë°œìë“¤ì´ GPU ì§€ì›ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í†µí•©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í”Œë«í¼ì¸ CUDAë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.</p>
<p>ê·¸ê±¸ í•˜ë ¤ë©´, íŠ¹ì • GPU ì‘ì—…(ì˜ˆ: CPU ë©”ëª¨ë¦¬ì—ì„œ GPU ë©”ëª¨ë¦¬ë¡œ ë°ì´í„° ë³µì‚¬)ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ê°„ë‹¨í•œ C/C++ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤ ì¸ CUDA C/C++ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ ì½”ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ CPUì—ì„œ GPUë¡œ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ê³  ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” AddTwoArrays í•¨ìˆ˜(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ Nê°œì˜ GPU ìŠ¤ë ˆë“œì—ì„œ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ëŠ” ëª‡ ê°€ì§€ CUDA C/C++ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-comment">// CPU ë²„ì „(ë¹„êµìš©)</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">AddTwoArrays_CPU</span><span class="hljs-params">(flaot A[], <span class="hljs-type">float</span> B[], <span class="hljs-type">float</span> C[])</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
        C[i] = A[i] + B[i];
    }
}

<span class="hljs-comment">// ì»¤ë„ ì •ì˜</span>
__global__ <span class="hljs-type">void</span> <span class="hljs-title function_">AddTwoArrays_GPU</span><span class="hljs-params">(<span class="hljs-type">float</span> A[], <span class="hljs-type">float</span> B[], <span class="hljs-type">float</span> C[])</span> {
    <span class="hljs-type">int</span> i = threadIdx.x;
    C[i] = A[i] + B[i];
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {

    <span class="hljs-type">int</span> N = <span class="hljs-number">1000</span>; <span class="hljs-comment">// ë°°ì—´ í¬ê¸°</span>
    <span class="hljs-type">float</span> A[N], B[N], C[N]; <span class="hljs-comment">// ë°°ì—´ A, B, C</span>

    ...

    <span class="hljs-type">float</span> *d_A, *d_B, *d_C; <span class="hljs-comment">// ë°°ì—´ A, B, Cì˜ ì¥ì¹˜ í¬ì¸í„°</span>

    <span class="hljs-comment">// ë°°ì—´ A, B, Cì— ëŒ€í•œ ì¥ì¹˜ì—ì„œì˜ ë©”ëª¨ë¦¬ í• ë‹¹</span>
    cudaMalloc((<span class="hljs-type">void</span> **)&amp;d_A, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>));
    cudaMalloc((<span class="hljs-type">void</span> **)&amp;d_B, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>));
    cudaMalloc((<span class="hljs-type">void</span> **)&amp;d_C, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>));

    <span class="hljs-comment">// í˜¸ìŠ¤íŠ¸ì—ì„œ ì¥ì¹˜ë¡œ ë°°ì—´ A ë° B ë³µì‚¬</span>
    cudaMemcpy(d_A, A, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>), cudaMemcpyHostToDevice);
    cudaMemcpy(d_B, B, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>), cudaMemcpyHostToDevice);

    <span class="hljs-comment">// Nê°œì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë„ í˜¸ì¶œ</span>
    AddTwoArrays_GPU&lt;&lt;&lt;<span class="hljs-number">1</span>, N&gt;&gt;&gt;(d_A, d_B, d_C);
    
    <span class="hljs-comment">// ì¥ì¹˜ì—ì„œ í˜¸ìŠ¤íŠ¸ë¡œ ë²¡í„° C ë³µì‚¬</span>
    cudaMemcpy(C, d_C, N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">float</span>), cudaMemcpyDeviceToHost);

}
</code></pre>
<p>ì£¼ëª©í•  ì ì€ ê° ìš”ì†Œ ìŒì„ ê°ê° ì¶”ê°€í•˜ëŠ” ëŒ€ì‹  ëª¨ë“  ë§ì…ˆ ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ì—¬ ë£¨í”„ ëª…ë ¹ì„ ì œê±°í•œ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ê°„ë‹¨í•œ ì†Œê°œ ì´í›„ì—, í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆì–´ìš”.</p>
<p>ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” CPUì—ì„œ GPUë¡œ í…ì„œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

<span class="hljs-keyword">void</span> <span class="hljs-title function_">to_device</span>(<span class="hljs-params">Tensor* tensor, char* target_device</span>) {
    <span class="hljs-keyword">if</span> ((<span class="hljs-title function_">strcmp</span>(target_device, <span class="hljs-string">&quot;cuda&quot;</span>) == <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-title function_">strcmp</span>(tensor-&gt;device, <span class="hljs-string">&quot;cpu&quot;</span>) == <span class="hljs-number">0</span>)) {
        <span class="hljs-title function_">cpu_to_cuda</span>(tensor);
    }

    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((<span class="hljs-title function_">strcmp</span>(target_device, <span class="hljs-string">&quot;cpu&quot;</span>) == <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-title function_">strcmp</span>(tensor-&gt;device, <span class="hljs-string">&quot;cuda&quot;</span>) == <span class="hljs-number">0</span>)) {
        <span class="hljs-title function_">cuda_to_cpu</span>(tensor);
    }
}
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/cuda.cu</span>

__host__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">cpu_to_cuda</span>(<span class="hljs-params">Tensor* tensor</span>) {
    
    float* data_tmp;
    <span class="hljs-title function_">cudaMalloc</span>((<span class="hljs-keyword">void</span> **)&amp;data_tmp, tensor-&gt;size * <span class="hljs-title function_">sizeof</span>(float));
    <span class="hljs-title function_">cudaMemcpy</span>(data_tmp, tensor-&gt;data, tensor-&gt;size * <span class="hljs-title function_">sizeof</span>(float), cudaMemcpyHostToDevice);

    tensor-&gt;data = data_tmp;

    <span class="hljs-keyword">const</span> char* device_str = <span class="hljs-string">&quot;cuda&quot;</span>;
    tensor-&gt;device = (char*)<span class="hljs-title function_">malloc</span>(<span class="hljs-title function_">strlen</span>(device_str) + <span class="hljs-number">1</span>);
    <span class="hljs-title function_">strcpy</span>(tensor-&gt;device, device_str); 

    <span class="hljs-title function_">printf</span>(<span class="hljs-string">&quot;í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\n&quot;</span>, tensor-&gt;device);
}

__host__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">cuda_to_cpu</span>(<span class="hljs-params">Tensor* tensor</span>) {
    float* data_tmp = (float*)<span class="hljs-title function_">malloc</span>(tensor-&gt;size * <span class="hljs-title function_">sizeof</span>(float));

    <span class="hljs-title function_">cudaMemcpy</span>(data_tmp, tensor-&gt;data, tensor-&gt;size * <span class="hljs-title function_">sizeof</span>(float), cudaMemcpyDeviceToHost);
    <span class="hljs-title function_">cudaFree</span>(tensor-&gt;data);

    tensor-&gt;data = data_tmp;

    <span class="hljs-keyword">const</span> char* device_str = <span class="hljs-string">&quot;cpu&quot;</span>;
    tensor-&gt;device = (char*)<span class="hljs-title function_">malloc</span>(<span class="hljs-title function_">strlen</span>(device_str) + <span class="hljs-number">1</span>);
    <span class="hljs-title function_">strcpy</span>(tensor-&gt;device, device_str); 

    <span class="hljs-title function_">printf</span>(<span class="hljs-string">&quot;í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\n&quot;</span>, tensor-&gt;device);
}
</code></pre>
<p>íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„ëœ ë˜í¼:</p>
<pre><code class="hljs language-js"># norch/tensor.<span class="hljs-property">py</span>

def <span class="hljs-title function_">to</span>(self, device):
    self.<span class="hljs-property">device</span> = device
    self.<span class="hljs-property">device_ctype</span> = self.<span class="hljs-property">device</span>.<span class="hljs-title function_">encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)
  
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">to_device</span>.<span class="hljs-property">argtypes</span> = [ctypes.<span class="hljs-title function_">POINTER</span>(<span class="hljs-title class_">CTensor</span>), ctypes.<span class="hljs-property">c_char_p</span>]
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-property">to_device</span>.<span class="hljs-property">restype</span> = <span class="hljs-title class_">None</span>
    <span class="hljs-title class_">Tensor</span>.<span class="hljs-property">_C</span>.<span class="hljs-title function_">to_device</span>(self.<span class="hljs-property">tensor</span>, self.<span class="hljs-property">device_ctype</span>)
  
    <span class="hljs-keyword">return</span> self
</code></pre>
<p>ë‹¤ìŒìœ¼ë¡œ, ëª¨ë“  í…ì„œ ì—°ì‚°ì— ëŒ€í•´ GPU ë²„ì „ì„ ìƒì„±í•©ë‹ˆë‹¤. ë§ì…ˆê³¼ ëº„ì…ˆì— ëŒ€í•œ ì˜ˆì œë¥¼ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/cuda.cu</span>

#define <span class="hljs-variable constant_">THREADS_PER_BLOCK</span> <span class="hljs-number">128</span>

__global__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">add_tensor_cuda_kernel</span>(<span class="hljs-params">float* data1, float* data2, float* result_data, int size</span>) {
    
    int i = blockIdx.<span class="hljs-property">x</span> * blockDim.<span class="hljs-property">x</span> + threadIdx.<span class="hljs-property">x</span>;
    <span class="hljs-keyword">if</span> (i &lt; size) {
        result_data[i] = data1[i] + data2[i];
    }
}

__host__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">add_tensor_cuda</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2, float* result_data</span>) {
    
    int number_of_blocks = (tensor1-&gt;size + <span class="hljs-variable constant_">THREADS_PER_BLOCK</span> - <span class="hljs-number">1</span>) / <span class="hljs-variable constant_">THREADS_PER_BLOCK</span>;
    add_tensor_cuda_kernel&lt;&lt;&lt;number_of_blocks, <span class="hljs-variable constant_">THREADS_PER_BLOCK</span>&gt;&gt;&gt;(tensor1-&gt;data, tensor2-&gt;data, result_data, tensor1-&gt;size);

    cudaError_t error = <span class="hljs-title function_">cudaGetLastError</span>();
    <span class="hljs-keyword">if</span> (error != cudaSuccess) {
        <span class="hljs-title function_">printf</span>(<span class="hljs-string">&quot;CUDA error: %s\n&quot;</span>, <span class="hljs-title function_">cudaGetErrorString</span>(error));
        <span class="hljs-title function_">exit</span>(-<span class="hljs-number">1</span>);
    }

    <span class="hljs-title function_">cudaDeviceSynchronize</span>();
}

__global__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">sub_tensor_cuda_kernel</span>(<span class="hljs-params">float* data1, float* data2, float* result_data, int size</span>) {
   
    int i = blockIdx.<span class="hljs-property">x</span> * blockDim.<span class="hljs-property">x</span> + threadIdx.<span class="hljs-property">x</span>;
    <span class="hljs-keyword">if</span> (i &lt; size) {
        result_data[i] = data1[i] - data2[i];
    }
}

__host__ <span class="hljs-keyword">void</span> <span class="hljs-title function_">sub_tensor_cuda</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2, float* result_data</span>) {
    
    int number_of_blocks = (tensor1-&gt;size + <span class="hljs-variable constant_">THREADS_PER_BLOCK</span> - <span class="hljs-number">1</span>) / <span class="hljs-variable constant_">THREADS_PER_BLOCK</span>;
    sub_tensor_cuda_kernel&lt;&lt;&lt;number_of_blocks, <span class="hljs-variable constant_">THREADS_PER_BLOCK</span>&gt;&gt;&gt;(tensor1-&gt;data, tensor2-&gt;data, result_data, tensor1-&gt;size);

    cudaError_t error = <span class="hljs-title function_">cudaGetLastError</span>();
    <span class="hljs-keyword">if</span> (error != cudaSuccess) {
        <span class="hljs-title function_">printf</span>(<span class="hljs-string">&quot;CUDA error: %s\n&quot;</span>, <span class="hljs-title function_">cudaGetErrorString</span>(error));
        <span class="hljs-title function_">exit</span>(-<span class="hljs-number">1</span>);
    }

    <span class="hljs-title function_">cudaDeviceSynchronize</span>();
}

...
</code></pre>
<p>ê·¸ëŸ° ë‹¤ìŒ, í…ì„œ.cppì— ìƒˆë¡œìš´ í…ì„œ ì†ì„± char* deviceë¥¼ ì¶”ê°€í•˜ê³  ì‘ì—…ì„ ì‹¤í–‰í•  ìœ„ì¹˜(CPU ë˜ëŠ” GPU)ë¥¼ ì„ íƒí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//norch/csrc/tensor.cpp</span>

<span class="hljs-title class_">Tensor</span>* <span class="hljs-title function_">add_tensor</span>(<span class="hljs-params">Tensor* tensor1, Tensor* tensor2</span>) {
    <span class="hljs-keyword">if</span> (tensor1-&gt;ndim != tensor2-&gt;ndim) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ í…ì„œê°€ ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\n&quot;</span>, tensor1-&gt;ndim, tensor2-&gt;ndim);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">strcmp</span>(tensor1-&gt;device, tensor2-&gt;device) != <span class="hljs-number">0</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;í…ì„œëŠ” ë™ì¼í•œ ì¥ì¹˜ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤: %s and %s\n&quot;</span>, tensor1-&gt;device, tensor2-&gt;device);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    char* device = (char*)<span class="hljs-title function_">malloc</span>(<span class="hljs-title function_">strlen</span>(tensor1-&gt;device) + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span> (device != <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">strcpy</span>(device, tensor1-&gt;device);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(-<span class="hljs-number">1</span>);
    }
    int ndim = tensor1-&gt;ndim;
    int* shape = (int*)<span class="hljs-title function_">malloc</span>(ndim * <span class="hljs-title function_">sizeof</span>(int));
    <span class="hljs-keyword">if</span> (shape == <span class="hljs-variable constant_">NULL</span>) {
        <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
        <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; ndim; i++) {
        <span class="hljs-keyword">if</span> (tensor1-&gt;shape[i] != tensor2-&gt;shape[i]) {
            <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ í…ì„œë“¤ì€ ìƒ‰ì¸ %dì—ì„œ ë™ì¼í•œ í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\n&quot;</span>, i, tensor1-&gt;shape[i], tensor2-&gt;shape[i]);
            <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
        }
        shape[i] = tensor1-&gt;shape[i];
    }        

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">strcmp</span>(tensor1-&gt;device, <span class="hljs-string">&quot;cuda&quot;</span>) == <span class="hljs-number">0</span>) {

        float* result_data;
        <span class="hljs-title function_">cudaMalloc</span>((<span class="hljs-keyword">void</span> **)&amp;result_data, tensor1-&gt;size * <span class="hljs-title function_">sizeof</span>(float));
        <span class="hljs-title function_">add_tensor_cuda</span>(tensor1, tensor2, result_data);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">create_tensor</span>(result_data, shape, ndim, device);
    } 
    <span class="hljs-keyword">else</span> {
        float* result_data = (float*)<span class="hljs-title function_">malloc</span>(tensor1-&gt;size * <span class="hljs-title function_">sizeof</span>(float));
        <span class="hljs-keyword">if</span> (result_data == <span class="hljs-variable constant_">NULL</span>) {
            <span class="hljs-title function_">fprintf</span>(stderr, <span class="hljs-string">&quot;ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\n&quot;</span>);
            <span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
        }
        <span class="hljs-title function_">add_tensor_cpu</span>(tensor1, tensor2, result_data);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">create_tensor</span>(result_data, shape, ndim, device);
    }     
}
</code></pre>
<p>ì´ì œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ GPU ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤!</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> norch

tensor1 = norch.<span class="hljs-title class_">Tensor</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]]).<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;cuda&quot;</span>)
tensor2 = norch.<span class="hljs-title class_">Tensor</span>([[<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]]).<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;cuda&quot;</span>)

result = tensor1 + tensor2
</code></pre>
<h1>#3 â€” Automatic Differentiation (Autograd)</h1>
<p>íŒŒì´í† ì¹˜ê°€ ì¸ê¸°ë¥¼ ì–»ê²Œ ëœ ì£¼ìš” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ” Autograd ëª¨ë“ˆ ë•Œë¬¸ì…ë‹ˆë‹¤. Autograd ëª¨ë“ˆì€ ìë™ ë¯¸ë¶„ì„ ìˆ˜í–‰í•˜ì—¬ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤ (ê²½ì‚¬ í•˜ê°•ë²•ê³¼ ê°™ì€ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤). .backward()ë¼ëŠ” ë‹¨ì¼ ë©”ì„œë“œ í˜¸ì¶œë¡œ ì´ì „ í…ì„œ ì—°ì‚°ì—ì„œ ëª¨ë“  ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">x = torch.<span class="hljs-title function_">tensor</span>([[<span class="hljs-number">1.</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">3.</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]], requires_grad=<span class="hljs-title class_">True</span>)
# [[<span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
#  [<span class="hljs-number">3</span>,  <span class="hljs-number">2.</span>, <span class="hljs-number">1</span>]]

y = torch.<span class="hljs-title function_">tensor</span>([[<span class="hljs-number">3.</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]], requires_grad=<span class="hljs-title class_">True</span>)
# [[<span class="hljs-number">3</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],
#  [<span class="hljs-number">1</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]]

L = ((x - y) ** <span class="hljs-number">3</span>).<span class="hljs-title function_">sum</span>()

L.<span class="hljs-title function_">backward</span>()

# xì™€ yì˜ ê¸°ìš¸ê¸°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
<span class="hljs-title function_">print</span>(x.<span class="hljs-property">grad</span>)
# [[<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>],
#  [<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>]]

<span class="hljs-title function_">print</span>(y.<span class="hljs-property">grad</span>)
# [[-<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">12</span>],
#  [-<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">12</span>]]

# zë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ì„œëŠ” ê²½ì‚¬ í•˜ê°•ë²•ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
# x = x - í•™ìŠµë¥  * x.<span class="hljs-property">grad</span>
# y = y - í•™ìŠµë¥  * y.<span class="hljs-property">grad</span>
</code></pre>
<p>ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€ ì´í•´í•˜ê¸° ìœ„í•´ ë™ì¼í•œ ì ˆì°¨ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³µì œí•´ë³´ê² ìŠµë‹ˆë‹¤:</p>
<img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_10.png"/>
<p>ìš°ì„  ê³„ì‚°í•´ ë´…ì‹œë‹¤:</p>
<img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_11.png"/>
<p>xê°€ í–‰ë ¬ì´ë¼ëŠ” ê²ƒì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê° ìš”ì†Œì— ëŒ€í•œ Lì˜ ë¯¸ë¶„ì„ ê°œë³„ì ìœ¼ë¡œ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ê²Œë‹¤ê°€, Lì€ ëª¨ë“  ìš”ì†Œì— ëŒ€í•œ í•©ì´ì§€ë§Œ ê° ìš”ì†Œì— ëŒ€í•œ ë¯¸ë¶„ì—ì„œ ë‹¤ë¥¸ ìš”ì†Œë“¤ì€ ì¤‘ìš”í•œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•­ì„ ì–»ìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_12.png" alt="ì´ë¯¸ì§€"/></p>
<p>ê° í•­ì— ëŒ€í•´ ì—°ì‡„ ë²•ì¹™ì„ ì ìš©í•˜ì—¬ ì™¸ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•˜ê³  ë‚´ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•œ ê°’ì„ ê³±í•©ë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_13.png" alt="ì´ë¯¸ì§€"/></p>
<p>Where:</p>
<p>ë§ˆì¹¨ë‚´:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_14.png" alt="ì´ë¯¸ì§€"/></p>
<p>ê·¸ëŸ¬ë¯€ë¡œ, xì— ê´€í•œ Lì˜ ë¯¸ë¶„ì„ ê³„ì‚°í•˜ëŠ” ìµœì¢… ë°©ì •ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>ì•„ë˜ëŠ” Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½ëœ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_16.png" alt="Image 1"/></p>
<p>Substituting the values into the equation:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_17.png" alt="Image 2"/></p>
<p>Calculating the result, we get the same values we obtained with PyTorch:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_18.png" alt="image"/></p>
<p>Now, letâ€™s analyze what we just did:</p>
<p>Basically, we observed all the operations involved in reverse order: a summation, a power of 3, and a subtraction. Then, we applied the chain rule, calculating the derivative of each operation and recursively calculated the derivative for the next operation. So, first we need an implementation of the derivative for different math operations:</p>
<p>For addition:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_19.png" alt="Image"/></p>
<pre><code class="hljs language-js"># norch/autograd/functions.<span class="hljs-property">py</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AddBackward</span>:
    def <span class="hljs-title function_">__init__</span>(self, x, y):
        self.<span class="hljs-property">input</span> = [x, y]

    def <span class="hljs-title function_">backward</span>(self, gradient):
        <span class="hljs-keyword">return</span> [gradient, gradient]
</code></pre>
<p>For sin:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_20.png" alt="Image"/></p>
<pre><code class="hljs language-js"># norch/autograd/functions.<span class="hljs-property">py</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SinBackward</span>:
    def <span class="hljs-title function_">__init__</span>(self, x):
        self.<span class="hljs-property">input</span> = [x]

    def <span class="hljs-title function_">backward</span>(self, gradient):
        x = self.<span class="hljs-property">input</span>[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">return</span> [x.<span class="hljs-title function_">cos</span>() * gradient]
</code></pre>
<p>ì½”ì‚¬ì¸ì— ëŒ€í•´:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21.png" alt="2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21"/></p>
<pre><code class="hljs language-js"># norch/autograd/functions.<span class="hljs-property">py</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CosBackward</span>:
    def <span class="hljs-title function_">__init__</span>(self, x):
        self.<span class="hljs-property">input</span> = [x]

    def <span class="hljs-title function_">backward</span>(self, gradient):
        x = self.<span class="hljs-property">input</span>[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">return</span> [- x.<span class="hljs-title function_">sin</span>() * gradient]
</code></pre>
<p>ìš”ì†Œë³„ ê³±ì…ˆì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•´ë³´ì„¸ìš”:</p>
<p><img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_22.png" alt="element-wise multiplication"/></p>
<pre><code class="hljs language-python"><span class="hljs-comment"># norch/autograd/functions.py</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ElementwiseMulBackward</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, x, y</span>):
        self.<span class="hljs-built_in">input</span> = [x, y]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">backward</span>(<span class="hljs-params">self, gradient</span>):
        x = self.<span class="hljs-built_in">input</span>[<span class="hljs-number">0</span>]
        y = self.<span class="hljs-built_in">input</span>[<span class="hljs-number">1</span>]
        <span class="hljs-keyword">return</span> [y * gradient, x * gradient]
</code></pre>
<p>í•©ì‚°ì— ëŒ€í•´ì„œ:</p>
<h1>norch/autograd/functions.py</h1>
<pre><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SumBackward</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, x</span>):
        self.<span class="hljs-built_in">input</span> = [x]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">backward</span>(<span class="hljs-params">self, gradient</span>):
        <span class="hljs-comment"># sum í•¨ìˆ˜ëŠ” í…ì„œë¥¼ ìŠ¤ì¹¼ë¼ë¡œ ì¤„ì´ë¯€ë¡œ ê¸°ìš¸ê¸°ë¥¼ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë©ë‹ˆë‹¤.</span>
        <span class="hljs-keyword">return</span> [<span class="hljs-built_in">float</span>(gradient.tensor.contents.data[<span class="hljs-number">0</span>]) * self.<span class="hljs-built_in">input</span>[<span class="hljs-number">0</span>].ones_like()]
</code></pre>
<p>ë‹¤ë¥¸ ì—°ì‚°ì„ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” GitHub ì €ì¥ì†Œ ë§í¬ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ê° ì‘ì—…ì— ëŒ€í•œ ë„í•¨ìˆ˜ ì‹ì„ ê°€ì¡Œìœ¼ë‹ˆ, ì¬ê·€ì ìœ¼ë¡œ ì—­ì „íŒŒ ì²´ì¸ ê·œì¹™ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í…ì„œì— requires_grad ì¸ìë¥¼ ì„¤ì •í•˜ì—¬ ì´ í…ì„œì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Trueì´ë©´ ê° í…ì„œ ì‘ì—…ì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># norch/tensor.py</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">__add__</span>(<span class="hljs-params">self, other</span>):

  <span class="hljs-keyword">if</span> self.shape != other.shape:
      <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;ë§ì…ˆì„ ìœ„í•´ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.&quot;</span>)
  
  Tensor._C.add_tensor.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(CTensor)]
  Tensor._C.add_tensor.restype = ctypes.POINTER(CTensor)
  
  result_tensor_ptr = Tensor._C.add_tensor(self.tensor, other.tensor)
  
  result_data = Tensor()
  result_data.tensor = result_tensor_ptr
  result_data.shape = self.shape.copy()
  result_data.ndim = self.ndim
  result_data.device = self.device
  
  result_data.requires_grad = self.requires_grad <span class="hljs-keyword">or</span> other.requires_grad
  <span class="hljs-keyword">if</span> result_data.requires_grad:
      result_data.grad_fn = AddBackward(self, other)
</code></pre>
<p>ê·¸ëŸ¼, <code>.backward()</code> ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ë³´ì„¸ìš”:</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># norch/tensor.py</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">backward</span>(<span class="hljs-params">self, gradient=<span class="hljs-literal">None</span></span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.requires_grad:
        <span class="hljs-keyword">return</span>
    
    <span class="hljs-keyword">if</span> gradient <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">if</span> self.shape == [<span class="hljs-number">1</span>]:
            gradient = Tensor([<span class="hljs-number">1</span>]) <span class="hljs-comment"># dx/dx = 1 case</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;Gradient argument must be specified for non-scalar tensors.&quot;</span>)

    <span class="hljs-keyword">if</span> self.grad <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        self.grad = gradient

    <span class="hljs-keyword">else</span>:
        self.grad += gradient

    <span class="hljs-keyword">if</span> self.grad_fn <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>: <span class="hljs-comment"># not a leaf</span>
        grads = self.grad_fn.backward(gradient) <span class="hljs-comment"># call the operation backward</span>
        <span class="hljs-keyword">for</span> tensor, grad <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(self.grad_fn.<span class="hljs-built_in">input</span>, grads):
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(tensor, Tensor):
                tensor.backward(grad) <span class="hljs-comment"># recursively call the backward again for the gradient expression (chain rule)</span>
</code></pre>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, í…ì„œì˜ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì œë¡œí™”í•˜ëŠ” <code>.zero_grad()</code>ì™€ í…ì„œì˜ ì˜¤í† ê·¸ë˜ë“œ íˆìŠ¤í† ë¦¬ë¥¼ ì œê±°í•˜ëŠ” <code>.detach()</code>ë¥¼ êµ¬í˜„í•´ì£¼ì„¸ìš”:</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># norch/tensor.py</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">zero_grad</span>(<span class="hljs-params">self</span>):
    self.grad = <span class="hljs-literal">None</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">detach</span>(<span class="hljs-params">self</span>):
    self.grad = <span class="hljs-literal">None</span>
    self.grad_fn = <span class="hljs-literal">None</span>
</code></pre>
<p>ì¶•í•˜í•©ë‹ˆë‹¤! GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ì´ ìˆëŠ” ì™„ì „í•œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“œì…¨êµ°ìš”! ì´ì œ nn ë° optim ëª¨ë“ˆì„ ë§Œë“¤ì–´ ëª‡ ê°€ì§€ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ ë” ì‰½ê²Œ í›ˆë ¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h2>#4 â€” nn ë° optim ëª¨ë“ˆ</h2>
<p>nnì€ ì‹ ê²½ë§ ë° ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ëª¨ë“ˆì´ë©°, optimì€ ì´ëŸ¬í•œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì¬í˜„í•˜ê¸° ìœ„í•œ ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” Parameterë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ParameterëŠ” ê°„ë‹¨íˆ ë§í•´ í•­ìƒ Trueë¡œ ì„¤ì •ëœ requires_grad ì†ì„±ì„ ê°–ëŠ” í›ˆë ¨ ê°€ëŠ¥í•œ í…ì„œë¡œ, ì¼ë¶€ ì„ì˜ì˜ ì´ˆê¸°í™” ê¸°ë²•ì„ ì‚¬ìš©í•´ ê°™ì€ ì—°ì‚°ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"># norch/nn/parameter.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> norch.<span class="hljs-property">tensor</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Tensor</span>
<span class="hljs-keyword">from</span> norch.<span class="hljs-property">utils</span> <span class="hljs-keyword">import</span> utils
<span class="hljs-keyword">import</span> random

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Parameter</span>(<span class="hljs-title class_">Tensor</span>):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    A parameter is a trainable tensor.
    &quot;</span><span class="hljs-string">&quot;&quot;</span>
    def <span class="hljs-title function_">__init__</span>(self, shape):
        data = utils.<span class="hljs-title function_">generate_random_list</span>(shape=shape)
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>(data, requires_grad=<span class="hljs-title class_">True</span>)
</code></pre>
<pre><code class="hljs language-js"># norch/utisl/utils.<span class="hljs-property">py</span>

def <span class="hljs-title function_">generate_random_list</span>(shape):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    ëœë¤í•œ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ &#x27;shape&#x27; í˜•íƒœì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
    [4, 2] --&gt; [[rand1, rand2], [rand3, rand4], [rand5, rand6], [rand7, rand8]]
    &quot;</span><span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-title function_">len</span>(shape) == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> []
    <span class="hljs-attr">else</span>:
        inner_shape = shape[<span class="hljs-number">1</span>:]
        <span class="hljs-keyword">if</span> <span class="hljs-title function_">len</span>(inner_shape) == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> [random.<span class="hljs-title function_">uniform</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(shape[<span class="hljs-number">0</span>])]
        <span class="hljs-attr">else</span>:
            <span class="hljs-keyword">return</span> [<span class="hljs-title function_">generate_random_list</span>(inner_shape) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(shape[<span class="hljs-number">0</span>])]
</code></pre>
<p>íŒŒë¼ë¯¸í„°ë¥¼ í™œìš©í•˜ë©´ ëª¨ë“ˆì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"># norch/nn/<span class="hljs-variable language_">module</span>.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> .<span class="hljs-property">parameter</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Parameter</span>
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> <span class="hljs-title class_">OrderedDict</span>
<span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> <span class="hljs-variable constant_">ABC</span>
<span class="hljs-keyword">import</span> inspect

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Module</span>(<span class="hljs-variable constant_">ABC</span>):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    ëª¨ë“ˆì„ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤
    &quot;</span><span class="hljs-string">&quot;&quot;</span>
    def <span class="hljs-title function_">__init__</span>(self):
        self.<span class="hljs-property">_modules</span> = <span class="hljs-title class_">OrderedDict</span>()
        self.<span class="hljs-property">_params</span> = <span class="hljs-title class_">OrderedDict</span>()
        self.<span class="hljs-property">_grads</span> = <span class="hljs-title class_">OrderedDict</span>()
        self.<span class="hljs-property">training</span> = <span class="hljs-title class_">True</span>

    def <span class="hljs-title function_">forward</span>(self, *inputs, **kwargs):
        raise <span class="hljs-title class_">NotImplementedError</span>

    def <span class="hljs-title function_">__call__</span>(self, *inputs, **kwargs):
        <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">forward</span>(*inputs, **kwargs)

    def <span class="hljs-title function_">train</span>(self):
        self.<span class="hljs-property">training</span> = <span class="hljs-title class_">True</span>
        <span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> self.<span class="hljs-title function_">parameters</span>():
            param.<span class="hljs-property">requires_grad</span> = <span class="hljs-title class_">True</span>

    def <span class="hljs-built_in">eval</span>(self):
        self.<span class="hljs-property">training</span> = <span class="hljs-title class_">False</span>
        <span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> self.<span class="hljs-title function_">parameters</span>():
            param.<span class="hljs-property">requires_grad</span> = <span class="hljs-title class_">False</span>

    def <span class="hljs-title function_">parameters</span>(self):
        <span class="hljs-keyword">for</span> name, value <span class="hljs-keyword">in</span> inspect.<span class="hljs-title function_">getmembers</span>(self):
            <span class="hljs-keyword">if</span> <span class="hljs-title function_">isinstance</span>(value, <span class="hljs-title class_">Parameter</span>):
                <span class="hljs-keyword">yield</span> self, name, value
            elif <span class="hljs-title function_">isinstance</span>(value, <span class="hljs-title class_">Module</span>):
                <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> value.<span class="hljs-title function_">parameters</span>()

    def <span class="hljs-title function_">modules</span>(self):
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> self.<span class="hljs-property">_modules</span>.<span class="hljs-title function_">values</span>()

    def <span class="hljs-title function_">gradients</span>(self):
        <span class="hljs-keyword">for</span> <span class="hljs-variable language_">module</span> <span class="hljs-keyword">in</span> self.<span class="hljs-title function_">modules</span>():
            <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">_grads</span>

    def <span class="hljs-title function_">zero_grad</span>(self):
        <span class="hljs-keyword">for</span> _, _, parameter <span class="hljs-keyword">in</span> self.<span class="hljs-title function_">parameters</span>():
            parameter.<span class="hljs-title function_">zero_grad</span>()

    def <span class="hljs-title function_">to</span>(self, device):
        <span class="hljs-keyword">for</span> _, _, parameter <span class="hljs-keyword">in</span> self.<span class="hljs-title function_">parameters</span>():
            parameter.<span class="hljs-title function_">to</span>(device)

        <span class="hljs-keyword">return</span> self
    
    def <span class="hljs-title function_">inner_repr</span>(self):
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>

    def <span class="hljs-title function_">__repr__</span>(self):
        string = f<span class="hljs-string">&quot;{self.get_name()}(&quot;</span>
        tab = <span class="hljs-string">&quot;   &quot;</span>
        modules = self.<span class="hljs-property">_modules</span>
        <span class="hljs-keyword">if</span> modules == {}:
            string += f<span class="hljs-string">&#x27;\n{tab}(parameters): {self.inner_repr()}&#x27;</span>
        <span class="hljs-attr">else</span>:
            <span class="hljs-keyword">for</span> key, <span class="hljs-variable language_">module</span> <span class="hljs-keyword">in</span> modules.<span class="hljs-title function_">items</span>():
                string += f<span class="hljs-string">&quot;\n{tab}({key}): {module.get_name()}({module.inner_repr()})&quot;</span>
        <span class="hljs-keyword">return</span> f<span class="hljs-string">&#x27;{string}\n)&#x27;</span>
    
    def <span class="hljs-title function_">get_name</span>(self):
        <span class="hljs-keyword">return</span> self.<span class="hljs-property">__class__</span>.<span class="hljs-property">__name__</span>
    
    def <span class="hljs-title function_">__setattr__</span>(self, key, value):
        self.<span class="hljs-property">__dict__</span>[key] = value

        <span class="hljs-keyword">if</span> <span class="hljs-title function_">isinstance</span>(value, <span class="hljs-title class_">Module</span>):
            self.<span class="hljs-property">_modules</span>[key] = value
        elif <span class="hljs-title function_">isinstance</span>(value, <span class="hljs-title class_">Parameter</span>):
            self.<span class="hljs-property">_params</span>[key] = value
</code></pre>
<p>ì˜ˆë¥¼ ë“¤ì–´, nn.Moduleì„ ìƒì†í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ ëª¨ë“ˆì„ ë§Œë“¤ê±°ë‚˜, ì´ì „ì— ìƒì„±ëœ ëª¨ë“ˆ ì¤‘ í•˜ë‚˜ì¸ ì„ í˜• ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ y = Wx + b ì‘ì—…ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"># norch/nn/modules/linear.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> ..<span class="hljs-property">module</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Module</span>
<span class="hljs-keyword">from</span> ..<span class="hljs-property">parameter</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Parameter</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Linear</span>(<span class="hljs-title class_">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self, input_dim, output_dim):
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>()
        self.<span class="hljs-property">input_dim</span> = input_dim
        self.<span class="hljs-property">output_dim</span> = output_dim
        self.<span class="hljs-property">weight</span> = <span class="hljs-title class_">Parameter</span>(shape=[self.<span class="hljs-property">output_dim</span>, self.<span class="hljs-property">input_dim</span>])
        self.<span class="hljs-property">bias</span> = <span class="hljs-title class_">Parameter</span>(shape=[self.<span class="hljs-property">output_dim</span>, <span class="hljs-number">1</span>])

    def <span class="hljs-title function_">forward</span>(self, x):
        z = self.<span class="hljs-property">weight</span> @ x + self.<span class="hljs-property">bias</span>
        <span class="hljs-keyword">return</span> z

    def <span class="hljs-title function_">inner_repr</span>(self):
        <span class="hljs-keyword">return</span> f<span class="hljs-string">&quot;input_dim={self.input_dim}, output_dim={self.output_dim}, &quot;</span> \
               f<span class="hljs-string">&quot;bias={True if self.bias is not None else False}&quot;</span>
</code></pre>
<p>ì´ì œ ëª‡ ê°€ì§€ ì†ì‹¤ ë° í™œì„±í™” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í‰ê·  ì œê³± ì˜¤ì°¨ ì†ì‹¤ ë° ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜:</p>
<pre><code class="hljs language-js"># norch/nn/loss.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> .<span class="hljs-property">module</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Module</span>
 
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MSELoss</span>(<span class="hljs-title class_">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self):
      pass

    def <span class="hljs-title function_">forward</span>(self, predictions, labels):
        assert labels.<span class="hljs-property">shape</span> == predictions.<span class="hljs-property">shape</span>, \
            <span class="hljs-string">&quot;Labels and predictions shape does not match: {} and {}&quot;</span>.<span class="hljs-title function_">format</span>(labels.<span class="hljs-property">shape</span>, predictions.<span class="hljs-property">shape</span>)
        
        <span class="hljs-keyword">return</span> ((predictions - labels) ** <span class="hljs-number">2</span>).<span class="hljs-title function_">sum</span>() / predictions.<span class="hljs-property">numel</span>

    def <span class="hljs-title function_">__call__</span>(self, *inputs):
        <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">forward</span>(*inputs)
</code></pre>
<pre><code class="hljs language-js"># norch/nn/activation.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> .<span class="hljs-property">module</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Module</span>
<span class="hljs-keyword">import</span> math

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Sigmoid</span>(<span class="hljs-title class_">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self):
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>()

    def <span class="hljs-title function_">forward</span>(self, x):
        <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span> / (<span class="hljs-number">1.0</span> + (math.<span class="hljs-property">e</span>) ** (-x)) 
</code></pre>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì˜µí‹°ë§ˆì´ì €ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤. ì˜ˆì‹œë¡œ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent) ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"># norch/optim/optimizer.<span class="hljs-property">py</span>

<span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> <span class="hljs-variable constant_">ABC</span>
<span class="hljs-keyword">from</span> norch.<span class="hljs-property">tensor</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">Tensor</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Optimizer</span>(<span class="hljs-variable constant_">ABC</span>):
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
    ì˜µí‹°ë§ˆì´ì €ë¥¼ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤
    &quot;</span><span class="hljs-string">&quot;&quot;</span>

    def <span class="hljs-title function_">__init__</span>(self, parameters):
        <span class="hljs-keyword">if</span> <span class="hljs-title function_">isinstance</span>(parameters, <span class="hljs-title class_">Tensor</span>):
            raise <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;parametersëŠ” ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´ì´ì–´ì•¼ í•˜ì§€ë§Œ {} íƒ€ì…ì´ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤&quot;</span>.<span class="hljs-title function_">format</span>(<span class="hljs-title function_">type</span>(parameters)))
        elif <span class="hljs-title function_">isinstance</span>(parameters, dict):
            parameters = parameters.<span class="hljs-title function_">values</span>()

        self.<span class="hljs-property">parameters</span> = <span class="hljs-title function_">list</span>(parameters)

    def <span class="hljs-title function_">step</span>(self):
        raise <span class="hljs-title class_">NotImplementedError</span>
    
    def <span class="hljs-title function_">zero_grad</span>(self):
        <span class="hljs-keyword">for</span> <span class="hljs-variable language_">module</span>, name, parameter <span class="hljs-keyword">in</span> self.<span class="hljs-property">parameters</span>:
            parameter.<span class="hljs-title function_">zero_grad</span>()


<span class="hljs-keyword">class</span> <span class="hljs-title class_">SGD</span>(<span class="hljs-title class_">Optimizer</span>):
    def <span class="hljs-title function_">__init__</span>(self, parameters, lr=<span class="hljs-number">1e-1</span>, momentum=<span class="hljs-number">0</span>):
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>(parameters)
        self.<span class="hljs-property">lr</span> = lr
        self.<span class="hljs-property">momentum</span> = momentum
        self.<span class="hljs-property">_cache</span> = {<span class="hljs-string">&#x27;velocity&#x27;</span>: [p.<span class="hljs-title function_">zeros_like</span>() <span class="hljs-keyword">for</span> (_, _, p) <span class="hljs-keyword">in</span> self.<span class="hljs-property">parameters</span>]}

    def <span class="hljs-title function_">step</span>(self):
        <span class="hljs-keyword">for</span> i, (<span class="hljs-variable language_">module</span>, name, _) <span class="hljs-keyword">in</span> <span class="hljs-title function_">enumerate</span>(self.<span class="hljs-property">parameters</span>):
            parameter = <span class="hljs-title function_">getattr</span>(<span class="hljs-variable language_">module</span>, name)

            velocity = self.<span class="hljs-property">_cache</span>[<span class="hljs-string">&#x27;velocity&#x27;</span>][i]

            velocity = self.<span class="hljs-property">momentum</span> * velocity - self.<span class="hljs-property">lr</span> * parameter.<span class="hljs-property">grad</span>

            updated_parameter = parameter + velocity

            <span class="hljs-title function_">setattr</span>(<span class="hljs-variable language_">module</span>, name, updated_parameter)

            self.<span class="hljs-property">_cache</span>[<span class="hljs-string">&#x27;velocity&#x27;</span>][i] = velocity

            parameter.<span class="hljs-title function_">detach</span>()
            velocity.<span class="hljs-title function_">detach</span>()
</code></pre>
<p>ê·¸ë¦¬ê³  ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤! ì´ì œ ìš°ë¦¬ë§Œì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ì—ˆì–´ìš”! ğŸ¥³</p>
<p>ì´ì œ í•™ìŠµì„ ì‹œì‘í•´ë´…ì‹œë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> norch
<span class="hljs-keyword">import</span> norch.<span class="hljs-property">nn</span> <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> norch.<span class="hljs-property">optim</span> <span class="hljs-keyword">as</span> optim
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> math

random.<span class="hljs-title function_">seed</span>(<span class="hljs-number">1</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.<span class="hljs-property">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self):
        <span class="hljs-variable language_">super</span>(<span class="hljs-title class_">MyModel</span>, self).<span class="hljs-title function_">__init__</span>()
        self.<span class="hljs-property">fc1</span> = nn.<span class="hljs-title class_">Linear</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)
        self.<span class="hljs-property">sigmoid</span> = nn.<span class="hljs-title class_">Sigmoid</span>()
        self.<span class="hljs-property">fc2</span> = nn.<span class="hljs-title class_">Linear</span>(<span class="hljs-number">10</span>, <span class="hljs-number">1</span>)

    def <span class="hljs-title function_">forward</span>(self, x):
        out = self.<span class="hljs-title function_">fc1</span>(x)
        out = self.<span class="hljs-title function_">sigmoid</span>(out)
        out = self.<span class="hljs-title function_">fc2</span>(out)
        
        <span class="hljs-keyword">return</span> out

device = <span class="hljs-string">&quot;cuda&quot;</span>
epochs = <span class="hljs-number">10</span>

model = <span class="hljs-title class_">MyModel</span>().<span class="hljs-title function_">to</span>(device)
criterion = nn.<span class="hljs-title class_">MSELoss</span>()
optimizer = optim.<span class="hljs-title function_">SGD</span>(model.<span class="hljs-title function_">parameters</span>(), lr=<span class="hljs-number">0.001</span>)
loss_list = []

x_values = [<span class="hljs-number">0.</span> ,  <span class="hljs-number">0.4</span>,  <span class="hljs-number">0.8</span>,  <span class="hljs-number">1.2</span>,  <span class="hljs-number">1.6</span>,  <span class="hljs-number">2.</span> ,  <span class="hljs-number">2.4</span>,  <span class="hljs-number">2.8</span>,  <span class="hljs-number">3.2</span>,  <span class="hljs-number">3.6</span>,  <span class="hljs-number">4.</span> ,
        <span class="hljs-number">4.4</span>,  <span class="hljs-number">4.8</span>,  <span class="hljs-number">5.2</span>,  <span class="hljs-number">5.6</span>,  <span class="hljs-number">6.</span> ,  <span class="hljs-number">6.4</span>,  <span class="hljs-number">6.8</span>,  <span class="hljs-number">7.2</span>,  <span class="hljs-number">7.6</span>,  <span class="hljs-number">8.</span> ,  <span class="hljs-number">8.4</span>,
        <span class="hljs-number">8.8</span>,  <span class="hljs-number">9.2</span>,  <span class="hljs-number">9.6</span>, <span class="hljs-number">10.</span> , <span class="hljs-number">10.4</span>, <span class="hljs-number">10.8</span>, <span class="hljs-number">11.2</span>, <span class="hljs-number">11.6</span>, <span class="hljs-number">12.</span> , <span class="hljs-number">12.4</span>, <span class="hljs-number">12.8</span>,
       <span class="hljs-number">13.2</span>, <span class="hljs-number">13.6</span>, <span class="hljs-number">14.</span> , <span class="hljs-number">14.4</span>, <span class="hljs-number">14.8</span>, <span class="hljs-number">15.2</span>, <span class="hljs-number">15.6</span>, <span class="hljs-number">16.</span> , <span class="hljs-number">16.4</span>, <span class="hljs-number">16.8</span>, <span class="hljs-number">17.2</span>,
       <span class="hljs-number">17.6</span>, <span class="hljs-number">18.</span> , <span class="hljs-number">18.4</span>, <span class="hljs-number">18.8</span>, <span class="hljs-number">19.2</span>, <span class="hljs-number">19.6</span>, <span class="hljs-number">20.</span>]

y_true = []
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-attr">x_values</span>:
    y_true.<span class="hljs-title function_">append</span>(math.<span class="hljs-title function_">pow</span>(math.<span class="hljs-title function_">sin</span>(x), <span class="hljs-number">2</span>))


<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(epochs):
    <span class="hljs-keyword">for</span> x, target <span class="hljs-keyword">in</span> <span class="hljs-title function_">zip</span>(x_values, y_true):
        x = norch.<span class="hljs-title class_">Tensor</span>([[x]]).<span class="hljs-property">T</span>
        target = norch.<span class="hljs-title class_">Tensor</span>([[target]]).<span class="hljs-property">T</span>

        x = x.<span class="hljs-title function_">to</span>(device)
        target = target.<span class="hljs-title function_">to</span>(device)

        outputs = <span class="hljs-title function_">model</span>(x)
        loss = <span class="hljs-title function_">criterion</span>(outputs, target)
        
        optimizer.<span class="hljs-title function_">zero_grad</span>()
        loss.<span class="hljs-title function_">backward</span>()
        optimizer.<span class="hljs-title function_">step</span>()

    <span class="hljs-title function_">print</span>(f<span class="hljs-string">&#x27;Epoch [{epoch + 1}/{epochs}], Loss: {loss[0]:.4f}&#x27;</span>)
    loss_list.<span class="hljs-title function_">append</span>(loss[<span class="hljs-number">0</span>])

# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">1</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">1.7035</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">2</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.7193</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">3</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.3068</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">4</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1742</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">5</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1342</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">6</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1232</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">7</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1220</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">8</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1241</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">9</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1270</span>
# <span class="hljs-title class_">Epoch</span> [<span class="hljs-number">10</span>/<span class="hljs-number">10</span>], <span class="hljs-title class_">Loss</span>: <span class="hljs-number">0.1297</span>
</code></pre>
<img src="/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_23.png"/>
<p>ì„±ê³µì ìœ¼ë¡œ ëª¨ë¸ì´ ìƒì„±ë˜ê³  ì‚¬ìš©ì ì •ì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
<p>ì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1>ê²°ë¡ </h1>
<p>ì´ ê²Œì‹œë¬¼ì—ì„œëŠ” í…ì„œì™€ ê°™ì€ ê¸°ë³¸ ê°œë…, ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€, CUDA ë° Autogradì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œ ë“±ì„ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ì´ ê°€ëŠ¥í•œ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ ê²Œì‹œë¬¼ì´ ì—¬ëŸ¬ë¶„ì´ PyTorchê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê°„ëµíˆ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.</p>
<p>ì•ìœ¼ë¡œì˜ ê²Œì‹œë¬¼ì—ì„œëŠ” ë¶„ì‚° í›ˆë ¨(ë‹¤ì¤‘ ë…¸ë“œ/ë‹¤ì¤‘ GPU) ë° ë©”ëª¨ë¦¬ ê´€ë¦¬ì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œë¥¼ ë‹¤ë£¨ë ¤ê³  í•  ê²ƒì…ë‹ˆë‹¤. ì˜ê²¬ì´ ìˆê±°ë‚˜ ë‹¤ìŒì— ì–´ë–¤ ë‚´ìš©ì„ ë‹¤ë£¨ê¸¸ ì›í•˜ì‹œëŠ”ì§€ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”! ì½ì–´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š</p>
<p>ë˜í•œ ìµœì‹  ê¸°ì‚¬ë¥¼ ë°›ì•„ë³´ê¸° ìœ„í•´ ì—¬ê¸°ì™€ ì œ LinkedIn í”„ë¡œí•„ì—ì„œ íŒ”ë¡œìš°í•´ ì£¼ì„¸ìš”!</p>
<h1>ì°¸ê³  ìë£Œ</h1>
<ul>
<li><a href="https://github.com">PyNorch</a> - ì´ í”„ë¡œì íŠ¸ì˜ GitHub ì €ì¥ì†Œ</li>
<li><a href="https://www.example.com/tutorial-cuda">CUDA íŠœí† ë¦¬ì–¼</a> - CUDA ì‘ë™ ë°©ì‹ì— ëŒ€í•œ ê°„ë‹¨í•œ ì†Œê°œ</li>
<li><a href="https://pytorch.org/docs">PyTorch</a> - PyTorch ë¬¸ì„œ</li>
</ul>
<h1>MartinLwx&#x27;s ë¸”ë¡œê·¸ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ íŠœí† ë¦¬ì–¼.</h1>
<h1>ìŠ¤íŠ¸ë¼ì´ë“œ íŠœí† ë¦¬ì–¼ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ ë˜ ë‹¤ë¥¸ íŠœí† ë¦¬ì–¼.</h1>
<h1>PyTorch ë‚´ë¶€ êµ¬ì¡° - PyTorch êµ¬ì¡°ì— ëŒ€í•œ ê°€ì´ë“œ.</h1>
<h1>ë„¤ì¸  - NumPyë¥¼ ì‚¬ìš©í•œ PyTorch ì¬êµ¬í˜„.</h1>
<p>Markdownìœ¼ë¡œ í‘œ íƒœê·¸ë¥¼ ë³€ê²½í•˜ì‹­ì‹œì˜¤.</p></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"íŒŒì´í† ì¹˜ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë§Œë“¤ì–´ë³´ê¸° GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ í¬í•¨","description":"","date":"2024-05-15 10:33","slug":"2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation","content":"\n\n## C/C++, CUDA, ë° Pythonì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê³ ìœ ì˜ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ êµ¬ì¶•í•´ ë³´ì„¸ìš”. GPU ì§€ì›ê³¼ ìë™ ë¯¸ë¶„ì„ ì œê³µí•©ë‹ˆë‹¤\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png)\n\n# ì†Œê°œ\n\nì—¬ëŸ¬ í•´ ë™ì•ˆ PyTorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³  í›ˆë ¨í•´ ì™”ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³ , ê·¸ ë¬¸ë²•ê³¼ ê·œì¹™ì„ ìµíˆê³ ë„, ì œ ê¶ê¸ˆì¦ì„ ìê·¹í•˜ë˜ ê²ƒì´ ìˆì—ˆìŠµë‹ˆë‹¤: ì´ëŸ¬í•œ ì‘ì—… ì¤‘ì— ë‚´ë¶€ì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ” ê±¸ê¹Œìš”? ì´ ëª¨ë“  ê²ƒì´ ì–´ë–»ê²Œ ì‘ë™í• ê¹Œìš”?\n\n\n\nì—¬ê¸°ê¹Œì§€ ì˜¤ì…¨ë‹¤ë©´, ì•„ë§ˆë„ ë¹„ìŠ·í•œ ì§ˆë¬¸ì„ ê°€ì§€ê³  ê³„ì‹¤ ê²ƒì…ë‹ˆë‹¤. íŒŒì´í† ì¹˜(PyTorch)ì—ì„œ ëª¨ë¸ì„ ìƒì„±í•˜ê³  í›ˆë ¨í•˜ëŠ” ë°©ë²•ì„ ë¬¼ì–´ë³¸ë‹¤ë©´ ì•„ë§ˆë„ ì•„ë˜ ì½”ë“œì™€ ë¹„ìŠ·í•œ ê²ƒì„ ìƒê°í•´ë³¼ ê²ƒì…ë‹ˆë‹¤:\n\n```js\nimport torch\nimport torch.nn as nn\nimport torch.optim as optim\n\nclass MyModel(nn.Module):\n    def __init__(self):\n        super(MyModel, self).__init__()\n        self.fc1 = nn.Linear(1, 10)\n        self.sigmoid = nn.Sigmoid()\n        self.fc2 = nn.Linear(10, 1)\n\n    def forward(self, x):\n        out = self.fc1(x)\n        out = self.sigmoid(out)\n        out = self.fc2(out)\n        \n        return out\n\n...\n\nmodel = MyModel().to(device)\ncriterion = nn.MSELoss()\noptimizer = optim.SGD(model.parameters(), lr=0.001)\n\nfor epoch in range(epochs):\n    for x, y in ...\n        \n        x = x.to(device)\n        y = y.to(device)\n\n        outputs = model(x)\n        loss = criterion(outputs, y)\n        \n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n```\n\ní•˜ì§€ë§Œ ì´ë²ˆì— ì—­ì „íŒŒ(backward) ë‹¨ê³„ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ë¬¼ì–´ë³¸ë‹¤ë©´ ì–´ë–¨ê¹Œìš”? ë˜ëŠ” ì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•  ë•Œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ìš”? ë‚´ë¶€ì—ì„œ ë°ì´í„°ê°€ ì¬ë°°ì¹˜ë˜ë‚˜ìš”? ê·¸ëŸ° ì¼ì´ ì–´ë–»ê²Œ ì¼ì–´ë‚˜ë‚˜ìš”? ì™œ PyTorchëŠ” ë¹ ë¥¸ê°€ìš”? PyTorchê°€ GPU ì—°ì‚°ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ìš”? ì´ëŸ° ì§ˆë¬¸ë“¤ì´ í•­ìƒ ì €ë¥¼ í˜¸ê¸°ì‹¬ ê°€ë“í•˜ê²Œ ë§Œë“¤ì—ˆê³ , ì—¬ëŸ¬ë¶„ë„ ë§ˆì°¬ê°€ì§€ë¡œ í˜¸ê¸°ì‹¬ì´ ë“œì‹¤ ê²ƒì´ë¼ê³  ìƒìƒí•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ëŸ¬í•œ ê°œë…ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ ìŠ¤ìŠ¤ë¡œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì²˜ìŒë¶€í„° êµ¬ì¶•í•´ë³´ëŠ” ê²ƒì´ ë¬´ì—‡ë³´ë‹¤ ì¢‹ì„ê¹Œìš”? ì´ ê¸€ì—ì„œ ì—¬ëŸ¬ë¶„ì´ ë°°ìš°ê²Œ ë  ê²ƒì´ ë°”ë¡œ ê·¸ê²ë‹ˆë‹¤!\n\n## #1 â€” í…ì„œ\n\n\n\ní…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ê°€ì¥ ë¨¼ì € ì•Œì•„ì•¼ í•  ê°œë…ì€ ë¬´ì—‡ì´ í…ì„œì¸ì§€ì— ëŒ€í•œ ëª…ë°±í•œ ê°œë…ì…ë‹ˆë‹¤.\n\ní…ì„œëŠ” ëª‡ ê°€ì§€ ìˆ«ìë¥¼ í¬í•¨í•˜ëŠ” nì°¨ì› ë°ì´í„° êµ¬ì¡°ì˜ ìˆ˜í•™ì  ê°œë…ì´ë¼ëŠ” ì§ê´€ì ì¸ ìƒê°ì„ ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ê¸°ì„œëŠ” ì´ ë°ì´í„° êµ¬ì¡°ë¥¼ ê³„ì‚°ì  ê´€ì ì—ì„œ ì–´ë–»ê²Œ ëª¨ë¸ë§í• ì§€ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤. í…ì„œëŠ” ë°ì´í„° ìì²´ë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ì–‘ì´ë‚˜ í…ì„œê°€ ìˆëŠ” ì¥ì¹˜(ì˜ˆ: CPU ë©”ëª¨ë¦¬, GPU ë©”ëª¨ë¦¬)ì™€ ê°™ì€ ì¸¡ë©´ì„ ì„¤ëª…í•˜ëŠ” ë©”íƒ€ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\ní…ì„œì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ëŠ” ë° ë§¤ìš° ì¤‘ìš”í•œ ê°œë…ì¸ strideë¼ëŠ” ì˜ ì•Œë ¤ì§€ì§€ ì•Šì€ ë©”íƒ€ë°ì´í„°ë„ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í…ì„œ ë°ì´í„° ì¬ë°°ì—´ì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ ì•½ê°„ ë” ì´ì— ëŒ€í•´ ë…¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.\n\n\n\n2-D í…ì„œì˜ ëª¨ì–‘ì´ [4, 8]ì¸ ê²½ìš°ë¥¼ ìƒìƒí•´ë³´ì„¸ìš”.\n\n![í…ì„œ](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_2.png)\n\ní…ì„œì˜ ë°ì´í„°(ì¦‰, ë¶€ë™ ì†Œìˆ˜ì  ìˆ˜)ëŠ” ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ì— 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\n\n![ë°ì´í„°](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_3.png)\n\n\n\nê·¸ëŸ¬ë©´ ì´ 1ì°¨ì› ë°°ì—´ì„ Nì°¨ì› í…ì„œë¡œ ë‚˜íƒ€ë‚´ë ¤ë©´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n4í–‰ 8ì—´ì˜ í–‰ë ¬ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ í–‰ë ¬ì˜ ëª¨ë“  ì›ì†Œê°€ 1ì°¨ì› ë°°ì—´ì˜ í–‰ì— ì˜í•´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ, ìœ„ì¹˜ [2, 3]ì˜ ê°’ì„ ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ 2í–‰(ê° í–‰ì— 8ê°œì˜ ìš”ì†Œ)ì„ íš¡ë‹¨í•´ì•¼ í•˜ë©° ì¶”ê°€ë¡œ 3ê°œì˜ ìœ„ì¹˜ë¥¼ ì§€ë‚˜ì•¼ í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ 1ì°¨ì› ë°°ì—´ì—ì„œ 3 + 2 * 8 ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.\n\në”°ë¼ì„œ, '8'ì€ ë‘ ë²ˆì§¸ ì°¨ì›ì˜ ìŠ¤íŠ¸ë¼ì´ë“œì…ë‹ˆë‹¤. ì´ ê²½ìš°, ë°°ì—´ì—ì„œ ë‹¤ë¥¸ ìœ„ì¹˜ë¡œ \"ì í”„\"í•˜ê¸° ìœ„í•´ ëª‡ ê°œì˜ ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ë³´ì…ë‹ˆë‹¤.\n\n\n\në”°ë¼ì„œ, ëª¨ì–‘ì´ [shape_0, shape_1]ì¸ 2ì°¨ì› í…ì„œì˜ ìš”ì†Œ [i, j]ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´, ê¸°ë³¸ì ìœ¼ë¡œ j + i * shape_1 ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤.\n\nì´ì œ 3ì°¨ì› í…ì„œë¥¼ ìƒìƒí•´ë³´ê² ìŠµë‹ˆë‹¤:\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_5.png)\n\nì´ 3ì°¨ì› í…ì„œë¥¼ í–‰ë ¬ì˜ ì‹œí€€ìŠ¤ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ [5, 4, 8] í…ì„œë¥¼ [4, 8] ëª¨ì–‘ì˜ 5ê°œ í–‰ë ¬ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\n\nì´ì œ [1, 3, 7] ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•´ [4,8] í˜•íƒœì˜ í–‰ë ¬ì„ 1ê°œ ì™„ì „íˆ íš¡ë‹¨í•˜ê³ , [8] í˜•íƒœì˜ í–‰ì„ 2ê°œ, [1] í˜•íƒœì˜ ì—´ì„ 7ê°œ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ 1ì°¨ì› ë°°ì—´ì—ì„œ (1 * 4 * 8) + (2 * 8) + (7 * 1) ìœ„ì¹˜ë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_6.png)\n\në”°ë¼ì„œ, [shape_0, shape_1, shape_2] ëª¨ì–‘ì˜ 3ì°¨ì› í…ì„œì—ì„œ 1ì°¨ì› ë°ì´í„° ë°°ì—´ì—ì„œ [i][j][k] ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_7.png)\n\n\n\nì´ shape_1 * shape_2ê°€ ì²« ë²ˆì§¸ ì°¨ì›ì˜ strideì´ê³ , shape_2ëŠ” ë‘ ë²ˆì§¸ ì°¨ì›ì˜ strideì´ë©° 1ì€ ì„¸ ë²ˆì§¸ ì°¨ì›ì˜ strideì…ë‹ˆë‹¤.\n\nê·¸ëŸ° ë‹¤ìŒ, ì¼ë°˜í™”í•˜ê¸° ìœ„í•´ì„œëŠ”:\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_8.png)\n\nê° ì°¨ì›ì˜ strideëŠ” ë‹¤ìŒ ì°¨ì› í…ì„œ ëª¨ì–‘ì˜ ê³±ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\n\n\u003cimg src=\"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_9.png\" /\u003e\n\nê·¸ëŸ° ë‹¤ìŒ stride[n-1] = 1ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\n\nìš°ë¦¬ì˜ í˜•íƒœì˜ í…ì„œ ì˜ˆì œ [5, 4, 8]ì—ì„œ strides = [4*8, 8, 1] = [32, 8, 1]ì¼ ê²ƒì…ë‹ˆë‹¤.\n\nì—¬ëŸ¬ë¶„ë“¤ë„ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆì–´ìš”:\n\n\n\n```js\nimport torch\n\ntorch.rand([5, 4, 8]).stride()\n#(32, 8, 1)\n```\n\nì•Œê² ì–´ìš”, ê·¸ëŸ°ë° ì™œ ëª¨ì–‘ê³¼ ìŠ¤íŠ¸ë¼ì´ë“œê°€ í•„ìš”í•œ ê±´ê°€ìš”? Nì°¨ì› í…ì„œì˜ ìš”ì†Œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë„˜ì–´, ì´ ê°œë…ì€ í…ì„œ ë°°ì—´ì„ ë§¤ìš° ì‰½ê²Œ ì¡°ì‘í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆì–´ìš”.\n\nì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•˜ë ¤ë©´ ìƒˆë¡œìš´ ëª¨ì–‘ì„ ì„¤ì •í•˜ê³  ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ê³„ì‚°í•˜ë©´ ë©ë‹ˆë‹¤! (ìƒˆë¡œìš´ ëª¨ì–‘ì€ ë™ì¼í•œ ìš”ì†Œ ìˆ˜ë¥¼ ë³´ì¥í•˜ë¯€ë¡œ)\n\n```js\nimport torch\n\nt = torch.rand([5, 4, 8])\n\nprint(t.shape)\n# [5, 4, 8]\n\nprint(t.stride())\n# [32, 8, 1]\n\nnew_t = t.reshape([4, 5, 2, 2, 2])\n\nprint(new_t.shape)\n# [4, 5, 2, 2, 2]\n\nprint(new_t.stride())\n# [40, 8, 4, 2, 1]\n``` \n\n\n\n\ní…ì„œ ë‚´ë¶€ì—ì„œëŠ” ì—¬ì „íˆ ë™ì¼í•œ 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤. reshape ë©”ì„œë“œëŠ” ë°°ì—´ ë‚´ ìš”ì†Œì˜ ìˆœì„œë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤! ëŒ€ë‹¨í•˜ì§€ ì•Šë‚˜ìš”? ğŸ˜\n\në‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ PyTorchì—ì„œ ë‚´ë¶€ 1ì°¨ì› ë°°ì—´ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nimport ctypes\n\ndef print_internal(t: torch.Tensor):\n    print(\n        torch.frombuffer(\n            ctypes.string_at(t.data_ptr(), t.storage().nbytes()), dtype=t.dtype\n        )\n    )\n\nprint_internal(t)\n# [0.0752, 0.5898, 0.3930, 0.9577, 0.2276, 0.9786, 0.1009, 0.138, ...\n\nprint_internal(new_t)\n# [0.0752, 0.5898, 0.3930, 0.9577, 0.2276, 0.9786, 0.1009, 0.138, ...\n```\n\nì˜ˆë¥¼ ë“¤ì–´ ë‘ ì¶•ì„ ì „ì¹˜í•˜ë ¤ë©´ ë‚´ë¶€ì ìœ¼ë¡œ í•´ë‹¹ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ë‹¨ìˆœíˆ ë°”ê¾¸ì–´ ì£¼ë©´ ë©ë‹ˆë‹¤!\n\n\n\n```js\nt = torch.arange(0, 24).reshape(2, 3, 4)\nprint(t)\n# [[[ 0,  1,  2,  3],\n#   [ 4,  5,  6,  7],\n#   [ 8,  9, 10, 11]],\n \n#  [[12, 13, 14, 15],\n#   [16, 17, 18, 19],\n#   [20, 21, 22, 23]]]\n\nprint(t.shape)\n# [2, 3, 4]\n\nprint(t.stride())\n# [12, 4, 1]\n\nnew_t = t.transpose(0, 1)\nprint(new_t)\n# [[[ 0,  1,  2,  3],\n#   [12, 13, 14, 15]],\n\n#  [[ 4,  5,  6,  7],\n#   [16, 17, 18, 19]],\n\n#  [[ 8,  9, 10, 11],\n#   [20, 21, 22, 23]]]\n\nprint(new_t.shape)\n# [3, 2, 4]\n\nprint(new_t.stride())\n# [4, 12, 1]\n```\n\në‚´ë¶€ ë°°ì—´ì„ ì¶œë ¥í•˜ë©´ ë‘ ê°’ ëª¨ë‘ ë™ì¼í•©ë‹ˆë‹¤:\n\n```js\nprint_internal(t)\n# [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]\n\nprint_internal(new_t)\n# [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]\n```\n\nê·¸ëŸ¬ë‚˜ new_tì˜ ìŠ¤íŠ¸ë¼ì´ë“œëŠ” ì´ì œ ìœ„ì˜ ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ê²ƒì€ í…ì„œê°€ ì´ì œ ì—°ì†ì ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤. ì¦‰, ë‚´ë¶€ ë°°ì—´ì€ ë™ì¼í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ ë‚´ì˜ ê°’ì˜ ìˆœì„œê°€ í…ì„œì˜ ì‹¤ì œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.```\n\n\n\n```js\nt.is_contiguous()\n# True\n\nnew_t.is_contiguous()\n# False\n```\n\nì´ëŠ” ì—°ì†ë˜ì§€ ì•ŠëŠ” ìš”ì†Œì— ì—°ì†ì ìœ¼ë¡œ ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤ (ì‹¤ì œ í…ì„œ ìš”ì†ŒëŠ” ë©”ëª¨ë¦¬ ìƒì—ì„œ ìˆœì„œëŒ€ë¡œ ì •ë ¬ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤). ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nnew_t_contiguous = new_t.contiguous()\n\nprint(new_t_contiguous.is_contiguous())\n# True\n```\n\në‚´ë¶€ ë°°ì—´ì„ ë¶„ì„í•˜ë©´ ì´ì œ ìˆœì„œê°€ ì‹¤ì œ í…ì„œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì—¬ ë” ë‚˜ì€ ë©”ëª¨ë¦¬ ì•¡ì„¸ìŠ¤ íš¨ìœ¨ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:```\n\n\n\n```js\nprint(new_t)\n# [[[ 0,  1,  2,  3],\n#   [12, 13, 14, 15]],\n\n#  [[ 4,  5,  6,  7],\n#   [16, 17, 18, 19]],\n\n#  [[ 8,  9, 10, 11],\n#   [20, 21, 22, 23]]]\n\nprint_internal(new_t)\n# [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]\n\nprint_internal(new_t_contiguous)\n# [ 0,  1,  2,  3, 12, 13, 14, 15,  4,  5,  6,  7, 16, 17, 18, 19,  8,  9, 10, 11, 20, 21, 22, 23]\n```\n\nì´ì œ ìš°ë¦¬ëŠ” í…ì„œê°€ ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€ ì´í•´í–ˆìœ¼ë‹ˆ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„±ì„ ì‹œì‘í•´ ë´…ì‹œë‹¤!\n\në‚´ê°€ ë§Œë“¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ì€ Norchì…ë‹ˆë‹¤. PyTorchê°€ ì•„ë‹Œ (NOT PyTorch)ì„ ì˜ë¯¸í•˜ë©°, ì„±(Nogueira)ì„ ì•”ì‹œí•˜ê¸°ë„ í•©ë‹ˆë‹¤. ğŸ˜\n\nì²« ë²ˆì§¸ë¡œ ì•Œì•„ì•¼ í•  ê²ƒì€ PyTorchê°€ Pythonì„ í†µí•´ ì‚¬ìš©ë˜ì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” C/C++ë¡œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë¨¼ì € ë‚´ë¶€ C/C++ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤.\n\n\n\n\në¨¼ì € í…ì„œë¥¼ ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¡œ ì •ì˜í•˜ê³  ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ í•¨ìˆ˜ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n//norch/csrc/tensor.cpp\n\n#include \u003cstdio.h\u003e\n#include \u003cstdlib.h\u003e\n#include \u003cstring.h\u003e\n#include \u003cmath.h\u003e\n\ntypedef struct {\n    float* data;\n    int* strides;\n    int* shape;\n    int ndim;\n    int size;\n    char* device;\n} Tensor;\n\nTensor* create_tensor(float* data, int* shape, int ndim) {\n    \n    Tensor* tensor = (Tensor*)malloc(sizeof(Tensor));\n    if (tensor == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n    tensor-\u003edata = data;\n    tensor-\u003eshape = shape;\n    tensor-\u003endim = ndim;\n\n    tensor-\u003esize = 1;\n    for (int i = 0; i \u003c ndim; i++) {\n        tensor-\u003esize *= shape[i];\n    }\n\n    tensor-\u003estrides = (int*)malloc(ndim * sizeof(int));\n    if (tensor-\u003estrides == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n    int stride = 1;\n    for (int i = ndim - 1; i \u003e= 0; i--) {\n        tensor-\u003estrides[i] = stride;\n        stride *= shape[i];\n    }\n    \n    return tensor;\n}\n```\n\nì¼ë¶€ ìš”ì†Œì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” ì•ì„œ ë°°ì› ë˜ ìŠ¤íŠ¸ë¼ì´ë“œ(strides)ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n//norch/csrc/tensor.cpp\n\nfloat get_item(Tensor* tensor, int* indices) {\n    int index = 0;\n    for (int i = 0; i \u003c tensor-\u003endim; i++) {\n        index += indices[i] * tensor-\u003estrides[i];\n    }\n\n    float result;\n    result = tensor-\u003edata[index];\n\n    return result;\n}\n```\n\n\n\nì´ì œ í…ì„œ ì‘ì—…ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª‡ ê°€ì§€ ì˜ˆì œë¥¼ ë³´ì—¬ë“œë¦¬ê² ê³ , ì´ ê¸€ ëì— ë§í¬ëœ ì €ì¥ì†Œì—ì„œ ì™„ì „í•œ ë²„ì „ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\n//norch/csrc/cpu.cpp\n\nvoid add_tensor_cpu(Tensor* tensor1, Tensor* tensor2, float* result_data) {\n    \n    for (int i = 0; i \u003c tensor1-\u003esize; i++) {\n        result_data[i] = tensor1-\u003edata[i] + tensor2-\u003edata[i];\n    }\n}\n\nvoid sub_tensor_cpu(Tensor* tensor1, Tensor* tensor2, float* result_data) {\n    \n    for (int i = 0; i \u003c tensor1-\u003esize; i++) {\n        result_data[i] = tensor1-\u003edata[i] - tensor2-\u003edata[i];\n    }\n}\n\nvoid elementwise_mul_tensor_cpu(Tensor* tensor1, Tensor* tensor2, float* result_data) {\n    \n    for (int i = 0; i \u003c tensor1-\u003esize; i++) {\n        result_data[i] = tensor1-\u003edata[i] * tensor2-\u003edata[i];\n    }\n}\n\nvoid assign_tensor_cpu(Tensor* tensor, float* result_data) {\n\n    for (int i = 0; i \u003c tensor-\u003esize; i++) {\n        result_data[i] = tensor-\u003edata[i];\n    }\n}\n\n...\n```\n\nê·¸ ë‹¤ìŒì—, ì´ëŸ¬í•œ ì‘ì—…ë“¤ì„ í˜¸ì¶œí•  í…ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\n//norch/csrc/tensor.cpp\n\nTensor* add_tensor(Tensor* tensor1, Tensor* tensor2) {\n    if (tensor1-\u003endim != tensor2-\u003endim) {\n        fprintf(stderr, \"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d\\n\", tensor1-\u003endim, tensor2-\u003endim);\n        exit(1);\n    }\n\n    int ndim = tensor1-\u003endim;\n    int* shape = (int*)malloc(ndim * sizeof(int));\n    if (shape == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n\n    for (int i = 0; i \u003c ndim; i++) {\n        if (tensor1-\u003eshape[i] != tensor2-\u003eshape[i]) {\n            fprintf(stderr, \"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d ì¸ë±ìŠ¤ %dì—ì„œ\\n\", tensor1-\u003eshape[i], tensor2-\u003eshape[i], i);\n            exit(1);\n        }\n        shape[i] = tensor1-\u003eshape[i];\n    }        \n    float* result_data = (float*)malloc(tensor1-\u003esize * sizeof(float));\n    if (result_data == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n    add_tensor_cpu(tensor1, tensor2, result_data);\n    \n    return create_tensor(result_data, shape, ndim, device);\n}\n```\n\n\n\nì´ì „ì— ì–¸ê¸‰í•œ ëŒ€ë¡œ, í…ì„œ ì¬êµ¬ì„±ì€ ë‚´ë¶€ ë°ì´í„° ë°°ì—´ì„ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n```js\n//norch/csrc/tensor.cpp\n\nTensor* reshape_tensor(Tensor* tensor, int* new_shape, int new_ndim) {\n\n    int ndim = new_ndim;\n    int* shape = (int*)malloc(ndim * sizeof(int));\n    if (shape == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n\n    for (int i = 0; i \u003c ndim; i++) {\n        shape[i] = new_shape[i];\n    }\n\n    // ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ ê³„ì‚°\n    int size = 1;\n    for (int i = 0; i \u003c new_ndim; i++) {\n        size *= shape[i];\n    }\n\n    // ì´ ìš”ì†Œ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸\n    if (size != tensor-\u003esize) {\n        fprintf(stderr, \"í…ì„œë¥¼ ì¬êµ¬ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\\n\");\n        exit(1);\n    }\n\n    float* result_data = (float*)malloc(tensor-\u003esize * sizeof(float));\n    if (result_data == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n    assign_tensor_cpu(tensor, result_data);\n    return create_tensor(result_data, shape, ndim, device);\n}\n```\n\nì´ì œ ì¼ë¶€ í…ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì§€ë§Œ, ëˆ„êµ¬ë‚˜ C/C++ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ì´ì œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤!\n\nPythonì„ ì‚¬ìš©í•˜ì—¬ C/C++ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. Pybind11ê³¼ Cython ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì˜ˆì‹œì—ì„œëŠ” ctypesë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.\n\n\n\nì•„ë˜ëŠ” ctypesì˜ ê¸°ë³¸ì ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤:\n\n```js\n//C ì½”ë“œ\n#include \u003cstdio.h\u003e\n\nfloat add_floats(float a, float b) {\n    return a + b;\n}\n```\n\n```js\n# ì»´íŒŒì¼\ngcc -shared -o add_floats.so -fPIC add_floats.c\n```\n\n```js\n# Python ì½”ë“œ\nimport ctypes\n\n# ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ\nlib = ctypes.CDLL('./add_floats.so')\n\n# í•¨ìˆ˜ì˜ ì¸ìì™€ ë°˜í™˜ ìœ í˜• ì •ì˜\nlib.add_floats.argtypes = [ctypes.c_float, ctypes.c_float]\nlib.add_floats.restype = ctypes.c_float\n\n# íŒŒì´ì¬ float ê°’ì„ c_float ìœ í˜•ìœ¼ë¡œ ë³€í™˜\na = ctypes.c_float(3.5)\nb = ctypes.c_float(2.2)\n\n# C í•¨ìˆ˜ í˜¸ì¶œ\nresult = lib.add_floats(a, b)\nprint(result)\n# 5.7\n```\n\n\n\në³´ì‹œë‹¤ì‹œí”¼ ë§¤ìš° ì§ê´€ì ì…ë‹ˆë‹¤. C/C++ ì½”ë“œë¥¼ ì»´íŒŒì¼í•œ í›„ Pythonì—ì„œ ctypesë¥¼ ì‚¬ìš©í•˜ë©´ ë§¤ìš° ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ ë° ë°˜í™˜ c_typesë¥¼ ì •ì˜í•˜ê³ , ë³€ìˆ˜ë¥¼ í•´ë‹¹ c_typesë¡œ ë³€í™˜í•˜ê³  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ë°°ì—´(ë¶€ë™ ì†Œìˆ˜ì  ëª©ë¡)ê³¼ ê°™ì€ ë³´ë‹¤ ë³µì¡í•œ ìœ í˜•ì˜ ê²½ìš° í¬ì¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\ndata = [1.0, 2.0, 3.0]\ndata_ctype = (ctypes.c_float * len(data))(*data)\n\nlib.some_array_func.argstypes = [ctypes.POINTER(ctypes.c_float)]\n\n...\n\nlib.some_array_func(data)\n```\n\nê·¸ë¦¬ê³  êµ¬ì¡°ì²´ ìœ í˜•ì˜ ê²½ìš° ì§ì ‘ c_typeì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\nclass CustomType(ctypes.Structure):\n    _fields_ = [\n        ('field1', ctypes.POINTER(ctypes.c_float)),\n        ('field2', ctypes.POINTER(ctypes.c_int)),\n        ('field3', ctypes.c_int),\n    ]\n\n# ctypes.POINTER(CustomType)ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n```\n\n\n\nê°„ë‹¨íˆ ì„¤ëª…í•˜ê³ , í…ì„œ C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìœ„í•œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤!\n\n```js\n# norch/tensor.py\n\nimport ctypes\n\nclass CTensor(ctypes.Structure):\n    _fields_ = [\n        ('data', ctypes.POINTER(ctypes.c_float)),\n        ('strides', ctypes.POINTER(ctypes.c_int)),\n        ('shape', ctypes.POINTER(ctypes.c_int)),\n        ('ndim', ctypes.c_int),\n        ('size', ctypes.c_int),\n    ]\n\nclass Tensor:\n    os.path.abspath(os.curdir)\n    _C = ctypes.CDLL(\"COMPILED_LIB.so\")\n\n    def __init__(self):\n        \n        data, shape = self.flatten(data)\n        self.data_ctype = (ctypes.c_float * len(data))(*data)\n        self.shape_ctype = (ctypes.c_int * len(shape))(*shape)\n        self.ndim_ctype = ctypes.c_int(len(shape))\n       \n        self.shape = shape\n        self.ndim = len(shape)\n\n        Tensor._C.create_tensor.argtypes = [ctypes.POINTER(ctypes.c_float), ctypes.POINTER(ctypes.c_int), ctypes.c_int]\n        Tensor._C.create_tensor.restype = ctypes.POINTER(CTensor)\n\n        self.tensor = Tensor._C.create_tensor(\n            self.data_ctype,\n            self.shape_ctype,\n            self.ndim_ctype,\n        )\n        \n    def flatten(self, nested_list):\n        \"\"\"\n        This method simply convert a list type tensor to a flatten tensor with its shape\n        \n        Example:\n        \n        Arguments:  \n            nested_list: [[1, 2, 3], [-5, 2, 0]]\n        Return:\n            flat_data: [1, 2, 3, -5, 2, 0]\n            shape: [2, 3]\n        \"\"\"\n        def flatten_recursively(nested_list):\n            flat_data = []\n            shape = []\n            if isinstance(nested_list, list):\n                for sublist in nested_list:\n                    inner_data, inner_shape = flatten_recursively(sublist)\n                    flat_data.extend(inner_data)\n                shape.append(len(nested_list))\n                shape.extend(inner_shape)\n            else:\n                flat_data.append(nested_list)\n            return flat_data, shape\n        \n        flat_data, shape = flatten_recursively(nested_list)\n        return flat_data, shape\n```\n\nì´ì œ Python í…ì„œ ì‘ì—…ì„ í¬í•¨í•˜ì—¬ C/C++ ì‘ì—…ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\n# norch/tensor.py\n\ndef __getitem__(self, indices):\n    \"\"\"\n    index í…ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ í…ì„œì— ì•¡ì„¸ìŠ¤ tensor[i, j, k...]\n    \"\"\"\n\n    if len(indices) != self.ndim:\n        raise ValueError(\"ì¸ë±ìŠ¤ ìˆ˜ê°€ ì°¨ì› ìˆ˜ì™€ ì¼ì¹˜í•´ì•¼ í•¨\")\n    \n    Tensor._C.get_item.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(ctypes.c_int)]\n    Tensor._C.get_item.restype = ctypes.c_float\n                                       \n    indices = (ctypes.c_int * len(indices))(*indices)\n    value = Tensor._C.get_item(self.tensor, indices)  \n    \n    return value\n\ndef reshape(self, new_shape):\n    \"\"\"\n    í…ì„œë¥¼ ì¬êµ¬ì„±í•©ë‹ˆë‹¤\n    result = tensor.reshape([1,2])\n    \"\"\"\n    new_shape_ctype = (ctypes.c_int * len(new_shape))(*new_shape)\n    new_ndim_ctype = ctypes.c_int(len(new_shape))\n    \n    Tensor._C.reshape_tensor.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(ctypes.c_int), ctypes.c_int]\n    Tensor._C.reshape_tensor.restype = ctypes.POINTER(CTensor)\n    result_tensor_ptr = Tensor._C.reshape_tensor(self.tensor, new_shape_ctype, new_ndim_ctype)   \n\n    result_data = Tensor()\n    result_data.tensor = result_tensor_ptr\n    result_data.shape = new_shape.copy()\n    result_data.ndim = len(new_shape)\n    result_data.device = self.device\n\n    return result_data\n\ndef __add__(self, other):\n    \"\"\"\n    í…ì„œë¥¼ ë”í•©ë‹ˆë‹¤\n    result = tensor1 + tensor2\n    \"\"\"\n  \n    if self.shape != other.shape:\n        raise ValueError(\"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œë“¤ì€ ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•¨\")\n    \n    Tensor._C.add_tensor.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(CTensor)]\n    Tensor._C.add_tensor.restype = ctypes.POINTER(CTensor)\n\n    result_tensor_ptr = Tensor._C.add_tensor(self.tensor, other.tensor)\n\n    result_data = Tensor()\n    result_data.tensor = result_tensor_ptr\n    result_data.shape = self.shape.copy()\n    result_data.ndim = self.ndim\n    result_data.device = self.device\n\n    return result_data\n\n# ê¸°íƒ€ ì—°ì‚° í¬í•¨:\n# __str__\n# __sub__ (-)\n# __mul__ (*)\n# __matmul__ (@)\n# __pow__ (**)\n# __truediv__ (/)\n# log\n# ...\n```\n\n\n\nì—¬ê¸°ê¹Œì§€ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ì´ì œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  í…ì„œ ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì´ ìƒê²¼ìŠµë‹ˆë‹¤!\n\n```js\nimport norch\n\ntensor1 = norch.Tensor([[1, 2, 3], [3, 2, 1]])\ntensor2 = norch.Tensor([[3, 2, 1], [1, 2, 3]])\n\nresult = tensor1 + tensor2\nprint(result[0, 0])\n# 4 \n```\n\n# #2 â€” GPU ì§€ì›\n\nìš°ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë§Œë“  í›„, ì´ì œ ìƒˆë¡œìš´ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì–´ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ GPUë¡œ ì „ì†¡í•˜ê³  ìˆ˜í•™ ì—°ì‚°ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ `.to(\"cuda\")`ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ ì˜ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. CUDAê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê¸°ë³¸ ì§€ì‹ì´ ìˆì„ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤ë§Œ, ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° ë‹¤ë¥¸ ê¸°ì‚¬ì¸ 'CUDA íŠœí† ë¦¬ì–¼'ì„ ì½ì–´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ê¸°ë‹¤ë¦´ê²Œìš”. ğŸ˜Š\n\n\n\n...\n\nê¸‰í•œ ì‚¬ëŒë“¤ì„ ìœ„í•´, ê°„ë‹¨í•œ ì†Œê°œê°€ ì—¬ê¸° ìˆì–´ìš”:\n\nê¸°ë³¸ì ìœ¼ë¡œ, ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë“  ì½”ë“œëŠ” CPU ë©”ëª¨ë¦¬ì—ì„œ ì‹¤í–‰ë˜ê³  ìˆì–´ìš”. í•˜ë‚˜ì˜ ì‘ì—…ì— ëŒ€í•´ì„œëŠ” CPUê°€ ë¹ ë¥´ì§€ë§Œ, GPUì˜ ì¥ì ì€ ë³‘ë ¬í™” ëŠ¥ë ¥ì— ìˆì–´ìš”. CPU ë””ìì¸ì€ ì—°ì‚°(ìŠ¤ë ˆë“œ)ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•œ ë°˜ë©´, GPU ë””ìì¸ì€ ìˆ˜ë°±ë§Œ ê°œì˜ ì—°ì‚°ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•´ìš” (ê°œë³„ ìŠ¤ë ˆë“œì˜ ì„±ëŠ¥ì„ í¬ìƒí•˜ë©°).\n\nê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì´ ëŠ¥ë ¥ì„ í™œìš©í•˜ì—¬ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ìš”. ì˜ˆë¥¼ ë“¤ì–´, ë°±ë§Œ ê°œì˜ ìš”ì†Œë¡œ êµ¬ì„±ëœ í…ì„œë¥¼ ì¶”ê°€í•  ë•Œ, ë°˜ë³µë¬¸ ë‚´ì—ì„œ ê° ìƒ‰ì¸ì˜ ìš”ì†Œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ , GPUë¥¼ ì‚¬ìš©í•˜ì—¬ í•œêº¼ë²ˆì— ëª¨ë‘ë¥¼ ë³‘ë ¬ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”. ì´ë¥¼ ìœ„í•´ NVIDIAì—ì„œ ê°œë°œí•œ ê°œë°œìë“¤ì´ GPU ì§€ì›ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í†µí•©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í”Œë«í¼ì¸ CUDAë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.\n\n\n\nê·¸ê±¸ í•˜ë ¤ë©´, íŠ¹ì • GPU ì‘ì—…(ì˜ˆ: CPU ë©”ëª¨ë¦¬ì—ì„œ GPU ë©”ëª¨ë¦¬ë¡œ ë°ì´í„° ë³µì‚¬)ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ê°„ë‹¨í•œ C/C++ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤ ì¸ CUDA C/C++ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì•„ë˜ ì½”ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ CPUì—ì„œ GPUë¡œ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ê³  ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” AddTwoArrays í•¨ìˆ˜(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ Nê°œì˜ GPU ìŠ¤ë ˆë“œì—ì„œ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ëŠ” ëª‡ ê°€ì§€ CUDA C/C++ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\n```c\n#include \u003cstdio.h\u003e\n\n// CPU ë²„ì „(ë¹„êµìš©)\nvoid AddTwoArrays_CPU(flaot A[], float B[], float C[]) {\n    for (int i = 0; i \u003c N; i++) {\n        C[i] = A[i] + B[i];\n    }\n}\n\n// ì»¤ë„ ì •ì˜\n__global__ void AddTwoArrays_GPU(float A[], float B[], float C[]) {\n    int i = threadIdx.x;\n    C[i] = A[i] + B[i];\n}\n\nint main() {\n\n    int N = 1000; // ë°°ì—´ í¬ê¸°\n    float A[N], B[N], C[N]; // ë°°ì—´ A, B, C\n\n    ...\n\n    float *d_A, *d_B, *d_C; // ë°°ì—´ A, B, Cì˜ ì¥ì¹˜ í¬ì¸í„°\n\n    // ë°°ì—´ A, B, Cì— ëŒ€í•œ ì¥ì¹˜ì—ì„œì˜ ë©”ëª¨ë¦¬ í• ë‹¹\n    cudaMalloc((void **)\u0026d_A, N * sizeof(float));\n    cudaMalloc((void **)\u0026d_B, N * sizeof(float));\n    cudaMalloc((void **)\u0026d_C, N * sizeof(float));\n\n    // í˜¸ìŠ¤íŠ¸ì—ì„œ ì¥ì¹˜ë¡œ ë°°ì—´ A ë° B ë³µì‚¬\n    cudaMemcpy(d_A, A, N * sizeof(float), cudaMemcpyHostToDevice);\n    cudaMemcpy(d_B, B, N * sizeof(float), cudaMemcpyHostToDevice);\n\n    // Nê°œì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë„ í˜¸ì¶œ\n    AddTwoArrays_GPU\u003c\u003c\u003c1, N\u003e\u003e\u003e(d_A, d_B, d_C);\n    \n    // ì¥ì¹˜ì—ì„œ í˜¸ìŠ¤íŠ¸ë¡œ ë²¡í„° C ë³µì‚¬\n    cudaMemcpy(C, d_C, N * sizeof(float), cudaMemcpyDeviceToHost);\n\n}\n```\n\nì£¼ëª©í•  ì ì€ ê° ìš”ì†Œ ìŒì„ ê°ê° ì¶”ê°€í•˜ëŠ” ëŒ€ì‹  ëª¨ë“  ë§ì…ˆ ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ì—¬ ë£¨í”„ ëª…ë ¹ì„ ì œê±°í•œ ê²ƒì…ë‹ˆë‹¤.\n\n\n\nê°„ë‹¨í•œ ì†Œê°œ ì´í›„ì—, í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆì–´ìš”.\n\nì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” CPUì—ì„œ GPUë¡œ í…ì„œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n```js\n//norch/csrc/tensor.cpp\n\nvoid to_device(Tensor* tensor, char* target_device) {\n    if ((strcmp(target_device, \"cuda\") == 0) \u0026\u0026 (strcmp(tensor-\u003edevice, \"cpu\") == 0)) {\n        cpu_to_cuda(tensor);\n    }\n\n    else if ((strcmp(target_device, \"cpu\") == 0) \u0026\u0026 (strcmp(tensor-\u003edevice, \"cuda\") == 0)) {\n        cuda_to_cpu(tensor);\n    }\n}\n```\n\n```js\n//norch/csrc/cuda.cu\n\n__host__ void cpu_to_cuda(Tensor* tensor) {\n    \n    float* data_tmp;\n    cudaMalloc((void **)\u0026data_tmp, tensor-\u003esize * sizeof(float));\n    cudaMemcpy(data_tmp, tensor-\u003edata, tensor-\u003esize * sizeof(float), cudaMemcpyHostToDevice);\n\n    tensor-\u003edata = data_tmp;\n\n    const char* device_str = \"cuda\";\n    tensor-\u003edevice = (char*)malloc(strlen(device_str) + 1);\n    strcpy(tensor-\u003edevice, device_str); \n\n    printf(\"í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\\n\", tensor-\u003edevice);\n}\n\n__host__ void cuda_to_cpu(Tensor* tensor) {\n    float* data_tmp = (float*)malloc(tensor-\u003esize * sizeof(float));\n\n    cudaMemcpy(data_tmp, tensor-\u003edata, tensor-\u003esize * sizeof(float), cudaMemcpyDeviceToHost);\n    cudaFree(tensor-\u003edata);\n\n    tensor-\u003edata = data_tmp;\n\n    const char* device_str = \"cpu\";\n    tensor-\u003edevice = (char*)malloc(strlen(device_str) + 1);\n    strcpy(tensor-\u003edevice, device_str); \n\n    printf(\"í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\\n\", tensor-\u003edevice);\n}\n```\n\n\n\níŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„ëœ ë˜í¼:\n\n```js\n# norch/tensor.py\n\ndef to(self, device):\n    self.device = device\n    self.device_ctype = self.device.encode('utf-8')\n  \n    Tensor._C.to_device.argtypes = [ctypes.POINTER(CTensor), ctypes.c_char_p]\n    Tensor._C.to_device.restype = None\n    Tensor._C.to_device(self.tensor, self.device_ctype)\n  \n    return self\n```\n\në‹¤ìŒìœ¼ë¡œ, ëª¨ë“  í…ì„œ ì—°ì‚°ì— ëŒ€í•´ GPU ë²„ì „ì„ ìƒì„±í•©ë‹ˆë‹¤. ë§ì…ˆê³¼ ëº„ì…ˆì— ëŒ€í•œ ì˜ˆì œë¥¼ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤:\n\n```js\n//norch/csrc/cuda.cu\n\n#define THREADS_PER_BLOCK 128\n\n__global__ void add_tensor_cuda_kernel(float* data1, float* data2, float* result_data, int size) {\n    \n    int i = blockIdx.x * blockDim.x + threadIdx.x;\n    if (i \u003c size) {\n        result_data[i] = data1[i] + data2[i];\n    }\n}\n\n__host__ void add_tensor_cuda(Tensor* tensor1, Tensor* tensor2, float* result_data) {\n    \n    int number_of_blocks = (tensor1-\u003esize + THREADS_PER_BLOCK - 1) / THREADS_PER_BLOCK;\n    add_tensor_cuda_kernel\u003c\u003c\u003cnumber_of_blocks, THREADS_PER_BLOCK\u003e\u003e\u003e(tensor1-\u003edata, tensor2-\u003edata, result_data, tensor1-\u003esize);\n\n    cudaError_t error = cudaGetLastError();\n    if (error != cudaSuccess) {\n        printf(\"CUDA error: %s\\n\", cudaGetErrorString(error));\n        exit(-1);\n    }\n\n    cudaDeviceSynchronize();\n}\n\n__global__ void sub_tensor_cuda_kernel(float* data1, float* data2, float* result_data, int size) {\n   \n    int i = blockIdx.x * blockDim.x + threadIdx.x;\n    if (i \u003c size) {\n        result_data[i] = data1[i] - data2[i];\n    }\n}\n\n__host__ void sub_tensor_cuda(Tensor* tensor1, Tensor* tensor2, float* result_data) {\n    \n    int number_of_blocks = (tensor1-\u003esize + THREADS_PER_BLOCK - 1) / THREADS_PER_BLOCK;\n    sub_tensor_cuda_kernel\u003c\u003c\u003cnumber_of_blocks, THREADS_PER_BLOCK\u003e\u003e\u003e(tensor1-\u003edata, tensor2-\u003edata, result_data, tensor1-\u003esize);\n\n    cudaError_t error = cudaGetLastError();\n    if (error != cudaSuccess) {\n        printf(\"CUDA error: %s\\n\", cudaGetErrorString(error));\n        exit(-1);\n    }\n\n    cudaDeviceSynchronize();\n}\n\n...\n```\n\n\n\nê·¸ëŸ° ë‹¤ìŒ, í…ì„œ.cppì— ìƒˆë¡œìš´ í…ì„œ ì†ì„± char* deviceë¥¼ ì¶”ê°€í•˜ê³  ì‘ì—…ì„ ì‹¤í–‰í•  ìœ„ì¹˜(CPU ë˜ëŠ” GPU)ë¥¼ ì„ íƒí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n//norch/csrc/tensor.cpp\n\nTensor* add_tensor(Tensor* tensor1, Tensor* tensor2) {\n    if (tensor1-\u003endim != tensor2-\u003endim) {\n        fprintf(stderr, \"ë§ì…ˆì„ ìœ„í•´ í…ì„œê°€ ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\\n\", tensor1-\u003endim, tensor2-\u003endim);\n        exit(1);\n    }\n\n    if (strcmp(tensor1-\u003edevice, tensor2-\u003edevice) != 0) {\n        fprintf(stderr, \"í…ì„œëŠ” ë™ì¼í•œ ì¥ì¹˜ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤: %s and %s\\n\", tensor1-\u003edevice, tensor2-\u003edevice);\n        exit(1);\n    }\n\n    char* device = (char*)malloc(strlen(tensor1-\u003edevice) + 1);\n    if (device != NULL) {\n        strcpy(device, tensor1-\u003edevice);\n    } else {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(-1);\n    }\n    int ndim = tensor1-\u003endim;\n    int* shape = (int*)malloc(ndim * sizeof(int));\n    if (shape == NULL) {\n        fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n        exit(1);\n    }\n\n    for (int i = 0; i \u003c ndim; i++) {\n        if (tensor1-\u003eshape[i] != tensor2-\u003eshape[i]) {\n            fprintf(stderr, \"ë§ì…ˆì„ ìœ„í•´ í…ì„œë“¤ì€ ìƒ‰ì¸ %dì—ì„œ ë™ì¼í•œ í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\\n\", i, tensor1-\u003eshape[i], tensor2-\u003eshape[i]);\n            exit(1);\n        }\n        shape[i] = tensor1-\u003eshape[i];\n    }        \n\n    if (strcmp(tensor1-\u003edevice, \"cuda\") == 0) {\n\n        float* result_data;\n        cudaMalloc((void **)\u0026result_data, tensor1-\u003esize * sizeof(float));\n        add_tensor_cuda(tensor1, tensor2, result_data);\n        return create_tensor(result_data, shape, ndim, device);\n    } \n    else {\n        float* result_data = (float*)malloc(tensor1-\u003esize * sizeof(float));\n        if (result_data == NULL) {\n            fprintf(stderr, \"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\n\");\n            exit(1);\n        }\n        add_tensor_cpu(tensor1, tensor2, result_data);\n        return create_tensor(result_data, shape, ndim, device);\n    }     \n}\n```\n\nì´ì œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ GPU ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤!\n\n```js\nimport norch\n\ntensor1 = norch.Tensor([[1, 2, 3], [3, 2, 1]]).to(\"cuda\")\ntensor2 = norch.Tensor([[3, 2, 1], [1, 2, 3]]).to(\"cuda\")\n\nresult = tensor1 + tensor2\n```\n\n\n\n# #3 â€” Automatic Differentiation (Autograd)\n\níŒŒì´í† ì¹˜ê°€ ì¸ê¸°ë¥¼ ì–»ê²Œ ëœ ì£¼ìš” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ” Autograd ëª¨ë“ˆ ë•Œë¬¸ì…ë‹ˆë‹¤. Autograd ëª¨ë“ˆì€ ìë™ ë¯¸ë¶„ì„ ìˆ˜í–‰í•˜ì—¬ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤ (ê²½ì‚¬ í•˜ê°•ë²•ê³¼ ê°™ì€ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤). .backward()ë¼ëŠ” ë‹¨ì¼ ë©”ì„œë“œ í˜¸ì¶œë¡œ ì´ì „ í…ì„œ ì—°ì‚°ì—ì„œ ëª¨ë“  ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤:\n\n```js\nx = torch.tensor([[1., 2, 3], [3., 2, 1]], requires_grad=True)\n# [[1,  2,  3],\n#  [3,  2., 1]]\n\ny = torch.tensor([[3., 2, 1], [1., 2, 3]], requires_grad=True)\n# [[3,  2, 1],\n#  [1,  2, 3]]\n\nL = ((x - y) ** 3).sum()\n\nL.backward()\n\n# xì™€ yì˜ ê¸°ìš¸ê¸°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\nprint(x.grad)\n# [[12, 0, 12],\n#  [12, 0, 12]]\n\nprint(y.grad)\n# [[-12, 0, -12],\n#  [-12, 0, -12]]\n\n# zë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ì„œëŠ” ê²½ì‚¬ í•˜ê°•ë²•ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n# x = x - í•™ìŠµë¥  * x.grad\n# y = y - í•™ìŠµë¥  * y.grad\n```\n\në¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€ ì´í•´í•˜ê¸° ìœ„í•´ ë™ì¼í•œ ì ˆì°¨ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³µì œí•´ë³´ê² ìŠµë‹ˆë‹¤:\n\n\n\n\u003cimg src=\"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_10.png\" /\u003e\n\nìš°ì„  ê³„ì‚°í•´ ë´…ì‹œë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_11.png\" /\u003e\n\nxê°€ í–‰ë ¬ì´ë¼ëŠ” ê²ƒì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê° ìš”ì†Œì— ëŒ€í•œ Lì˜ ë¯¸ë¶„ì„ ê°œë³„ì ìœ¼ë¡œ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ê²Œë‹¤ê°€, Lì€ ëª¨ë“  ìš”ì†Œì— ëŒ€í•œ í•©ì´ì§€ë§Œ ê° ìš”ì†Œì— ëŒ€í•œ ë¯¸ë¶„ì—ì„œ ë‹¤ë¥¸ ìš”ì†Œë“¤ì€ ì¤‘ìš”í•œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•­ì„ ì–»ìŠµë‹ˆë‹¤:\n\n\n\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_12.png)\n\nê° í•­ì— ëŒ€í•´ ì—°ì‡„ ë²•ì¹™ì„ ì ìš©í•˜ì—¬ ì™¸ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•˜ê³  ë‚´ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•œ ê°’ì„ ê³±í•©ë‹ˆë‹¤:\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_13.png)\n\nWhere:\n\n\n\n\në§ˆì¹¨ë‚´:\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_14.png)\n\nê·¸ëŸ¬ë¯€ë¡œ, xì— ê´€í•œ Lì˜ ë¯¸ë¶„ì„ ê³„ì‚°í•˜ëŠ” ìµœì¢… ë°©ì •ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n\n\nì•„ë˜ëŠ” Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½ëœ ë‚´ìš©ì…ë‹ˆë‹¤.\n\n\n![Image 1](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_16.png)\n\nSubstituting the values into the equation:\n\n![Image 2](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_17.png)\n\nCalculating the result, we get the same values we obtained with PyTorch:\n\n\n\n\n\n![image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_18.png)\n\nNow, letâ€™s analyze what we just did:\n\nBasically, we observed all the operations involved in reverse order: a summation, a power of 3, and a subtraction. Then, we applied the chain rule, calculating the derivative of each operation and recursively calculated the derivative for the next operation. So, first we need an implementation of the derivative for different math operations:\n\nFor addition:\n\n\n\n\n\n![Image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_19.png)\n\n```js\n# norch/autograd/functions.py\n\nclass AddBackward:\n    def __init__(self, x, y):\n        self.input = [x, y]\n\n    def backward(self, gradient):\n        return [gradient, gradient]\n```\n\nFor sin:\n\n![Image](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_20.png)\n\n\n\n\n```js\n# norch/autograd/functions.py\n\nclass SinBackward:\n    def __init__(self, x):\n        self.input = [x]\n\n    def backward(self, gradient):\n        x = self.input[0]\n        return [x.cos() * gradient]\n```\n\nì½”ì‚¬ì¸ì— ëŒ€í•´:\n\n![2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21.png)\n\n```js\n# norch/autograd/functions.py\n\nclass CosBackward:\n    def __init__(self, x):\n        self.input = [x]\n\n    def backward(self, gradient):\n        x = self.input[0]\n        return [- x.sin() * gradient]\n```\n\n\n\nìš”ì†Œë³„ ê³±ì…ˆì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•´ë³´ì„¸ìš”:\n\n![element-wise multiplication](/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_22.png)\n\n```python\n# norch/autograd/functions.py\n\nclass ElementwiseMulBackward:\n    def __init__(self, x, y):\n        self.input = [x, y]\n\n    def backward(self, gradient):\n        x = self.input[0]\n        y = self.input[1]\n        return [y * gradient, x * gradient]\n```\n\ní•©ì‚°ì— ëŒ€í•´ì„œ:\n\n\n\n\n# norch/autograd/functions.py\n\n```python\nclass SumBackward:\n    def __init__(self, x):\n        self.input = [x]\n\n    def backward(self, gradient):\n        # sum í•¨ìˆ˜ëŠ” í…ì„œë¥¼ ìŠ¤ì¹¼ë¼ë¡œ ì¤„ì´ë¯€ë¡œ ê¸°ìš¸ê¸°ë¥¼ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë©ë‹ˆë‹¤.\n        return [float(gradient.tensor.contents.data[0]) * self.input[0].ones_like()]\n```\n\në‹¤ë¥¸ ì—°ì‚°ì„ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” GitHub ì €ì¥ì†Œ ë§í¬ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ì œ ê° ì‘ì—…ì— ëŒ€í•œ ë„í•¨ìˆ˜ ì‹ì„ ê°€ì¡Œìœ¼ë‹ˆ, ì¬ê·€ì ìœ¼ë¡œ ì—­ì „íŒŒ ì²´ì¸ ê·œì¹™ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í…ì„œì— requires_grad ì¸ìë¥¼ ì„¤ì •í•˜ì—¬ ì´ í…ì„œì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Trueì´ë©´ ê° í…ì„œ ì‘ì—…ì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:\n\n```python\n# norch/tensor.py\n\ndef __add__(self, other):\n\n  if self.shape != other.shape:\n      raise ValueError(\"ë§ì…ˆì„ ìœ„í•´ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.\")\n  \n  Tensor._C.add_tensor.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(CTensor)]\n  Tensor._C.add_tensor.restype = ctypes.POINTER(CTensor)\n  \n  result_tensor_ptr = Tensor._C.add_tensor(self.tensor, other.tensor)\n  \n  result_data = Tensor()\n  result_data.tensor = result_tensor_ptr\n  result_data.shape = self.shape.copy()\n  result_data.ndim = self.ndim\n  result_data.device = self.device\n  \n  result_data.requires_grad = self.requires_grad or other.requires_grad\n  if result_data.requires_grad:\n      result_data.grad_fn = AddBackward(self, other)\n```\n\n\n\nê·¸ëŸ¼, `.backward()` ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ë³´ì„¸ìš”:\n\n```python\n# norch/tensor.py\n\ndef backward(self, gradient=None):\n    if not self.requires_grad:\n        return\n    \n    if gradient is None:\n        if self.shape == [1]:\n            gradient = Tensor([1]) # dx/dx = 1 case\n        else:\n            raise RuntimeError(\"Gradient argument must be specified for non-scalar tensors.\")\n\n    if self.grad is None:\n        self.grad = gradient\n\n    else:\n        self.grad += gradient\n\n    if self.grad_fn is not None: # not a leaf\n        grads = self.grad_fn.backward(gradient) # call the operation backward\n        for tensor, grad in zip(self.grad_fn.input, grads):\n            if isinstance(tensor, Tensor):\n                tensor.backward(grad) # recursively call the backward again for the gradient expression (chain rule)\n```\n\në§ˆì§€ë§‰ìœ¼ë¡œ, í…ì„œì˜ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì œë¡œí™”í•˜ëŠ” `.zero_grad()`ì™€ í…ì„œì˜ ì˜¤í† ê·¸ë˜ë“œ íˆìŠ¤í† ë¦¬ë¥¼ ì œê±°í•˜ëŠ” `.detach()`ë¥¼ êµ¬í˜„í•´ì£¼ì„¸ìš”:\n\n```python\n# norch/tensor.py\n\ndef zero_grad(self):\n    self.grad = None\n\ndef detach(self):\n    self.grad = None\n    self.grad_fn = None\n```\n\n\n\nì¶•í•˜í•©ë‹ˆë‹¤! GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ì´ ìˆëŠ” ì™„ì „í•œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“œì…¨êµ°ìš”! ì´ì œ nn ë° optim ëª¨ë“ˆì„ ë§Œë“¤ì–´ ëª‡ ê°€ì§€ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ ë” ì‰½ê²Œ í›ˆë ¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## #4 â€” nn ë° optim ëª¨ë“ˆ\n\nnnì€ ì‹ ê²½ë§ ë° ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ëª¨ë“ˆì´ë©°, optimì€ ì´ëŸ¬í•œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì¬í˜„í•˜ê¸° ìœ„í•œ ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” Parameterë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ParameterëŠ” ê°„ë‹¨íˆ ë§í•´ í•­ìƒ Trueë¡œ ì„¤ì •ëœ requires_grad ì†ì„±ì„ ê°–ëŠ” í›ˆë ¨ ê°€ëŠ¥í•œ í…ì„œë¡œ, ì¼ë¶€ ì„ì˜ì˜ ì´ˆê¸°í™” ê¸°ë²•ì„ ì‚¬ìš©í•´ ê°™ì€ ì—°ì‚°ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n\n```js\n# norch/nn/parameter.py\n\nfrom norch.tensor import Tensor\nfrom norch.utils import utils\nimport random\n\nclass Parameter(Tensor):\n    \"\"\"\n    A parameter is a trainable tensor.\n    \"\"\"\n    def __init__(self, shape):\n        data = utils.generate_random_list(shape=shape)\n        super().__init__(data, requires_grad=True)\n```\n\n\n\n```js\n# norch/utisl/utils.py\n\ndef generate_random_list(shape):\n    \"\"\"\n    ëœë¤í•œ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ 'shape' í˜•íƒœì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤\n    [4, 2] --\u003e [[rand1, rand2], [rand3, rand4], [rand5, rand6], [rand7, rand8]]\n    \"\"\"\n    if len(shape) == 0:\n        return []\n    else:\n        inner_shape = shape[1:]\n        if len(inner_shape) == 0:\n            return [random.uniform(-1, 1) for _ in range(shape[0])]\n        else:\n            return [generate_random_list(inner_shape) for _ in range(shape[0])]\n```\n\níŒŒë¼ë¯¸í„°ë¥¼ í™œìš©í•˜ë©´ ëª¨ë“ˆì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n# norch/nn/module.py\n\nfrom .parameter import Parameter\nfrom collections import OrderedDict\nfrom abc import ABC\nimport inspect\n\nclass Module(ABC):\n    \"\"\"\n    ëª¨ë“ˆì„ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤\n    \"\"\"\n    def __init__(self):\n        self._modules = OrderedDict()\n        self._params = OrderedDict()\n        self._grads = OrderedDict()\n        self.training = True\n\n    def forward(self, *inputs, **kwargs):\n        raise NotImplementedError\n\n    def __call__(self, *inputs, **kwargs):\n        return self.forward(*inputs, **kwargs)\n\n    def train(self):\n        self.training = True\n        for param in self.parameters():\n            param.requires_grad = True\n\n    def eval(self):\n        self.training = False\n        for param in self.parameters():\n            param.requires_grad = False\n\n    def parameters(self):\n        for name, value in inspect.getmembers(self):\n            if isinstance(value, Parameter):\n                yield self, name, value\n            elif isinstance(value, Module):\n                yield from value.parameters()\n\n    def modules(self):\n        yield from self._modules.values()\n\n    def gradients(self):\n        for module in self.modules():\n            yield module._grads\n\n    def zero_grad(self):\n        for _, _, parameter in self.parameters():\n            parameter.zero_grad()\n\n    def to(self, device):\n        for _, _, parameter in self.parameters():\n            parameter.to(device)\n\n        return self\n    \n    def inner_repr(self):\n        return \"\"\n\n    def __repr__(self):\n        string = f\"{self.get_name()}(\"\n        tab = \"   \"\n        modules = self._modules\n        if modules == {}:\n            string += f'\\n{tab}(parameters): {self.inner_repr()}'\n        else:\n            for key, module in modules.items():\n                string += f\"\\n{tab}({key}): {module.get_name()}({module.inner_repr()})\"\n        return f'{string}\\n)'\n    \n    def get_name(self):\n        return self.__class__.__name__\n    \n    def __setattr__(self, key, value):\n        self.__dict__[key] = value\n\n        if isinstance(value, Module):\n            self._modules[key] = value\n        elif isinstance(value, Parameter):\n            self._params[key] = value\n```\n\nì˜ˆë¥¼ ë“¤ì–´, nn.Moduleì„ ìƒì†í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ ëª¨ë“ˆì„ ë§Œë“¤ê±°ë‚˜, ì´ì „ì— ìƒì„±ëœ ëª¨ë“ˆ ì¤‘ í•˜ë‚˜ì¸ ì„ í˜• ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ y = Wx + b ì‘ì—…ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\n\n\n```js\n# norch/nn/modules/linear.py\n\nfrom ..module import Module\nfrom ..parameter import Parameter\n\nclass Linear(Module):\n    def __init__(self, input_dim, output_dim):\n        super().__init__()\n        self.input_dim = input_dim\n        self.output_dim = output_dim\n        self.weight = Parameter(shape=[self.output_dim, self.input_dim])\n        self.bias = Parameter(shape=[self.output_dim, 1])\n\n    def forward(self, x):\n        z = self.weight @ x + self.bias\n        return z\n\n    def inner_repr(self):\n        return f\"input_dim={self.input_dim}, output_dim={self.output_dim}, \" \\\n               f\"bias={True if self.bias is not None else False}\"\n```\n\nì´ì œ ëª‡ ê°€ì§€ ì†ì‹¤ ë° í™œì„±í™” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í‰ê·  ì œê³± ì˜¤ì°¨ ì†ì‹¤ ë° ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜:\n\n```js\n# norch/nn/loss.py\n\nfrom .module import Module\n \nclass MSELoss(Module):\n    def __init__(self):\n      pass\n\n    def forward(self, predictions, labels):\n        assert labels.shape == predictions.shape, \\\n            \"Labels and predictions shape does not match: {} and {}\".format(labels.shape, predictions.shape)\n        \n        return ((predictions - labels) ** 2).sum() / predictions.numel\n\n    def __call__(self, *inputs):\n        return self.forward(*inputs)\n```\n\n```js\n# norch/nn/activation.py\n\nfrom .module import Module\nimport math\n\nclass Sigmoid(Module):\n    def __init__(self):\n        super().__init__()\n\n    def forward(self, x):\n        return 1.0 / (1.0 + (math.e) ** (-x)) \n```\n\n\n\në§ˆì§€ë§‰ìœ¼ë¡œ ì˜µí‹°ë§ˆì´ì €ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤. ì˜ˆì‹œë¡œ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent) ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤:\n\n```js\n# norch/optim/optimizer.py\n\nfrom abc import ABC\nfrom norch.tensor import Tensor\n\nclass Optimizer(ABC):\n    \"\"\"\n    ì˜µí‹°ë§ˆì´ì €ë¥¼ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤\n    \"\"\"\n\n    def __init__(self, parameters):\n        if isinstance(parameters, Tensor):\n            raise TypeError(\"parametersëŠ” ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´ì´ì–´ì•¼ í•˜ì§€ë§Œ {} íƒ€ì…ì´ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤\".format(type(parameters)))\n        elif isinstance(parameters, dict):\n            parameters = parameters.values()\n\n        self.parameters = list(parameters)\n\n    def step(self):\n        raise NotImplementedError\n    \n    def zero_grad(self):\n        for module, name, parameter in self.parameters:\n            parameter.zero_grad()\n\n\nclass SGD(Optimizer):\n    def __init__(self, parameters, lr=1e-1, momentum=0):\n        super().__init__(parameters)\n        self.lr = lr\n        self.momentum = momentum\n        self._cache = {'velocity': [p.zeros_like() for (_, _, p) in self.parameters]}\n\n    def step(self):\n        for i, (module, name, _) in enumerate(self.parameters):\n            parameter = getattr(module, name)\n\n            velocity = self._cache['velocity'][i]\n\n            velocity = self.momentum * velocity - self.lr * parameter.grad\n\n            updated_parameter = parameter + velocity\n\n            setattr(module, name, updated_parameter)\n\n            self._cache['velocity'][i] = velocity\n\n            parameter.detach()\n            velocity.detach()\n```\n\nê·¸ë¦¬ê³  ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤! ì´ì œ ìš°ë¦¬ë§Œì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ì—ˆì–´ìš”! ğŸ¥³\n\nì´ì œ í•™ìŠµì„ ì‹œì‘í•´ë´…ì‹œë‹¤:\n\n\n\n```js\nimport norch\nimport norch.nn as nn\nimport norch.optim as optim\nimport random\nimport math\n\nrandom.seed(1)\n\nclass MyModel(nn.Module):\n    def __init__(self):\n        super(MyModel, self).__init__()\n        self.fc1 = nn.Linear(1, 10)\n        self.sigmoid = nn.Sigmoid()\n        self.fc2 = nn.Linear(10, 1)\n\n    def forward(self, x):\n        out = self.fc1(x)\n        out = self.sigmoid(out)\n        out = self.fc2(out)\n        \n        return out\n\ndevice = \"cuda\"\nepochs = 10\n\nmodel = MyModel().to(device)\ncriterion = nn.MSELoss()\noptimizer = optim.SGD(model.parameters(), lr=0.001)\nloss_list = []\n\nx_values = [0. ,  0.4,  0.8,  1.2,  1.6,  2. ,  2.4,  2.8,  3.2,  3.6,  4. ,\n        4.4,  4.8,  5.2,  5.6,  6. ,  6.4,  6.8,  7.2,  7.6,  8. ,  8.4,\n        8.8,  9.2,  9.6, 10. , 10.4, 10.8, 11.2, 11.6, 12. , 12.4, 12.8,\n       13.2, 13.6, 14. , 14.4, 14.8, 15.2, 15.6, 16. , 16.4, 16.8, 17.2,\n       17.6, 18. , 18.4, 18.8, 19.2, 19.6, 20.]\n\ny_true = []\nfor x in x_values:\n    y_true.append(math.pow(math.sin(x), 2))\n\n\nfor epoch in range(epochs):\n    for x, target in zip(x_values, y_true):\n        x = norch.Tensor([[x]]).T\n        target = norch.Tensor([[target]]).T\n\n        x = x.to(device)\n        target = target.to(device)\n\n        outputs = model(x)\n        loss = criterion(outputs, target)\n        \n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\n    print(f'Epoch [{epoch + 1}/{epochs}], Loss: {loss[0]:.4f}')\n    loss_list.append(loss[0])\n\n# Epoch [1/10], Loss: 1.7035\n# Epoch [2/10], Loss: 0.7193\n# Epoch [3/10], Loss: 0.3068\n# Epoch [4/10], Loss: 0.1742\n# Epoch [5/10], Loss: 0.1342\n# Epoch [6/10], Loss: 0.1232\n# Epoch [7/10], Loss: 0.1220\n# Epoch [8/10], Loss: 0.1241\n# Epoch [9/10], Loss: 0.1270\n# Epoch [10/10], Loss: 0.1297\n```\n\n\u003cimg src=\"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_23.png\" /\u003e\n\nì„±ê³µì ìœ¼ë¡œ ëª¨ë¸ì´ ìƒì„±ë˜ê³  ì‚¬ìš©ì ì •ì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\n\n# ê²°ë¡ \n\nì´ ê²Œì‹œë¬¼ì—ì„œëŠ” í…ì„œì™€ ê°™ì€ ê¸°ë³¸ ê°œë…, ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€, CUDA ë° Autogradì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œ ë“±ì„ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ì´ ê°€ëŠ¥í•œ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ ê²Œì‹œë¬¼ì´ ì—¬ëŸ¬ë¶„ì´ PyTorchê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê°„ëµíˆ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.\n\nì•ìœ¼ë¡œì˜ ê²Œì‹œë¬¼ì—ì„œëŠ” ë¶„ì‚° í›ˆë ¨(ë‹¤ì¤‘ ë…¸ë“œ/ë‹¤ì¤‘ GPU) ë° ë©”ëª¨ë¦¬ ê´€ë¦¬ì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œë¥¼ ë‹¤ë£¨ë ¤ê³  í•  ê²ƒì…ë‹ˆë‹¤. ì˜ê²¬ì´ ìˆê±°ë‚˜ ë‹¤ìŒì— ì–´ë–¤ ë‚´ìš©ì„ ë‹¤ë£¨ê¸¸ ì›í•˜ì‹œëŠ”ì§€ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”! ì½ì–´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š\n\në˜í•œ ìµœì‹  ê¸°ì‚¬ë¥¼ ë°›ì•„ë³´ê¸° ìœ„í•´ ì—¬ê¸°ì™€ ì œ LinkedIn í”„ë¡œí•„ì—ì„œ íŒ”ë¡œìš°í•´ ì£¼ì„¸ìš”!\n\n\n\n# ì°¸ê³  ìë£Œ\n\n- [PyNorch](https://github.com) - ì´ í”„ë¡œì íŠ¸ì˜ GitHub ì €ì¥ì†Œ \n- [CUDA íŠœí† ë¦¬ì–¼](https://www.example.com/tutorial-cuda) - CUDA ì‘ë™ ë°©ì‹ì— ëŒ€í•œ ê°„ë‹¨í•œ ì†Œê°œ\n- [PyTorch](https://pytorch.org/docs) - PyTorch ë¬¸ì„œ\n\n\n\n# MartinLwx's ë¸”ë¡œê·¸ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ íŠœí† ë¦¬ì–¼.\n\n# ìŠ¤íŠ¸ë¼ì´ë“œ íŠœí† ë¦¬ì–¼ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ ë˜ ë‹¤ë¥¸ íŠœí† ë¦¬ì–¼.\n\n# PyTorch ë‚´ë¶€ êµ¬ì¡° - PyTorch êµ¬ì¡°ì— ëŒ€í•œ ê°€ì´ë“œ.\n\n# ë„¤ì¸  - NumPyë¥¼ ì‚¬ìš©í•œ PyTorch ì¬êµ¬í˜„.\n\n\n\nMarkdownìœ¼ë¡œ í‘œ íƒœê·¸ë¥¼ ë³€ê²½í•˜ì‹­ì‹œì˜¤.","ogImage":{"url":"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png"},"coverImage":"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png","tag":["Tech"],"readingTime":40},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    p: \"p\",\n    img: \"img\",\n    h1: \"h1\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h2, {\n      children: \"C/C++, CUDA, ë° Pythonì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê³ ìœ ì˜ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ êµ¬ì¶•í•´ ë³´ì„¸ìš”. GPU ì§€ì›ê³¼ ìë™ ë¯¸ë¶„ì„ ì œê³µí•©ë‹ˆë‹¤\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_0.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ì†Œê°œ\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ëŸ¬ í•´ ë™ì•ˆ PyTorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³  í›ˆë ¨í•´ ì™”ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³ , ê·¸ ë¬¸ë²•ê³¼ ê·œì¹™ì„ ìµíˆê³ ë„, ì œ ê¶ê¸ˆì¦ì„ ìê·¹í•˜ë˜ ê²ƒì´ ìˆì—ˆìŠµë‹ˆë‹¤: ì´ëŸ¬í•œ ì‘ì—… ì¤‘ì— ë‚´ë¶€ì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ” ê±¸ê¹Œìš”? ì´ ëª¨ë“  ê²ƒì´ ì–´ë–»ê²Œ ì‘ë™í• ê¹Œìš”?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ê¹Œì§€ ì˜¤ì…¨ë‹¤ë©´, ì•„ë§ˆë„ ë¹„ìŠ·í•œ ì§ˆë¬¸ì„ ê°€ì§€ê³  ê³„ì‹¤ ê²ƒì…ë‹ˆë‹¤. íŒŒì´í† ì¹˜(PyTorch)ì—ì„œ ëª¨ë¸ì„ ìƒì„±í•˜ê³  í›ˆë ¨í•˜ëŠ” ë°©ë²•ì„ ë¬¼ì–´ë³¸ë‹¤ë©´ ì•„ë§ˆë„ ì•„ë˜ ì½”ë“œì™€ ë¹„ìŠ·í•œ ê²ƒì„ ìƒê°í•´ë³¼ ê²ƒì…ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" torch\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" torch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"nn\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" nn\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" torch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"optim\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" optim\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \"(nn.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"Module\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \", self).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"fc1\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Linear\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \")\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"sigmoid\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Sigmoid\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"fc2\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Linear\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \")\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, x):\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fc1\"\n        }), \"(x)\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sigmoid\"\n        }), \"(out)\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fc2\"\n        }), \"(out)\\n        \\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" out\\n\\n...\\n\\nmodel = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\ncriterion = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MSELoss\"\n        }), \"()\\noptimizer = optim.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"SGD\"\n        }), \"(model.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"(), lr=\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.001\"\n        }), \")\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" epoch \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"range\"\n        }), \"(epochs):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" x, y \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" ...\\n        \\n        x = x.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\n        y = y.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\n\\n        outputs = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"model\"\n        }), \"(x)\\n        loss = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"criterion\"\n        }), \"(outputs, y)\\n        \\n        optimizer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"()\\n        loss.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"()\\n        optimizer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"step\"\n        }), \"()\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í•˜ì§€ë§Œ ì´ë²ˆì— ì—­ì „íŒŒ(backward) ë‹¨ê³„ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ë¬¼ì–´ë³¸ë‹¤ë©´ ì–´ë–¨ê¹Œìš”? ë˜ëŠ” ì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•  ë•Œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ìš”? ë‚´ë¶€ì—ì„œ ë°ì´í„°ê°€ ì¬ë°°ì¹˜ë˜ë‚˜ìš”? ê·¸ëŸ° ì¼ì´ ì–´ë–»ê²Œ ì¼ì–´ë‚˜ë‚˜ìš”? ì™œ PyTorchëŠ” ë¹ ë¥¸ê°€ìš”? PyTorchê°€ GPU ì—°ì‚°ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ìš”? ì´ëŸ° ì§ˆë¬¸ë“¤ì´ í•­ìƒ ì €ë¥¼ í˜¸ê¸°ì‹¬ ê°€ë“í•˜ê²Œ ë§Œë“¤ì—ˆê³ , ì—¬ëŸ¬ë¶„ë„ ë§ˆì°¬ê°€ì§€ë¡œ í˜¸ê¸°ì‹¬ì´ ë“œì‹¤ ê²ƒì´ë¼ê³  ìƒìƒí•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ëŸ¬í•œ ê°œë…ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ ìŠ¤ìŠ¤ë¡œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì²˜ìŒë¶€í„° êµ¬ì¶•í•´ë³´ëŠ” ê²ƒì´ ë¬´ì—‡ë³´ë‹¤ ì¢‹ì„ê¹Œìš”? ì´ ê¸€ì—ì„œ ì—¬ëŸ¬ë¶„ì´ ë°°ìš°ê²Œ ë  ê²ƒì´ ë°”ë¡œ ê·¸ê²ë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"#1 â€” í…ì„œ\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ê°€ì¥ ë¨¼ì € ì•Œì•„ì•¼ í•  ê°œë…ì€ ë¬´ì—‡ì´ í…ì„œì¸ì§€ì— ëŒ€í•œ ëª…ë°±í•œ ê°œë…ì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…ì„œëŠ” ëª‡ ê°€ì§€ ìˆ«ìë¥¼ í¬í•¨í•˜ëŠ” nì°¨ì› ë°ì´í„° êµ¬ì¡°ì˜ ìˆ˜í•™ì  ê°œë…ì´ë¼ëŠ” ì§ê´€ì ì¸ ìƒê°ì„ ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ê¸°ì„œëŠ” ì´ ë°ì´í„° êµ¬ì¡°ë¥¼ ê³„ì‚°ì  ê´€ì ì—ì„œ ì–´ë–»ê²Œ ëª¨ë¸ë§í• ì§€ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤. í…ì„œëŠ” ë°ì´í„° ìì²´ë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ì–‘ì´ë‚˜ í…ì„œê°€ ìˆëŠ” ì¥ì¹˜(ì˜ˆ: CPU ë©”ëª¨ë¦¬, GPU ë©”ëª¨ë¦¬)ì™€ ê°™ì€ ì¸¡ë©´ì„ ì„¤ëª…í•˜ëŠ” ë©”íƒ€ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…ì„œì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ëŠ” ë° ë§¤ìš° ì¤‘ìš”í•œ ê°œë…ì¸ strideë¼ëŠ” ì˜ ì•Œë ¤ì§€ì§€ ì•Šì€ ë©”íƒ€ë°ì´í„°ë„ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í…ì„œ ë°ì´í„° ì¬ë°°ì—´ì˜ ë‚´ë¶€ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ ì•½ê°„ ë” ì´ì— ëŒ€í•´ ë…¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"2-D í…ì„œì˜ ëª¨ì–‘ì´ [4, 8]ì¸ ê²½ìš°ë¥¼ ìƒìƒí•´ë³´ì„¸ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_2.png\",\n        alt: \"í…ì„œ\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…ì„œì˜ ë°ì´í„°(ì¦‰, ë¶€ë™ ì†Œìˆ˜ì  ìˆ˜)ëŠ” ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ì— 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_3.png\",\n        alt: \"ë°ì´í„°\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ¬ë©´ ì´ 1ì°¨ì› ë°°ì—´ì„ Nì°¨ì› í…ì„œë¡œ ë‚˜íƒ€ë‚´ë ¤ë©´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"4í–‰ 8ì—´ì˜ í–‰ë ¬ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ í–‰ë ¬ì˜ ëª¨ë“  ì›ì†Œê°€ 1ì°¨ì› ë°°ì—´ì˜ í–‰ì— ì˜í•´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ, ìœ„ì¹˜ [2, 3]ì˜ ê°’ì„ ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ 2í–‰(ê° í–‰ì— 8ê°œì˜ ìš”ì†Œ)ì„ íš¡ë‹¨í•´ì•¼ í•˜ë©° ì¶”ê°€ë¡œ 3ê°œì˜ ìœ„ì¹˜ë¥¼ ì§€ë‚˜ì•¼ í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ 1ì°¨ì› ë°°ì—´ì—ì„œ 3 + 2 * 8 ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë”°ë¼ì„œ, '8'ì€ ë‘ ë²ˆì§¸ ì°¨ì›ì˜ ìŠ¤íŠ¸ë¼ì´ë“œì…ë‹ˆë‹¤. ì´ ê²½ìš°, ë°°ì—´ì—ì„œ ë‹¤ë¥¸ ìœ„ì¹˜ë¡œ \\\"ì í”„\\\"í•˜ê¸° ìœ„í•´ ëª‡ ê°œì˜ ìš”ì†Œë¥¼ íš¡ë‹¨í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ë³´ì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë”°ë¼ì„œ, ëª¨ì–‘ì´ [shape_0, shape_1]ì¸ 2ì°¨ì› í…ì„œì˜ ìš”ì†Œ [i, j]ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´, ê¸°ë³¸ì ìœ¼ë¡œ j + i * shape_1 ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ 3ì°¨ì› í…ì„œë¥¼ ìƒìƒí•´ë³´ê² ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_5.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ 3ì°¨ì› í…ì„œë¥¼ í–‰ë ¬ì˜ ì‹œí€€ìŠ¤ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ [5, 4, 8] í…ì„œë¥¼ [4, 8] ëª¨ì–‘ì˜ 5ê°œ í–‰ë ¬ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ [1, 3, 7] ìœ„ì¹˜ì— ìˆëŠ” ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•´ [4,8] í˜•íƒœì˜ í–‰ë ¬ì„ 1ê°œ ì™„ì „íˆ íš¡ë‹¨í•˜ê³ , [8] í˜•íƒœì˜ í–‰ì„ 2ê°œ, [1] í˜•íƒœì˜ ì—´ì„ 7ê°œ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ 1ì°¨ì› ë°°ì—´ì—ì„œ (1 * 4 * 8) + (2 * 8) + (7 * 1) ìœ„ì¹˜ë¥¼ íš¡ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_6.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë”°ë¼ì„œ, [shape_0, shape_1, shape_2] ëª¨ì–‘ì˜ 3ì°¨ì› í…ì„œì—ì„œ 1ì°¨ì› ë°ì´í„° ë°°ì—´ì—ì„œ [i][j][k] ìš”ì†Œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_7.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ shape_1 * shape_2ê°€ ì²« ë²ˆì§¸ ì°¨ì›ì˜ strideì´ê³ , shape_2ëŠ” ë‘ ë²ˆì§¸ ì°¨ì›ì˜ strideì´ë©° 1ì€ ì„¸ ë²ˆì§¸ ì°¨ì›ì˜ strideì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ° ë‹¤ìŒ, ì¼ë°˜í™”í•˜ê¸° ìœ„í•´ì„œëŠ”:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_8.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê° ì°¨ì›ì˜ strideëŠ” ë‹¤ìŒ ì°¨ì› í…ì„œ ëª¨ì–‘ì˜ ê³±ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_9.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ° ë‹¤ìŒ stride[n-1] = 1ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ìš°ë¦¬ì˜ í˜•íƒœì˜ í…ì„œ ì˜ˆì œ [5, 4, 8]ì—ì„œ strides = [4*8, 8, 1] = [32, 8, 1]ì¼ ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ëŸ¬ë¶„ë“¤ë„ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆì–´ìš”:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" torch\\n\\ntorch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"rand\"\n        }), \"([\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \"]).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"stride\"\n        }), \"()\\n#(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"32\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•Œê² ì–´ìš”, ê·¸ëŸ°ë° ì™œ ëª¨ì–‘ê³¼ ìŠ¤íŠ¸ë¼ì´ë“œê°€ í•„ìš”í•œ ê±´ê°€ìš”? Nì°¨ì› í…ì„œì˜ ìš”ì†Œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë„˜ì–´, ì´ ê°œë…ì€ í…ì„œ ë°°ì—´ì„ ë§¤ìš° ì‰½ê²Œ ì¡°ì‘í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆì–´ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì˜ˆë¥¼ ë“¤ì–´, í…ì„œë¥¼ ì¬êµ¬ì„±í•˜ë ¤ë©´ ìƒˆë¡œìš´ ëª¨ì–‘ì„ ì„¤ì •í•˜ê³  ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ê³„ì‚°í•˜ë©´ ë©ë‹ˆë‹¤! (ìƒˆë¡œìš´ ëª¨ì–‘ì€ ë™ì¼í•œ ìš”ì†Œ ìˆ˜ë¥¼ ë³´ì¥í•˜ë¯€ë¡œ)\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" torch\\n\\nt = torch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"rand\"\n        }), \"([\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \"])\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(t.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \")\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"stride\"\n        }), \"())\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"32\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n\\nnew_t = t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"reshape\"\n        }), \"([\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"])\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \")\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"stride\"\n        }), \"())\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"40\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…ì„œ ë‚´ë¶€ì—ì„œëŠ” ì—¬ì „íˆ ë™ì¼í•œ 1ì°¨ì› ë°°ì—´ë¡œ ì €ì¥ë©ë‹ˆë‹¤. reshape ë©”ì„œë“œëŠ” ë°°ì—´ ë‚´ ìš”ì†Œì˜ ìˆœì„œë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤! ëŒ€ë‹¨í•˜ì§€ ì•Šë‚˜ìš”? ğŸ˜\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ PyTorchì—ì„œ ë‚´ë¶€ 1ì°¨ì› ë°°ì—´ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" ctypes\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"t\"\n        }), \": torch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"Tensor\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(\\n        torch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"frombuffer\"\n        }), \"(\\n            ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"string_at\"\n        }), \"(t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"data_ptr\"\n        }), \"(), t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"storage\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"nbytes\"\n        }), \"()), dtype=t.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"dtype\"\n        }), \"\\n        )\\n    )\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(t)\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.0752\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.5898\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.3930\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.9577\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.2276\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.9786\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1009\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.138\"\n        }), \", ...\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(new_t)\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.0752\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.5898\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.3930\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.9577\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.2276\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.9786\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1009\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.138\"\n        }), \", ...\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì˜ˆë¥¼ ë“¤ì–´ ë‘ ì¶•ì„ ì „ì¹˜í•˜ë ¤ë©´ ë‚´ë¶€ì ìœ¼ë¡œ í•´ë‹¹ ìŠ¤íŠ¸ë¼ì´ë“œë¥¼ ë‹¨ìˆœíˆ ë°”ê¾¸ì–´ ì£¼ë©´ ë©ë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"t = torch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"arange\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"24\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"reshape\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \")\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(t)\\n# [[[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"],\\n#   [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \"],\\n#   [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \"]],\\n \\n#  [[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]]]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(t.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \")\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"stride\"\n        }), \"())\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n\\nnew_t = t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"transpose\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \")\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t)\\n# [[[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \"]],\\n\\n#  [[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \"]],\\n\\n#  [[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]]]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \")\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"stride\"\n        }), \"())\\n# [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‚´ë¶€ ë°°ì—´ì„ ì¶œë ¥í•˜ë©´ ë‘ ê°’ ëª¨ë‘ ë™ì¼í•©ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(t)\\n# [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(new_t)\\n# [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ¬ë‚˜ new_tì˜ ìŠ¤íŠ¸ë¼ì´ë“œëŠ” ì´ì œ ìœ„ì˜ ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ê²ƒì€ í…ì„œê°€ ì´ì œ ì—°ì†ì ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤. ì¦‰, ë‚´ë¶€ ë°°ì—´ì€ ë™ì¼í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ ë‚´ì˜ ê°’ì˜ ìˆœì„œê°€ í…ì„œì˜ ì‹¤ì œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.```\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"is_contiguous\"\n        }), \"()\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \"\\n\\nnew_t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"is_contiguous\"\n        }), \"()\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"False\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ëŠ” ì—°ì†ë˜ì§€ ì•ŠëŠ” ìš”ì†Œì— ì—°ì†ì ìœ¼ë¡œ ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤ (ì‹¤ì œ í…ì„œ ìš”ì†ŒëŠ” ë©”ëª¨ë¦¬ ìƒì—ì„œ ìˆœì„œëŒ€ë¡œ ì •ë ¬ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤). ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"new_t_contiguous = new_t.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"contiguous\"\n        }), \"()\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t_contiguous.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"is_contiguous\"\n        }), \"())\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‚´ë¶€ ë°°ì—´ì„ ë¶„ì„í•˜ë©´ ì´ì œ ìˆœì„œê°€ ì‹¤ì œ í…ì„œ ìˆœì„œì™€ ì¼ì¹˜í•˜ì—¬ ë” ë‚˜ì€ ë©”ëª¨ë¦¬ ì•¡ì„¸ìŠ¤ íš¨ìœ¨ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:```\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(new_t)\\n# [[[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \"]],\\n\\n#  [[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \"]],\\n\\n#  [[ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \"],\\n#   [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]]]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(new_t)\\n# [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print_internal\"\n        }), \"(new_t_contiguous)\\n# [ \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"21\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"22\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"23\"\n        }), \"]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ ìš°ë¦¬ëŠ” í…ì„œê°€ ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€ ì´í•´í–ˆìœ¼ë‹ˆ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„±ì„ ì‹œì‘í•´ ë´…ì‹œë‹¤!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‚´ê°€ ë§Œë“¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ì€ Norchì…ë‹ˆë‹¤. PyTorchê°€ ì•„ë‹Œ (NOT PyTorch)ì„ ì˜ë¯¸í•˜ë©°, ì„±(Nogueira)ì„ ì•”ì‹œí•˜ê¸°ë„ í•©ë‹ˆë‹¤. ğŸ˜\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì²« ë²ˆì§¸ë¡œ ì•Œì•„ì•¼ í•  ê²ƒì€ PyTorchê°€ Pythonì„ í†µí•´ ì‚¬ìš©ë˜ì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” C/C++ë¡œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë¨¼ì € ë‚´ë¶€ C/C++ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë¨¼ì € í…ì„œë¥¼ ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¡œ ì •ì˜í•˜ê³  ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ í•¨ìˆ˜ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\n#include \u003cstdio.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"h\"\n        }), \"\u003e\\n#include \u003cstdlib.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"h\"\n        }), \"\u003e\\n#include \u003cstring.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"h\"\n        }), \"\u003e\\n#include \u003cmath.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"h\"\n        }), \"\u003e\\n\\ntypedef struct {\\n    float* data;\\n    int* strides;\\n    int* shape;\\n    int ndim;\\n    int size;\\n    char* device;\\n} \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \";\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"* \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"float* data, int* shape, int ndim\"\n        }), \") {\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"* tensor = (\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n    tensor-\u003edata = data;\\n    tensor-\u003eshape = shape;\\n    tensor-\u003endim = ndim;\\n\\n    tensor-\u003esize = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c ndim; i++) {\\n        tensor-\u003esize *= shape[i];\\n    }\\n\\n    tensor-\u003estrides = (int*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(ndim * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(int));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor-\u003estrides == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n    int stride = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = ndim - \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"; i \u003e= \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i--) {\\n        tensor-\u003estrides[i] = stride;\\n        stride *= shape[i];\\n    }\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" tensor;\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì¼ë¶€ ìš”ì†Œì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” ì•ì„œ ë°°ì› ë˜ ìŠ¤íŠ¸ë¼ì´ë“œ(strides)ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\nfloat \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"get_item\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor, int* indices\"\n        }), \") {\\n    int index = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c tensor-\u003endim; i++) {\\n        index += indices[i] * tensor-\u003estrides[i];\\n    }\\n\\n    float result;\\n    result = tensor-\u003edata[index];\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" result;\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ í…ì„œ ì‘ì—…ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª‡ ê°€ì§€ ì˜ˆì œë¥¼ ë³´ì—¬ë“œë¦¬ê² ê³ , ì´ ê¸€ ëì— ë§í¬ëœ ì €ì¥ì†Œì—ì„œ ì™„ì „í•œ ë²„ì „ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/cpu.cpp\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cpu\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2, float* result_data\"\n        }), \") {\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c tensor1-\u003esize; i++) {\\n        result_data[i] = tensor1-\u003edata[i] + tensor2-\u003edata[i];\\n    }\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sub_tensor_cpu\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2, float* result_data\"\n        }), \") {\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c tensor1-\u003esize; i++) {\\n        result_data[i] = tensor1-\u003edata[i] - tensor2-\u003edata[i];\\n    }\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"elementwise_mul_tensor_cpu\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2, float* result_data\"\n        }), \") {\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c tensor1-\u003esize; i++) {\\n        result_data[i] = tensor1-\u003edata[i] * tensor2-\u003edata[i];\\n    }\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"assign_tensor_cpu\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor, float* result_data\"\n        }), \") {\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c tensor-\u003esize; i++) {\\n        result_data[i] = tensor-\u003edata[i];\\n    }\\n}\\n\\n...\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ ë‹¤ìŒì—, ì´ëŸ¬í•œ ì‘ì—…ë“¤ì„ í˜¸ì¶œí•  í…ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"* \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2\"\n        }), \") {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor1-\u003endim != tensor2-\u003endim) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d\\\\n\\\"\"\n        }), \", tensor1-\u003endim, tensor2-\u003endim);\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    int ndim = tensor1-\u003endim;\\n    int* shape = (int*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(ndim * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(int));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (shape == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c ndim; i++) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor1-\u003eshape[i] != tensor2-\u003eshape[i]) {\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤ %d ì™€ %d ì¸ë±ìŠ¤ %dì—ì„œ\\\\n\\\"\"\n        }), \", tensor1-\u003eshape[i], tensor2-\u003eshape[i], i);\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n        }\\n        shape[i] = tensor1-\u003eshape[i];\\n    }        \\n    float* result_data = (float*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(tensor1-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (result_data == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cpu\"\n        }), \"(tensor1, tensor2, result_data);\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(result_data, shape, ndim, device);\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì „ì— ì–¸ê¸‰í•œ ëŒ€ë¡œ, í…ì„œ ì¬êµ¬ì„±ì€ ë‚´ë¶€ ë°ì´í„° ë°°ì—´ì„ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"* \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"reshape_tensor\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor, int* new_shape, int new_ndim\"\n        }), \") {\\n\\n    int ndim = new_ndim;\\n    int* shape = (int*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(ndim * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(int));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (shape == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c ndim; i++) {\\n        shape[i] = new_shape[i];\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ ê³„ì‚°\"\n        }), \"\\n    int size = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c new_ndim; i++) {\\n        size *= shape[i];\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ì´ ìš”ì†Œ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (size != tensor-\u003esize) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"í…ì„œë¥¼ ì¬êµ¬ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ëª¨ì–‘ì˜ ìš”ì†Œ ì´ ìˆ˜ê°€ í˜„ì¬ í…ì„œì˜ í¬ê¸°ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    float* result_data = (float*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(tensor-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (result_data == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"assign_tensor_cpu\"\n        }), \"(tensor, result_data);\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(result_data, shape, ndim, device);\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ ì¼ë¶€ í…ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì§€ë§Œ, ëˆ„êµ¬ë‚˜ C/C++ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ì´ì œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Pythonì„ ì‚¬ìš©í•˜ì—¬ C/C++ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. Pybind11ê³¼ Cython ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì˜ˆì‹œì—ì„œëŠ” ctypesë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•„ë˜ëŠ” ctypesì˜ ê¸°ë³¸ì ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//C ì½”ë“œ\"\n        }), \"\\n#include \u003cstdio.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"h\"\n        }), \"\u003e\\n\\nfloat \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_floats\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"float a, float b\"\n        }), \") {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" a + b;\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# ì»´íŒŒì¼\\ngcc -shared -o add_floats.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"so\"\n        }), \" -fPIC add_floats.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Python\"\n        }), \" ì½”ë“œ\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" ctypes\\n\\n# ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ\\nlib = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"CDLL\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'./add_floats.so'\"\n        }), \")\\n\\n# í•¨ìˆ˜ì˜ ì¸ìì™€ ë°˜í™˜ ìœ í˜• ì •ì˜\\nlib.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"add_floats\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \"]\\nlib.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"add_floats\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \"\\n\\n# íŒŒì´ì¬ float ê°’ì„ c_float ìœ í˜•ìœ¼ë¡œ ë³€í™˜\\na = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"c_float\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.5\"\n        }), \")\\nb = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"c_float\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.2\"\n        }), \")\\n\\n# C í•¨ìˆ˜ í˜¸ì¶œ\\nresult = lib.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_floats\"\n        }), \"(a, b)\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(result)\\n# \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5.7\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë³´ì‹œë‹¤ì‹œí”¼ ë§¤ìš° ì§ê´€ì ì…ë‹ˆë‹¤. C/C++ ì½”ë“œë¥¼ ì»´íŒŒì¼í•œ í›„ Pythonì—ì„œ ctypesë¥¼ ì‚¬ìš©í•˜ë©´ ë§¤ìš° ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ ë° ë°˜í™˜ c_typesë¥¼ ì •ì˜í•˜ê³ , ë³€ìˆ˜ë¥¼ í•´ë‹¹ c_typesë¡œ ë³€í™˜í•˜ê³  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ë°°ì—´(ë¶€ë™ ì†Œìˆ˜ì  ëª©ë¡)ê³¼ ê°™ì€ ë³´ë‹¤ ë³µì¡í•œ ìœ í˜•ì˜ ê²½ìš° í¬ì¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"data = [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.0\"\n        }), \"]\\ndata_ctype = (ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \" * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(data))(*data)\\n\\nlib.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"some_array_func\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argstypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \")]\\n\\n...\\n\\nlib.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"some_array_func\"\n        }), \"(data)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ë¦¬ê³  êµ¬ì¡°ì²´ ìœ í˜•ì˜ ê²½ìš° ì§ì ‘ c_typeì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CustomType\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"Structure\"\n        }), \"):\\n    _fields_ = [\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'field1'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \")),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'field2'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \")),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'field3'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"),\\n    ]\\n\\n# ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CustomType\"\n        }), \")ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê°„ë‹¨íˆ ì„¤ëª…í•˜ê³ , í…ì„œ C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìœ„í•œ Python ë˜í¼ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/tensor.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" ctypes\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"Structure\"\n        }), \"):\\n    _fields_ = [\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'data'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \")),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'strides'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \")),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'shape'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \")),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'ndim'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"),\\n        (\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'size'\"\n        }), \", ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"),\\n    ]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \":\\n    os.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"path\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"abspath\"\n        }), \"(os.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"curdir\"\n        }), \")\\n    _C = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"CDLL\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"COMPILED_LIB.so\\\"\"\n        }), \")\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n        \\n        data, shape = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flatten\"\n        }), \"(data)\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"data_ctype\"\n        }), \" = (ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \" * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(data))(*data)\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape_ctype\"\n        }), \" = (ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \" * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(shape))(*shape)\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim_ctype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"c_int\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(shape))\\n       \\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \" = shape\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(shape)\\n\\n        \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"create_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"]\\n        \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"create_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \")\\n\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"data_ctype\"\n        }), \",\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape_ctype\"\n        }), \",\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim_ctype\"\n        }), \",\\n        )\\n        \\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flatten\"\n        }), \"(self, nested_list):\\n        \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n        This method simply convert a list type tensor to a flatten tensor with its shape\\n        \\n        Example:\\n        \\n        Arguments:  \\n            nested_list: [[1, 2, 3], [-5, 2, 0]]\\n        Return:\\n            flat_data: [1, 2, 3, -5, 2, 0]\\n            shape: [2, 3]\\n        \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n        def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flatten_recursively\"\n        }), \"(nested_list):\\n            flat_data = []\\n            shape = []\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(nested_list, list):\\n                \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" sublist \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"nested_list\"\n        }), \":\\n                    inner_data, inner_shape = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flatten_recursively\"\n        }), \"(sublist)\\n                    flat_data.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"extend\"\n        }), \"(inner_data)\\n                shape.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"append\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(nested_list))\\n                shape.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"extend\"\n        }), \"(inner_shape)\\n            \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"else\"\n        }), \":\\n                flat_data.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"append\"\n        }), \"(nested_list)\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" flat_data, shape\\n        \\n        flat_data, shape = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flatten_recursively\"\n        }), \"(nested_list)\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" flat_data, shape\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ Python í…ì„œ ì‘ì—…ì„ í¬í•¨í•˜ì—¬ C/C++ ì‘ì—…ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/tensor.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__getitem__\"\n        }), \"(self, indices):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    index í…ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ í…ì„œì— ì•¡ì„¸ìŠ¤ tensor[i, j, k...]\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(indices) != self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim\"\n        }), \":\\n        raise \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ValueError\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ì¸ë±ìŠ¤ ìˆ˜ê°€ ì°¨ì› ìˆ˜ì™€ ì¼ì¹˜í•´ì•¼ í•¨\\\"\"\n        }), \")\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"get_item\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \")]\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"get_item\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_float\"\n        }), \"\\n                                       \\n    indices = (ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \" * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(indices))(*indices)\\n    value = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"get_item\"\n        }), \"(self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \", indices)  \\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" value\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"reshape\"\n        }), \"(self, new_shape):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    í…ì„œë¥¼ ì¬êµ¬ì„±í•©ë‹ˆë‹¤\\n    result = tensor.reshape([1,2])\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n    new_shape_ctype = (ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \" * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(new_shape))(*new_shape)\\n    new_ndim_ctype = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"c_int\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(new_shape))\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"reshape_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_int\"\n        }), \"]\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"reshape_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \")\\n    result_tensor_ptr = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"reshape_tensor\"\n        }), \"(self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \", new_shape_ctype, new_ndim_ctype)   \\n\\n    result_data = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"()\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \" = result_tensor_ptr\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \" = new_shape.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"copy\"\n        }), \"()\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(new_shape)\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \" = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \"\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" result_data\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__add__\"\n        }), \"(self, other):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    í…ì„œë¥¼ ë”í•©ë‹ˆë‹¤\\n    result = tensor1 + tensor2\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \" != other.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \":\\n        raise \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ValueError\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ì„œ í…ì„œë“¤ì€ ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•¨\\\"\"\n        }), \")\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"add_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \")]\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"add_tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \")\\n\\n    result_tensor_ptr = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor\"\n        }), \"(self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \", other.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \")\\n\\n    result_data = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"()\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \" = result_tensor_ptr\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \" = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"copy\"\n        }), \"()\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim\"\n        }), \" = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"ndim\"\n        }), \"\\n    result_data.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \" = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \"\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" result_data\\n\\n# ê¸°íƒ€ ì—°ì‚° í¬í•¨:\\n# __str__\\n# __sub__ (-)\\n# __mul__ (*)\\n# __matmul__ (@)\\n# __pow__ (**)\\n# __truediv__ (/)\\n# log\\n# ...\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ê¹Œì§€ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ì´ì œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  í…ì„œ ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì´ ìƒê²¼ìŠµë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" norch\\n\\ntensor1 = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]])\\ntensor2 = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"]])\\n\\nresult = tensor1 + tensor2\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(result[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"])\\n# \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \" \\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"#2 â€” GPU ì§€ì›\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ìš°ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë§Œë“  í›„, ì´ì œ ìƒˆë¡œìš´ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì–´ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ GPUë¡œ ì „ì†¡í•˜ê³  ìˆ˜í•™ ì—°ì‚°ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ \", _jsx(_components.code, {\n        children: \".to(\\\"cuda\\\")\"\n      }), \"ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ ì˜ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. CUDAê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê¸°ë³¸ ì§€ì‹ì´ ìˆì„ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤ë§Œ, ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° ë‹¤ë¥¸ ê¸°ì‚¬ì¸ 'CUDA íŠœí† ë¦¬ì–¼'ì„ ì½ì–´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ê¸°ë‹¤ë¦´ê²Œìš”. ğŸ˜Š\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"...\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê¸‰í•œ ì‚¬ëŒë“¤ì„ ìœ„í•´, ê°„ë‹¨í•œ ì†Œê°œê°€ ì—¬ê¸° ìˆì–´ìš”:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê¸°ë³¸ì ìœ¼ë¡œ, ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë“  ì½”ë“œëŠ” CPU ë©”ëª¨ë¦¬ì—ì„œ ì‹¤í–‰ë˜ê³  ìˆì–´ìš”. í•˜ë‚˜ì˜ ì‘ì—…ì— ëŒ€í•´ì„œëŠ” CPUê°€ ë¹ ë¥´ì§€ë§Œ, GPUì˜ ì¥ì ì€ ë³‘ë ¬í™” ëŠ¥ë ¥ì— ìˆì–´ìš”. CPU ë””ìì¸ì€ ì—°ì‚°(ìŠ¤ë ˆë“œ)ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•œ ë°˜ë©´, GPU ë””ìì¸ì€ ìˆ˜ë°±ë§Œ ê°œì˜ ì—°ì‚°ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¥¼ í•´ìš” (ê°œë³„ ìŠ¤ë ˆë“œì˜ ì„±ëŠ¥ì„ í¬ìƒí•˜ë©°).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì´ ëŠ¥ë ¥ì„ í™œìš©í•˜ì—¬ ë³‘ë ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ìš”. ì˜ˆë¥¼ ë“¤ì–´, ë°±ë§Œ ê°œì˜ ìš”ì†Œë¡œ êµ¬ì„±ëœ í…ì„œë¥¼ ì¶”ê°€í•  ë•Œ, ë°˜ë³µë¬¸ ë‚´ì—ì„œ ê° ìƒ‰ì¸ì˜ ìš”ì†Œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ , GPUë¥¼ ì‚¬ìš©í•˜ì—¬ í•œêº¼ë²ˆì— ëª¨ë‘ë¥¼ ë³‘ë ¬ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”. ì´ë¥¼ ìœ„í•´ NVIDIAì—ì„œ ê°œë°œí•œ ê°œë°œìë“¤ì´ GPU ì§€ì›ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í†µí•©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í”Œë«í¼ì¸ CUDAë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ê±¸ í•˜ë ¤ë©´, íŠ¹ì • GPU ì‘ì—…(ì˜ˆ: CPU ë©”ëª¨ë¦¬ì—ì„œ GPU ë©”ëª¨ë¦¬ë¡œ ë°ì´í„° ë³µì‚¬)ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ê°„ë‹¨í•œ C/C++ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤ ì¸ CUDA C/C++ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•„ë˜ ì½”ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ CPUì—ì„œ GPUë¡œ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ê³  ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” AddTwoArrays í•¨ìˆ˜(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ Nê°œì˜ GPU ìŠ¤ë ˆë“œì—ì„œ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ëŠ” ëª‡ ê°€ì§€ CUDA C/C++ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsxs(_components.span, {\n          className: \"hljs-meta\",\n          children: [\"#\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"include\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\u003cstdio.h\u003e\"\n          })]\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// CPU ë²„ì „(ë¹„êµìš©)\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"AddTwoArrays_CPU\"\n        }), _jsxs(_components.span, {\n          className: \"hljs-params\",\n          children: [\"(flaot A[], \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"float\"\n          }), \" B[], \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"float\"\n          }), \" C[])\"]\n        }), \" {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c N; i++) {\\n        C[i] = A[i] + B[i];\\n    }\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ì»¤ë„ ì •ì˜\"\n        }), \"\\n__global__ \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"AddTwoArrays_GPU\"\n        }), _jsxs(_components.span, {\n          className: \"hljs-params\",\n          children: [\"(\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"float\"\n          }), \" A[], \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"float\"\n          }), \" B[], \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"float\"\n          }), \" C[])\"]\n        }), \" {\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" i = threadIdx.x;\\n    C[i] = A[i] + B[i];\\n}\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"main\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"()\"\n        }), \" {\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" N = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1000\"\n        }), \"; \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ë°°ì—´ í¬ê¸°\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \" A[N], B[N], C[N]; \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ë°°ì—´ A, B, C\"\n        }), \"\\n\\n    ...\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \" *d_A, *d_B, *d_C; \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ë°°ì—´ A, B, Cì˜ ì¥ì¹˜ í¬ì¸í„°\"\n        }), \"\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ë°°ì—´ A, B, Cì— ëŒ€í•œ ì¥ì¹˜ì—ì„œì˜ ë©”ëª¨ë¦¬ í• ë‹¹\"\n        }), \"\\n    cudaMalloc((\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" **)\u0026d_A, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"));\\n    cudaMalloc((\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" **)\u0026d_B, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"));\\n    cudaMalloc((\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" **)\u0026d_C, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"));\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// í˜¸ìŠ¤íŠ¸ì—ì„œ ì¥ì¹˜ë¡œ ë°°ì—´ A ë° B ë³µì‚¬\"\n        }), \"\\n    cudaMemcpy(d_A, A, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"), cudaMemcpyHostToDevice);\\n    cudaMemcpy(d_B, B, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"), cudaMemcpyHostToDevice);\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// Nê°œì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë„ í˜¸ì¶œ\"\n        }), \"\\n    AddTwoArrays_GPU\u003c\u003c\u003c\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", N\u003e\u003e\u003e(d_A, d_B, d_C);\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// ì¥ì¹˜ì—ì„œ í˜¸ìŠ¤íŠ¸ë¡œ ë²¡í„° C ë³µì‚¬\"\n        }), \"\\n    cudaMemcpy(C, d_C, N * \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"float\"\n        }), \"), cudaMemcpyDeviceToHost);\\n\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì£¼ëª©í•  ì ì€ ê° ìš”ì†Œ ìŒì„ ê°ê° ì¶”ê°€í•˜ëŠ” ëŒ€ì‹  ëª¨ë“  ë§ì…ˆ ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ì—¬ ë£¨í”„ ëª…ë ¹ì„ ì œê±°í•œ ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê°„ë‹¨í•œ ì†Œê°œ ì´í›„ì—, í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆì–´ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” CPUì—ì„œ GPUë¡œ í…ì„œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to_device\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor, char* target_device\"\n        }), \") {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" ((\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(target_device, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \") == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \") \u0026\u0026 (\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(tensor-\u003edevice, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cpu\\\"\"\n        }), \") == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \")) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cpu_to_cuda\"\n        }), \"(tensor);\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" ((\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(target_device, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cpu\\\"\"\n        }), \") == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \") \u0026\u0026 (\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(tensor-\u003edevice, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \") == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \")) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cuda_to_cpu\"\n        }), \"(tensor);\\n    }\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/cuda.cu\"\n        }), \"\\n\\n__host__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cpu_to_cuda\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor\"\n        }), \") {\\n    \\n    float* data_tmp;\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaMalloc\"\n        }), \"((\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" **)\u0026data_tmp, tensor-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaMemcpy\"\n        }), \"(data_tmp, tensor-\u003edata, tensor-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float), cudaMemcpyHostToDevice);\\n\\n    tensor-\u003edata = data_tmp;\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" char* device_str = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \";\\n    tensor-\u003edevice = (char*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strlen\"\n        }), \"(device_str) + \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcpy\"\n        }), \"(tensor-\u003edevice, device_str); \\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\\\\n\\\"\"\n        }), \", tensor-\u003edevice);\\n}\\n\\n__host__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cuda_to_cpu\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor\"\n        }), \") {\\n    float* data_tmp = (float*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(tensor-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaMemcpy\"\n        }), \"(data_tmp, tensor-\u003edata, tensor-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float), cudaMemcpyDeviceToHost);\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaFree\"\n        }), \"(tensor-\u003edata);\\n\\n    tensor-\u003edata = data_tmp;\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"const\"\n        }), \" char* device_str = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cpu\\\"\"\n        }), \";\\n    tensor-\u003edevice = (char*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strlen\"\n        }), \"(device_str) + \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcpy\"\n        }), \"(tensor-\u003edevice, device_str); \\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"í…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ %së¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\\\\n\\\"\"\n        }), \", tensor-\u003edevice);\\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„ëœ ë˜í¼:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/tensor.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(self, device):\\n    self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \" = device\\n    self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device_ctype\"\n        }), \" = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"encode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'utf-8'\"\n        }), \")\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"to_device\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"argtypes\"\n        }), \" = [ctypes.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"POINTER\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CTensor\"\n        }), \"), ctypes.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"c_char_p\"\n        }), \"]\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"to_device\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"restype\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"None\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_C\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to_device\"\n        }), \"(self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \", self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"device_ctype\"\n        }), \")\\n  \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" self\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‹¤ìŒìœ¼ë¡œ, ëª¨ë“  í…ì„œ ì—°ì‚°ì— ëŒ€í•´ GPU ë²„ì „ì„ ìƒì„±í•©ë‹ˆë‹¤. ë§ì…ˆê³¼ ëº„ì…ˆì— ëŒ€í•œ ì˜ˆì œë¥¼ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/cuda.cu\"\n        }), \"\\n\\n#define \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"128\"\n        }), \"\\n\\n__global__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cuda_kernel\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"float* data1, float* data2, float* result_data, int size\"\n        }), \") {\\n    \\n    int i = blockIdx.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \" * blockDim.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \" + threadIdx.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (i \u003c size) {\\n        result_data[i] = data1[i] + data2[i];\\n    }\\n}\\n\\n__host__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cuda\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2, float* result_data\"\n        }), \") {\\n    \\n    int number_of_blocks = (tensor1-\u003esize + \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \" - \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") / \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \";\\n    add_tensor_cuda_kernel\u003c\u003c\u003cnumber_of_blocks, \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \"\u003e\u003e\u003e(tensor1-\u003edata, tensor2-\u003edata, result_data, tensor1-\u003esize);\\n\\n    cudaError_t error = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaGetLastError\"\n        }), \"();\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (error != cudaSuccess) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"CUDA error: %s\\\\n\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaGetErrorString\"\n        }), \"(error));\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaDeviceSynchronize\"\n        }), \"();\\n}\\n\\n__global__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sub_tensor_cuda_kernel\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"float* data1, float* data2, float* result_data, int size\"\n        }), \") {\\n   \\n    int i = blockIdx.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \" * blockDim.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \" + threadIdx.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"x\"\n        }), \";\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (i \u003c size) {\\n        result_data[i] = data1[i] - data2[i];\\n    }\\n}\\n\\n__host__ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sub_tensor_cuda\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2, float* result_data\"\n        }), \") {\\n    \\n    int number_of_blocks = (tensor1-\u003esize + \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \" - \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") / \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \";\\n    sub_tensor_cuda_kernel\u003c\u003c\u003cnumber_of_blocks, \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"THREADS_PER_BLOCK\"\n        }), \"\u003e\u003e\u003e(tensor1-\u003edata, tensor2-\u003edata, result_data, tensor1-\u003esize);\\n\\n    cudaError_t error = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaGetLastError\"\n        }), \"();\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (error != cudaSuccess) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"CUDA error: %s\\\\n\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaGetErrorString\"\n        }), \"(error));\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaDeviceSynchronize\"\n        }), \"();\\n}\\n\\n...\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ° ë‹¤ìŒ, í…ì„œ.cppì— ìƒˆë¡œìš´ í…ì„œ ì†ì„± char* deviceë¥¼ ì¶”ê°€í•˜ê³  ì‘ì—…ì„ ì‹¤í–‰í•  ìœ„ì¹˜(CPU ë˜ëŠ” GPU)ë¥¼ ì„ íƒí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"//norch/csrc/tensor.cpp\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"* \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"Tensor* tensor1, Tensor* tensor2\"\n        }), \") {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor1-\u003endim != tensor2-\u003endim) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ í…ì„œê°€ ë™ì¼í•œ ì°¨ì› ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\\\\n\\\"\"\n        }), \", tensor1-\u003endim, tensor2-\u003endim);\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(tensor1-\u003edevice, tensor2-\u003edevice) != \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"í…ì„œëŠ” ë™ì¼í•œ ì¥ì¹˜ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤: %s and %s\\\\n\\\"\"\n        }), \", tensor1-\u003edevice, tensor2-\u003edevice);\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    char* device = (char*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strlen\"\n        }), \"(tensor1-\u003edevice) + \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (device != \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcpy\"\n        }), \"(device, tensor1-\u003edevice);\\n    } \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \" {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n    int ndim = tensor1-\u003endim;\\n    int* shape = (int*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(ndim * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(int));\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (shape == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (int i = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"; i \u003c ndim; i++) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (tensor1-\u003eshape[i] != tensor2-\u003eshape[i]) {\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ í…ì„œë“¤ì€ ìƒ‰ì¸ %dì—ì„œ ë™ì¼í•œ í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤ %d and %d\\\\n\\\"\"\n        }), \", i, tensor1-\u003eshape[i], tensor2-\u003eshape[i]);\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n        }\\n        shape[i] = tensor1-\u003eshape[i];\\n    }        \\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"strcmp\"\n        }), \"(tensor1-\u003edevice, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \") == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \") {\\n\\n        float* result_data;\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cudaMalloc\"\n        }), \"((\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"void\"\n        }), \" **)\u0026result_data, tensor1-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cuda\"\n        }), \"(tensor1, tensor2, result_data);\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(result_data, shape, ndim, device);\\n    } \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \" {\\n        float* result_data = (float*)\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"malloc\"\n        }), \"(tensor1-\u003esize * \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sizeof\"\n        }), \"(float));\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (result_data == \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"NULL\"\n        }), \") {\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fprintf\"\n        }), \"(stderr, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨\\\\n\\\"\"\n        }), \");\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"exit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \");\\n        }\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"add_tensor_cpu\"\n        }), \"(tensor1, tensor2, result_data);\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_tensor\"\n        }), \"(result_data, shape, ndim, device);\\n    }     \\n}\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ GPU ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" norch\\n\\ntensor1 = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]]).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \")\\ntensor2 = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"]]).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \")\\n\\nresult = tensor1 + tensor2\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"#3 â€” Automatic Differentiation (Autograd)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"íŒŒì´í† ì¹˜ê°€ ì¸ê¸°ë¥¼ ì–»ê²Œ ëœ ì£¼ìš” ì´ìœ  ì¤‘ í•˜ë‚˜ëŠ” Autograd ëª¨ë“ˆ ë•Œë¬¸ì…ë‹ˆë‹¤. Autograd ëª¨ë“ˆì€ ìë™ ë¯¸ë¶„ì„ ìˆ˜í–‰í•˜ì—¬ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤ (ê²½ì‚¬ í•˜ê°•ë²•ê³¼ ê°™ì€ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤). .backward()ë¼ëŠ” ë‹¨ì¼ ë©”ì„œë“œ í˜¸ì¶œë¡œ ì´ì „ í…ì„œ ì—°ì‚°ì—ì„œ ëª¨ë“  ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"x = torch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]], requires_grad=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \")\\n# [[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"],\\n#  [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]]\\n\\ny = torch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"tensor\"\n        }), \"([[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"], [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"]], requires_grad=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \")\\n# [[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"],\\n#  [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"]]\\n\\nL = ((x - y) ** \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"()\\n\\nL.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"()\\n\\n# xì™€ yì˜ ê¸°ìš¸ê¸°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(x.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"grad\"\n        }), \")\\n# [[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \"],\\n#  [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \"]]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(y.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"grad\"\n        }), \")\\n# [[-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", -\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \"],\\n#  [-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \", -\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12\"\n        }), \"]]\\n\\n# zë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ì„œëŠ” ê²½ì‚¬ í•˜ê°•ë²•ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\\n# x = x - í•™ìŠµë¥  * x.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"grad\"\n        }), \"\\n# y = y - í•™ìŠµë¥  * y.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"grad\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€ ì´í•´í•˜ê¸° ìœ„í•´ ë™ì¼í•œ ì ˆì°¨ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³µì œí•´ë³´ê² ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_10.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ìš°ì„  ê³„ì‚°í•´ ë´…ì‹œë‹¤:\"\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_11.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"xê°€ í–‰ë ¬ì´ë¼ëŠ” ê²ƒì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê° ìš”ì†Œì— ëŒ€í•œ Lì˜ ë¯¸ë¶„ì„ ê°œë³„ì ìœ¼ë¡œ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ê²Œë‹¤ê°€, Lì€ ëª¨ë“  ìš”ì†Œì— ëŒ€í•œ í•©ì´ì§€ë§Œ ê° ìš”ì†Œì— ëŒ€í•œ ë¯¸ë¶„ì—ì„œ ë‹¤ë¥¸ ìš”ì†Œë“¤ì€ ì¤‘ìš”í•œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•­ì„ ì–»ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_12.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê° í•­ì— ëŒ€í•´ ì—°ì‡„ ë²•ì¹™ì„ ì ìš©í•˜ì—¬ ì™¸ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•˜ê³  ë‚´ë¶€ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•œ ê°’ì„ ê³±í•©ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_13.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì¹¨ë‚´:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_14.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ¬ë¯€ë¡œ, xì— ê´€í•œ Lì˜ ë¯¸ë¶„ì„ ê³„ì‚°í•˜ëŠ” ìµœì¢… ë°©ì •ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•„ë˜ëŠ” Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½ëœ ë‚´ìš©ì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_16.png\",\n        alt: \"Image 1\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Substituting the values into the equation:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_17.png\",\n        alt: \"Image 2\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Calculating the result, we get the same values we obtained with PyTorch:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_18.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, letâ€™s analyze what we just did:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Basically, we observed all the operations involved in reverse order: a summation, a power of 3, and a subtraction. Then, we applied the chain rule, calculating the derivative of each operation and recursively calculated the derivative for the next operation. So, first we need an implementation of the derivative for different math operations:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For addition:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_19.png\",\n        alt: \"Image\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/autograd/functions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"AddBackward\"\n        }), \":\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, x, y):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input\"\n        }), \" = [x, y]\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(self, gradient):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [gradient, gradient]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For sin:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_20.png\",\n        alt: \"Image\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/autograd/functions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"SinBackward\"\n        }), \":\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, x):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input\"\n        }), \" = [x]\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(self, gradient):\\n        x = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"]\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [x.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"cos\"\n        }), \"() * gradient]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì½”ì‚¬ì¸ì— ëŒ€í•´:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21.png\",\n        alt: \"2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_21\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/autograd/functions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"CosBackward\"\n        }), \":\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, x):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input\"\n        }), \" = [x]\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(self, gradient):\\n        x = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"]\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [- x.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sin\"\n        }), \"() * gradient]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ìš”ì†Œë³„ ê³±ì…ˆì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•´ë³´ì„¸ìš”:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_22.png\",\n        alt: \"element-wise multiplication\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# norch/autograd/functions.py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"ElementwiseMulBackward\"\n        }), \":\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self, x, y\"\n        }), \"):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \" = [x, y]\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self, gradient\"\n        }), \"):\\n        x = self.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"]\\n        y = self.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [y * gradient, x * gradient]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í•©ì‚°ì— ëŒ€í•´ì„œ:\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"norch/autograd/functions.py\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"SumBackward\"\n        }), \":\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self, x\"\n        }), \"):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \" = [x]\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self, gradient\"\n        }), \"):\\n        \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# sum í•¨ìˆ˜ëŠ” í…ì„œë¥¼ ìŠ¤ì¹¼ë¼ë¡œ ì¤„ì´ë¯€ë¡œ ê¸°ìš¸ê¸°ë¥¼ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë©ë‹ˆë‹¤.\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"float\"\n        }), \"(gradient.tensor.contents.data[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"]) * self.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"].ones_like()]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë‹¤ë¥¸ ì—°ì‚°ì„ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” GitHub ì €ì¥ì†Œ ë§í¬ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ ê° ì‘ì—…ì— ëŒ€í•œ ë„í•¨ìˆ˜ ì‹ì„ ê°€ì¡Œìœ¼ë‹ˆ, ì¬ê·€ì ìœ¼ë¡œ ì—­ì „íŒŒ ì²´ì¸ ê·œì¹™ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í…ì„œì— requires_grad ì¸ìë¥¼ ì„¤ì •í•˜ì—¬ ì´ í…ì„œì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Trueì´ë©´ ê° í…ì„œ ì‘ì—…ì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# norch/tensor.py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__add__\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self, other\"\n        }), \"):\\n\\n  \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" self.shape != other.shape:\\n      \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"raise\"\n        }), \" ValueError(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"ë§ì…ˆì„ ìœ„í•´ í…ì„œëŠ” ë™ì¼í•œ ëª¨ì–‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.\\\"\"\n        }), \")\\n  \\n  Tensor._C.add_tensor.argtypes = [ctypes.POINTER(CTensor), ctypes.POINTER(CTensor)]\\n  Tensor._C.add_tensor.restype = ctypes.POINTER(CTensor)\\n  \\n  result_tensor_ptr = Tensor._C.add_tensor(self.tensor, other.tensor)\\n  \\n  result_data = Tensor()\\n  result_data.tensor = result_tensor_ptr\\n  result_data.shape = self.shape.copy()\\n  result_data.ndim = self.ndim\\n  result_data.device = self.device\\n  \\n  result_data.requires_grad = self.requires_grad \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"or\"\n        }), \" other.requires_grad\\n  \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" result_data.requires_grad:\\n      result_data.grad_fn = AddBackward(self, other)\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ê·¸ëŸ¼, \", _jsx(_components.code, {\n        children: \".backward()\"\n      }), \" ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ë³´ì„¸ìš”:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# norch/tensor.py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"(\", _jsxs(_components.span, {\n          className: \"hljs-params\",\n          children: [\"self, gradient=\", _jsx(_components.span, {\n            className: \"hljs-literal\",\n            children: \"None\"\n          })]\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"not\"\n        }), \" self.requires_grad:\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \"\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" gradient \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"is\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" self.shape == [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]:\\n            gradient = Tensor([\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]) \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# dx/dx = 1 case\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \":\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"raise\"\n        }), \" RuntimeError(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Gradient argument must be specified for non-scalar tensors.\\\"\"\n        }), \")\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" self.grad \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"is\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \":\\n        self.grad = gradient\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \":\\n        self.grad += gradient\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" self.grad_fn \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"is\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"not\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# not a leaf\"\n        }), \"\\n        grads = self.grad_fn.backward(gradient) \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# call the operation backward\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" tensor, grad \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"zip\"\n        }), \"(self.grad_fn.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"input\"\n        }), \", grads):\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"isinstance\"\n        }), \"(tensor, Tensor):\\n                tensor.backward(grad) \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# recursively call the backward again for the gradient expression (chain rule)\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ë§ˆì§€ë§‰ìœ¼ë¡œ, í…ì„œì˜ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì œë¡œí™”í•˜ëŠ” \", _jsx(_components.code, {\n        children: \".zero_grad()\"\n      }), \"ì™€ í…ì„œì˜ ì˜¤í† ê·¸ë˜ë“œ íˆìŠ¤í† ë¦¬ë¥¼ ì œê±°í•˜ëŠ” \", _jsx(_components.code, {\n        children: \".detach()\"\n      }), \"ë¥¼ êµ¬í˜„í•´ì£¼ì„¸ìš”:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# norch/tensor.py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self\"\n        }), \"):\\n    self.grad = \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"detach\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"self\"\n        }), \"):\\n    self.grad = \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \"\\n    self.grad_fn = \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"None\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì¶•í•˜í•©ë‹ˆë‹¤! GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ ê¸°ëŠ¥ì´ ìˆëŠ” ì™„ì „í•œ í…ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“œì…¨êµ°ìš”! ì´ì œ nn ë° optim ëª¨ë“ˆì„ ë§Œë“¤ì–´ ëª‡ ê°€ì§€ ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ ë” ì‰½ê²Œ í›ˆë ¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"#4 â€” nn ë° optim ëª¨ë“ˆ\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"nnì€ ì‹ ê²½ë§ ë° ë”¥ ëŸ¬ë‹ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ëª¨ë“ˆì´ë©°, optimì€ ì´ëŸ¬í•œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì¬í˜„í•˜ê¸° ìœ„í•œ ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” Parameterë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ParameterëŠ” ê°„ë‹¨íˆ ë§í•´ í•­ìƒ Trueë¡œ ì„¤ì •ëœ requires_grad ì†ì„±ì„ ê°–ëŠ” í›ˆë ¨ ê°€ëŠ¥í•œ í…ì„œë¡œ, ì¼ë¶€ ì„ì˜ì˜ ì´ˆê¸°í™” ê¸°ë²•ì„ ì‚¬ìš©í•´ ê°™ì€ ì—°ì‚°ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/nn/parameter.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" norch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" norch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"utils\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" utils\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" random\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    A parameter is a trainable tensor.\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, shape):\\n        data = utils.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"generate_random_list\"\n        }), \"(shape=shape)\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(data, requires_grad=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/utisl/utils.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\ndef \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"generate_random_list\"\n        }), \"(shape):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    ëœë¤í•œ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ 'shape' í˜•íƒœì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤\\n    [4, 2] --\u003e [[rand1, rand2], [rand3, rand4], [rand5, rand6], [rand7, rand8]]\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(shape) == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" []\\n    \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"else\"\n        }), \":\\n        inner_shape = shape[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \":]\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(inner_shape) == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \":\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [random.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"uniform\"\n        }), \"(-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" _ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"range\"\n        }), \"(shape[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"])]\\n        \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"else\"\n        }), \":\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"generate_random_list\"\n        }), \"(inner_shape) \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" _ \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"range\"\n        }), \"(shape[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"])]\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"íŒŒë¼ë¯¸í„°ë¥¼ í™œìš©í•˜ë©´ ëª¨ë“ˆì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/nn/\", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" .\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameter\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" collections \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"OrderedDict\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" abc \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"ABC\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" inspect\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"ABC\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    ëª¨ë“ˆì„ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_modules\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"OrderedDict\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_params\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"OrderedDict\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_grads\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"OrderedDict\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"training\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, *inputs, **kwargs):\\n        raise \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"NotImplementedError\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__call__\"\n        }), \"(self, *inputs, **kwargs):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(*inputs, **kwargs)\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"train\"\n        }), \"(self):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"training\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" param \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"():\\n            param.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"requires_grad\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"True\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"eval\"\n        }), \"(self):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"training\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"False\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" param \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"():\\n            param.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"requires_grad\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"False\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" name, value \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" inspect.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"getmembers\"\n        }), \"(self):\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(value, \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"):\\n                \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"yield\"\n        }), \" self, name, value\\n            elif \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(value, \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"):\\n                \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"yield\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" value.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"()\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"modules\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"yield\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_modules\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"values\"\n        }), \"()\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"gradients\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"modules\"\n        }), \"():\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"yield\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_grads\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" _, _, parameter \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"():\\n            parameter.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"()\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(self, device):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" _, _, parameter \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"():\\n            parameter.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\n\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" self\\n    \\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"inner_repr\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__repr__\"\n        }), \"(self):\\n        string = f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{self.get_name()}(\\\"\"\n        }), \"\\n        tab = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"   \\\"\"\n        }), \"\\n        modules = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_modules\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" modules == {}:\\n            string += f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'\\\\n{tab}(parameters): {self.inner_repr()}'\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"else\"\n        }), \":\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" key, \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" modules.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"items\"\n        }), \"():\\n                string += f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\\n{tab}({key}): {module.get_name()}({module.inner_repr()})\\\"\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'{string}\\\\n)'\"\n        }), \"\\n    \\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"get_name\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"__class__\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"__name__\"\n        }), \"\\n    \\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__setattr__\"\n        }), \"(self, key, value):\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"__dict__\"\n        }), \"[key] = value\\n\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(value, \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"):\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_modules\"\n        }), \"[key] = value\\n        elif \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(value, \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"):\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_params\"\n        }), \"[key] = value\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì˜ˆë¥¼ ë“¤ì–´, nn.Moduleì„ ìƒì†í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ ëª¨ë“ˆì„ ë§Œë“¤ê±°ë‚˜, ì´ì „ì— ìƒì„±ëœ ëª¨ë“ˆ ì¤‘ í•˜ë‚˜ì¸ ì„ í˜• ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ y = Wx + b ì‘ì—…ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/nn/modules/linear.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" ..\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"module\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" ..\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameter\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Linear\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, input_dim, output_dim):\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input_dim\"\n        }), \" = input_dim\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"output_dim\"\n        }), \" = output_dim\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"weight\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"(shape=[self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"output_dim\"\n        }), \", self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"input_dim\"\n        }), \"])\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"bias\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Parameter\"\n        }), \"(shape=[self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"output_dim\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"])\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, x):\\n        z = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"weight\"\n        }), \" @ x + self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"bias\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" z\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"inner_repr\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"input_dim={self.input_dim}, output_dim={self.output_dim}, \\\"\"\n        }), \" \\\\\\n               f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"bias={True if self.bias is not None else False}\\\"\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ ëª‡ ê°€ì§€ ì†ì‹¤ ë° í™œì„±í™” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í‰ê·  ì œê³± ì˜¤ì°¨ ì†ì‹¤ ë° ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/nn/loss.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" .\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"module\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"\\n \\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MSELoss\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n      pass\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, predictions, labels):\\n        assert labels.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \" == predictions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \", \\\\\\n            \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Labels and predictions shape does not match: {} and {}\\\"\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(labels.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \", predictions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"shape\"\n        }), \")\\n        \\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" ((predictions - labels) ** \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"() / predictions.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"numel\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__call__\"\n        }), \"(self, *inputs):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(*inputs)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/nn/activation.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" .\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"module\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" math\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Sigmoid\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Module\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"()\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, x):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.0\"\n        }), \" / (\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.0\"\n        }), \" + (math.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"e\"\n        }), \") ** (-x)) \\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì§€ë§‰ìœ¼ë¡œ ì˜µí‹°ë§ˆì´ì €ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤. ì˜ˆì‹œë¡œ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent) ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"# norch/optim/optimizer.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"py\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" abc \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"ABC\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" norch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"tensor\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Optimizer\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-variable constant_\",\n          children: \"ABC\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\n    ì˜µí‹°ë§ˆì´ì €ë¥¼ ìœ„í•œ ì¶”ìƒ í´ë˜ìŠ¤\\n    \\\"\"\n        }), _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"\\\"\"\n        }), \"\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, parameters):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(parameters, \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"):\\n            raise \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"TypeError\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"parametersëŠ” ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´ì´ì–´ì•¼ í•˜ì§€ë§Œ {} íƒ€ì…ì´ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤\\\"\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"type\"\n        }), \"(parameters)))\\n        elif \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"isinstance\"\n        }), \"(parameters, dict):\\n            parameters = parameters.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"values\"\n        }), \"()\\n\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameters\"\n        }), \" = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"list\"\n        }), \"(parameters)\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"step\"\n        }), \"(self):\\n        raise \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"NotImplementedError\"\n        }), \"\\n    \\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \", name, parameter \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameters\"\n        }), \":\\n            parameter.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"()\\n\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"SGD\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Optimizer\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self, parameters, lr=\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1e-1\"\n        }), \", momentum=\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"):\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(parameters)\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"lr\"\n        }), \" = lr\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"momentum\"\n        }), \" = momentum\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_cache\"\n        }), \" = {\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'velocity'\"\n        }), \": [p.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zeros_like\"\n        }), \"() \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" (_, _, p) \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameters\"\n        }), \"]}\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"step\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" i, (\", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \", name, _) \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"enumerate\"\n        }), \"(self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"parameters\"\n        }), \"):\\n            parameter = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"getattr\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \", name)\\n\\n            velocity = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_cache\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'velocity'\"\n        }), \"][i]\\n\\n            velocity = self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"momentum\"\n        }), \" * velocity - self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"lr\"\n        }), \" * parameter.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"grad\"\n        }), \"\\n\\n            updated_parameter = parameter + velocity\\n\\n            \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"setattr\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"module\"\n        }), \", name, updated_parameter)\\n\\n            self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"_cache\"\n        }), \"[\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'velocity'\"\n        }), \"][i] = velocity\\n\\n            parameter.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"detach\"\n        }), \"()\\n            velocity.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"detach\"\n        }), \"()\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ë¦¬ê³  ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤! ì´ì œ ìš°ë¦¬ë§Œì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ì—ˆì–´ìš”! ğŸ¥³\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ì œ í•™ìŠµì„ ì‹œì‘í•´ë´…ì‹œë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" norch\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" norch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"nn\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" nn\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" norch.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"optim\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" optim\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" random\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" math\\n\\nrandom.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"seed\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \")\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"class\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \"(nn.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"Module\"\n        }), \"):\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"(self):\\n        \", _jsx(_components.span, {\n          className: \"hljs-variable language_\",\n          children: \"super\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \", self).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"__init__\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"fc1\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Linear\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \")\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"sigmoid\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Sigmoid\"\n        }), \"()\\n        self.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"fc2\"\n        }), \" = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Linear\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \")\\n\\n    def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"forward\"\n        }), \"(self, x):\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fc1\"\n        }), \"(x)\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sigmoid\"\n        }), \"(out)\\n        out = self.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fc2\"\n        }), \"(out)\\n        \\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" out\\n\\ndevice = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cuda\\\"\"\n        }), \"\\nepochs = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"\\n\\nmodel = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MyModel\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\ncriterion = nn.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"MSELoss\"\n        }), \"()\\noptimizer = optim.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"SGD\"\n        }), \"(model.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"parameters\"\n        }), \"(), lr=\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.001\"\n        }), \")\\nloss_list = []\\n\\nx_values = [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.\"\n        }), \" ,  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.\"\n        }), \" ,  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2.8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3.6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4.\"\n        }), \" ,\\n        \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4.4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4.8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5.2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5.6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6.\"\n        }), \" ,  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6.4\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6.8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7.2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7.6\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8.\"\n        }), \" ,  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8.4\"\n        }), \",\\n        \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8.8\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9.2\"\n        }), \",  \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10.\"\n        }), \" , \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10.4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10.8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11.2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"11.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12.\"\n        }), \" , \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12.4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"12.8\"\n        }), \",\\n       \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13.2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"13.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14.\"\n        }), \" , \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14.4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"14.8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15.2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"15.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16.\"\n        }), \" , \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16.4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"16.8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17.2\"\n        }), \",\\n       \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"17.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18.\"\n        }), \" , \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18.4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"18.8\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19.2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"19.6\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"20.\"\n        }), \"]\\n\\ny_true = []\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" x \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"x_values\"\n        }), \":\\n    y_true.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"append\"\n        }), \"(math.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"pow\"\n        }), \"(math.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sin\"\n        }), \"(x), \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"))\\n\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" epoch \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"range\"\n        }), \"(epochs):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" x, target \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zip\"\n        }), \"(x_values, y_true):\\n        x = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[x]]).\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"T\"\n        }), \"\\n        target = norch.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Tensor\"\n        }), \"([[target]]).\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"T\"\n        }), \"\\n\\n        x = x.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\n        target = target.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to\"\n        }), \"(device)\\n\\n        outputs = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"model\"\n        }), \"(x)\\n        loss = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"criterion\"\n        }), \"(outputs, target)\\n        \\n        optimizer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"zero_grad\"\n        }), \"()\\n        loss.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"backward\"\n        }), \"()\\n        optimizer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"step\"\n        }), \"()\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"print\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'Epoch [{epoch + 1}/{epochs}], Loss: {loss[0]:.4f}'\"\n        }), \")\\n    loss_list.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"append\"\n        }), \"(loss[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"])\\n\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1.7035\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.7193\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.3068\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1742\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1342\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"6\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1232\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"7\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1220\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"8\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1241\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"9\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1270\"\n        }), \"\\n# \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Epoch\"\n        }), \" [\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"/\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"10\"\n        }), \"], \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Loss\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0.1297\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation_23.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì„±ê³µì ìœ¼ë¡œ ëª¨ë¸ì´ ìƒì„±ë˜ê³  ì‚¬ìš©ì ì •ì˜ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨ë˜ì—ˆìŠµë‹ˆë‹¤!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ê²°ë¡ \"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ ê²Œì‹œë¬¼ì—ì„œëŠ” í…ì„œì™€ ê°™ì€ ê¸°ë³¸ ê°œë…, ì–´ë–»ê²Œ ëª¨ë¸ë§ë˜ëŠ”ì§€, CUDA ë° Autogradì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œ ë“±ì„ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” GPU ì§€ì› ë° ìë™ ë¯¸ë¶„ì´ ê°€ëŠ¥í•œ ë”¥ ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ ê²Œì‹œë¬¼ì´ ì—¬ëŸ¬ë¶„ì´ PyTorchê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê°„ëµíˆ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•ìœ¼ë¡œì˜ ê²Œì‹œë¬¼ì—ì„œëŠ” ë¶„ì‚° í›ˆë ¨(ë‹¤ì¤‘ ë…¸ë“œ/ë‹¤ì¤‘ GPU) ë° ë©”ëª¨ë¦¬ ê´€ë¦¬ì™€ ê°™ì€ ê³ ê¸‰ ì£¼ì œë¥¼ ë‹¤ë£¨ë ¤ê³  í•  ê²ƒì…ë‹ˆë‹¤. ì˜ê²¬ì´ ìˆê±°ë‚˜ ë‹¤ìŒì— ì–´ë–¤ ë‚´ìš©ì„ ë‹¤ë£¨ê¸¸ ì›í•˜ì‹œëŠ”ì§€ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”! ì½ì–´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë˜í•œ ìµœì‹  ê¸°ì‚¬ë¥¼ ë°›ì•„ë³´ê¸° ìœ„í•´ ì—¬ê¸°ì™€ ì œ LinkedIn í”„ë¡œí•„ì—ì„œ íŒ”ë¡œìš°í•´ ì£¼ì„¸ìš”!\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ì°¸ê³  ìë£Œ\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://github.com\",\n          children: \"PyNorch\"\n        }), \" - ì´ í”„ë¡œì íŠ¸ì˜ GitHub ì €ì¥ì†Œ\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://www.example.com/tutorial-cuda\",\n          children: \"CUDA íŠœí† ë¦¬ì–¼\"\n        }), \" - CUDA ì‘ë™ ë°©ì‹ì— ëŒ€í•œ ê°„ë‹¨í•œ ì†Œê°œ\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://pytorch.org/docs\",\n          children: \"PyTorch\"\n        }), \" - PyTorch ë¬¸ì„œ\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"MartinLwx's ë¸”ë¡œê·¸ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ íŠœí† ë¦¬ì–¼.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ìŠ¤íŠ¸ë¼ì´ë“œ íŠœí† ë¦¬ì–¼ - ìŠ¤íŠ¸ë¼ì´ë“œì— ê´€í•œ ë˜ ë‹¤ë¥¸ íŠœí† ë¦¬ì–¼.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"PyTorch ë‚´ë¶€ êµ¬ì¡° - PyTorch êµ¬ì¡°ì— ëŒ€í•œ ê°€ì´ë“œ.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ë„¤ì¸  - NumPyë¥¼ ì‚¬ìš©í•œ PyTorch ì¬êµ¬í˜„.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Markdownìœ¼ë¡œ í‘œ íƒœê·¸ë¥¼ ë³€ê²½í•˜ì‹­ì‹œì˜¤.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-15-RecreatingPyTorchfromScratchwithGPUSupportandAutomaticDifferentiation"},"buildId":"K-h7XvEVBqnNx_uXMgZoe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>