<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood" data-gatsby-head="true"/><meta name="twitter:title" content="오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-14 11:04" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/acd99c507555fdc6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/acd99c507555fdc6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-742e6c91a18eb160.js" defer=""></script><script src="/_next/static/6w6Yg3qJxLtqeXNguENru/_buildManifest.js" defer=""></script><script src="/_next/static/6w6Yg3qJxLtqeXNguENru/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 14, 2024</span><span class="posts_reading_time__f7YPP">4<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>이 기사에서는 넥스트.js에서 리다이렉션 작동 방식을 살펴보면서 넥스트.js 소스 코드 주변의 리다이렉션 기능에 대해 배우게 됩니다.</p>
<h1>나의 접근 방식:</h1>
<ul>
<li>Import를 시작으로</li>
<li>Redirect 함수를 redirect.ts 파일까지 추적</li>
<li>redirect.ts 설명</li>
<li>에러를 throw 하는 것이 리디렉션이 작동하는 방법</li>
<li>전체 맥락을 이해하기 위해 redirect.test.ts 확인</li>
<li>redirect-boundary.ts에 리다이렉션 기능이 있음</li>
</ul>
<h1>1. Import를 시작으로:</h1>
<p>리다이렉트 함수는 next/navigation에서 가져온 것입니다. 리다이렉트에 대해 더 알고 싶다면 다음 링크를 확인해보세요: <a href="https://nextjs.org/docs/app/api-reference/functions/redirect" rel="nofollow" target="_blank">https://nextjs.org/docs/app/api-reference/functions/redirect</a>.</p>
<p>하지만 next/navigation 코드는 어디에서 찾을 수 있을까요? navigation.js 파일에서 이 코드를 찾을 수 있습니다. 이 파일은 기본적으로 navigation.ts를 내보내는데, 이는 /packages/next/src/client/components에 있습니다.</p>
<h1>2. 리다이렉트 함수를 redirect.ts 파일로 추적하기</h1>
<p>현재 이 글을 작성하는 시점에서 navigation.ts에는 272줄의 코드가 있지만, 우리가 관심 있는 것은 파일 끝에 아래와 같이 표시된 "redirect"의 내보내기입니다. 찾고자 하는 것에 집중하세요. 다른 코드에 방해받지 마세요.</p>
<p>"여기 보시다시피, redirect는 navigation.react-server.ts에서 내보내는 것입니다. navigation.react-server.ts 안에 들어가보면, redirect 함수가 실제로 redirect.ts에서 왔다는 것을 알게 될 거에요.</p>
<p>저는 중첩된 내보내기를 몰랐어요. 흥미롭네요."</p>
<h1>3. Render.ts 설명</h1>
<p>“redirect() 함수를 호출하면 NEXT_REDIRECT 오류가 발생하고 발생한 위치의 라우트 세그먼트의 렌더링을 중단합니다." — Nextjs 문서</p>
<p>redirect.ts 파일 내에서 오류를 발생시키는 코드 조각을 살펴봅시다.</p>
<p><img src="/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_2.png" alt="이미지"></p>
<h1>4. 에러를 발생시켜서 리디렉션이 작동하는 방식은 무엇인가요?</h1>
<p>리디렉트 함수가 에러를 발생시켜서 에러.digest를 설정하지만, 에러를 발생시켜서 리디렉션이 작동하는 방식이 명확하지 않았습니다.</p>
<p>오랫동안 찾아봤고, 리디렉트가 에러를 발생시킨다는 것을 고려하여 catch 블록을 찾으려고 노력했습니다. 서버 관련 파일을 뒤져봐도 도움이 되지 않았어요.</p>
<p>redirect.test.ts를 살펴보면서 조금씩 이해되기 시작했어요.</p>
<h1>5. 전체 맥락을 이해하려면 redirect.test.ts를 확인하세요</h1>
<p><img src="/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_3.png" alt="image"></p>
<p>한 번 어딘가에서 함수의 컨텍스트를 이해하는 데 테스트를 사용할 수 있다고 읽은 적이 있습니다. 그래서 redirect.test.ts에서 코드를 확인한 이유입니다.</p>
<p>테스트 코드에서 getURLFromRedirectError(err) 함수가 호출되는 것이 명백합니다. 이 함수는 react-boundary.ts에서 찾을 수 있습니다.</p>
<p>알겠어요. 테스트에서는 getURLFromRedirectError 함수를 호출하는데 실행 흐름은 어떻게 될까요? 에러가 발생한 후에는 무엇이 일어날까요? getURLFromRedirectError 함수를 기반으로 검색한 결과는 다음과 같아요:</p>
<p><img src="/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_4.png" alt="이미지"></p>
<h2>6. redirect-boundary.ts에는 리디렉션 기능이 있어요</h2>
<p>답은 Next.js 리디렉션이 useRouter 훅을 사용하며 리디렉션 유형에 따라 URL을 푸시하거나 교체합니다.</p>
<p>이 리다이렉트 경계는 아래에 표시된 앱-라우터 코드의 일부입니다.</p>
<p>리다이렉트에서 오류가 발생하면 리다이렉트 경계에서 오류가 catch되고 리다이렉트가 발생합니다. 리다이렉트 함수 자체가 리다이렉트를 수행하지 않고 앱-라우터 내부의 리다이렉트 경계가 라우팅 로직을 처리하는 것이 상당히 흥미로운 점입니다.</p>
<h1>결론:</h1>
<p>나는 이 API가 왜 이런 식으로 설계되었는지 모르겠지만, 여기에 오류를 throw하는 패턴을 사용하고 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용할 수 있습니다. 이 npm 패키지에서 오류를 throw하는 패턴을 사용하여 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용해 보세요.</p>
<p>redirect.test.ts 코드를 확인하지 않았다면, redirect 작동 방식을 파악하지 못했을 것입니다. 나는 redirect.ts 에 catch 블록을 찾고 있었지만 그렇지 않았기 때문입니다.</p>
<p>이 글에 대해 궁금한 점이 있으시면 언제든지 <a href="mailto:ramu.narasinga@gmail.com">ramu.narasinga@gmail.com</a> 으로 연락 주세요.</p>
<h1>더 많은 자료:</h1>
<ul>
<li><a href="https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/navigation.react-server.ts" rel="nofollow" target="_blank">navigation.react-server.ts</a></li>
<li><a href="https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/navigation.js" rel="nofollow" target="_blank">navigation.js</a></li>
<li><a href="https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect.ts" rel="nofollow" target="_blank">redirect.ts</a></li>
<li><a href="https://github.com/vercel/next.js/blob/canary/packages/next/src/client/components/redirect.test.ts" rel="nofollow" target="_blank">redirect.test.ts</a></li>
<li><a href="https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect-boundary.tsx#L8" rel="nofollow" target="_blank">redirect-boundary.tsx</a></li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"오픈 소스로 배우는 팁 Nextjs에서 리다이렉트가 어떻게 작동하는지 살펴보기","description":"","date":"2024-05-14 11:04","slug":"2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood","content":"\n\n이 기사에서는 넥스트.js에서 리다이렉션 작동 방식을 살펴보면서 넥스트.js 소스 코드 주변의 리다이렉션 기능에 대해 배우게 됩니다.\n\n# 나의 접근 방식:\n\n- Import를 시작으로\n- Redirect 함수를 redirect.ts 파일까지 추적\n- redirect.ts 설명\n- 에러를 throw 하는 것이 리디렉션이 작동하는 방법\n- 전체 맥락을 이해하기 위해 redirect.test.ts 확인\n- redirect-boundary.ts에 리다이렉션 기능이 있음\n\n# 1. Import를 시작으로:\n\n\n\n리다이렉트 함수는 next/navigation에서 가져온 것입니다. 리다이렉트에 대해 더 알고 싶다면 다음 링크를 확인해보세요: https://nextjs.org/docs/app/api-reference/functions/redirect.\n\n하지만 next/navigation 코드는 어디에서 찾을 수 있을까요? navigation.js 파일에서 이 코드를 찾을 수 있습니다. 이 파일은 기본적으로 navigation.ts를 내보내는데, 이는 /packages/next/src/client/components에 있습니다.\n\n# 2. 리다이렉트 함수를 redirect.ts 파일로 추적하기\n\n현재 이 글을 작성하는 시점에서 navigation.ts에는 272줄의 코드가 있지만, 우리가 관심 있는 것은 파일 끝에 아래와 같이 표시된 \"redirect\"의 내보내기입니다. 찾고자 하는 것에 집중하세요. 다른 코드에 방해받지 마세요.\n\n\n\n\"여기 보시다시피, redirect는 navigation.react-server.ts에서 내보내는 것입니다. navigation.react-server.ts 안에 들어가보면, redirect 함수가 실제로 redirect.ts에서 왔다는 것을 알게 될 거에요.\n\n저는 중첩된 내보내기를 몰랐어요. 흥미롭네요.\"\n\n\n\n# 3. Render.ts 설명\n\n“redirect() 함수를 호출하면 NEXT_REDIRECT 오류가 발생하고 발생한 위치의 라우트 세그먼트의 렌더링을 중단합니다.\" — Nextjs 문서\n\nredirect.ts 파일 내에서 오류를 발생시키는 코드 조각을 살펴봅시다.\n\n![이미지](/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_2.png)\n\n\n\n# 4. 에러를 발생시켜서 리디렉션이 작동하는 방식은 무엇인가요?\n\n리디렉트 함수가 에러를 발생시켜서 에러.digest를 설정하지만, 에러를 발생시켜서 리디렉션이 작동하는 방식이 명확하지 않았습니다.\n\n오랫동안 찾아봤고, 리디렉트가 에러를 발생시킨다는 것을 고려하여 catch 블록을 찾으려고 노력했습니다. 서버 관련 파일을 뒤져봐도 도움이 되지 않았어요.\n\nredirect.test.ts를 살펴보면서 조금씩 이해되기 시작했어요.\n\n\n\n# 5. 전체 맥락을 이해하려면 redirect.test.ts를 확인하세요\n\n![image](/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_3.png)\n\n한 번 어딘가에서 함수의 컨텍스트를 이해하는 데 테스트를 사용할 수 있다고 읽은 적이 있습니다. 그래서 redirect.test.ts에서 코드를 확인한 이유입니다.\n\n테스트 코드에서 getURLFromRedirectError(err) 함수가 호출되는 것이 명백합니다. 이 함수는 react-boundary.ts에서 찾을 수 있습니다.\n\n\n\n알겠어요. 테스트에서는 getURLFromRedirectError 함수를 호출하는데 실행 흐름은 어떻게 될까요? 에러가 발생한 후에는 무엇이 일어날까요? getURLFromRedirectError 함수를 기반으로 검색한 결과는 다음과 같아요:\n\n![이미지](/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_4.png)\n\n## 6. redirect-boundary.ts에는 리디렉션 기능이 있어요\n\n답은 Next.js 리디렉션이 useRouter 훅을 사용하며 리디렉션 유형에 따라 URL을 푸시하거나 교체합니다.\n\n\n\n\u003cimg src=\"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_5.png\" /\u003e\n\n이 리다이렉트 경계는 아래에 표시된 앱-라우터 코드의 일부입니다.\n\n\u003cimg src=\"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_6.png\" /\u003e\n\n리다이렉트에서 오류가 발생하면 리다이렉트 경계에서 오류가 catch되고 리다이렉트가 발생합니다. 리다이렉트 함수 자체가 리다이렉트를 수행하지 않고 앱-라우터 내부의 리다이렉트 경계가 라우팅 로직을 처리하는 것이 상당히 흥미로운 점입니다.\n\n\n\n# 결론:\n\n나는 이 API가 왜 이런 식으로 설계되었는지 모르겠지만, 여기에 오류를 throw하는 패턴을 사용하고 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용할 수 있습니다. 이 npm 패키지에서 오류를 throw하는 패턴을 사용하여 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용해 보세요.\n\nredirect.test.ts 코드를 확인하지 않았다면, redirect 작동 방식을 파악하지 못했을 것입니다. 나는 redirect.ts 에 catch 블록을 찾고 있었지만 그렇지 않았기 때문입니다.\n\n이 글에 대해 궁금한 점이 있으시면 언제든지 ramu.narasinga@gmail.com 으로 연락 주세요.\n\n\n\n# 더 많은 자료:\n\n- [navigation.react-server.ts](https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/navigation.react-server.ts)\n- [navigation.js](https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/navigation.js)\n- [redirect.ts](https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect.ts)\n- [redirect.test.ts](https://github.com/vercel/next.js/blob/canary/packages/next/src/client/components/redirect.test.ts)\n- [redirect-boundary.tsx](https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect-boundary.tsx#L8)","ogImage":{"url":"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_0.png"},"coverImage":"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_0.png","tag":["Tech"],"readingTime":4},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e이 기사에서는 넥스트.js에서 리다이렉션 작동 방식을 살펴보면서 넥스트.js 소스 코드 주변의 리다이렉션 기능에 대해 배우게 됩니다.\u003c/p\u003e\n\u003ch1\u003e나의 접근 방식:\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eImport를 시작으로\u003c/li\u003e\n\u003cli\u003eRedirect 함수를 redirect.ts 파일까지 추적\u003c/li\u003e\n\u003cli\u003eredirect.ts 설명\u003c/li\u003e\n\u003cli\u003e에러를 throw 하는 것이 리디렉션이 작동하는 방법\u003c/li\u003e\n\u003cli\u003e전체 맥락을 이해하기 위해 redirect.test.ts 확인\u003c/li\u003e\n\u003cli\u003eredirect-boundary.ts에 리다이렉션 기능이 있음\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e1. Import를 시작으로:\u003c/h1\u003e\n\u003cp\u003e리다이렉트 함수는 next/navigation에서 가져온 것입니다. 리다이렉트에 대해 더 알고 싶다면 다음 링크를 확인해보세요: \u003ca href=\"https://nextjs.org/docs/app/api-reference/functions/redirect\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://nextjs.org/docs/app/api-reference/functions/redirect\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e하지만 next/navigation 코드는 어디에서 찾을 수 있을까요? navigation.js 파일에서 이 코드를 찾을 수 있습니다. 이 파일은 기본적으로 navigation.ts를 내보내는데, 이는 /packages/next/src/client/components에 있습니다.\u003c/p\u003e\n\u003ch1\u003e2. 리다이렉트 함수를 redirect.ts 파일로 추적하기\u003c/h1\u003e\n\u003cp\u003e현재 이 글을 작성하는 시점에서 navigation.ts에는 272줄의 코드가 있지만, 우리가 관심 있는 것은 파일 끝에 아래와 같이 표시된 \"redirect\"의 내보내기입니다. 찾고자 하는 것에 집중하세요. 다른 코드에 방해받지 마세요.\u003c/p\u003e\n\u003cp\u003e\"여기 보시다시피, redirect는 navigation.react-server.ts에서 내보내는 것입니다. navigation.react-server.ts 안에 들어가보면, redirect 함수가 실제로 redirect.ts에서 왔다는 것을 알게 될 거에요.\u003c/p\u003e\n\u003cp\u003e저는 중첩된 내보내기를 몰랐어요. 흥미롭네요.\"\u003c/p\u003e\n\u003ch1\u003e3. Render.ts 설명\u003c/h1\u003e\n\u003cp\u003e“redirect() 함수를 호출하면 NEXT_REDIRECT 오류가 발생하고 발생한 위치의 라우트 세그먼트의 렌더링을 중단합니다.\" — Nextjs 문서\u003c/p\u003e\n\u003cp\u003eredirect.ts 파일 내에서 오류를 발생시키는 코드 조각을 살펴봅시다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_2.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch1\u003e4. 에러를 발생시켜서 리디렉션이 작동하는 방식은 무엇인가요?\u003c/h1\u003e\n\u003cp\u003e리디렉트 함수가 에러를 발생시켜서 에러.digest를 설정하지만, 에러를 발생시켜서 리디렉션이 작동하는 방식이 명확하지 않았습니다.\u003c/p\u003e\n\u003cp\u003e오랫동안 찾아봤고, 리디렉트가 에러를 발생시킨다는 것을 고려하여 catch 블록을 찾으려고 노력했습니다. 서버 관련 파일을 뒤져봐도 도움이 되지 않았어요.\u003c/p\u003e\n\u003cp\u003eredirect.test.ts를 살펴보면서 조금씩 이해되기 시작했어요.\u003c/p\u003e\n\u003ch1\u003e5. 전체 맥락을 이해하려면 redirect.test.ts를 확인하세요\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_3.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e한 번 어딘가에서 함수의 컨텍스트를 이해하는 데 테스트를 사용할 수 있다고 읽은 적이 있습니다. 그래서 redirect.test.ts에서 코드를 확인한 이유입니다.\u003c/p\u003e\n\u003cp\u003e테스트 코드에서 getURLFromRedirectError(err) 함수가 호출되는 것이 명백합니다. 이 함수는 react-boundary.ts에서 찾을 수 있습니다.\u003c/p\u003e\n\u003cp\u003e알겠어요. 테스트에서는 getURLFromRedirectError 함수를 호출하는데 실행 흐름은 어떻게 될까요? 에러가 발생한 후에는 무엇이 일어날까요? getURLFromRedirectError 함수를 기반으로 검색한 결과는 다음과 같아요:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood_4.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch2\u003e6. redirect-boundary.ts에는 리디렉션 기능이 있어요\u003c/h2\u003e\n\u003cp\u003e답은 Next.js 리디렉션이 useRouter 훅을 사용하며 리디렉션 유형에 따라 URL을 푸시하거나 교체합니다.\u003c/p\u003e\n\u003cp\u003e이 리다이렉트 경계는 아래에 표시된 앱-라우터 코드의 일부입니다.\u003c/p\u003e\n\u003cp\u003e리다이렉트에서 오류가 발생하면 리다이렉트 경계에서 오류가 catch되고 리다이렉트가 발생합니다. 리다이렉트 함수 자체가 리다이렉트를 수행하지 않고 앱-라우터 내부의 리다이렉트 경계가 라우팅 로직을 처리하는 것이 상당히 흥미로운 점입니다.\u003c/p\u003e\n\u003ch1\u003e결론:\u003c/h1\u003e\n\u003cp\u003e나는 이 API가 왜 이런 식으로 설계되었는지 모르겠지만, 여기에 오류를 throw하는 패턴을 사용하고 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용할 수 있습니다. 이 npm 패키지에서 오류를 throw하는 패턴을 사용하여 해당 오류를 catch하고 원하는 작업을 수행하는 boundary 를 사용해 보세요.\u003c/p\u003e\n\u003cp\u003eredirect.test.ts 코드를 확인하지 않았다면, redirect 작동 방식을 파악하지 못했을 것입니다. 나는 redirect.ts 에 catch 블록을 찾고 있었지만 그렇지 않았기 때문입니다.\u003c/p\u003e\n\u003cp\u003e이 글에 대해 궁금한 점이 있으시면 언제든지 \u003ca href=\"mailto:ramu.narasinga@gmail.com\"\u003eramu.narasinga@gmail.com\u003c/a\u003e 으로 연락 주세요.\u003c/p\u003e\n\u003ch1\u003e더 많은 자료:\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/navigation.react-server.ts\" rel=\"nofollow\" target=\"_blank\"\u003enavigation.react-server.ts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/navigation.js\" rel=\"nofollow\" target=\"_blank\"\u003enavigation.js\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect.ts\" rel=\"nofollow\" target=\"_blank\"\u003eredirect.ts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/client/components/redirect.test.ts\" rel=\"nofollow\" target=\"_blank\"\u003eredirect.test.ts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/blob/c1f8d9317588e51a8a31240f6add36b5f2c9f9bf/packages/next/src/client/components/redirect-boundary.tsx#L8\" rel=\"nofollow\" target=\"_blank\"\u003eredirect-boundary.tsx\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-14-Tipsfromopen-sourceHowredirectinNextjsworksunderthehood"},"buildId":"6w6Yg3qJxLtqeXNguENru","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>