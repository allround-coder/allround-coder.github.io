<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²• | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²• | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²• | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs" data-gatsby-head="true"/><meta name="twitter:title" content="Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²• | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-23 13:20" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/QH5Mz7n7Y6w0r4_gCGFQf/_buildManifest.js" defer=""></script><script src="/_next/static/QH5Mz7n7Y6w0r4_gCGFQf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 23, 2024</span><span class="posts_reading_time__f7YPP">8<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>ëª½ê³ ë””ë¹„ì—ì„œ ë¬¸ì„œ ë‚´ ë°°ì—´ ì—…ë°ì´íŠ¸í•˜ê¸°.</p>
<p><img src="/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png" alt="ì´ë¯¸ì§€"></p>
<p>Node.jsì™€ ëª½ê³ ë””ë¹„ë¥¼ ì´ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°ì—´ ë‚´ íŠ¹ì • applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. $ ì—°ì‚°ìëŠ” ì¿¼ë¦¬ ì¡°ê±´ê³¼ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ë°°ì—´ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// applications ë°°ì—´ì—ì„œ ì§€ì •ëœ applicationIdë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œë¥¼ ì°¾ëŠ” ì¿¼ë¦¬.</span>
<span class="hljs-keyword">const</span> filter = { <span class="hljs-attr">_id</span>: userId, <span class="hljs-string">'applications.applicationId'</span>: applicationId };

<span class="hljs-comment">// í™œì„± ìƒíƒœë¥¼ ì„¤ì •í•˜ëŠ” ì—…ë°ì´íŠ¸.</span>
<span class="hljs-keyword">const</span> updateDoc = {
  <span class="hljs-comment">// $set ë° $ ì—°ì‚°ì í™œìš©: ì¼ì¹˜í•˜ëŠ” applicationIdì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸.</span>
  <span class="hljs-attr">$set</span>: { <span class="hljs-string">'applications.$.active'</span>: newStatus }
};

<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">updateOne</span>(filter, updateDoc);
</code></pre>
<div class="content-ad"></div>
<h2>ì„¤ëª…:</h2>
<ul>
<li>í•„í„°: í•„í„° ê°ì²´ëŠ” íŠ¹ì • userId(ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ì)ì™€ applications ë°°ì—´ ë‚´ì˜ applicationIdë¥¼ ê°€ì§„ ë¬¸ì„œë¥¼ ì°¾ê³  ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
<li>ì—…ë°ì´íŠ¸: $set ì—°ì‚°ìëŠ” ì¼ì¹˜í•˜ëŠ” ë°°ì—´ ìš”ì†Œì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ ìœ„ì¹˜ $ ì—°ì‚°ìì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.</li>
</ul>
<h2>ì´ì œ ì¤‘ì²©ëœ ë°°ì—´ì—ì„œ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•:</h2>
<p>í•œ ë²ˆì˜ ì‘ì—…ì—ì„œ applications ë°°ì—´ ë‚´ì˜ ì—¬ëŸ¬ applicationId í•­ëª©ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ $[<code>identifier</code>] ë°°ì—´ í•„í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°°ì—´ ë‚´ì˜ ìš”ì†Œë¥¼ ì¼ì¹˜ì‹œí‚¤ê³  ì´ì— ë”°ë¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="content-ad"></div>
<h1>ì—¬ëŸ¬ applicationId í•­ëª©ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë‹¨ê³„:</h1>
<ul>
<li>MongoDBì— ì—°ê²°: MongoDB í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤.</li>
<li>ì¿¼ë¦¬ ì •ì˜: ì—…ë°ì´íŠ¸í•  ë¬¸ì„œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.</li>
<li>Array Filtersì™€ $set ì‚¬ìš©: ë°°ì—´ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ applicationId í•­ëª©ì„ ì¼ì¹˜ì‹œí‚¤ê³  ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</li>
<li>ì—…ë°ì´íŠ¸ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ì‘ë‹µì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.</li>
</ul>
<h1>ì˜ˆì‹œ ì½”ë“œ</h1>
<p>ë‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);

<span class="hljs-comment">// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.</span>
<span class="hljs-keyword">const</span> uri = <span class="hljs-string">'mongodb://localhost:27017'</span>;
<span class="hljs-keyword">const</span> dbName = <span class="hljs-string">'ê·€í•˜ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„'</span>;
<span class="hljs-keyword">const</span> collectionName = <span class="hljs-string">'ê·€í•˜ì˜ì»¬ë ‰ì…˜ì´ë¦„'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateApplicationStatu</span>(<span class="hljs-params">userId, updates</span>) {
  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(uri, { <span class="hljs-attr">useNewUrlParser</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">useUnifiedTopology</span>: <span class="hljs-literal">true</span> });

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'MongoDBì— ì—°ê²°ë¨'</span>);

    <span class="hljs-keyword">const</span> database = client.<span class="hljs-title function_">db</span>(dbName);
    <span class="hljs-keyword">const</span> collection = database.<span class="hljs-title function_">collection</span>(collectionName);

    <span class="hljs-comment">// ì‚¬ìš©ì ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸°</span>
    <span class="hljs-keyword">const</span> userDoc = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">_id</span>: userId });

    <span class="hljs-keyword">if</span> (!userDoc) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// applications ë°°ì—´ì„ ì´ˆê¸°í™”</span>
    <span class="hljs-keyword">if</span> (!userDoc.<span class="hljs-property">applications</span>) {
      userDoc.<span class="hljs-property">applications</span> = [];
    }

    <span class="hljs-keyword">const</span> updateOperations = [];
    <span class="hljs-keyword">const</span> applicationIds = userDoc.<span class="hljs-property">applications</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">app</span> =></span> app.<span class="hljs-property">applicationId</span>);

    <span class="hljs-comment">// ì¤‘ì²© ë°°ì—´ ë‚´ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸</span>
    updates.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">update</span> =></span> {
      <span class="hljs-keyword">if</span> (applicationIds.<span class="hljs-title function_">includes</span>(update.<span class="hljs-property">applicationId</span>)) {
        <span class="hljs-comment">// ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸</span>
        updateOperations.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">updateOne</span>: {
            <span class="hljs-attr">filter</span>: { <span class="hljs-attr">_id</span>: userId, <span class="hljs-string">'applications.applicationId'</span>: update.<span class="hljs-property">applicationId</span> },
            <span class="hljs-attr">update</span>: { 
              <span class="hljs-attr">$set</span>: { <span class="hljs-string">'applications.$.active'</span>: update.<span class="hljs-property">active</span> },
              <span class="hljs-attr">$addToSet</span>: { <span class="hljs-attr">updatedBy</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">userId</span> }
            }
          }
        });
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€</span>
        updateOperations.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">updateOne</span>: {
            <span class="hljs-attr">filter</span>: { <span class="hljs-attr">_id</span>: userId },
            <span class="hljs-attr">update</span>: {
              <span class="hljs-attr">$push</span>: {
                <span class="hljs-attr">applications</span>: { <span class="hljs-attr">applicationId</span>: update.<span class="hljs-property">applicationId</span>, <span class="hljs-attr">active</span>: update.<span class="hljs-property">active</span> }
              }
            },
            <span class="hljs-attr">$addToSet</span>: { <span class="hljs-attr">updatedBy</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">userId</span> }
          }
        });
      }
    });

    <span class="hljs-comment">// ëŒ€ëŸ‰ ì“°ê¸° ì‘ì—… ìˆ˜í–‰</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">bulkWrite</span>(updateOperations);

    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">modifiedCount</span> > <span class="hljs-number">0</span> || result.<span class="hljs-property">insertedCount</span> > <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨.'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.'</span>);
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:'</span>, error);
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
  }
}

<span class="hljs-comment">// ì‚¬ìš© ì˜ˆì‹œ: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë°ì´íŠ¸</span>
<span class="hljs-title function_">updateApplicationStatuses</span>(<span class="hljs-string">'userId123'</span>, [
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Apple'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Mango'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Orange'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> }
]);
</code></pre>
<h1>ì„¤ëª…</h1>
<ul>
<li>MongoDB ì—°ê²°: MongoDB ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì„ ì„¤ì •í•©ë‹ˆë‹¤.</li>
<li>ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜: ì‘ì—…í•  ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ì„ ì§€ì •í•©ë‹ˆë‹¤.</li>
<li>í•„í„°: í•„í„° ê°ì²´ëŠ” userId ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.</li>
<li>ì—…ë°ì´íŠ¸ ì˜¤ë¸Œì íŠ¸: updateDocì€ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ applicationId ì—”íŠ¸ë¦¬ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. í•„ë“œ ê²½ë¡œëŠ” ë°°ì—´ í•„í„°ë¥¼ ë™ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ êµ¬ì„±ë©ë‹ˆë‹¤.</li>
<li>ë°°ì—´ í•„í„°: arrayFilters ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë–¤ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì •ì˜í•˜ëŠ” ì¡°ê±´ì„ ì •ì˜í•©ë‹ˆë‹¤. ê° í•„í„°ëŠ” ì—…ë°ì´íŠ¸í•´ì•¼ í•  applicationIdì— í•´ë‹¹í•©ë‹ˆë‹¤.</li>
<li>updatedBy í•„ë“œ: updatedByëŠ” applications ë°°ì—´ì˜ ì¼ë¶€ê°€ ì•„ë‹Œ ë¬¸ì„œì˜ ë³„ë„ í•„ë“œì…ë‹ˆë‹¤. ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ì„œ applications ë°°ì—´ì—ì„œ ìˆ˜ì •ì´ë‚˜ ì¶”ê°€ê°€ ìˆì„ ë•Œë§ˆë‹¤ updatedBy í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.</li>
<li>ê²°ê³¼ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ì‘ì—…ì´ ë¬¸ì„œë¥¼ ìˆ˜ì •í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  ê²°ê³¼ë¥¼ ë¡œê·¸ì— ë‚¨ê¹ë‹ˆë‹¤.</li>
</ul>
<p>ë§Œì•½ applicationIdê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° í•´ë‹¹ í™œì„± ìƒíƒœì™€ í•¨ê»˜ ì¶”ê°€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì¿¼ë¦¬ì™€ ì—…ë°ì´íŠ¸ ì‘ì—…ì„ í˜¼í•©í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<div class="content-ad"></div>
<h1>ë‹¨ê³„:</h1>
<ul>
<li>ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸° ë° í™•ì¸: _idë³„ë¡œ ë¬¸ì„œë¥¼ ê°€ì ¸ì™€ì„œ applications ë°°ì—´ì˜ ê° applicationIdë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</li>
<li>ì—…ë°ì´íŠ¸ ìˆ˜í–‰: applicationIdê°€ ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ ê¸°ì¡´ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</li>
</ul>
<h1>ì˜ˆì‹œ ì½”ë“œ</h1>
<p>ë‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì „ì²´ ì˜ˆì‹œ ì½”ë“œì…ë‹ˆë‹¤:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);

<span class="hljs-comment">// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ ë° ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.</span>
<span class="hljs-keyword">const</span> uri = <span class="hljs-string">'mongodb://localhost:27017'</span>;
<span class="hljs-keyword">const</span> dbName = <span class="hljs-string">'ë‹¹ì‹ ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„'</span>;
<span class="hljs-keyword">const</span> collectionName = <span class="hljs-string">'ë‹¹ì‹ ì˜ì»¬ë ‰ì…˜ì´ë¦„'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateApplicationStatuses</span>(<span class="hljs-params">userId, updates</span>) {
  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(uri, { <span class="hljs-attr">useNewUrlParser</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">useUnifiedTopology</span>: <span class="hljs-literal">true</span> });

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'MongoDBì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.'</span>);

    <span class="hljs-keyword">const</span> database = client.<span class="hljs-title function_">db</span>(dbName);
    <span class="hljs-keyword">const</span> collection = database.<span class="hljs-title function_">collection</span>(collectionName);

    <span class="hljs-comment">// ì‚¬ìš©ì ë¬¸ì„œ ê²€ìƒ‰</span>
    <span class="hljs-keyword">const</span> userDoc = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">_id</span>: userId });

    <span class="hljs-keyword">if</span> (!userDoc) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// applications ë°°ì—´ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</span>
    <span class="hljs-keyword">if</span> (!userDoc.<span class="hljs-property">applications</span>) {
      userDoc.<span class="hljs-property">applications</span> = [];
    }

    <span class="hljs-keyword">const</span> updateOperations = [];
    <span class="hljs-keyword">const</span> applicationIds = userDoc.<span class="hljs-property">applications</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">app</span> =></span> app.<span class="hljs-property">applicationId</span>);

    updates.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">update</span> =></span> {
      <span class="hljs-keyword">if</span> (applicationIds.<span class="hljs-title function_">includes</span>(update.<span class="hljs-property">applicationId</span>)) {
        <span class="hljs-comment">// ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸</span>
        updateOperations.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">updateOne</span>: {
            <span class="hljs-attr">filter</span>: { <span class="hljs-attr">_id</span>: userId, <span class="hljs-string">'applications.applicationId'</span>: update.<span class="hljs-property">applicationId</span> },
            <span class="hljs-attr">update</span>: { <span class="hljs-attr">$set</span>: { <span class="hljs-string">'applications.$.active'</span>: update.<span class="hljs-property">active</span> } }
          }
        });
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€</span>
        updateOperations.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">updateOne</span>: {
            <span class="hljs-attr">filter</span>: { <span class="hljs-attr">_id</span>: userId },
            <span class="hljs-attr">update</span>: {
              <span class="hljs-attr">$push</span>: {
                <span class="hljs-attr">applications</span>: { <span class="hljs-attr">applicationId</span>: update.<span class="hljs-property">applicationId</span>, <span class="hljs-attr">active</span>: update.<span class="hljs-property">active</span> }
              }
            }
          }
        });
      }
    });

    <span class="hljs-comment">// ì¼ê´„ ì‘ì„± ì‘ì—… ìˆ˜í–‰</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">bulkWrite</span>(updateOperations);

    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">modifiedCount</span> > <span class="hljs-number">0</span> || result.<span class="hljs-property">insertedCount</span> > <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.'</span>);
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:'</span>, error);
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
  }
}

<span class="hljs-comment">// ì˜ˆì œ ì‚¬ìš©ë²•: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—…ë°ì´íŠ¸</span>
<span class="hljs-title function_">updateApplicationStatuses</span>(<span class="hljs-string">'userId123'</span>, [
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Apple'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Mango'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">applicationId</span>: <span class="hljs-string">'Orange'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> }
]);
</code></pre>
<p>ë§Œì•½ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ğŸ‘ ë¥¼ ì¢€ ë°›ì•„ë„ ê´œì°®ìœ¼ì„¸ìš”? ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œë„ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ê¸€ì„ ê³µìœ í•´ì£¼ì‹œë©´ ì •ë§ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤ :)</p>
<p>ì–¸ì œë‚˜ í™˜í˜¸í•´ ì£¼ì„¸ìš”...</p>
<img src="https://miro.medium.com/v2/resize:fit:156/0*9zGASKmAOha2Ov3S.gif">
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Nodejsë¥¼ ì‚¬ìš©í•˜ì—¬ MongoDBì—ì„œ ì¤‘ì²©ëœ ë°°ì—´ í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•","description":"","date":"2024-06-23 13:20","slug":"2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs","content":"\n\nëª½ê³ ë””ë¹„ì—ì„œ ë¬¸ì„œ ë‚´ ë°°ì—´ ì—…ë°ì´íŠ¸í•˜ê¸°.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png)\n\nNode.jsì™€ ëª½ê³ ë””ë¹„ë¥¼ ì´ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°ì—´ ë‚´ íŠ¹ì • applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. $ ì—°ì‚°ìëŠ” ì¿¼ë¦¬ ì¡°ê±´ê³¼ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ë°°ì—´ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n\n```js\n// applications ë°°ì—´ì—ì„œ ì§€ì •ëœ applicationIdë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œë¥¼ ì°¾ëŠ” ì¿¼ë¦¬.\nconst filter = { _id: userId, 'applications.applicationId': applicationId };\n\n// í™œì„± ìƒíƒœë¥¼ ì„¤ì •í•˜ëŠ” ì—…ë°ì´íŠ¸.\nconst updateDoc = {\n  // $set ë° $ ì—°ì‚°ì í™œìš©: ì¼ì¹˜í•˜ëŠ” applicationIdì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸.\n  $set: { 'applications.$.active': newStatus }\n};\n\nconst result = await collection.updateOne(filter, updateDoc);\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì„¤ëª…:\n\n- í•„í„°: í•„í„° ê°ì²´ëŠ” íŠ¹ì • userId(ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ì)ì™€ applications ë°°ì—´ ë‚´ì˜ applicationIdë¥¼ ê°€ì§„ ë¬¸ì„œë¥¼ ì°¾ê³  ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n- ì—…ë°ì´íŠ¸: $set ì—°ì‚°ìëŠ” ì¼ì¹˜í•˜ëŠ” ë°°ì—´ ìš”ì†Œì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ ìœ„ì¹˜ $ ì—°ì‚°ìì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\n## ì´ì œ ì¤‘ì²©ëœ ë°°ì—´ì—ì„œ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•:\n\ní•œ ë²ˆì˜ ì‘ì—…ì—ì„œ applications ë°°ì—´ ë‚´ì˜ ì—¬ëŸ¬ applicationId í•­ëª©ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ $[`identifier`] ë°°ì—´ í•„í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°°ì—´ ë‚´ì˜ ìš”ì†Œë¥¼ ì¼ì¹˜ì‹œí‚¤ê³  ì´ì— ë”°ë¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì—¬ëŸ¬ applicationId í•­ëª©ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë‹¨ê³„:\n\n- MongoDBì— ì—°ê²°: MongoDB í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤.\n- ì¿¼ë¦¬ ì •ì˜: ì—…ë°ì´íŠ¸í•  ë¬¸ì„œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.\n- Array Filtersì™€ $set ì‚¬ìš©: ë°°ì—´ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ applicationId í•­ëª©ì„ ì¼ì¹˜ì‹œí‚¤ê³  ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.\n- ì—…ë°ì´íŠ¸ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ì‘ë‹µì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.\n\n# ì˜ˆì‹œ ì½”ë“œ\n\në‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\nconst { MongoClient } = require('mongodb');\r\n\r\n// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.\r\nconst uri = 'mongodb://localhost:27017';\r\nconst dbName = 'ê·€í•˜ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„';\r\nconst collectionName = 'ê·€í•˜ì˜ì»¬ë ‰ì…˜ì´ë¦„';\r\n\r\nasync function updateApplicationStatu(userId, updates) {\r\n  const client = new MongoClient(uri, { useNewUrlParser: true, useUnifiedTopology: true });\r\n\r\n  try {\r\n    await client.connect();\r\n    console.log('MongoDBì— ì—°ê²°ë¨');\r\n\r\n    const database = client.db(dbName);\r\n    const collection = database.collection(collectionName);\r\n\r\n    // ì‚¬ìš©ì ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸°\r\n    const userDoc = await collection.findOne({ _id: userId });\r\n\r\n    if (!userDoc) {\r\n      console.log('ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');\r\n      return;\r\n    }\r\n\r\n    // applications ë°°ì—´ì„ ì´ˆê¸°í™”\r\n    if (!userDoc.applications) {\r\n      userDoc.applications = [];\r\n    }\r\n\r\n    const updateOperations = [];\r\n    const applicationIds = userDoc.applications.map(app =\u003e app.applicationId);\r\n\r\n    // ì¤‘ì²© ë°°ì—´ ë‚´ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸\r\n    updates.forEach(update =\u003e {\r\n      if (applicationIds.includes(update.applicationId)) {\r\n        // ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸\r\n        updateOperations.push({\r\n          updateOne: {\r\n            filter: { _id: userId, 'applications.applicationId': update.applicationId },\r\n            update: { \r\n              $set: { 'applications.$.active': update.active },\r\n              $addToSet: { updatedBy: req.session.userId }\r\n            }\r\n          }\r\n        });\r\n      } else {\r\n        // ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€\r\n        updateOperations.push({\r\n          updateOne: {\r\n            filter: { _id: userId },\r\n            update: {\r\n              $push: {\r\n                applications: { applicationId: update.applicationId, active: update.active }\r\n              }\r\n            },\r\n            $addToSet: { updatedBy: req.session.userId }\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    // ëŒ€ëŸ‰ ì“°ê¸° ì‘ì—… ìˆ˜í–‰\r\n    const result = await collection.bulkWrite(updateOperations);\r\n\r\n    if (result.modifiedCount \u003e 0 || result.insertedCount \u003e 0) {\r\n      console.log('ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨.');\r\n    } else {\r\n      console.log('ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');\r\n    }\r\n  } catch (error) {\r\n    console.error('ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);\r\n  } finally {\r\n    await client.close();\r\n  }\r\n}\r\n\r\n// ì‚¬ìš© ì˜ˆì‹œ: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë°ì´íŠ¸\r\nupdateApplicationStatuses('userId123', [\r\n  { applicationId: 'Apple', active: true },\r\n  { applicationId: 'Mango', active: false },\r\n  { applicationId: 'Orange', active: true }\r\n]);\r\n```\r\n\r\n# ì„¤ëª…\r\n\r\n- MongoDB ì—°ê²°: MongoDB ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì„ ì„¤ì •í•©ë‹ˆë‹¤.\r\n- ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜: ì‘ì—…í•  ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ì„ ì§€ì •í•©ë‹ˆë‹¤.\r\n- í•„í„°: í•„í„° ê°ì²´ëŠ” userId ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.\r\n- ì—…ë°ì´íŠ¸ ì˜¤ë¸Œì íŠ¸: updateDocì€ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ applicationId ì—”íŠ¸ë¦¬ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. í•„ë“œ ê²½ë¡œëŠ” ë°°ì—´ í•„í„°ë¥¼ ë™ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ êµ¬ì„±ë©ë‹ˆë‹¤.\r\n- ë°°ì—´ í•„í„°: arrayFilters ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë–¤ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì •ì˜í•˜ëŠ” ì¡°ê±´ì„ ì •ì˜í•©ë‹ˆë‹¤. ê° í•„í„°ëŠ” ì—…ë°ì´íŠ¸í•´ì•¼ í•  applicationIdì— í•´ë‹¹í•©ë‹ˆë‹¤.\r\n- updatedBy í•„ë“œ: updatedByëŠ” applications ë°°ì—´ì˜ ì¼ë¶€ê°€ ì•„ë‹Œ ë¬¸ì„œì˜ ë³„ë„ í•„ë“œì…ë‹ˆë‹¤. ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ì„œ applications ë°°ì—´ì—ì„œ ìˆ˜ì •ì´ë‚˜ ì¶”ê°€ê°€ ìˆì„ ë•Œë§ˆë‹¤ updatedBy í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.\r\n- ê²°ê³¼ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ì‘ì—…ì´ ë¬¸ì„œë¥¼ ìˆ˜ì •í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  ê²°ê³¼ë¥¼ ë¡œê·¸ì— ë‚¨ê¹ë‹ˆë‹¤.\r\n\r\në§Œì•½ applicationIdê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° í•´ë‹¹ í™œì„± ìƒíƒœì™€ í•¨ê»˜ ì¶”ê°€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì¿¼ë¦¬ì™€ ì—…ë°ì´íŠ¸ ì‘ì—…ì„ í˜¼í•©í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.\r\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë‹¨ê³„:\n\n- ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸° ë° í™•ì¸: _idë³„ë¡œ ë¬¸ì„œë¥¼ ê°€ì ¸ì™€ì„œ applications ë°°ì—´ì˜ ê° applicationIdë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n- ì—…ë°ì´íŠ¸ ìˆ˜í–‰: applicationIdê°€ ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ ê¸°ì¡´ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n# ì˜ˆì‹œ ì½”ë“œ\n\në‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì „ì²´ ì˜ˆì‹œ ì½”ë“œì…ë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nconst { MongoClient } = require('mongodb');\n\n// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ ë° ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.\nconst uri = 'mongodb://localhost:27017';\nconst dbName = 'ë‹¹ì‹ ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„';\nconst collectionName = 'ë‹¹ì‹ ì˜ì»¬ë ‰ì…˜ì´ë¦„';\n\nasync function updateApplicationStatuses(userId, updates) {\n  const client = new MongoClient(uri, { useNewUrlParser: true, useUnifiedTopology: true });\n\n  try {\n    await client.connect();\n    console.log('MongoDBì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.');\n\n    const database = client.db(dbName);\n    const collection = database.collection(collectionName);\n\n    // ì‚¬ìš©ì ë¬¸ì„œ ê²€ìƒ‰\n    const userDoc = await collection.findOne({ _id: userId });\n\n    if (!userDoc) {\n      console.log('ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n      return;\n    }\n\n    // applications ë°°ì—´ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\n    if (!userDoc.applications) {\n      userDoc.applications = [];\n    }\n\n    const updateOperations = [];\n    const applicationIds = userDoc.applications.map(app =\u003e app.applicationId);\n\n    updates.forEach(update =\u003e {\n      if (applicationIds.includes(update.applicationId)) {\n        // ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸\n        updateOperations.push({\n          updateOne: {\n            filter: { _id: userId, 'applications.applicationId': update.applicationId },\n            update: { $set: { 'applications.$.active': update.active } }\n          }\n        });\n      } else {\n        // ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€\n        updateOperations.push({\n          updateOne: {\n            filter: { _id: userId },\n            update: {\n              $push: {\n                applications: { applicationId: update.applicationId, active: update.active }\n              }\n            }\n          }\n        });\n      }\n    });\n\n    // ì¼ê´„ ì‘ì„± ì‘ì—… ìˆ˜í–‰\n    const result = await collection.bulkWrite(updateOperations);\n\n    if (result.modifiedCount \u003e 0 || result.insertedCount \u003e 0) {\n      console.log('ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.');\n    } else {\n      console.log('ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.');\n    }\n  } catch (error) {\n    console.error('ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);\n  } finally {\n    await client.close();\n  }\n}\n\n// ì˜ˆì œ ì‚¬ìš©ë²•: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—…ë°ì´íŠ¸\nupdateApplicationStatuses('userId123', [\n  { applicationId: 'Apple', active: true },\n  { applicationId: 'Mango', active: false },\n  { applicationId: 'Orange', active: true }\n]);\n```\n\në§Œì•½ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ğŸ‘ ë¥¼ ì¢€ ë°›ì•„ë„ ê´œì°®ìœ¼ì„¸ìš”? ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œë„ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ê¸€ì„ ê³µìœ í•´ì£¼ì‹œë©´ ì •ë§ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤ :)\n\nì–¸ì œë‚˜ í™˜í˜¸í•´ ì£¼ì„¸ìš”...\n\n\u003cimg src=\"https://miro.medium.com/v2/resize:fit:156/0*9zGASKmAOha2Ov3S.gif\" /\u003e\n","ogImage":{"url":"/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png"},"coverImage":"/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png","tag":["Tech"],"readingTime":8},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eëª½ê³ ë””ë¹„ì—ì„œ ë¬¸ì„œ ë‚´ ë°°ì—´ ì—…ë°ì´íŠ¸í•˜ê¸°.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs_0.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eNode.jsì™€ ëª½ê³ ë””ë¹„ë¥¼ ì´ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°ì—´ ë‚´ íŠ¹ì • applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. $ ì—°ì‚°ìëŠ” ì¿¼ë¦¬ ì¡°ê±´ê³¼ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ë°°ì—´ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// applications ë°°ì—´ì—ì„œ ì§€ì •ëœ applicationIdë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œë¥¼ ì°¾ëŠ” ì¿¼ë¦¬.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e filter = { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId, \u003cspan class=\"hljs-string\"\u003e'applications.applicationId'\u003c/span\u003e: applicationId };\n\n\u003cspan class=\"hljs-comment\"\u003e// í™œì„± ìƒíƒœë¥¼ ì„¤ì •í•˜ëŠ” ì—…ë°ì´íŠ¸.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e updateDoc = {\n  \u003cspan class=\"hljs-comment\"\u003e// $set ë° $ ì—°ì‚°ì í™œìš©: ì¼ì¹˜í•˜ëŠ” applicationIdì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e$set\u003c/span\u003e: { \u003cspan class=\"hljs-string\"\u003e'applications.$.active'\u003c/span\u003e: newStatus }\n};\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e collection.\u003cspan class=\"hljs-title function_\"\u003eupdateOne\u003c/span\u003e(filter, updateDoc);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch2\u003eì„¤ëª…:\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eí•„í„°: í•„í„° ê°ì²´ëŠ” íŠ¹ì • userId(ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ì)ì™€ applications ë°°ì—´ ë‚´ì˜ applicationIdë¥¼ ê°€ì§„ ë¬¸ì„œë¥¼ ì°¾ê³  ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì—…ë°ì´íŠ¸: $set ì—°ì‚°ìëŠ” ì¼ì¹˜í•˜ëŠ” ë°°ì—´ ìš”ì†Œì˜ active í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ ìœ„ì¹˜ $ ì—°ì‚°ìì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eì´ì œ ì¤‘ì²©ëœ ë°°ì—´ì—ì„œ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•:\u003c/h2\u003e\n\u003cp\u003eí•œ ë²ˆì˜ ì‘ì—…ì—ì„œ applications ë°°ì—´ ë‚´ì˜ ì—¬ëŸ¬ applicationId í•­ëª©ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ $set ì—°ì‚°ìë¥¼ $[\u003ccode\u003eidentifier\u003c/code\u003e] ë°°ì—´ í•„í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°°ì—´ ë‚´ì˜ ìš”ì†Œë¥¼ ì¼ì¹˜ì‹œí‚¤ê³  ì´ì— ë”°ë¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003eì—¬ëŸ¬ applicationId í•­ëª©ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë‹¨ê³„:\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eMongoDBì— ì—°ê²°: MongoDB í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì¿¼ë¦¬ ì •ì˜: ì—…ë°ì´íŠ¸í•  ë¬¸ì„œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eArray Filtersì™€ $set ì‚¬ìš©: ë°°ì—´ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ applicationId í•­ëª©ì„ ì¼ì¹˜ì‹œí‚¤ê³  ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì—…ë°ì´íŠ¸ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ì‘ë‹µì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eì˜ˆì‹œ ì½”ë“œ\u003c/h1\u003e\n\u003cp\u003eë‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eMongoClient\u003c/span\u003e } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'mongodb'\u003c/span\u003e);\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e uri = \u003cspan class=\"hljs-string\"\u003e'mongodb://localhost:27017'\u003c/span\u003e;\r\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dbName = \u003cspan class=\"hljs-string\"\u003e'ê·€í•˜ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„'\u003c/span\u003e;\r\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e collectionName = \u003cspan class=\"hljs-string\"\u003e'ê·€í•˜ì˜ì»¬ë ‰ì…˜ì´ë¦„'\u003c/span\u003e;\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eupdateApplicationStatu\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003euserId, updates\u003c/span\u003e) {\r\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e client = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMongoClient\u003c/span\u003e(uri, { \u003cspan class=\"hljs-attr\"\u003euseNewUrlParser\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003euseUnifiedTopology\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e });\r\n\r\n  \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\r\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e client.\u003cspan class=\"hljs-title function_\"\u003econnect\u003c/span\u003e();\r\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'MongoDBì— ì—°ê²°ë¨'\u003c/span\u003e);\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e database = client.\u003cspan class=\"hljs-title function_\"\u003edb\u003c/span\u003e(dbName);\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e collection = database.\u003cspan class=\"hljs-title function_\"\u003ecollection\u003c/span\u003e(collectionName);\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e// ì‚¬ìš©ì ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸°\u003c/span\u003e\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e userDoc = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e collection.\u003cspan class=\"hljs-title function_\"\u003efindOne\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId });\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!userDoc) {\r\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ'\u003c/span\u003e);\r\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\r\n    }\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e// applications ë°°ì—´ì„ ì´ˆê¸°í™”\u003c/span\u003e\r\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e) {\r\n      userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e = [];\r\n    }\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e updateOperations = [];\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e applicationIds = userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eapp\u003c/span\u003e =\u003e\u003c/span\u003e app.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e);\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e// ì¤‘ì²© ë°°ì—´ ë‚´ ì—¬ëŸ¬ applicationIdì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸\u003c/span\u003e\r\n    updates.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eupdate\u003c/span\u003e =\u003e\u003c/span\u003e {\r\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (applicationIds.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e)) {\r\n        \u003cspan class=\"hljs-comment\"\u003e// ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸\u003c/span\u003e\r\n        updateOperations.\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e({\r\n          \u003cspan class=\"hljs-attr\"\u003eupdateOne\u003c/span\u003e: {\r\n            \u003cspan class=\"hljs-attr\"\u003efilter\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId, \u003cspan class=\"hljs-string\"\u003e'applications.applicationId'\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e },\r\n            \u003cspan class=\"hljs-attr\"\u003eupdate\u003c/span\u003e: { \r\n              \u003cspan class=\"hljs-attr\"\u003e$set\u003c/span\u003e: { \u003cspan class=\"hljs-string\"\u003e'applications.$.active'\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eactive\u003c/span\u003e },\r\n              \u003cspan class=\"hljs-attr\"\u003e$addToSet\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eupdatedBy\u003c/span\u003e: req.\u003cspan class=\"hljs-property\"\u003esession\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserId\u003c/span\u003e }\r\n            }\r\n          }\r\n        });\r\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\r\n        \u003cspan class=\"hljs-comment\"\u003e// ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€\u003c/span\u003e\r\n        updateOperations.\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e({\r\n          \u003cspan class=\"hljs-attr\"\u003eupdateOne\u003c/span\u003e: {\r\n            \u003cspan class=\"hljs-attr\"\u003efilter\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId },\r\n            \u003cspan class=\"hljs-attr\"\u003eupdate\u003c/span\u003e: {\r\n              \u003cspan class=\"hljs-attr\"\u003e$push\u003c/span\u003e: {\r\n                \u003cspan class=\"hljs-attr\"\u003eapplications\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eactive\u003c/span\u003e }\r\n              }\r\n            },\r\n            \u003cspan class=\"hljs-attr\"\u003e$addToSet\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eupdatedBy\u003c/span\u003e: req.\u003cspan class=\"hljs-property\"\u003esession\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003euserId\u003c/span\u003e }\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e// ëŒ€ëŸ‰ ì“°ê¸° ì‘ì—… ìˆ˜í–‰\u003c/span\u003e\r\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e collection.\u003cspan class=\"hljs-title function_\"\u003ebulkWrite\u003c/span\u003e(updateOperations);\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (result.\u003cspan class=\"hljs-property\"\u003emodifiedCount\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e || result.\u003cspan class=\"hljs-property\"\u003einsertedCount\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\r\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨.'\u003c/span\u003e);\r\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\r\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.'\u003c/span\u003e);\r\n    }\r\n  } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\r\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:'\u003c/span\u003e, error);\r\n  } \u003cspan class=\"hljs-keyword\"\u003efinally\u003c/span\u003e {\r\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e client.\u003cspan class=\"hljs-title function_\"\u003eclose\u003c/span\u003e();\r\n  }\r\n}\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e// ì‚¬ìš© ì˜ˆì‹œ: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë°ì´íŠ¸\u003c/span\u003e\r\n\u003cspan class=\"hljs-title function_\"\u003eupdateApplicationStatuses\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'userId123'\u003c/span\u003e, [\r\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Apple'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e },\r\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Mango'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e },\r\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Orange'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e }\r\n]);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003eì„¤ëª…\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eMongoDB ì—°ê²°: MongoDB ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì„ ì„¤ì •í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜: ì‘ì—…í•  ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ì„ ì§€ì •í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eí•„í„°: í•„í„° ê°ì²´ëŠ” userId ë˜ëŠ” ë¬¸ì„œì˜ ë‹¤ë¥¸ ê³ ìœ  ì‹ë³„ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì—…ë°ì´íŠ¸ ì˜¤ë¸Œì íŠ¸: updateDocì€ $set ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ applicationId ì—”íŠ¸ë¦¬ì˜ í™œì„± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. í•„ë“œ ê²½ë¡œëŠ” ë°°ì—´ í•„í„°ë¥¼ ë™ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ êµ¬ì„±ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë°°ì—´ í•„í„°: arrayFilters ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë–¤ ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì •ì˜í•˜ëŠ” ì¡°ê±´ì„ ì •ì˜í•©ë‹ˆë‹¤. ê° í•„í„°ëŠ” ì—…ë°ì´íŠ¸í•´ì•¼ í•  applicationIdì— í•´ë‹¹í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eupdatedBy í•„ë“œ: updatedByëŠ” applications ë°°ì—´ì˜ ì¼ë¶€ê°€ ì•„ë‹Œ ë¬¸ì„œì˜ ë³„ë„ í•„ë“œì…ë‹ˆë‹¤. ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ì„œ applications ë°°ì—´ì—ì„œ ìˆ˜ì •ì´ë‚˜ ì¶”ê°€ê°€ ìˆì„ ë•Œë§ˆë‹¤ updatedBy í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eê²°ê³¼ ì²˜ë¦¬: ì—…ë°ì´íŠ¸ ì‘ì—…ì´ ë¬¸ì„œë¥¼ ìˆ˜ì •í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  ê²°ê³¼ë¥¼ ë¡œê·¸ì— ë‚¨ê¹ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eë§Œì•½ applicationIdê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° í•´ë‹¹ í™œì„± ìƒíƒœì™€ í•¨ê»˜ ì¶”ê°€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì¿¼ë¦¬ì™€ ì—…ë°ì´íŠ¸ ì‘ì—…ì„ í˜¼í•©í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003eë‹¨ê³„:\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eë¬¸ì„œ ê°€ì ¸ì˜¤ê¸° ë° í™•ì¸: _idë³„ë¡œ ë¬¸ì„œë¥¼ ê°€ì ¸ì™€ì„œ applications ë°°ì—´ì˜ ê° applicationIdë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì—…ë°ì´íŠ¸ ìˆ˜í–‰: applicationIdê°€ ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ ê¸°ì¡´ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eì˜ˆì‹œ ì½”ë“œ\u003c/h1\u003e\n\u003cp\u003eë‹¤ìŒì€ Node.jsì™€ MongoDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì „ì²´ ì˜ˆì‹œ ì½”ë“œì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eMongoClient\u003c/span\u003e } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'mongodb'\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// ê·€í•˜ì˜ MongoDB ì—°ê²° ë¬¸ìì—´ ë° ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e uri = \u003cspan class=\"hljs-string\"\u003e'mongodb://localhost:27017'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dbName = \u003cspan class=\"hljs-string\"\u003e'ë‹¹ì‹ ì˜ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e collectionName = \u003cspan class=\"hljs-string\"\u003e'ë‹¹ì‹ ì˜ì»¬ë ‰ì…˜ì´ë¦„'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eupdateApplicationStatuses\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003euserId, updates\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e client = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMongoClient\u003c/span\u003e(uri, { \u003cspan class=\"hljs-attr\"\u003euseNewUrlParser\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003euseUnifiedTopology\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e });\n\n  \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e client.\u003cspan class=\"hljs-title function_\"\u003econnect\u003c/span\u003e();\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'MongoDBì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.'\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e database = client.\u003cspan class=\"hljs-title function_\"\u003edb\u003c/span\u003e(dbName);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e collection = database.\u003cspan class=\"hljs-title function_\"\u003ecollection\u003c/span\u003e(collectionName);\n\n    \u003cspan class=\"hljs-comment\"\u003e// ì‚¬ìš©ì ë¬¸ì„œ ê²€ìƒ‰\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e userDoc = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e collection.\u003cspan class=\"hljs-title function_\"\u003efindOne\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId });\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!userDoc) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì‚¬ìš©ì ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// applications ë°°ì—´ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e) {\n      userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e = [];\n    }\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e updateOperations = [];\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e applicationIds = userDoc.\u003cspan class=\"hljs-property\"\u003eapplications\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eapp\u003c/span\u003e =\u003e\u003c/span\u003e app.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e);\n\n    updates.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eupdate\u003c/span\u003e =\u003e\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (applicationIds.\u003cspan class=\"hljs-title function_\"\u003eincludes\u003c/span\u003e(update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e)) {\n        \u003cspan class=\"hljs-comment\"\u003e// ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸\u003c/span\u003e\n        updateOperations.\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e({\n          \u003cspan class=\"hljs-attr\"\u003eupdateOne\u003c/span\u003e: {\n            \u003cspan class=\"hljs-attr\"\u003efilter\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId, \u003cspan class=\"hljs-string\"\u003e'applications.applicationId'\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e },\n            \u003cspan class=\"hljs-attr\"\u003eupdate\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e$set\u003c/span\u003e: { \u003cspan class=\"hljs-string\"\u003e'applications.$.active'\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eactive\u003c/span\u003e } }\n          }\n        });\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment\"\u003e// ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€\u003c/span\u003e\n        updateOperations.\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e({\n          \u003cspan class=\"hljs-attr\"\u003eupdateOne\u003c/span\u003e: {\n            \u003cspan class=\"hljs-attr\"\u003efilter\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: userId },\n            \u003cspan class=\"hljs-attr\"\u003eupdate\u003c/span\u003e: {\n              \u003cspan class=\"hljs-attr\"\u003e$push\u003c/span\u003e: {\n                \u003cspan class=\"hljs-attr\"\u003eapplications\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eapplicationId\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: update.\u003cspan class=\"hljs-property\"\u003eactive\u003c/span\u003e }\n              }\n            }\n          }\n        });\n      }\n    });\n\n    \u003cspan class=\"hljs-comment\"\u003e// ì¼ê´„ ì‘ì„± ì‘ì—… ìˆ˜í–‰\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e collection.\u003cspan class=\"hljs-title function_\"\u003ebulkWrite\u003c/span\u003e(updateOperations);\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (result.\u003cspan class=\"hljs-property\"\u003emodifiedCount\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e || result.\u003cspan class=\"hljs-property\"\u003einsertedCount\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.'\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì¼ì¹˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ê±°ë‚˜ ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.'\u003c/span\u003e);\n    }\n  } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:'\u003c/span\u003e, error);\n  } \u003cspan class=\"hljs-keyword\"\u003efinally\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e client.\u003cspan class=\"hljs-title function_\"\u003eclose\u003c/span\u003e();\n  }\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// ì˜ˆì œ ì‚¬ìš©ë²•: ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—…ë°ì´íŠ¸\u003c/span\u003e\n\u003cspan class=\"hljs-title function_\"\u003eupdateApplicationStatuses\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'userId123'\u003c/span\u003e, [\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Apple'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e },\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Mango'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e },\n  { \u003cspan class=\"hljs-attr\"\u003eapplicationId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Orange'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e }\n]);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë§Œì•½ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ğŸ‘ ë¥¼ ì¢€ ë°›ì•„ë„ ê´œì°®ìœ¼ì„¸ìš”? ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œë„ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ê¸€ì„ ê³µìœ í•´ì£¼ì‹œë©´ ì •ë§ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤ :)\u003c/p\u003e\n\u003cp\u003eì–¸ì œë‚˜ í™˜í˜¸í•´ ì£¼ì„¸ìš”...\u003c/p\u003e\n\u003cimg src=\"https://miro.medium.com/v2/resize:fit:156/0*9zGASKmAOha2Ov3S.gif\"\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-23-HowtoupdatenestedarrayfieldinMongoDBusingNodejs"},"buildId":"QH5Mz7n7Y6w0r4_gCGFQf","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>