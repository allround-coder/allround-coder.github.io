<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas" data-gatsby-head="true"/><meta name="twitter:title" content="팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 23:17" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/t9N7vwmpvBMQnO2PSctoH/_buildManifest.js" defer=""></script><script src="/_next/static/t9N7vwmpvBMQnO2PSctoH/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">6<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png" alt="이미지"></p>
<p>데이터 분석, 데이터 정리 또는 심지어 피처 엔지니어링을 할 때, 다른 열의 값에 기반한 새로운 열을 만드는 것은 자주 수행되는 작업입니다.</p>
<p>나는 데이터 정리 및 조작에 사용한 모든 도구들이 이 작업을 위한 함수를 가지고 있었다 (예: SQL, R 데이터 테이블, PySpark). 이제 우리에게 새로운 플레이어가 등장했습니다: Pandas.</p>
<p>그런데, Pandas로 조건부 열을 만드는 것은 가능했지만, 전용 case-when 함수는 없었습니다.</p>
<p>판다 2.2.0에서 case_when 함수가 도입되어 한 개 이상의 조건에 기반한 Series 객체를 생성할 수 있습니다.</p>
<p>이 유용한 작업을 어떻게 수행하는지 다시 살펴봅시다. 이것은 데이터 분석 및 조작 도구로 널리 사용되는 방법입니다.</p>
<p>도구 간 차이를 쉽게 식별하고 일관성 있게 유지하기 위해 작은 데이터셋을 사용하겠습니다.</p>
<h2>SQL</h2>
<p>다음은 'mytable'이라는 작은 SQL 테이블입니다.</p>
<pre><code class="hljs language-js">|           a |        b |       c |
|-------------|----------|---------|
|           <span class="hljs-number">0</span> |        <span class="hljs-number">5</span> |       <span class="hljs-number">1</span> |
|           <span class="hljs-number">1</span> |       -<span class="hljs-number">1</span> |       <span class="hljs-number">0</span> |
|           <span class="hljs-number">5</span> |       <span class="hljs-number">20</span> |       <span class="hljs-number">0</span> |
|           <span class="hljs-number">4</span> |        <span class="hljs-number">8</span> |       <span class="hljs-number">1</span> |
|           <span class="hljs-number">4</span> |        <span class="hljs-number">4</span> |       <span class="hljs-number">1</span> |
|          <span class="hljs-number">10</span> |        <span class="hljs-number">7</span> |       <span class="hljs-number">0</span> |
|           <span class="hljs-number">4</span> |        <span class="hljs-number">2</span> |       <span class="hljs-number">1</span> |
</code></pre>
<p>기존 열의 값에 따라 새로운 열을 생성할 것입니다. 다음은 조건입니다:</p>
<ul>
<li>a 열이 b 열보다 크면 a 열의 값이 사용됩니다.</li>
<li>a 열이 b 열보다 작으면 a 열과 c 열의 곱이 사용됩니다.</li>
<li>그렇지 않은 경우 (즉, a 열이 b 열과 같은 경우), a 열과 b 열의 합이 사용됩니다.</li>
</ul>
<p>필요에 따라 여러 조건을 만들고, 그것들을 훨씬 복잡하게 만들 수 있지만, 이 세 가지 조건은 논리를 배울 때 충분합니다.</p>
<p>새 열을 "d" 라고 부르고, 위 두 조건에 기반한 이 열을 생성하기 위한 SQL 코드는 다음과 같습니다:</p>
<pre><code class="hljs language-js">select 
  (<span class="hljs-keyword">case</span> 
     when a > b then a
     when a &#x3C; b then a * c
     <span class="hljs-keyword">else</span> a + b end
  ) <span class="hljs-keyword">as</span> d
<span class="hljs-keyword">from</span> mytable
</code></pre>
<p>이 SQL 코드는 "mytable"에서 열 d만 생성하고 선택합니다. 열 a, b, c를 함께 반환하도록 필요하다면, select 문에 해당 열을 작성해주세요.</p>
<pre><code class="hljs language-R">select 
  a<span class="hljs-punctuation">,</span>
  b<span class="hljs-punctuation">,</span>
  <span class="hljs-built_in">c</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">(</span>case 
     when a <span class="hljs-operator">></span> b then a
     when a <span class="hljs-operator">&#x3C;</span> b then a <span class="hljs-operator">*</span> <span class="hljs-built_in">c</span>
     <span class="hljs-keyword">else</span> a <span class="hljs-operator">+</span> b end
  <span class="hljs-punctuation">)</span> as d
from mytable
</code></pre>
<h2>R data table</h2>
<p>데이터 테이블 패키지는 R 프로그래밍 언어를 위한 매우 효율적인 데이터 분석 및 조작 도구입니다.</p>
<p>이제 이 패키지를 사용하여 조건부 열 d를 생성하는 방법을 배워보겠습니다. 먼저 SQL 테이블과 동일한 열을 포함하는 데이터 테이블을 만들어봅시다.</p>
<pre><code class="hljs language-js">mytable &#x3C;- data.<span class="hljs-title function_">table</span>(
      a=<span class="hljs-title function_">c</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>), 
      b=<span class="hljs-title function_">c</span>(<span class="hljs-number">5</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">20</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>), 
      c=<span class="hljs-title function_">c</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
)
</code></pre>
<p>데이터 테이블에서 조건에 맞는 경우 fcase 함수를 사용하여 구현할 수 있습니다. 조건을 작성하고 해당하는 값들을 쉼표로 구분하여 입력할 수 있습니다.</p>
<p>다음은 주어진 조건에 따라 열 d를 만드는 방법입니다:</p>
<pre><code class="hljs language-js">mytable[, d := (<span class="hljs-title function_">fcase</span>(a > b, a, a &#x3C; b, a*c, a==b, a+b))]
</code></pre>
<p>fcase 함수 내부의 첫 번째 표현식(a <code>b)은 첫 번째 조건이며, 두 번째 표현식(a)은 해당 값을 나타냅니다. 세 번째 표현식(a</code> b)은 두 번째 조건이며, 네 번째 표현식(a*c)은 해당 값을 의미합니다. 그리고 이어서 계속됩니다.</p>
<p>이제 데이터 테이블 "mytable"은 다음과 같습니다:</p>
<pre><code class="hljs language-js">    a  b c  d
<span class="hljs-number">1</span>:  <span class="hljs-number">0</span>  <span class="hljs-number">5</span> <span class="hljs-number">1</span>  <span class="hljs-number">0</span>
<span class="hljs-number">2</span>:  <span class="hljs-number">1</span> -<span class="hljs-number">1</span> <span class="hljs-number">0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>:  <span class="hljs-number">5</span> <span class="hljs-number">20</span> <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
<span class="hljs-number">4</span>:  <span class="hljs-number">4</span>  <span class="hljs-number">8</span> <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
<span class="hljs-number">5</span>:  <span class="hljs-number">4</span>  <span class="hljs-number">4</span> <span class="hljs-number">1</span>  <span class="hljs-number">8</span>
<span class="hljs-number">6</span>: <span class="hljs-number">10</span>  <span class="hljs-number">7</span> <span class="hljs-number">0</span> <span class="hljs-number">10</span>
<span class="hljs-number">7</span>:  <span class="hljs-number">4</span>  <span class="hljs-number">2</span> <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
</code></pre>
<h2>PySpark</h2>
<p>파이스파크는 대규모 데이터 처리에 사용되는 분석 엔진인 Spark를 위한 Python API입니다. 수십억 개의 행을 가진 데이터셋 작업에는 보통 Spark가 선호되는 도구입니다.</p>
<p>PySpark API는 매우 직관적이며 이해하기 쉬운 구문을 가지고 있습니다. 먼저 이전과 동일한 열과 값이 포함된 Spark DataFrame을 만들어 봅시다.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession
<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> functions <span class="hljs-keyword">as</span> F
spark = SparkSession.builder.getOrCreate()

data = [
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">0</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">1</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"b"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">0</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">0</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">8</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">1</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">1</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">7</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">0</span>},
    {<span class="hljs-string">"a"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">1</span>}
]

mytable = spark.createDataFrame(data)
</code></pre>
<p>우리는 먼저 spark 세션을 시작하고 그 후에 DataFrame을 만들었습니다. Databricks와 같은 개발 환경에서 작업하는 경우에는 명시적으로 spark 세션을 생성할 필요가 없다는 점에 유의하세요.</p>
<p>withColumn 함수를 사용하여 새 열을 생성하고 여러 조건에 따라 값을 결정하기 위해 when 함수를 사용할 수 있습니다.</p>
<pre><code class="hljs language-js">mytable = (
    mytable
    .<span class="hljs-title function_">withColumn</span>(<span class="hljs-string">"d"</span>,
                F.<span class="hljs-title function_">when</span>(F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"a"</span>) > F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"b"</span>), F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"a"</span>))
                 .<span class="hljs-title function_">when</span>(F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"a"</span>) &#x3C; F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"b"</span>), F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"a"</span>) * F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"c"</span>))
                 .<span class="hljs-title function_">otherwise</span>(F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"a"</span>) + F.<span class="hljs-title function_">col</span>(<span class="hljs-string">"b"</span>)))
)

mytable.<span class="hljs-title function_">show</span>()

+---+---+---+---+
|  a|  b|  c|  d|
+---+---+---+---+
|  <span class="hljs-number">0</span>|  <span class="hljs-number">5</span>|  <span class="hljs-number">1</span>|  <span class="hljs-number">0</span>|
|  <span class="hljs-number">1</span>| -<span class="hljs-number">1</span>|  <span class="hljs-number">0</span>|  <span class="hljs-number">1</span>|
|  <span class="hljs-number">5</span>| <span class="hljs-number">20</span>|  <span class="hljs-number">0</span>|  <span class="hljs-number">0</span>|
|  <span class="hljs-number">4</span>|  <span class="hljs-number">8</span>|  <span class="hljs-number">1</span>|  <span class="hljs-number">4</span>|
|  <span class="hljs-number">4</span>|  <span class="hljs-number">4</span>|  <span class="hljs-number">1</span>|  <span class="hljs-number">8</span>|
| <span class="hljs-number">10</span>|  <span class="hljs-number">7</span>|  <span class="hljs-number">0</span>| <span class="hljs-number">10</span>|
|  <span class="hljs-number">4</span>|  <span class="hljs-number">2</span>|  <span class="hljs-number">1</span>|  <span class="hljs-number">4</span>|
+---+---+---+---+
</code></pre>
<p>이전 도구와 마찬가지로 필요한만큼 많은 조건을 결합할 수 있습니다. 각 조건은 자체 when 함수를 가지고 있고 최종 조건의 값 (이전 조건 중 어느 것도 충족되지 않을 경우)은 otherwise 함수를 사용하여 지정됩니다.</p>
<h2>판다스</h2>
<p>팬더스는 데이터 분석 및 조작 작업 중 가장 자주 사용되는 도구일 수 있습니다. 버전 2.2.0 이전에는 팬더스에 case_when 함수가 없었습니다. 그러나 다른 함수들을 사용하여 작업을 처리할 수 있었습니다. 예를 들어, 팬더스의 where 함수나 NumPy의 where 및 select 함수를 사용할 수 있었습니다. 그러나 지금은 팬더스에 case_when 함수가 있으니 다른 도구들로 작업하던 것을 이 함수를 사용하여 보겠습니다.</p>
<p>먼저 팬더스 데이터프레임을 생성해보겠습니다.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

mytable = pd.DataFrame(
    {
        <span class="hljs-string">"a"</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>],
        <span class="hljs-string">"b"</span>: [<span class="hljs-number">5</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">20</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>],
        <span class="hljs-string">"c"</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
    }
)
</code></pre>
<p>case_when 함수는 조건 및 해당 값을 튜플로 포함하는 케이스 리스트를 인수로 사용합니다.</p>
<pre><code class="hljs language-js">caselist = [
    (mytable[<span class="hljs-string">"a"</span>] > mytable[<span class="hljs-string">"b"</span>], mytable[<span class="hljs-string">"a"</span>]),
    (mytable[<span class="hljs-string">"a"</span>] &#x3C; mytable[<span class="hljs-string">"b"</span>], mytable[<span class="hljs-string">"a"</span>] * mytable[<span class="hljs-string">"c"</span>]),
    (mytable[<span class="hljs-string">"a"</span>] == mytable[<span class="hljs-string">"b"</span>], mytable[<span class="hljs-string">"a"</span>] + mytable[<span class="hljs-string">"b"</span>])
]

mytable.<span class="hljs-property">loc</span>[:, <span class="hljs-string">"d"</span>] = mytable[<span class="hljs-string">"a"</span>].<span class="hljs-title function_">case_when</span>(caselist)

mytable

    a  b  c  d
<span class="hljs-number">0</span>   <span class="hljs-number">0</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1</span> -<span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   <span class="hljs-number">5</span> <span class="hljs-number">20</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
<span class="hljs-number">3</span>   <span class="hljs-number">4</span>  <span class="hljs-number">8</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
<span class="hljs-number">4</span>   <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">1</span>  <span class="hljs-number">8</span>
<span class="hljs-number">5</span>  <span class="hljs-number">10</span>  <span class="hljs-number">7</span>  <span class="hljs-number">0</span> <span class="hljs-number">10</span>
<span class="hljs-number">6</span>   <span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
</code></pre>
<p>caselist의 각 튜플은 조건과 해당하는 값이 포함되어 있어요. DataFrame의 열에 대해 case_when 함수를 적용할 때 중요한 점이에요. 주어진 조건 중 어느 조건도 충족되지 않는 행이 있는 경우, 새 열의 해당 행은 원래 열의 값을 가져와요.</p>
<p>위의 예시에서, 만약 그러한 행이 있다면, 열 d의 해당 값은 열 a에서 가져오게 될 거에요. caselist의 마지막 조건을 제거하여 시도해보겠어요.</p>
<pre><code class="hljs language-js">caselist = [
    (mytable[<span class="hljs-string">"a"</span>] > mytable[<span class="hljs-string">"b"</span>], mytable[<span class="hljs-string">"a"</span>]),
    (mytable[<span class="hljs-string">"a"</span>] &#x3C; mytable[<span class="hljs-string">"b"</span>], mytable[<span class="hljs-string">"a"</span>] * mytable[<span class="hljs-string">"c"</span>])
]

mytable.<span class="hljs-property">loc</span>[:, <span class="hljs-string">"d"</span>] = mytable[<span class="hljs-string">"a"</span>].<span class="hljs-title function_">case_when</span>(caselist)

mytable

    a  b  c  d
<span class="hljs-number">0</span>   <span class="hljs-number">0</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1</span> -<span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   <span class="hljs-number">5</span> <span class="hljs-number">20</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
<span class="hljs-number">3</span>   <span class="hljs-number">4</span>  <span class="hljs-number">8</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
<span class="hljs-number">4</span>   <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
<span class="hljs-number">5</span>  <span class="hljs-number">10</span>  <span class="hljs-number">7</span>  <span class="hljs-number">0</span> <span class="hljs-number">10</span>
<span class="hljs-number">6</span>   <span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>
</code></pre>
<p>4번 행의 값들을 확인해 보세요. 열 d의 값은 열 a의 값과 같습니다.</p>
<h2>마지막으로</h2>
<p>데이터 정리, 분석 및 조작을 위한 많은 도구와 라이브러리가 있습니다. 대부분의 경우 사용할 도구는 선택의 문제입니다. 이러한 도구들은 일반적인 작업을 효율적으로 수행할 수 있는 능력을 갖추고 있습니다. 그러나 여전히 다양한 도구를 사용하여 특정 작업을 수행하는 방법을 알고 있는 것이 좋습니다.</p>
<p>이 글에서는 SQL, PySpark, R 데이터 테이블 및 Pandas를 사용하여 조건부 열을 생성하는 방법에 대해 배웠습니다.</p>
<p>읽어 주셔서 감사합니다. 피드백이 있으시면 언제든 알려주세요!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"팬더스를 포함한 다양한 라이브러리에서 Case-When 다시 살펴보기","description":"","date":"2024-06-19 23:17","slug":"2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas","content":"\n\n\n![이미지](/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png)\n\n데이터 분석, 데이터 정리 또는 심지어 피처 엔지니어링을 할 때, 다른 열의 값에 기반한 새로운 열을 만드는 것은 자주 수행되는 작업입니다.\n\n나는 데이터 정리 및 조작에 사용한 모든 도구들이 이 작업을 위한 함수를 가지고 있었다 (예: SQL, R 데이터 테이블, PySpark). 이제 우리에게 새로운 플레이어가 등장했습니다: Pandas.\n\n그런데, Pandas로 조건부 열을 만드는 것은 가능했지만, 전용 case-when 함수는 없었습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n판다 2.2.0에서 case_when 함수가 도입되어 한 개 이상의 조건에 기반한 Series 객체를 생성할 수 있습니다.\n\n이 유용한 작업을 어떻게 수행하는지 다시 살펴봅시다. 이것은 데이터 분석 및 조작 도구로 널리 사용되는 방법입니다.\n\n도구 간 차이를 쉽게 식별하고 일관성 있게 유지하기 위해 작은 데이터셋을 사용하겠습니다.\n\n## SQL\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n다음은 'mytable'이라는 작은 SQL 테이블입니다.\n\n```js\n|           a |        b |       c |\n|-------------|----------|---------|\n|           0 |        5 |       1 |\n|           1 |       -1 |       0 |\n|           5 |       20 |       0 |\n|           4 |        8 |       1 |\n|           4 |        4 |       1 |\n|          10 |        7 |       0 |\n|           4 |        2 |       1 |\n```\n\n기존 열의 값에 따라 새로운 열을 생성할 것입니다. 다음은 조건입니다:\n\n- a 열이 b 열보다 크면 a 열의 값이 사용됩니다.\n- a 열이 b 열보다 작으면 a 열과 c 열의 곱이 사용됩니다.\n- 그렇지 않은 경우 (즉, a 열이 b 열과 같은 경우), a 열과 b 열의 합이 사용됩니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n필요에 따라 여러 조건을 만들고, 그것들을 훨씬 복잡하게 만들 수 있지만, 이 세 가지 조건은 논리를 배울 때 충분합니다.\n\n새 열을 \"d\" 라고 부르고, 위 두 조건에 기반한 이 열을 생성하기 위한 SQL 코드는 다음과 같습니다:\n\n```js\nselect \n  (case \n     when a \u003e b then a\n     when a \u003c b then a * c\n     else a + b end\n  ) as d\nfrom mytable\n```\n\n이 SQL 코드는 \"mytable\"에서 열 d만 생성하고 선택합니다. 열 a, b, c를 함께 반환하도록 필요하다면, select 문에 해당 열을 작성해주세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```R\nselect \n  a,\n  b,\n  c,\n  (case \n     when a \u003e b then a\n     when a \u003c b then a * c\n     else a + b end\n  ) as d\nfrom mytable\n```\n\n## R data table\n\n데이터 테이블 패키지는 R 프로그래밍 언어를 위한 매우 효율적인 데이터 분석 및 조작 도구입니다.\n\n이제 이 패키지를 사용하여 조건부 열 d를 생성하는 방법을 배워보겠습니다. 먼저 SQL 테이블과 동일한 열을 포함하는 데이터 테이블을 만들어봅시다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nmytable \u003c- data.table(\n      a=c(0, 1, 5, 4, 4, 10, 4), \n      b=c(5, -1, 20, 8, 4, 7, 2), \n      c=c(1, 0, 0, 1, 1, 0, 1)\n)\n```\n\n데이터 테이블에서 조건에 맞는 경우 fcase 함수를 사용하여 구현할 수 있습니다. 조건을 작성하고 해당하는 값들을 쉼표로 구분하여 입력할 수 있습니다.\n\n다음은 주어진 조건에 따라 열 d를 만드는 방법입니다:\n\n```js\nmytable[, d := (fcase(a \u003e b, a, a \u003c b, a*c, a==b, a+b))]\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nfcase 함수 내부의 첫 번째 표현식(a ` b)은 첫 번째 조건이며, 두 번째 표현식(a)은 해당 값을 나타냅니다. 세 번째 표현식(a ` b)은 두 번째 조건이며, 네 번째 표현식(a*c)은 해당 값을 의미합니다. 그리고 이어서 계속됩니다.\n\n이제 데이터 테이블 \"mytable\"은 다음과 같습니다:\n\n```js\n    a  b c  d\n1:  0  5 1  0\n2:  1 -1 0  1\n3:  5 20 0  0\n4:  4  8 1  4\n5:  4  4 1  8\n6: 10  7 0 10\n7:  4  2 1  4\n```\n\n## PySpark\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n파이스파크는 대규모 데이터 처리에 사용되는 분석 엔진인 Spark를 위한 Python API입니다. 수십억 개의 행을 가진 데이터셋 작업에는 보통 Spark가 선호되는 도구입니다.\n\nPySpark API는 매우 직관적이며 이해하기 쉬운 구문을 가지고 있습니다. 먼저 이전과 동일한 열과 값이 포함된 Spark DataFrame을 만들어 봅시다.\n\n```python\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nspark = SparkSession.builder.getOrCreate()\n\ndata = [\n    {\"a\": 0, \"b\": 5, \"c\": 1},\n    {\"a\": 1, \"b\": -1, \"c\": 0},\n    {\"a\": 5, \"b\": 20, \"c\": 0},\n    {\"a\": 4, \"b\": 8, \"c\": 1},\n    {\"a\": 4, \"b\": 4, \"c\": 1},\n    {\"a\": 10, \"b\": 7, \"c\": 0},\n    {\"a\": 4, \"b\": 2, \"c\": 1}\n]\n\nmytable = spark.createDataFrame(data)\n```\n\n우리는 먼저 spark 세션을 시작하고 그 후에 DataFrame을 만들었습니다. Databricks와 같은 개발 환경에서 작업하는 경우에는 명시적으로 spark 세션을 생성할 필요가 없다는 점에 유의하세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nwithColumn 함수를 사용하여 새 열을 생성하고 여러 조건에 따라 값을 결정하기 위해 when 함수를 사용할 수 있습니다.\n\n```js\nmytable = (\n    mytable\n    .withColumn(\"d\",\n                F.when(F.col(\"a\") \u003e F.col(\"b\"), F.col(\"a\"))\n                 .when(F.col(\"a\") \u003c F.col(\"b\"), F.col(\"a\") * F.col(\"c\"))\n                 .otherwise(F.col(\"a\") + F.col(\"b\")))\n)\n\nmytable.show()\n\n+---+---+---+---+\n|  a|  b|  c|  d|\n+---+---+---+---+\n|  0|  5|  1|  0|\n|  1| -1|  0|  1|\n|  5| 20|  0|  0|\n|  4|  8|  1|  4|\n|  4|  4|  1|  8|\n| 10|  7|  0| 10|\n|  4|  2|  1|  4|\n+---+---+---+---+\n```\n\n이전 도구와 마찬가지로 필요한만큼 많은 조건을 결합할 수 있습니다. 각 조건은 자체 when 함수를 가지고 있고 최종 조건의 값 (이전 조건 중 어느 것도 충족되지 않을 경우)은 otherwise 함수를 사용하여 지정됩니다.\n\n## 판다스\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n팬더스는 데이터 분석 및 조작 작업 중 가장 자주 사용되는 도구일 수 있습니다. 버전 2.2.0 이전에는 팬더스에 case_when 함수가 없었습니다. 그러나 다른 함수들을 사용하여 작업을 처리할 수 있었습니다. 예를 들어, 팬더스의 where 함수나 NumPy의 where 및 select 함수를 사용할 수 있었습니다. 그러나 지금은 팬더스에 case_when 함수가 있으니 다른 도구들로 작업하던 것을 이 함수를 사용하여 보겠습니다.\n\n먼저 팬더스 데이터프레임을 생성해보겠습니다.\n\n```python\nimport pandas as pd\n\nmytable = pd.DataFrame(\n    {\n        \"a\": [0, 1, 5, 4, 4, 10, 4],\n        \"b\": [5, -1, 20, 8, 4, 7, 2],\n        \"c\": [1, 0, 0, 1, 1, 0, 1]\n    }\n)\n```\n\ncase_when 함수는 조건 및 해당 값을 튜플로 포함하는 케이스 리스트를 인수로 사용합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\ncaselist = [\n    (mytable[\"a\"] \u003e mytable[\"b\"], mytable[\"a\"]),\n    (mytable[\"a\"] \u003c mytable[\"b\"], mytable[\"a\"] * mytable[\"c\"]),\n    (mytable[\"a\"] == mytable[\"b\"], mytable[\"a\"] + mytable[\"b\"])\n]\n\nmytable.loc[:, \"d\"] = mytable[\"a\"].case_when(caselist)\n\nmytable\n\n    a  b  c  d\n0   0  5  1  0\n1   1 -1  0  1\n2   5 20  0  0\n3   4  8  1  4\n4   4  4  1  8\n5  10  7  0 10\n6   4  2  1  4\n```\n\ncaselist의 각 튜플은 조건과 해당하는 값이 포함되어 있어요. DataFrame의 열에 대해 case_when 함수를 적용할 때 중요한 점이에요. 주어진 조건 중 어느 조건도 충족되지 않는 행이 있는 경우, 새 열의 해당 행은 원래 열의 값을 가져와요.\n\n위의 예시에서, 만약 그러한 행이 있다면, 열 d의 해당 값은 열 a에서 가져오게 될 거에요. caselist의 마지막 조건을 제거하여 시도해보겠어요.\n\n```js\ncaselist = [\n    (mytable[\"a\"] \u003e mytable[\"b\"], mytable[\"a\"]),\n    (mytable[\"a\"] \u003c mytable[\"b\"], mytable[\"a\"] * mytable[\"c\"])\n]\n\nmytable.loc[:, \"d\"] = mytable[\"a\"].case_when(caselist)\n\nmytable\n\n    a  b  c  d\n0   0  5  1  0\n1   1 -1  0  1\n2   5 20  0  0\n3   4  8  1  4\n4   4  4  1  4\n5  10  7  0 10\n6   4  2  1  4\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n4번 행의 값들을 확인해 보세요. 열 d의 값은 열 a의 값과 같습니다.\n\n## 마지막으로\n\n데이터 정리, 분석 및 조작을 위한 많은 도구와 라이브러리가 있습니다. 대부분의 경우 사용할 도구는 선택의 문제입니다. 이러한 도구들은 일반적인 작업을 효율적으로 수행할 수 있는 능력을 갖추고 있습니다. 그러나 여전히 다양한 도구를 사용하여 특정 작업을 수행하는 방법을 알고 있는 것이 좋습니다.\n\n이 글에서는 SQL, PySpark, R 데이터 테이블 및 Pandas를 사용하여 조건부 열을 생성하는 방법에 대해 배웠습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n읽어 주셔서 감사합니다. 피드백이 있으시면 언제든 알려주세요!","ogImage":{"url":"/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png"},"coverImage":"/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png","tag":["Tech"],"readingTime":6},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e데이터 분석, 데이터 정리 또는 심지어 피처 엔지니어링을 할 때, 다른 열의 값에 기반한 새로운 열을 만드는 것은 자주 수행되는 작업입니다.\u003c/p\u003e\n\u003cp\u003e나는 데이터 정리 및 조작에 사용한 모든 도구들이 이 작업을 위한 함수를 가지고 있었다 (예: SQL, R 데이터 테이블, PySpark). 이제 우리에게 새로운 플레이어가 등장했습니다: Pandas.\u003c/p\u003e\n\u003cp\u003e그런데, Pandas로 조건부 열을 만드는 것은 가능했지만, 전용 case-when 함수는 없었습니다.\u003c/p\u003e\n\u003cp\u003e판다 2.2.0에서 case_when 함수가 도입되어 한 개 이상의 조건에 기반한 Series 객체를 생성할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이 유용한 작업을 어떻게 수행하는지 다시 살펴봅시다. 이것은 데이터 분석 및 조작 도구로 널리 사용되는 방법입니다.\u003c/p\u003e\n\u003cp\u003e도구 간 차이를 쉽게 식별하고 일관성 있게 유지하기 위해 작은 데이터셋을 사용하겠습니다.\u003c/p\u003e\n\u003ch2\u003eSQL\u003c/h2\u003e\n\u003cp\u003e다음은 'mytable'이라는 작은 SQL 테이블입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e|           a |        b |       c |\n|-------------|----------|---------|\n|           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e |        \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |\n|           \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |       -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e |\n|           \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e |\n|           \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e |        \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |\n|           \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e |        \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |\n|          \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e |        \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e |\n|           \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e |        \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e |       \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e |\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e기존 열의 값에 따라 새로운 열을 생성할 것입니다. 다음은 조건입니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea 열이 b 열보다 크면 a 열의 값이 사용됩니다.\u003c/li\u003e\n\u003cli\u003ea 열이 b 열보다 작으면 a 열과 c 열의 곱이 사용됩니다.\u003c/li\u003e\n\u003cli\u003e그렇지 않은 경우 (즉, a 열이 b 열과 같은 경우), a 열과 b 열의 합이 사용됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e필요에 따라 여러 조건을 만들고, 그것들을 훨씬 복잡하게 만들 수 있지만, 이 세 가지 조건은 논리를 배울 때 충분합니다.\u003c/p\u003e\n\u003cp\u003e새 열을 \"d\" 라고 부르고, 위 두 조건에 기반한 이 열을 생성하기 위한 SQL 코드는 다음과 같습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eselect \n  (\u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \n     when a \u003e b then a\n     when a \u0026#x3C; b then a * c\n     \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e a + b end\n  ) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e d\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e mytable\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이 SQL 코드는 \"mytable\"에서 열 d만 생성하고 선택합니다. 열 a, b, c를 함께 반환하도록 필요하다면, select 문에 해당 열을 작성해주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-R\"\u003eselect \n  a\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  b\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"hljs-built_in\"\u003ec\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003ecase \n     when a \u003cspan class=\"hljs-operator\"\u003e\u003e\u003c/span\u003e b then a\n     when a \u003cspan class=\"hljs-operator\"\u003e\u0026#x3C;\u003c/span\u003e b then a \u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ec\u003c/span\u003e\n     \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e a \u003cspan class=\"hljs-operator\"\u003e+\u003c/span\u003e b end\n  \u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e as d\nfrom mytable\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eR data table\u003c/h2\u003e\n\u003cp\u003e데이터 테이블 패키지는 R 프로그래밍 언어를 위한 매우 효율적인 데이터 분석 및 조작 도구입니다.\u003c/p\u003e\n\u003cp\u003e이제 이 패키지를 사용하여 조건부 열 d를 생성하는 방법을 배워보겠습니다. 먼저 SQL 테이블과 동일한 열을 포함하는 데이터 테이블을 만들어봅시다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emytable \u0026#x3C;- data.\u003cspan class=\"hljs-title function_\"\u003etable\u003c/span\u003e(\n      a=\u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e), \n      b=\u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e), \n      c=\u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e데이터 테이블에서 조건에 맞는 경우 fcase 함수를 사용하여 구현할 수 있습니다. 조건을 작성하고 해당하는 값들을 쉼표로 구분하여 입력할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e다음은 주어진 조건에 따라 열 d를 만드는 방법입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emytable[, d := (\u003cspan class=\"hljs-title function_\"\u003efcase\u003c/span\u003e(a \u003e b, a, a \u0026#x3C; b, a*c, a==b, a+b))]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003efcase 함수 내부의 첫 번째 표현식(a \u003ccode\u003eb)은 첫 번째 조건이며, 두 번째 표현식(a)은 해당 값을 나타냅니다. 세 번째 표현식(a\u003c/code\u003e b)은 두 번째 조건이며, 네 번째 표현식(a*c)은 해당 값을 의미합니다. 그리고 이어서 계속됩니다.\u003c/p\u003e\n\u003cp\u003e이제 데이터 테이블 \"mytable\"은 다음과 같습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e    a  b c  d\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003ePySpark\u003c/h2\u003e\n\u003cp\u003e파이스파크는 대규모 데이터 처리에 사용되는 분석 엔진인 Spark를 위한 Python API입니다. 수십억 개의 행을 가진 데이터셋 작업에는 보통 Spark가 선호되는 도구입니다.\u003c/p\u003e\n\u003cp\u003ePySpark API는 매우 직관적이며 이해하기 쉬운 구문을 가지고 있습니다. 먼저 이전과 동일한 열과 값이 포함된 Spark DataFrame을 만들어 봅시다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pyspark.sql \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e SparkSession\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pyspark.sql \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e functions \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e F\nspark = SparkSession.builder.getOrCreate()\n\ndata = [\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e},\n    {\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}\n]\n\nmytable = spark.createDataFrame(data)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e우리는 먼저 spark 세션을 시작하고 그 후에 DataFrame을 만들었습니다. Databricks와 같은 개발 환경에서 작업하는 경우에는 명시적으로 spark 세션을 생성할 필요가 없다는 점에 유의하세요.\u003c/p\u003e\n\u003cp\u003ewithColumn 함수를 사용하여 새 열을 생성하고 여러 조건에 따라 값을 결정하기 위해 when 함수를 사용할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emytable = (\n    mytable\n    .\u003cspan class=\"hljs-title function_\"\u003ewithColumn\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"d\"\u003c/span\u003e,\n                F.\u003cspan class=\"hljs-title function_\"\u003ewhen\u003c/span\u003e(F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e) \u003e F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e), F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e))\n                 .\u003cspan class=\"hljs-title function_\"\u003ewhen\u003c/span\u003e(F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e) \u0026#x3C; F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e), F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e) * F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e))\n                 .\u003cspan class=\"hljs-title function_\"\u003eotherwise\u003c/span\u003e(F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e) + F.\u003cspan class=\"hljs-title function_\"\u003ecol\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e)))\n)\n\nmytable.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e()\n\n+---+---+---+---+\n|  a|  b|  c|  d|\n+---+---+---+---+\n|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e|\n|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e| -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|\n|  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e|\n|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|\n|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e|\n| \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e|\n|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e|\n+---+---+---+---+\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이전 도구와 마찬가지로 필요한만큼 많은 조건을 결합할 수 있습니다. 각 조건은 자체 when 함수를 가지고 있고 최종 조건의 값 (이전 조건 중 어느 것도 충족되지 않을 경우)은 otherwise 함수를 사용하여 지정됩니다.\u003c/p\u003e\n\u003ch2\u003e판다스\u003c/h2\u003e\n\u003cp\u003e팬더스는 데이터 분석 및 조작 작업 중 가장 자주 사용되는 도구일 수 있습니다. 버전 2.2.0 이전에는 팬더스에 case_when 함수가 없었습니다. 그러나 다른 함수들을 사용하여 작업을 처리할 수 있었습니다. 예를 들어, 팬더스의 where 함수나 NumPy의 where 및 select 함수를 사용할 수 있었습니다. 그러나 지금은 팬더스에 case_when 함수가 있으니 다른 도구들로 작업하던 것을 이 함수를 사용하여 보겠습니다.\u003c/p\u003e\n\u003cp\u003e먼저 팬더스 데이터프레임을 생성해보겠습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\nmytable = pd.DataFrame(\n    {\n        \u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e]\n    }\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ecase_when 함수는 조건 및 해당 값을 튜플로 포함하는 케이스 리스트를 인수로 사용합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecaselist = [\n    (mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] \u003e mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e], mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e]),\n    (mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] \u0026#x3C; mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e], mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] * mytable[\u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e]),\n    (mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] == mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e], mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] + mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e])\n]\n\nmytable.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:, \u003cspan class=\"hljs-string\"\u003e\"d\"\u003c/span\u003e] = mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003ecase_when\u003c/span\u003e(caselist)\n\nmytable\n\n    a  b  c  d\n\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ecaselist의 각 튜플은 조건과 해당하는 값이 포함되어 있어요. DataFrame의 열에 대해 case_when 함수를 적용할 때 중요한 점이에요. 주어진 조건 중 어느 조건도 충족되지 않는 행이 있는 경우, 새 열의 해당 행은 원래 열의 값을 가져와요.\u003c/p\u003e\n\u003cp\u003e위의 예시에서, 만약 그러한 행이 있다면, 열 d의 해당 값은 열 a에서 가져오게 될 거에요. caselist의 마지막 조건을 제거하여 시도해보겠어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecaselist = [\n    (mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] \u003e mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e], mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e]),\n    (mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] \u0026#x3C; mytable[\u003cspan class=\"hljs-string\"\u003e\"b\"\u003c/span\u003e], mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e] * mytable[\u003cspan class=\"hljs-string\"\u003e\"c\"\u003c/span\u003e])\n]\n\nmytable.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:, \u003cspan class=\"hljs-string\"\u003e\"d\"\u003c/span\u003e] = mytable[\u003cspan class=\"hljs-string\"\u003e\"a\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003ecase_when\u003c/span\u003e(caselist)\n\nmytable\n\n    a  b  c  d\n\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e4번 행의 값들을 확인해 보세요. 열 d의 값은 열 a의 값과 같습니다.\u003c/p\u003e\n\u003ch2\u003e마지막으로\u003c/h2\u003e\n\u003cp\u003e데이터 정리, 분석 및 조작을 위한 많은 도구와 라이브러리가 있습니다. 대부분의 경우 사용할 도구는 선택의 문제입니다. 이러한 도구들은 일반적인 작업을 효율적으로 수행할 수 있는 능력을 갖추고 있습니다. 그러나 여전히 다양한 도구를 사용하여 특정 작업을 수행하는 방법을 알고 있는 것이 좋습니다.\u003c/p\u003e\n\u003cp\u003e이 글에서는 SQL, PySpark, R 데이터 테이블 및 Pandas를 사용하여 조건부 열을 생성하는 방법에 대해 배웠습니다.\u003c/p\u003e\n\u003cp\u003e읽어 주셔서 감사합니다. 피드백이 있으시면 언제든 알려주세요!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-LetsRevisitCase-WheninDifferentLibrariesIncludingtheNewPlayerPandas"},"buildId":"t9N7vwmpvBMQnO2PSctoH","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>