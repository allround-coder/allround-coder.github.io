<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>SigmaHQ Rules 릴리스 하이라이트  r2024-05-13 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="SigmaHQ Rules 릴리스 하이라이트  r2024-05-13 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="SigmaHQ Rules 릴리스 하이라이트  r2024-05-13 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513" data-gatsby-head="true"/><meta name="twitter:title" content="SigmaHQ Rules 릴리스 하이라이트  r2024-05-13 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-15 03:57" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/aCCUs-qPrLLLWRnkN0AOd/_buildManifest.js" defer=""></script><script src="/_next/static/aCCUs-qPrLLLWRnkN0AOd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">SigmaHQ Rules 릴리스 하이라이트  r2024-05-13</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="SigmaHQ Rules 릴리스 하이라이트  r2024-05-13" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 15, 2024</span><span class="posts_reading_time__f7YPP">12<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png" alt="SigmaHQRulesReleaseHighlights"></p>
<p>2024년 5월 13일 Sigma Rule Packages가 발표되었습니다. 이번 릴리즈에는 16개의 새로운 규칙, 7개의 규칙 업데이트 및 1개의 규칙 수정이 7명의 기여자에 의해 추가되었습니다.</p>
<h1>새로운 규칙</h1>
<p>새로운 규칙 중 일부 하이라이트는 다음과 같습니다. Wbadmin을 이용하여 민감한 파일을 덤프/복원하고 백업을 삭제하는 다양한 사례를 다루는 규칙입니다.</p>
<pre><code class="hljs language-js">제목: <span class="hljs-title class_">Wbadmin</span>.<span class="hljs-property">EXE</span>를 통한 파일 복구
아이디: 6fe4aa1e-<span class="hljs-number">0531</span>-<span class="hljs-number">4510</span>-8be2-782154b73b48
관련:
    - 아이디: 84972c80-251c-4c3a-<span class="hljs-number">9079</span>-4f00aad93938
      유형: 파생
상태: 실험적
설명: |
    <span class="hljs-string">"wbadmin.exe"</span>를 통한 백업 파일로부터 파일 복구를 감지합니다.
    공격자는 <span class="hljs-variable constant_">NTDS</span>.<span class="hljs-property">DIT</span> 또는 레지스트리 하이브와 같은 민감한 파일을 백업에서 복원하여 자격 증명을 뽑아낼 수 있습니다.
참고:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//lolbas-project.github.io/lolbas/Binaries/Wbadmin/</span>
작성자: <span class="hljs-title class_">Nasreddine</span> <span class="hljs-title class_">Bencherchali</span> (<span class="hljs-title class_">Nextron</span> <span class="hljs-title class_">Systems</span>), frack113
날짜: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">10</span>
태그:
    - attack.<span class="hljs-property">impact</span>
    - attack.<span class="hljs-property">t1490</span>
로그 소스:
    카테고리: process_creation
    제품: windows
감지:
    선택 이미지:
        - <span class="hljs-title class_">Image</span>|<span class="hljs-attr">endswith</span>: <span class="hljs-string">'\wbadmin.exe'</span>
        - <span class="hljs-title class_">OriginalFileName</span>: <span class="hljs-string">'WBADMIN.EXE'</span>
    선택 <span class="hljs-attr">CLI</span>:
        <span class="hljs-title class_">CommandLine</span>|contains|<span class="hljs-attr">all</span>:
            - <span class="hljs-string">' recovery'</span>
            - <span class="hljs-string">'recoveryTarget'</span>
            - <span class="hljs-string">'itemtype:File'</span>
    조건: 모두 선택_*
거짓 양성:
    - 알 수 없음
수준: 중간
</code></pre>
<pre><code class="hljs language-js">제목: <span class="hljs-title class_">Wbadmin</span>.<span class="hljs-property">EXE</span>를 통한 민감한 파일 덤프
아이디: 8b93a509-1cb8-<span class="hljs-number">42e1</span>-97aa-ee24224cdc15
상태: 실험적
설명: |
    <span class="hljs-string">"NTDS.DIT"</span> 및 <span class="hljs-string">"SECURITY"</span> 하이브와 같은 고도로 민감한 파일의 덤프를 감지합니다.
    공격자는 <span class="hljs-string">"wbadmin"</span> 유틸리티를 활용하여 자격 증명이나 민감한 정보가 포함된 민감한 파일을 덤프할 수 있습니다.
참고:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//lolbas-project.github.io/lolbas/Binaries/Wbadmin/</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup</span>
작성자: <span class="hljs-title class_">Nasreddine</span> <span class="hljs-title class_">Bencherchali</span> (<span class="hljs-title class_">Nextron</span> <span class="hljs-title class_">Systems</span>), frack113
날짜: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">10</span>
태그:
    - attack.<span class="hljs-property">credential_access</span>
    - attack.<span class="hljs-property">t1003</span><span class="hljs-number">.003</span>
로그 소스:
    카테고리: process_creation
    제품: windows
감지:
    선택 이미지:
        - <span class="hljs-title class_">Image</span>|<span class="hljs-attr">endswith</span>: <span class="hljs-string">'\wbadmin.exe'</span>
        - <span class="hljs-title class_">OriginalFileName</span>: <span class="hljs-string">'WBADMIN.EXE'</span>
    선택 백업:
        <span class="hljs-title class_">CommandLine</span>|<span class="hljs-attr">contains</span>:
            - <span class="hljs-string">'start'</span>
            - <span class="hljs-string">'backup'</span>
    선택 경로:
        <span class="hljs-title class_">CommandLine</span>|<span class="hljs-attr">contains</span>:
            - <span class="hljs-string">'\config\SAM'</span>
            - <span class="hljs-string">'\config\SECURITY'</span>
            - <span class="hljs-string">'\config\SYSTEM'</span>
            - <span class="hljs-string">'\Windows\NTDS\NTDS.dit'</span>
    조건: 모두 선택_*
거짓 양성:
    - 허가된 관리자에 의한 합법적인 백업 작업. 일치 사항은 감사하고 사안별로 허용되어야 합니다.
수준: 높음
</code></pre>
<p>파워셸 cmdlet인 “Start-NetEventSession" 및 “New-NetFirewallRule" 사용을 다루는 새로운 규칙을 소개하였습니다. 공격자가 패킷을 캡처하거나 새 방화벽 규칙을 생성하는 데 사용할 수 있습니다.</p>
<pre><code class="hljs language-js">제목: <span class="hljs-title class_">New</span>-<span class="hljs-title class_">NetFirewallRule</span> <span class="hljs-title class_">Cmdlet</span>을 통한 새 <span class="hljs-title class_">Windows</span> 방화벽 규칙 추가 - <span class="hljs-title class_">ScriptBlock</span>
아이디: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264
관련:
    - 아이디: <span class="hljs-number">51483085</span>-0cba-46a8-837e-4416496d6971
      유형: 유사
상태: 실험적
설명: |
    <span class="hljs-title class_">PowerShell</span> 스크립트에 <span class="hljs-string">"New-NetFirewallRule"</span> cmdlet 호출이 포함되어 있어 <span class="hljs-string">"허용"</span> 동작을 하는 새 방화벽 규칙이 추가될 때 감지합니다.
참고:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//cybersecuritynews.com/rhysida-ransomware-attacking-windows/</span>
작성자: frack113
날짜: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">10</span>
태그:
    - attack.<span class="hljs-property">defense_evasion</span>
    - attack.<span class="hljs-property">t1562</span><span class="hljs-number">.004</span>
    - detection.<span class="hljs-property">threat_hunting</span>
로그 소스:
    제품: windows
    카테고리: ps_script
    정의: <span class="hljs-string">'요구 사항: 스크립트 블록 로깅이 활성화되어 있어야 함'</span>
감지:
    선택:
        <span class="hljs-title class_">ScriptBlockText</span>|<span class="hljs-attr">contains</span>: <span class="hljs-string">'New-NetFirewallRule*-Action*Allow'</span>
    조건: 선택
거짓 양성:
    - 관리자 스크립트
수준: 낮음
</code></pre>
<pre><code class="hljs language-yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">"Start-NetEventSession를 통한 잠재적인 패킷 캡처 활동 - 스크립트 블록"</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">da34e323-1e65-42db-83be-a6725ac2caa3</span>
<span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">|
    "Start-NetEventSession" cmdlet을 호출하는 PowerShell 스크립트 실행을 감지합니다. 이를 통해 공격자는 네트워크 이벤트 세션에 이벤트 및 패킷 캡처를 시작할 수 있습니다.
    이 기술을 통해 수행 중인 작업의 정보를 수집하기 위해 공격자가 네트워크를 캡처하려 할 수 있습니다.
    이 기술을 통해 캡처된 데이터에는 특히 안전하지 않고 암호화되지 않은 프로토콜을 통해 전송된 사용자 자격 증명이 포함될 수 있습니다.
</span><span class="hljs-attr">references:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">https://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">https://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13</span>
<span class="hljs-attr">author:</span> <span class="hljs-string">frack113</span>
<span class="hljs-attr">date:</span> <span class="hljs-number">2024</span><span class="hljs-string">/05/12</span>
<span class="hljs-attr">tags:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.credential_access</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.discovery</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.t1040</span>
<span class="hljs-attr">logsource:</span>
    <span class="hljs-attr">product:</span> <span class="hljs-string">windows</span>
    <span class="hljs-attr">category:</span> <span class="hljs-string">ps_script</span>
    <span class="hljs-attr">definition:</span> <span class="hljs-string">'Script Block Logging이 활성화되어 있어야 함'</span>
<span class="hljs-attr">detection:</span>
    <span class="hljs-attr">selection:</span>
        <span class="hljs-string">ScriptBlockText|contains:</span> <span class="hljs-string">'Start-NetEventSession'</span>
    <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span>
<span class="hljs-attr">falsepositives:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">적절한</span> <span class="hljs-string">네트워크</span> <span class="hljs-string">진단</span> <span class="hljs-string">스크립트.</span>
<span class="hljs-attr">level:</span> <span class="hljs-string">medium</span>
</code></pre>
<p>또한 "KeyScrambler.exe"의 잠재적으로 의심스러운 자식 프로세스를 보와하는 새로운 규칙이 추가되었습니다.</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">"KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스"</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">ca5583e9-8f80-46ac-ab91-7f314d13b984</span>
<span class="hljs-attr">related:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">d2451be2-b582-4e15-8701-4196ac180260</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">similar</span>
<span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">KeyScrambler.exe의</span> <span class="hljs-string">잠재적으로</span> <span class="hljs-string">의심스러운</span> <span class="hljs-string">자식</span> <span class="hljs-string">프로세스를</span> <span class="hljs-string">감지합니다.</span>
<span class="hljs-attr">references:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">https://twitter.com/DTCERT/status/1712785421845790799</span>
<span class="hljs-attr">author:</span> <span class="hljs-string">Swachchhanda</span> <span class="hljs-string">Shrawan</span> <span class="hljs-string">Poudel</span>
<span class="hljs-attr">date:</span> <span class="hljs-number">2024</span><span class="hljs-string">/05/13</span>
<span class="hljs-attr">tags:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.execution</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.defense_evasion</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.privilege_escalation</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.t1203</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">attack.t1574.002</span>
<span class="hljs-attr">logsource:</span>
    <span class="hljs-attr">category:</span> <span class="hljs-string">process_creation</span>
    <span class="hljs-attr">product:</span> <span class="hljs-string">windows</span>
<span class="hljs-attr">detection:</span>
    <span class="hljs-attr">selection_parent:</span>
        <span class="hljs-string">ParentImage|endswith:</span> <span class="hljs-string">'\KeyScrambler.exe'</span>
    <span class="hljs-attr">selection_binaries:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">Image|endswith:</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\cmd.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\cscript.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\mshta.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\powershell.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\pwsh.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\regsvr32.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\rundll32.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'\wscript.exe'</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">OriginalFileName:</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'Cmd.Exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'cscript.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'mshta.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'PowerShell.EXE'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'pwsh.dll'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'regsvr32.exe'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'RUNDLL32.EXE'</span>
              <span class="hljs-bullet">-</span> <span class="hljs-string">'wscript.exe'</span>
    <span class="hljs-attr">condition:</span> <span class="hljs-string">all</span> <span class="hljs-string">of</span> <span class="hljs-string">selection_*</span>
<span class="hljs-attr">falsepositives:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">알</span> <span class="hljs-string">수</span> <span class="hljs-string">없음</span>
<span class="hljs-attr">level:</span> <span class="hljs-string">medium</span>
</code></pre>
<p>모든 새로운 규칙 목록의 전체 릴리스 변경 로그를 확인하세요.</p>
<h1>새로운 업데이트</h1>
<p>일부 이전 규칙들이 커버리지 및 메타데이터에서 개선되었습니다.</p>
<p>우선, "Microsoft-Windows-Windows Firewall With Advanced Security"를 활용하는 몇 가지 규칙에서는 커버리지를 늘리기 위해 EID 2097이 추가되었습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-attr">title</span>: 잠재적으로 의심스러운 응용 프로그램을 위한 <span class="hljs-title class_">Windows</span> 방화벽 예외 목록에 새로운 방화벽 규칙이 추가되었습니다.
<span class="hljs-attr">id</span>: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e
<span class="hljs-attr">related</span>:
    - <span class="hljs-attr">id</span>: cde0a575-7d3d-4a49-<span class="hljs-number">9817</span>-b8004a7bf105
      <span class="hljs-attr">type</span>: derived
<span class="hljs-attr">status</span>: experimental
<span class="hljs-attr">description</span>: 잠재적으로 의심스러운 위치에 있는 응용 프로그램에 대한 <span class="hljs-title class_">Windows</span> 방화벽 예외 목록에 새로운 규칙이 추가되는 것을 탐지합니다.
<span class="hljs-attr">references</span>:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)</span>
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#</span>
<span class="hljs-attr">author</span>: frack113
<span class="hljs-attr">date</span>: <span class="hljs-number">2023</span>/<span class="hljs-number">02</span>/<span class="hljs-number">26</span>
<span class="hljs-attr">modified</span>: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">10</span>
<span class="hljs-attr">tags</span>:
    - attack.<span class="hljs-property">defense_evasion</span>
    - attack.<span class="hljs-property">t1562</span><span class="hljs-number">.004</span>
<span class="hljs-attr">logsource</span>:
    <span class="hljs-attr">product</span>: windows
    <span class="hljs-attr">service</span>: firewall-<span class="hljs-keyword">as</span>
<span class="hljs-attr">detection</span>:
    <span class="hljs-attr">selection</span>:
        <span class="hljs-title class_">EventID</span>:
            - <span class="hljs-number">2004</span> # <span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Defender</span> 방화벽 예외 목록에 규칙이 추가되었습니다. (<span class="hljs-title class_">Windows</span> <span class="hljs-number">10</span>)
            - <span class="hljs-number">2071</span> # <span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Defender</span> 방화벽 예외 목록에 규칙이 추가되었습니다. (<span class="hljs-title class_">Windows</span> <span class="hljs-number">11</span>)
            - <span class="hljs-number">2097</span>
        <span class="hljs-title class_">ApplicationPath</span>|<span class="hljs-attr">contains</span>:
            - <span class="hljs-string">':\PerfLogs\'
            - '</span>:\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Tmp</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Users</span>\<span class="hljs-title class_">Public</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">Tasks</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
            - '</span>\<span class="hljs-title class_">AppData</span>\<span class="hljs-title class_">Local</span>\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
    filter_main_block:
        Action: 2 # 차단
    condition: selection and not 1 of filter_main_*
falsepositives:
    - 알 수 없음
level: 높음
</span></code></pre>
<pre><code class="hljs language-js"><span class="hljs-attr">title</span>: <span class="hljs-title class_">Windows</span> 방화벽 예외 목록에 추가된 새로운 드문한 방화벽 규칙
<span class="hljs-attr">id</span>: cde0a575-7d3d-4a49-<span class="hljs-number">9817</span>-b8004a7bf105
<span class="hljs-attr">status</span>: experimental
<span class="hljs-attr">description</span>: <span class="hljs-title class_">Windows</span> 방화벽 예외 목록에 규칙이 추가된 것을 감지합니다
<span class="hljs-attr">references</span>:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)</span>
<span class="hljs-attr">author</span>: frack113
<span class="hljs-attr">date</span>: <span class="hljs-number">2022</span>/<span class="hljs-number">02</span>/<span class="hljs-number">19</span>
<span class="hljs-attr">modified</span>: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">10</span>
<span class="hljs-attr">tags</span>:
    - attack.<span class="hljs-property">defense_evasion</span>
    - attack.<span class="hljs-property">t1562</span><span class="hljs-number">.004</span>
<span class="hljs-attr">logsource</span>:
    <span class="hljs-attr">product</span>: windows
    <span class="hljs-attr">service</span>: firewall-<span class="hljs-keyword">as</span>
<span class="hljs-attr">detection</span>:
    <span class="hljs-attr">selection</span>:
        <span class="hljs-title class_">EventID</span>:
            - <span class="hljs-number">2004</span> # <span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Defender</span> 방화벽 예외 목록에 규칙이 추가됨
            - <span class="hljs-number">2071</span> # <span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Defender</span> 방화벽 예외 목록에 규칙이 추가됨. (<span class="hljs-title class_">Windows</span> <span class="hljs-number">11</span>)
            - <span class="hljs-number">2097</span>
    <span class="hljs-attr">filter_main_block</span>:
        <span class="hljs-title class_">Action</span>: <span class="hljs-number">2</span> # 차단
    <span class="hljs-attr">filter_main_generic</span>:
        <span class="hljs-title class_">ApplicationPath</span>|<span class="hljs-attr">contains</span>:
            - <span class="hljs-string">':\Program Files (x86)\'
            - '</span>:\<span class="hljs-title class_">Program</span> <span class="hljs-title class_">Files</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">System32</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">SysWOW64</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">WinSxS</span>\<span class="hljs-string">'
    filter_optional_msmpeng:
        ModifyingApplication|contains|all:
            - '</span>:\<span class="hljs-title class_">ProgramData</span>\<span class="hljs-title class_">Microsoft</span>\<span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Defender</span>\<span class="hljs-title class_">Platform</span>\<span class="hljs-string">'
            - '</span>\<span class="hljs-title class_">MsMpEng</span>.<span class="hljs-property">exe</span><span class="hljs-string">'
    filter_main_covered_paths:
        # 이 필터는 9e2575e7-2cb9-4da1-adc8-ed94221dca5e로부터의 중복 경고 방지를 위해 추가되었습니다
        ApplicationPath|contains:
            - '</span>:\<span class="hljs-title class_">PerfLogs</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Tmp</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Users</span>\<span class="hljs-title class_">Public</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">Tasks</span>\<span class="hljs-string">'
            - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
            - '</span>\<span class="hljs-title class_">AppData</span>\<span class="hljs-title class_">Local</span>\<span class="hljs-title class_">Temp</span>\<span class="hljs-string">'
    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
level: medium
</span></code></pre>
<p><code>PDQDeployRunner</code>를 사용하여 추가 경로 및 프로세스가 규칙에 추가되었습니다. 이는 악의적인 랜섬웨어 위협 행위자들이 환경 전체로 악성 소프트웨어를 배포하기 위해 종종 사용하는 유틸리티입니다.</p>
<pre><code class="hljs language-js"><span class="hljs-attr">title</span>: <span class="hljs-title class_">PDQDeployRunner</span>의 잠재적으로 의심스러운 실행
<span class="hljs-attr">id</span>: 12b8e9f5-96b2-<span class="hljs-number">41e1</span>-9a42-8c6779a5c184
<span class="hljs-attr">related</span>:
    - <span class="hljs-attr">id</span>: d679950c-abb7-43a6-80fb-2a480c4fc450
      <span class="hljs-attr">type</span>: 비슷함
<span class="hljs-attr">status</span>: 테스트
<span class="hljs-attr">description</span>: <span class="hljs-string">"PDQDeployRunner"</span>의 의심스러운 실행을 감지합니다. 이는 원격 장치에서 명령과 패키지를 실행하는 <span class="hljs-title class_">PDQDeploy</span> 서비스 스택의 일부입니다
<span class="hljs-attr">references</span>:
    - <span class="hljs-attr">https</span>:<span class="hljs-comment">//twitter.com/malmoeb/status/1550483085472432128</span>
<span class="hljs-attr">author</span>: <span class="hljs-title class_">Nasreddine</span> <span class="hljs-title class_">Bencherchali</span> (<span class="hljs-title class_">Nextron</span> <span class="hljs-title class_">Systems</span>)
<span class="hljs-attr">date</span>: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">22</span>
<span class="hljs-attr">modified</span>: <span class="hljs-number">2024</span>/<span class="hljs-number">05</span>/<span class="hljs-number">02</span>
<span class="hljs-attr">tags</span>:
    - 공격.실행
<span class="hljs-attr">logsource</span>:
    <span class="hljs-attr">category</span>: process_creation
    <span class="hljs-attr">product</span>: windows
<span class="hljs-attr">detection</span>:
    <span class="hljs-attr">selection_parent</span>:
        <span class="hljs-title class_">ParentImage</span>|<span class="hljs-attr">contains</span>: <span class="hljs-string">'\PDQDeployRunner-'</span>
    <span class="hljs-attr">selection_child</span>:
        # 다른 의심스러운 프로세스, 명령줄 또는 경로 추가하여 이 섹션을 개선
        - <span class="hljs-title class_">Image</span>|<span class="hljs-attr">endswith</span>:
              # 다음 프로세스 중 하나를 정상적으로 사용할 경우 주석 처리
              - <span class="hljs-string">'\bash.exe'</span>
              - <span class="hljs-string">'\certutil.exe'</span>
              - <span class="hljs-string">'\cmd.exe'</span>
              - <span class="hljs-string">'\csc.exe'</span>
              - <span class="hljs-string">'\cscript.exe'</span>
              - <span class="hljs-string">'\dllhost.exe'</span>
              - <span class="hljs-string">'\mshta.exe'</span>
              - <span class="hljs-string">'\msiexec.exe'</span>
              - <span class="hljs-string">'\regsvr32.exe'</span>
              - <span class="hljs-string">'\rundll32.exe'</span>
              - <span class="hljs-string">'\scriptrunner.exe'</span>
              - <span class="hljs-string">'\wmic.exe'</span>
              - <span class="hljs-string">'\wscript.exe'</span>
              - <span class="hljs-string">'\wsl.exe'</span>
        - <span class="hljs-title class_">Image</span>|<span class="hljs-attr">contains</span>:
              - <span class="hljs-string">':\ProgramData\'
              - '</span>:\<span class="hljs-title class_">Users</span>\<span class="hljs-title class_">Public</span>\<span class="hljs-string">'
              - '</span>:\<span class="hljs-title class_">Windows</span>\<span class="hljs-variable constant_">TEMP</span>\<span class="hljs-string">'
              - '</span>\<span class="hljs-title class_">AppData</span>\<span class="hljs-title class_">Local</span>\<span class="hljs-title class_">Temp</span><span class="hljs-string">'
        - CommandLine|contains:
              - '</span> -decode <span class="hljs-string">'
              - '</span> -enc <span class="hljs-string">'
              - '</span> -encodedcommand <span class="hljs-string">'
              - '</span> -w hidden<span class="hljs-string">'
              - '</span><span class="hljs-title class_">DownloadString</span><span class="hljs-string">'
              - '</span><span class="hljs-title class_">FromBase64String</span><span class="hljs-string">'
              - '</span>http<span class="hljs-string">'
              - '</span>iex <span class="hljs-string">'
              - '</span><span class="hljs-title class_">Invoke</span>-<span class="hljs-string">'
    condition: all of selection_*
falsepositives:
    - PDQDeploy 도구를 사용하여 이러한 명령을 실행하는 것이 정당할 경우
level: medium
</span></code></pre>
<p>모든 업데이트 목록을 확인하려면 전체 릴리스 변경 로그를 확인하세요.</p>
<h1>수정 사항</h1>
<p>이 릴리스에서는 "Forest Blizzard APT - 프로세스 생성 활동" 규칙이 작동하지 않도록 만드는 누락된 수정 자를 처리한 것을 확인할 수 있었습니다.</p>
<p>변경 사항 및 추가 사항의 전체 변경 로그를 확인하려면 아래 릴리스 페이지를 참조해주세요.</p>
<h1>기여자</h1>
<p>이 릴리스는 Sigma 커뮤니티 기여자 여러분 덕분에 가능해 졌어요. 다음 분들께 큰 감사를 전합니다.</p>
<ul>
<li>@ahmedfarou22</li>
<li>@frack113</li>
<li>@hasselj</li>
<li>@joshnck</li>
<li>@nasbench</li>
<li>@pratinavchandra</li>
<li>@swachchhanda000</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"SigmaHQ Rules 릴리스 하이라이트  r2024-05-13","description":"","date":"2024-05-15 03:57","slug":"2024-05-15-SigmaHQRulesReleaseHighlightsr20240513","content":"\n\n\n![SigmaHQRulesReleaseHighlights](/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png)\n\n2024년 5월 13일 Sigma Rule Packages가 발표되었습니다. 이번 릴리즈에는 16개의 새로운 규칙, 7개의 규칙 업데이트 및 1개의 규칙 수정이 7명의 기여자에 의해 추가되었습니다.\n\n# 새로운 규칙\n\n새로운 규칙 중 일부 하이라이트는 다음과 같습니다. Wbadmin을 이용하여 민감한 파일을 덤프/복원하고 백업을 삭제하는 다양한 사례를 다루는 규칙입니다.\n\n\n\n```js\n제목: Wbadmin.EXE를 통한 파일 복구\n아이디: 6fe4aa1e-0531-4510-8be2-782154b73b48\n관련:\n    - 아이디: 84972c80-251c-4c3a-9079-4f00aad93938\n      유형: 파생\n상태: 실험적\n설명: |\n    \"wbadmin.exe\"를 통한 백업 파일로부터 파일 복구를 감지합니다.\n    공격자는 NTDS.DIT 또는 레지스트리 하이브와 같은 민감한 파일을 백업에서 복원하여 자격 증명을 뽑아낼 수 있습니다.\n참고:\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\n    - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/\n작성자: Nasreddine Bencherchali (Nextron Systems), frack113\n날짜: 2024/05/10\n태그:\n    - attack.impact\n    - attack.t1490\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - Image|endswith: '\\wbadmin.exe'\n        - OriginalFileName: 'WBADMIN.EXE'\n    선택 CLI:\n        CommandLine|contains|all:\n            - ' recovery'\n            - 'recoveryTarget'\n            - 'itemtype:File'\n    조건: 모두 선택_*\n거짓 양성:\n    - 알 수 없음\n수준: 중간\n```\n\n```js\n제목: Wbadmin.EXE를 통한 민감한 파일 덤프\n아이디: 8b93a509-1cb8-42e1-97aa-ee24224cdc15\n상태: 실험적\n설명: |\n    \"NTDS.DIT\" 및 \"SECURITY\" 하이브와 같은 고도로 민감한 파일의 덤프를 감지합니다.\n    공격자는 \"wbadmin\" 유틸리티를 활용하여 자격 증명이나 민감한 정보가 포함된 민감한 파일을 덤프할 수 있습니다.\n참고:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml\n    - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\n    - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup\n작성자: Nasreddine Bencherchali (Nextron Systems), frack113\n날짜: 2024/05/10\n태그:\n    - attack.credential_access\n    - attack.t1003.003\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - Image|endswith: '\\wbadmin.exe'\n        - OriginalFileName: 'WBADMIN.EXE'\n    선택 백업:\n        CommandLine|contains:\n            - 'start'\n            - 'backup'\n    선택 경로:\n        CommandLine|contains:\n            - '\\config\\SAM'\n            - '\\config\\SECURITY'\n            - '\\config\\SYSTEM'\n            - '\\Windows\\NTDS\\NTDS.dit'\n    조건: 모두 선택_*\n거짓 양성:\n    - 허가된 관리자에 의한 합법적인 백업 작업. 일치 사항은 감사하고 사안별로 허용되어야 합니다.\n수준: 높음\n```\n\n파워셸 cmdlet인 “Start-NetEventSession\" 및 “New-NetFirewallRule\" 사용을 다루는 새로운 규칙을 소개하였습니다. 공격자가 패킷을 캡처하거나 새 방화벽 규칙을 생성하는 데 사용할 수 있습니다.\n\n```js\n제목: New-NetFirewallRule Cmdlet을 통한 새 Windows 방화벽 규칙 추가 - ScriptBlock\n아이디: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264\n관련:\n    - 아이디: 51483085-0cba-46a8-837e-4416496d6971\n      유형: 유사\n상태: 실험적\n설명: |\n    PowerShell 스크립트에 \"New-NetFirewallRule\" cmdlet 호출이 포함되어 있어 \"허용\" 동작을 하는 새 방화벽 규칙이 추가될 때 감지합니다.\n참고:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule\n    - https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170\n    - https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/\n작성자: frack113\n날짜: 2024/05/10\n태그:\n    - attack.defense_evasion\n    - attack.t1562.004\n    - detection.threat_hunting\n로그 소스:\n    제품: windows\n    카테고리: ps_script\n    정의: '요구 사항: 스크립트 블록 로깅이 활성화되어 있어야 함'\n감지:\n    선택:\n        ScriptBlockText|contains: 'New-NetFirewallRule*-Action*Allow'\n    조건: 선택\n거짓 양성:\n    - 관리자 스크립트\n수준: 낮음\n```\n\n\n\n```yaml\ntitle: \"Start-NetEventSession를 통한 잠재적인 패킷 캡처 활동 - 스크립트 블록\"\nid: da34e323-1e65-42db-83be-a6725ac2caa3\nstatus: experimental\ndescription: |\n    \"Start-NetEventSession\" cmdlet을 호출하는 PowerShell 스크립트 실행을 감지합니다. 이를 통해 공격자는 네트워크 이벤트 세션에 이벤트 및 패킷 캡처를 시작할 수 있습니다.\n    이 기술을 통해 수행 중인 작업의 정보를 수집하기 위해 공격자가 네트워크를 캡처하려 할 수 있습니다.\n    이 기술을 통해 캡처된 데이터에는 특히 안전하지 않고 암호화되지 않은 프로토콜을 통해 전송된 사용자 자격 증명이 포함될 수 있습니다.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing\n    - https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md\n    - https://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13\nauthor: frack113\ndate: 2024/05/12\ntags:\n    - attack.credential_access\n    - attack.discovery\n    - attack.t1040\nlogsource:\n    product: windows\n    category: ps_script\n    definition: 'Script Block Logging이 활성화되어 있어야 함'\ndetection:\n    selection:\n        ScriptBlockText|contains: 'Start-NetEventSession'\n    condition: selection\nfalsepositives:\n    - 적절한 네트워크 진단 스크립트.\nlevel: medium\n```\n\n또한 \"KeyScrambler.exe\"의 잠재적으로 의심스러운 자식 프로세스를 보와하는 새로운 규칙이 추가되었습니다.\n\n```yaml\ntitle: \"KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스\"\nid: ca5583e9-8f80-46ac-ab91-7f314d13b984\nrelated:\n    - id: d2451be2-b582-4e15-8701-4196ac180260\n      type: similar\nstatus: experimental\ndescription: KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스를 감지합니다.\nreferences:\n    - https://twitter.com/DTCERT/status/1712785421845790799\nauthor: Swachchhanda Shrawan Poudel\ndate: 2024/05/13\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1203\n    - attack.t1574.002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_parent:\n        ParentImage|endswith: '\\KeyScrambler.exe'\n    selection_binaries:\n        - Image|endswith:\n              - '\\cmd.exe'\n              - '\\cscript.exe'\n              - '\\mshta.exe'\n              - '\\powershell.exe'\n              - '\\pwsh.exe'\n              - '\\regsvr32.exe'\n              - '\\rundll32.exe'\n              - '\\wscript.exe'\n        - OriginalFileName:\n              - 'Cmd.Exe'\n              - 'cscript.exe'\n              - 'mshta.exe'\n              - 'PowerShell.EXE'\n              - 'pwsh.dll'\n              - 'regsvr32.exe'\n              - 'RUNDLL32.EXE'\n              - 'wscript.exe'\n    condition: all of selection_*\nfalsepositives:\n    - 알 수 없음\nlevel: medium\n```  \n\n모든 새로운 규칙 목록의 전체 릴리스 변경 로그를 확인하세요.\n\n\n\n\n# 새로운 업데이트\n\n일부 이전 규칙들이 커버리지 및 메타데이터에서 개선되었습니다.\n\n우선, \"Microsoft-Windows-Windows Firewall With Advanced Security\"를 활용하는 몇 가지 규칙에서는 커버리지를 늘리기 위해 EID 2097이 추가되었습니다.\n\n```js\ntitle: 잠재적으로 의심스러운 응용 프로그램을 위한 Windows 방화벽 예외 목록에 새로운 방화벽 규칙이 추가되었습니다.\nid: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e\nrelated:\n    - id: cde0a575-7d3d-4a49-9817-b8004a7bf105\n      type: derived\nstatus: experimental\ndescription: 잠재적으로 의심스러운 위치에 있는 응용 프로그램에 대한 Windows 방화벽 예외 목록에 새로운 규칙이 추가되는 것을 탐지합니다.\nreferences:\n    - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\n    - https://app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#\nauthor: frack113\ndate: 2023/02/26\nmodified: 2024/05/10\ntags:\n    - attack.defense_evasion\n    - attack.t1562.004\nlogsource:\n    product: windows\n    service: firewall-as\ndetection:\n    selection:\n        EventID:\n            - 2004 # Windows Defender 방화벽 예외 목록에 규칙이 추가되었습니다. (Windows 10)\n            - 2071 # Windows Defender 방화벽 예외 목록에 규칙이 추가되었습니다. (Windows 11)\n            - 2097\n        ApplicationPath|contains:\n            - ':\\PerfLogs\\'\n            - ':\\Temp\\'\n            - ':\\Tmp\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\Tasks\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n    filter_main_block:\n        Action: 2 # 차단\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - 알 수 없음\nlevel: 높음\n```\n\n\n\n```js\ntitle: Windows 방화벽 예외 목록에 추가된 새로운 드문한 방화벽 규칙\nid: cde0a575-7d3d-4a49-9817-b8004a7bf105\nstatus: experimental\ndescription: Windows 방화벽 예외 목록에 규칙이 추가된 것을 감지합니다\nreferences:\n    - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\nauthor: frack113\ndate: 2022/02/19\nmodified: 2024/05/10\ntags:\n    - attack.defense_evasion\n    - attack.t1562.004\nlogsource:\n    product: windows\n    service: firewall-as\ndetection:\n    selection:\n        EventID:\n            - 2004 # Windows Defender 방화벽 예외 목록에 규칙이 추가됨\n            - 2071 # Windows Defender 방화벽 예외 목록에 규칙이 추가됨. (Windows 11)\n            - 2097\n    filter_main_block:\n        Action: 2 # 차단\n    filter_main_generic:\n        ApplicationPath|contains:\n            - ':\\Program Files (x86)\\'\n            - ':\\Program Files\\'\n            - ':\\Windows\\System32\\'\n            - ':\\Windows\\SysWOW64\\'\n            - ':\\Windows\\WinSxS\\'\n    filter_optional_msmpeng:\n        ModifyingApplication|contains|all:\n            - ':\\ProgramData\\Microsoft\\Windows Defender\\Platform\\'\n            - '\\MsMpEng.exe'\n    filter_main_covered_paths:\n        # 이 필터는 9e2575e7-2cb9-4da1-adc8-ed94221dca5e로부터의 중복 경고 방지를 위해 추가되었습니다\n        ApplicationPath|contains:\n            - ':\\PerfLogs\\'\n            - ':\\Temp\\'\n            - ':\\Tmp\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\Tasks\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nlevel: medium\n```\n\n`PDQDeployRunner`를 사용하여 추가 경로 및 프로세스가 규칙에 추가되었습니다. 이는 악의적인 랜섬웨어 위협 행위자들이 환경 전체로 악성 소프트웨어를 배포하기 위해 종종 사용하는 유틸리티입니다.\n\n```js\ntitle: PDQDeployRunner의 잠재적으로 의심스러운 실행\nid: 12b8e9f5-96b2-41e1-9a42-8c6779a5c184\nrelated:\n    - id: d679950c-abb7-43a6-80fb-2a480c4fc450\n      type: 비슷함\nstatus: 테스트\ndescription: \"PDQDeployRunner\"의 의심스러운 실행을 감지합니다. 이는 원격 장치에서 명령과 패키지를 실행하는 PDQDeploy 서비스 스택의 일부입니다\nreferences:\n    - https://twitter.com/malmoeb/status/1550483085472432128\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/07/22\nmodified: 2024/05/02\ntags:\n    - 공격.실행\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_parent:\n        ParentImage|contains: '\\PDQDeployRunner-'\n    selection_child:\n        # 다른 의심스러운 프로세스, 명령줄 또는 경로 추가하여 이 섹션을 개선\n        - Image|endswith:\n              # 다음 프로세스 중 하나를 정상적으로 사용할 경우 주석 처리\n              - '\\bash.exe'\n              - '\\certutil.exe'\n              - '\\cmd.exe'\n              - '\\csc.exe'\n              - '\\cscript.exe'\n              - '\\dllhost.exe'\n              - '\\mshta.exe'\n              - '\\msiexec.exe'\n              - '\\regsvr32.exe'\n              - '\\rundll32.exe'\n              - '\\scriptrunner.exe'\n              - '\\wmic.exe'\n              - '\\wscript.exe'\n              - '\\wsl.exe'\n        - Image|contains:\n              - ':\\ProgramData\\'\n              - ':\\Users\\Public\\'\n              - ':\\Windows\\TEMP\\'\n              - '\\AppData\\Local\\Temp'\n        - CommandLine|contains:\n              - ' -decode '\n              - ' -enc '\n              - ' -encodedcommand '\n              - ' -w hidden'\n              - 'DownloadString'\n              - 'FromBase64String'\n              - 'http'\n              - 'iex '\n              - 'Invoke-'\n    condition: all of selection_*\nfalsepositives:\n    - PDQDeploy 도구를 사용하여 이러한 명령을 실행하는 것이 정당할 경우\nlevel: medium\n```\n\n모든 업데이트 목록을 확인하려면 전체 릴리스 변경 로그를 확인하세요.\n\n\n\n\n# 수정 사항\n\n이 릴리스에서는 \"Forest Blizzard APT - 프로세스 생성 활동\" 규칙이 작동하지 않도록 만드는 누락된 수정 자를 처리한 것을 확인할 수 있었습니다.\n\n변경 사항 및 추가 사항의 전체 변경 로그를 확인하려면 아래 릴리스 페이지를 참조해주세요.\n\n# 기여자\n\n\n\n이 릴리스는 Sigma 커뮤니티 기여자 여러분 덕분에 가능해 졌어요. 다음 분들께 큰 감사를 전합니다.\n\n- @ahmedfarou22\n- @frack113\n- @hasselj\n- @joshnck\n- @nasbench\n- @pratinavchandra\n- @swachchhanda000","ogImage":{"url":"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png"},"coverImage":"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png","tag":["Tech"],"readingTime":12},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-15-SigmaHQRulesReleaseHighlightsr20240513_0.png\" alt=\"SigmaHQRulesReleaseHighlights\"\u003e\u003c/p\u003e\n\u003cp\u003e2024년 5월 13일 Sigma Rule Packages가 발표되었습니다. 이번 릴리즈에는 16개의 새로운 규칙, 7개의 규칙 업데이트 및 1개의 규칙 수정이 7명의 기여자에 의해 추가되었습니다.\u003c/p\u003e\n\u003ch1\u003e새로운 규칙\u003c/h1\u003e\n\u003cp\u003e새로운 규칙 중 일부 하이라이트는 다음과 같습니다. Wbadmin을 이용하여 민감한 파일을 덤프/복원하고 백업을 삭제하는 다양한 사례를 다루는 규칙입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e제목: \u003cspan class=\"hljs-title class_\"\u003eWbadmin\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eEXE\u003c/span\u003e를 통한 파일 복구\n아이디: 6fe4aa1e-\u003cspan class=\"hljs-number\"\u003e0531\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e4510\u003c/span\u003e-8be2-782154b73b48\n관련:\n    - 아이디: 84972c80-251c-4c3a-\u003cspan class=\"hljs-number\"\u003e9079\u003c/span\u003e-4f00aad93938\n      유형: 파생\n상태: 실험적\n설명: |\n    \u003cspan class=\"hljs-string\"\u003e\"wbadmin.exe\"\u003c/span\u003e를 통한 백업 파일로부터 파일 복구를 감지합니다.\n    공격자는 \u003cspan class=\"hljs-variable constant_\"\u003eNTDS\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDIT\u003c/span\u003e 또는 레지스트리 하이브와 같은 민감한 파일을 백업에서 복원하여 자격 증명을 뽑아낼 수 있습니다.\n참고:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//lolbas-project.github.io/lolbas/Binaries/Wbadmin/\u003c/span\u003e\n작성자: \u003cspan class=\"hljs-title class_\"\u003eNasreddine\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBencherchali\u003c/span\u003e (\u003cspan class=\"hljs-title class_\"\u003eNextron\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSystems\u003c/span\u003e), frack113\n날짜: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n태그:\n    - attack.\u003cspan class=\"hljs-property\"\u003eimpact\u003c/span\u003e\n    - attack.\u003cspan class=\"hljs-property\"\u003et1490\u003c/span\u003e\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003eendswith\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\\wbadmin.exe'\u003c/span\u003e\n        - \u003cspan class=\"hljs-title class_\"\u003eOriginalFileName\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'WBADMIN.EXE'\u003c/span\u003e\n    선택 \u003cspan class=\"hljs-attr\"\u003eCLI\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eCommandLine\u003c/span\u003e|contains|\u003cspan class=\"hljs-attr\"\u003eall\u003c/span\u003e:\n            - \u003cspan class=\"hljs-string\"\u003e' recovery'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'recoveryTarget'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'itemtype:File'\u003c/span\u003e\n    조건: 모두 선택_*\n거짓 양성:\n    - 알 수 없음\n수준: 중간\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e제목: \u003cspan class=\"hljs-title class_\"\u003eWbadmin\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eEXE\u003c/span\u003e를 통한 민감한 파일 덤프\n아이디: 8b93a509-1cb8-\u003cspan class=\"hljs-number\"\u003e42e1\u003c/span\u003e-97aa-ee24224cdc15\n상태: 실험적\n설명: |\n    \u003cspan class=\"hljs-string\"\u003e\"NTDS.DIT\"\u003c/span\u003e 및 \u003cspan class=\"hljs-string\"\u003e\"SECURITY\"\u003c/span\u003e 하이브와 같은 고도로 민감한 파일의 덤프를 감지합니다.\n    공격자는 \u003cspan class=\"hljs-string\"\u003e\"wbadmin\"\u003c/span\u003e 유틸리티를 활용하여 자격 증명이나 민감한 정보가 포함된 민감한 파일을 덤프할 수 있습니다.\n참고:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//lolbas-project.github.io/lolbas/Binaries/Wbadmin/\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup\u003c/span\u003e\n작성자: \u003cspan class=\"hljs-title class_\"\u003eNasreddine\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBencherchali\u003c/span\u003e (\u003cspan class=\"hljs-title class_\"\u003eNextron\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSystems\u003c/span\u003e), frack113\n날짜: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n태그:\n    - attack.\u003cspan class=\"hljs-property\"\u003ecredential_access\u003c/span\u003e\n    - attack.\u003cspan class=\"hljs-property\"\u003et1003\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.003\u003c/span\u003e\n로그 소스:\n    카테고리: process_creation\n    제품: windows\n감지:\n    선택 이미지:\n        - \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003eendswith\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\\wbadmin.exe'\u003c/span\u003e\n        - \u003cspan class=\"hljs-title class_\"\u003eOriginalFileName\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'WBADMIN.EXE'\u003c/span\u003e\n    선택 백업:\n        \u003cspan class=\"hljs-title class_\"\u003eCommandLine\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e:\n            - \u003cspan class=\"hljs-string\"\u003e'start'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'backup'\u003c/span\u003e\n    선택 경로:\n        \u003cspan class=\"hljs-title class_\"\u003eCommandLine\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e:\n            - \u003cspan class=\"hljs-string\"\u003e'\\config\\SAM'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'\\config\\SECURITY'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'\\config\\SYSTEM'\u003c/span\u003e\n            - \u003cspan class=\"hljs-string\"\u003e'\\Windows\\NTDS\\NTDS.dit'\u003c/span\u003e\n    조건: 모두 선택_*\n거짓 양성:\n    - 허가된 관리자에 의한 합법적인 백업 작업. 일치 사항은 감사하고 사안별로 허용되어야 합니다.\n수준: 높음\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e파워셸 cmdlet인 “Start-NetEventSession\" 및 “New-NetFirewallRule\" 사용을 다루는 새로운 규칙을 소개하였습니다. 공격자가 패킷을 캡처하거나 새 방화벽 규칙을 생성하는 데 사용할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e제목: \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eNetFirewallRule\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eCmdlet\u003c/span\u003e을 통한 새 \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e 방화벽 규칙 추가 - \u003cspan class=\"hljs-title class_\"\u003eScriptBlock\u003c/span\u003e\n아이디: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264\n관련:\n    - 아이디: \u003cspan class=\"hljs-number\"\u003e51483085\u003c/span\u003e-0cba-46a8-837e-4416496d6971\n      유형: 유사\n상태: 실험적\n설명: |\n    \u003cspan class=\"hljs-title class_\"\u003ePowerShell\u003c/span\u003e 스크립트에 \u003cspan class=\"hljs-string\"\u003e\"New-NetFirewallRule\"\u003c/span\u003e cmdlet 호출이 포함되어 있어 \u003cspan class=\"hljs-string\"\u003e\"허용\"\u003c/span\u003e 동작을 하는 새 방화벽 규칙이 추가될 때 감지합니다.\n참고:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//cybersecuritynews.com/rhysida-ransomware-attacking-windows/\u003c/span\u003e\n작성자: frack113\n날짜: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n태그:\n    - attack.\u003cspan class=\"hljs-property\"\u003edefense_evasion\u003c/span\u003e\n    - attack.\u003cspan class=\"hljs-property\"\u003et1562\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.004\u003c/span\u003e\n    - detection.\u003cspan class=\"hljs-property\"\u003ethreat_hunting\u003c/span\u003e\n로그 소스:\n    제품: windows\n    카테고리: ps_script\n    정의: \u003cspan class=\"hljs-string\"\u003e'요구 사항: 스크립트 블록 로깅이 활성화되어 있어야 함'\u003c/span\u003e\n감지:\n    선택:\n        \u003cspan class=\"hljs-title class_\"\u003eScriptBlockText\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'New-NetFirewallRule*-Action*Allow'\u003c/span\u003e\n    조건: 선택\n거짓 양성:\n    - 관리자 스크립트\n수준: 낮음\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003etitle:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Start-NetEventSession를 통한 잠재적인 패킷 캡처 활동 - 스크립트 블록\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eid:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eda34e323-1e65-42db-83be-a6725ac2caa3\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003estatus:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexperimental\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edescription:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\n    \"Start-NetEventSession\" cmdlet을 호출하는 PowerShell 스크립트 실행을 감지합니다. 이를 통해 공격자는 네트워크 이벤트 세션에 이벤트 및 패킷 캡처를 시작할 수 있습니다.\n    이 기술을 통해 수행 중인 작업의 정보를 수집하기 위해 공격자가 네트워크를 캡처하려 할 수 있습니다.\n    이 기술을 통해 캡처된 데이터에는 특히 안전하지 않고 암호화되지 않은 프로토콜을 통해 전송된 사용자 자격 증명이 포함될 수 있습니다.\n\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003ereferences:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttps://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttps://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttps://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eauthor:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003efrack113\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edate:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e/05/12\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003etags:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.credential_access\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.discovery\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.t1040\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elogsource:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eproduct:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewindows\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecategory:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eps_script\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edefinition:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Script Block Logging이 활성화되어 있어야 함'\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edetection:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eselection:\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003eScriptBlockText|contains:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Start-NetEventSession'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003econdition:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eselection\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003efalsepositives:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e적절한\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e네트워크\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e진단\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e스크립트.\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elevel:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emedium\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e또한 \"KeyScrambler.exe\"의 잠재적으로 의심스러운 자식 프로세스를 보와하는 새로운 규칙이 추가되었습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003etitle:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"KeyScrambler.exe의 잠재적으로 의심스러운 자식 프로세스\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eid:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eca5583e9-8f80-46ac-ab91-7f314d13b984\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003erelated:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ed2451be2-b582-4e15-8701-4196ac180260\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003etype:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esimilar\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003estatus:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexperimental\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edescription:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eKeyScrambler.exe의\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e잠재적으로\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e의심스러운\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e자식\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e프로세스를\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e감지합니다.\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ereferences:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttps://twitter.com/DTCERT/status/1712785421845790799\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eauthor:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eSwachchhanda\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eShrawan\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePoudel\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edate:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e/05/13\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003etags:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.execution\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.defense_evasion\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.privilege_escalation\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.t1203\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eattack.t1574.002\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elogsource:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecategory:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eprocess_creation\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eproduct:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewindows\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edetection:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eselection_parent:\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003eParentImage|endswith:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\KeyScrambler.exe'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eselection_binaries:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eImage|endswith:\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\cmd.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\cscript.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\mshta.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\powershell.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\pwsh.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\regsvr32.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\rundll32.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\wscript.exe'\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eOriginalFileName:\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Cmd.Exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'cscript.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'mshta.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'PowerShell.EXE'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'pwsh.dll'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'regsvr32.exe'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'RUNDLL32.EXE'\u003c/span\u003e\n              \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'wscript.exe'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003econdition:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eall\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eselection_*\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003efalsepositives:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e알\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e수\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e없음\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elevel:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emedium\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e모든 새로운 규칙 목록의 전체 릴리스 변경 로그를 확인하세요.\u003c/p\u003e\n\u003ch1\u003e새로운 업데이트\u003c/h1\u003e\n\u003cp\u003e일부 이전 규칙들이 커버리지 및 메타데이터에서 개선되었습니다.\u003c/p\u003e\n\u003cp\u003e우선, \"Microsoft-Windows-Windows Firewall With Advanced Security\"를 활용하는 몇 가지 규칙에서는 커버리지를 늘리기 위해 EID 2097이 추가되었습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: 잠재적으로 의심스러운 응용 프로그램을 위한 \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e 방화벽 예외 목록에 새로운 방화벽 규칙이 추가되었습니다.\n\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e\n\u003cspan class=\"hljs-attr\"\u003erelated\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: cde0a575-7d3d-4a49-\u003cspan class=\"hljs-number\"\u003e9817\u003c/span\u003e-b8004a7bf105\n      \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: derived\n\u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: experimental\n\u003cspan class=\"hljs-attr\"\u003edescription\u003c/span\u003e: 잠재적으로 의심스러운 위치에 있는 응용 프로그램에 대한 \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e 방화벽 예외 목록에 새로운 규칙이 추가되는 것을 탐지합니다.\n\u003cspan class=\"hljs-attr\"\u003ereferences\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\u003c/span\u003e\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eauthor\u003c/span\u003e: frack113\n\u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emodified\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003etags\u003c/span\u003e:\n    - attack.\u003cspan class=\"hljs-property\"\u003edefense_evasion\u003c/span\u003e\n    - attack.\u003cspan class=\"hljs-property\"\u003et1562\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.004\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elogsource\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eproduct\u003c/span\u003e: windows\n    \u003cspan class=\"hljs-attr\"\u003eservice\u003c/span\u003e: firewall-\u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edetection\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eselection\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eEventID\u003c/span\u003e:\n            - \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e # \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDefender\u003c/span\u003e 방화벽 예외 목록에 규칙이 추가되었습니다. (\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n            - \u003cspan class=\"hljs-number\"\u003e2071\u003c/span\u003e # \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDefender\u003c/span\u003e 방화벽 예외 목록에 규칙이 추가되었습니다. (\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e)\n            - \u003cspan class=\"hljs-number\"\u003e2097\u003c/span\u003e\n        \u003cspan class=\"hljs-title class_\"\u003eApplicationPath\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e:\n            - \u003cspan class=\"hljs-string\"\u003e':\\PerfLogs\\'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eTmp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eUsers\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003ePublic\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTasks\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eAppData\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eLocal\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n    filter_main_block:\n        Action: 2 # 차단\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - 알 수 없음\nlevel: 높음\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e 방화벽 예외 목록에 추가된 새로운 드문한 방화벽 규칙\n\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: cde0a575-7d3d-4a49-\u003cspan class=\"hljs-number\"\u003e9817\u003c/span\u003e-b8004a7bf105\n\u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: experimental\n\u003cspan class=\"hljs-attr\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e 방화벽 예외 목록에 규칙이 추가된 것을 감지합니다\n\u003cspan class=\"hljs-attr\"\u003ereferences\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eauthor\u003c/span\u003e: frack113\n\u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emodified\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003etags\u003c/span\u003e:\n    - attack.\u003cspan class=\"hljs-property\"\u003edefense_evasion\u003c/span\u003e\n    - attack.\u003cspan class=\"hljs-property\"\u003et1562\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.004\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elogsource\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eproduct\u003c/span\u003e: windows\n    \u003cspan class=\"hljs-attr\"\u003eservice\u003c/span\u003e: firewall-\u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edetection\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eselection\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eEventID\u003c/span\u003e:\n            - \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e # \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDefender\u003c/span\u003e 방화벽 예외 목록에 규칙이 추가됨\n            - \u003cspan class=\"hljs-number\"\u003e2071\u003c/span\u003e # \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDefender\u003c/span\u003e 방화벽 예외 목록에 규칙이 추가됨. (\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e)\n            - \u003cspan class=\"hljs-number\"\u003e2097\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003efilter_main_block\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eAction\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e # 차단\n    \u003cspan class=\"hljs-attr\"\u003efilter_main_generic\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eApplicationPath\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e:\n            - \u003cspan class=\"hljs-string\"\u003e':\\Program Files (x86)\\'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eProgram\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFiles\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eSystem32\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eSysWOW64\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eWinSxS\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n    filter_optional_msmpeng:\n        ModifyingApplication|contains|all:\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eProgramData\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eMicrosoft\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDefender\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003ePlatform\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eMsMpEng\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexe\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n    filter_main_covered_paths:\n        # 이 필터는 9e2575e7-2cb9-4da1-adc8-ed94221dca5e로부터의 중복 경고 방지를 위해 추가되었습니다\n        ApplicationPath|contains:\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003ePerfLogs\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eTmp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eUsers\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003ePublic\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTasks\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n            - '\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eAppData\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eLocal\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nlevel: medium\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ePDQDeployRunner\u003c/code\u003e를 사용하여 추가 경로 및 프로세스가 규칙에 추가되었습니다. 이는 악의적인 랜섬웨어 위협 행위자들이 환경 전체로 악성 소프트웨어를 배포하기 위해 종종 사용하는 유틸리티입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003ePDQDeployRunner\u003c/span\u003e의 잠재적으로 의심스러운 실행\n\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: 12b8e9f5-96b2-\u003cspan class=\"hljs-number\"\u003e41e1\u003c/span\u003e-9a42-8c6779a5c184\n\u003cspan class=\"hljs-attr\"\u003erelated\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: d679950c-abb7-43a6-80fb-2a480c4fc450\n      \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: 비슷함\n\u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: 테스트\n\u003cspan class=\"hljs-attr\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"PDQDeployRunner\"\u003c/span\u003e의 의심스러운 실행을 감지합니다. 이는 원격 장치에서 명령과 패키지를 실행하는 \u003cspan class=\"hljs-title class_\"\u003ePDQDeploy\u003c/span\u003e 서비스 스택의 일부입니다\n\u003cspan class=\"hljs-attr\"\u003ereferences\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//twitter.com/malmoeb/status/1550483085472432128\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eauthor\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eNasreddine\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBencherchali\u003c/span\u003e (\u003cspan class=\"hljs-title class_\"\u003eNextron\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSystems\u003c/span\u003e)\n\u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emodified\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003etags\u003c/span\u003e:\n    - 공격.실행\n\u003cspan class=\"hljs-attr\"\u003elogsource\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003ecategory\u003c/span\u003e: process_creation\n    \u003cspan class=\"hljs-attr\"\u003eproduct\u003c/span\u003e: windows\n\u003cspan class=\"hljs-attr\"\u003edetection\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eselection_parent\u003c/span\u003e:\n        \u003cspan class=\"hljs-title class_\"\u003eParentImage\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\\PDQDeployRunner-'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eselection_child\u003c/span\u003e:\n        # 다른 의심스러운 프로세스, 명령줄 또는 경로 추가하여 이 섹션을 개선\n        - \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003eendswith\u003c/span\u003e:\n              # 다음 프로세스 중 하나를 정상적으로 사용할 경우 주석 처리\n              - \u003cspan class=\"hljs-string\"\u003e'\\bash.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\certutil.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\cmd.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\csc.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\cscript.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\dllhost.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\mshta.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\msiexec.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\regsvr32.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\rundll32.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\scriptrunner.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\wmic.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\wscript.exe'\u003c/span\u003e\n              - \u003cspan class=\"hljs-string\"\u003e'\\wsl.exe'\u003c/span\u003e\n        - \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e|\u003cspan class=\"hljs-attr\"\u003econtains\u003c/span\u003e:\n              - \u003cspan class=\"hljs-string\"\u003e':\\ProgramData\\'\n              - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eUsers\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003ePublic\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e\\\u003cspan class=\"hljs-variable constant_\"\u003eTEMP\u003c/span\u003e\\\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eAppData\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eLocal\u003c/span\u003e\\\u003cspan class=\"hljs-title class_\"\u003eTemp\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n        - CommandLine|contains:\n              - '\u003c/span\u003e -decode \u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e -enc \u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e -encodedcommand \u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e -w hidden\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eDownloadString\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eFromBase64String\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003ehttp\u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003eiex \u003cspan class=\"hljs-string\"\u003e'\n              - '\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eInvoke\u003c/span\u003e-\u003cspan class=\"hljs-string\"\u003e'\n    condition: all of selection_*\nfalsepositives:\n    - PDQDeploy 도구를 사용하여 이러한 명령을 실행하는 것이 정당할 경우\nlevel: medium\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e모든 업데이트 목록을 확인하려면 전체 릴리스 변경 로그를 확인하세요.\u003c/p\u003e\n\u003ch1\u003e수정 사항\u003c/h1\u003e\n\u003cp\u003e이 릴리스에서는 \"Forest Blizzard APT - 프로세스 생성 활동\" 규칙이 작동하지 않도록 만드는 누락된 수정 자를 처리한 것을 확인할 수 있었습니다.\u003c/p\u003e\n\u003cp\u003e변경 사항 및 추가 사항의 전체 변경 로그를 확인하려면 아래 릴리스 페이지를 참조해주세요.\u003c/p\u003e\n\u003ch1\u003e기여자\u003c/h1\u003e\n\u003cp\u003e이 릴리스는 Sigma 커뮤니티 기여자 여러분 덕분에 가능해 졌어요. 다음 분들께 큰 감사를 전합니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e@ahmedfarou22\u003c/li\u003e\n\u003cli\u003e@frack113\u003c/li\u003e\n\u003cli\u003e@hasselj\u003c/li\u003e\n\u003cli\u003e@joshnck\u003c/li\u003e\n\u003cli\u003e@nasbench\u003c/li\u003e\n\u003cli\u003e@pratinavchandra\u003c/li\u003e\n\u003cli\u003e@swachchhanda000\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-15-SigmaHQRulesReleaseHighlightsr20240513"},"buildId":"aCCUs-qPrLLLWRnkN0AOd","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>