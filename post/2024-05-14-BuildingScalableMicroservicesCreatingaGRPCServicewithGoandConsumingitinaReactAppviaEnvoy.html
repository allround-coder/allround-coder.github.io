<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy" data-gatsby-head="true"/><meta name="twitter:title" content="스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-14 10:14" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/OFpTzInQeZKWBaqJEukNX/_buildManifest.js" defer=""></script><script src="/_next/static/OFpTzInQeZKWBaqJEukNX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 14, 2024</span><span class="posts_reading_time__f7YPP">11<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<img src="/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png">
<h1>준비물</h1>
<p>구현에 들어가기 전에 시스템에 다음 사항이 설치되어 있는지 확인하세요:</p>
<ul>
<li>Go: 공식 웹사이트(<a href="https://golang.org/)%EC%97%90%EC%84%9C" rel="nofollow" target="_blank">https://golang.org/)에서</a> Go를 설치하세요.</li>
<li>Node.js와 npm: (<a href="https://nodejs.org/)%EC%97%90%EC%84%9C" rel="nofollow" target="_blank">https://nodejs.org/)에서</a> Node.js를 다운로드하고 설치하세요.</li>
<li>Docker: Envoy 프록시 컨테이너를 실행하기 위해 Docker를 설치하세요(<a href="https://www.docker.com/" rel="nofollow" target="_blank">https://www.docker.com/</a>).</li>
</ul>
<h1>단계 1: Go에서 GRPC 서비스 만들기</h1>
<p>먼저 Go로 GRPC 서비스를 만들어봅시다. 프로젝트를 위한 새 디렉토리를 만들고 Go 환경을 설정해보세요:</p>
<pre><code class="hljs language-js">go-grpc-server-<span class="hljs-keyword">with</span>-envoy
</code></pre>
<p>아래 명령을 실행하여 프로젝트를 초기화하세요:</p>
<pre><code class="hljs language-js">cd go-grpc-server-<span class="hljs-keyword">with</span>-envoy
go mod init
</code></pre>
<p>지금은 새로운 Go 파일을 만들어서 서비스를 구현해보세요. 예를 들어 main.go 파일을 만들 수 있습니다. 이 파일에서 GRPC 서비스와 그 메서드를 정의해보세요. 다음은 간단한 예시입니다:</p>
<pre><code class="hljs language-js">package main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"log"</span>
	<span class="hljs-string">"net"</span>
	<span class="hljs-string">"google.golang.org/grpc"</span>
)

<span class="hljs-comment">// YourService should implement the methods of your GRPC service.</span>
type <span class="hljs-title class_">YourService</span> struct{}

<span class="hljs-comment">// 여기에 GRPC 메서드를 구현하세요.</span>

func <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
	listener, err := net.<span class="hljs-title class_">Listen</span>(<span class="hljs-string">"tcp"</span>, <span class="hljs-string">":8080"</span>)
	<span class="hljs-keyword">if</span> err != nil {
		log.<span class="hljs-title class_">Fatalf</span>(<span class="hljs-string">"Failed to listen: %v"</span>, err)
	}

	grpcServer := grpc.<span class="hljs-title class_">NewServer</span>()
	<span class="hljs-comment">// 여기에 서비스를 등록하세요.</span>

	<span class="hljs-keyword">if</span> err := grpcServer.<span class="hljs-title class_">Serve</span>(listener); err != nil {
		log.<span class="hljs-title class_">Fatalf</span>(<span class="hljs-string">"Failed to serve: %v"</span>, err)
	}
}
</code></pre>
<h1>스텝 2: 프로토버프 정의 만들기</h1>
<p>서비스와 메시지를 Protocol Buffers(Protobuf)를 사용하여 정의하세요. "proto" 폴더 안에 .proto 파일을 만들어주세요. 예를 들어 UserInfo.proto 파일을 만들어서 서비스와 메시지 유형을 정의해주세요:</p>
<pre><code class="hljs language-js">syntax = <span class="hljs-string">"proto3"</span>;

package proto;

option go_package = <span class="hljs-string">"app/proto"</span>;

message <span class="hljs-title class_">User</span> {
    string name = <span class="hljs-number">1</span>;
    int32 age = <span class="hljs-number">2</span>;
    <span class="hljs-title class_">Address</span> address = <span class="hljs-number">3</span>;
    <span class="hljs-title class_">PhoneNumber</span> phone = <span class="hljs-number">4</span>;
    string updated_at = <span class="hljs-number">5</span>;
    string created_at = <span class="hljs-number">6</span>;
}

message <span class="hljs-title class_">Address</span> {
    string street = <span class="hljs-number">1</span>;
    string city = <span class="hljs-number">2</span>;
    string state = <span class="hljs-number">3</span>;
    string zip = <span class="hljs-number">4</span>;
}

message <span class="hljs-title class_">PhoneNumber</span> {
    string primary = <span class="hljs-number">1</span>;
    map&#x3C;string, string> others = <span class="hljs-number">2</span>;
}

message <span class="hljs-title class_">UserRequest</span> {
    string name = <span class="hljs-number">1</span>;
}

message <span class="hljs-title class_">UserResponse</span> {
    <span class="hljs-title class_">User</span> user = <span class="hljs-number">1</span>;
    int32 status = <span class="hljs-number">2</span>;
    string error = <span class="hljs-number">3</span>;
}

service <span class="hljs-title class_">Usr</span> {
    rpc <span class="hljs-title class_">GetUser</span>(<span class="hljs-title class_">UserRequest</span>) returns (<span class="hljs-title class_">UserResponse</span>) {}
}
</code></pre>
<p>.proto 파일을 컴파일하여 Go 코드를 생성하세요:</p>
<pre><code class="hljs language-js"> protoc ./proto/userInfo.<span class="hljs-property">proto</span> --go_out=. --go-grpc_out=.
</code></pre>
<h1>단계 3: GRPC 서비스 구현하기</h1>
<p>main.go 파일에 .proto 파일의 정의에 따라 GRPC 서비스 메소드를 구현해주세요.</p>
<pre><code class="hljs language-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/digvijay17july/golang-projects/go-grpc-react-example/go-grpc-server-with-envoy/app/proto"</span>
    <span class="hljs-string">"google.golang.org/grpc"</span>
)

<span class="hljs-keyword">type</span> server <span class="hljs-keyword">struct</span> {
    proto.UnimplementedUsrServer
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(*server)</span></span> GetUser(ctx context.Context, in *proto.UserRequest) (*proto.UserResponse, <span class="hljs-type">error</span>) {
    
    others := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)
    others[<span class="hljs-string">"secondary"</span>] = <span class="hljs-string">"233453"</span>
    phone := &#x26;proto.PhoneNumber{Primary: <span class="hljs-string">"1234567890"</span>, Others: others}
    user := &#x26;proto.User{Name: <span class="hljs-string">"Digvijay"</span>, Age: <span class="hljs-number">23</span>, Address: &#x26;proto.Address{Street: <span class="hljs-string">"Pune"</span>, City: <span class="hljs-string">"Pune"</span>, State: <span class="hljs-string">"MAHARASHTRA"</span>, Zip: <span class="hljs-string">"201223"</span>}, Phone: phone, UpdatedAt: time.Now().UTC().String(), CreatedAt: time.Now().UTC().String()}
    <span class="hljs-keyword">return</span> &#x26;proto.UserResponse{User: user, Status: <span class="hljs-number">200</span>, Error: <span class="hljs-string">""</span>}, <span class="hljs-literal">nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    lis, err := net.Listen(<span class="hljs-string">"tcp"</span>, <span class="hljs-string">":8080"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatalf(<span class="hljs-string">"failed to listen: %v"</span>, err)
    }
    s := grpc.NewServer()
    grpcServer := &#x26;server{}
    proto.RegisterUsrServer(s, grpcServer)
    log.Printf(<span class="hljs-string">"Starting server on port :%v"</span>, lis.Addr())
    <span class="hljs-keyword">if</span> err := s.Serve(lis); err != <span class="hljs-literal">nil</span> {
        log.Fatalf(<span class="hljs-string">"failed to serve: %v"</span>, err)
    }

}
</code></pre>
<h1>단계 4: GRPC 서비스 Docker 이미지 빌드 및 실행하기</h1>
<p>Dockerfile for the Grpc Service app -</p>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">FROM</span> <span class="hljs-attr">golang</span>:<span class="hljs-number">1.21</span><span class="hljs-number">.4</span>-alpine

<span class="hljs-variable constant_">WORKDIR</span> /app

<span class="hljs-variable constant_">COPY</span> go.<span class="hljs-property">sum</span> ./

<span class="hljs-variable constant_">COPY</span> . ./

<span class="hljs-variable constant_">RUN</span> go build -o /go-grpc-server-<span class="hljs-keyword">with</span>-envoy

<span class="hljs-variable constant_">EXPOSE</span> <span class="hljs-number">8080</span>

<span class="hljs-variable constant_">CMD</span> [<span class="hljs-string">"/go-grpc-server-with-envoy"</span>]
</code></pre>
<p>이미지 빌드하기 -</p>
<pre><code class="hljs language-js">docker build -t go-grpc-server-<span class="hljs-keyword">with</span>-envoy .
</code></pre>
<h1>단계 5: Envoy Proxy 설정하기</h1>
<p>Envoy 폴더를 생성하세요. 이 폴더에는 2개의 파일이 포함됩니다.</p>
<ul>
<li>./config/envoy.yaml</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-attr">admin</span>:
  <span class="hljs-attr">address</span>:
    <span class="hljs-attr">socket_address</span>: { <span class="hljs-attr">address</span>: <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>, <span class="hljs-attr">port_value</span>: <span class="hljs-number">9901</span> }
<span class="hljs-attr">static_resources</span>:
  <span class="hljs-attr">listeners</span>:
    - <span class="hljs-attr">name</span>: listener_0
      <span class="hljs-attr">address</span>:
        <span class="hljs-attr">socket_address</span>: { <span class="hljs-attr">address</span>: <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>, <span class="hljs-attr">port_value</span>:  <span class="hljs-number">8080</span> }
      <span class="hljs-attr">filter_chains</span>:
        - <span class="hljs-attr">filters</span>:
            - <span class="hljs-attr">name</span>: envoy.<span class="hljs-property">filters</span>.<span class="hljs-property">network</span>.<span class="hljs-property">http_connection_manager</span>
              <span class="hljs-attr">typed_config</span>:
                <span class="hljs-string">"@type"</span>: type.<span class="hljs-property">googleapis</span>.<span class="hljs-property">com</span>/envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">filters</span>.<span class="hljs-property">network</span>.<span class="hljs-property">http_connection_manager</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">HttpConnectionManager</span>
                <span class="hljs-attr">codec_type</span>: auto
                <span class="hljs-attr">stat_prefix</span>: ingress_http
                <span class="hljs-attr">route_config</span>:
                  <span class="hljs-attr">name</span>: local_route
                  <span class="hljs-attr">virtual_hosts</span>:
                    - <span class="hljs-attr">name</span>: local_service
                      <span class="hljs-attr">domains</span>: [<span class="hljs-string">"*"</span>]
                      <span class="hljs-attr">routes</span>:
                        - <span class="hljs-attr">match</span>: { <span class="hljs-attr">prefix</span>: <span class="hljs-string">"/"</span>}
                          <span class="hljs-attr">route</span>: { <span class="hljs-attr">cluster</span>: grpc_service}
                      <span class="hljs-attr">cors</span>:
                        <span class="hljs-attr">allow_origin_string_match</span>:
                          - <span class="hljs-attr">prefix</span>: <span class="hljs-string">"*"</span>
                        <span class="hljs-attr">allow_methods</span>: <span class="hljs-variable constant_">GET</span>, <span class="hljs-variable constant_">PUT</span>, <span class="hljs-variable constant_">DELETE</span>, <span class="hljs-variable constant_">POST</span>, <span class="hljs-variable constant_">OPTIONS</span>
                        <span class="hljs-attr">allow_headers</span>: keep-alive,user-agent,cache-control,content-type,content-transfer-encoding,custom-header-<span class="hljs-number">1</span>,x-accept-content-transfer-encoding,x-accept-response-streaming,x-user-agent,x-grpc-web,grpc-timeout
                        <span class="hljs-attr">max_age</span>: <span class="hljs-string">"1728000"</span>
                        <span class="hljs-attr">expose_headers</span>: custom-header-<span class="hljs-number">1</span>,grpc-status,grpc-message
                <span class="hljs-attr">http_filters</span>:
                  - <span class="hljs-attr">name</span>: envoy.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">grpc_web</span>
                    <span class="hljs-attr">typed_config</span>:
                      <span class="hljs-string">"@type"</span>: type.<span class="hljs-property">googleapis</span>.<span class="hljs-property">com</span>/envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">grpc_web</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">GrpcWeb</span>
                  - <span class="hljs-attr">name</span>: envoy.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">cors</span>
                    <span class="hljs-attr">typed_config</span>:
                      <span class="hljs-string">"@type"</span>: type.<span class="hljs-property">googleapis</span>.<span class="hljs-property">com</span>/envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">cors</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">Cors</span>
                  - <span class="hljs-attr">name</span>: envoy.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">router</span>
                    <span class="hljs-attr">typed_config</span>:
                      <span class="hljs-string">"@type"</span>: type.<span class="hljs-property">googleapis</span>.<span class="hljs-property">com</span>/envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">filters</span>.<span class="hljs-property">http</span>.<span class="hljs-property">router</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">Router</span>
  <span class="hljs-attr">clusters</span>:
    - <span class="hljs-attr">name</span>: grpc_service
      <span class="hljs-attr">connect_timeout</span>: <span class="hljs-number">0.</span>25s
      <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">LOGICAL_DNS</span>
      <span class="hljs-attr">typed_extension_protocol_options</span>:
        envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">upstreams</span>.<span class="hljs-property">http</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">HttpProtocolOptions</span>:
          <span class="hljs-string">"@type"</span>: type.<span class="hljs-property">googleapis</span>.<span class="hljs-property">com</span>/envoy.<span class="hljs-property">extensions</span>.<span class="hljs-property">upstreams</span>.<span class="hljs-property">http</span>.<span class="hljs-property">v3</span>.<span class="hljs-property">HttpProtocolOptions</span>
          <span class="hljs-attr">explicit_http_config</span>:
            <span class="hljs-attr">http2_protocol_options</span>: {}
      <span class="hljs-attr">lb_policy</span>: <span class="hljs-variable constant_">ROUND_ROBIN</span>
      <span class="hljs-attr">load_assignment</span>:
        <span class="hljs-attr">cluster_name</span>: grpc_service
        <span class="hljs-attr">endpoints</span>:
          - <span class="hljs-attr">lb_endpoints</span>:
              - <span class="hljs-attr">endpoint</span>:
                  <span class="hljs-attr">address</span>:
                    <span class="hljs-attr">socket_address</span>:
                      <span class="hljs-attr">address</span>: host.<span class="hljs-property">docker</span>.<span class="hljs-property">internal</span>
                      <span class="hljs-attr">port_value</span>: <span class="hljs-number">8080</span>
</code></pre>
<ol start="2">
<li>./config/Dockerfile</li>
</ol>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">FROM</span> envoyproxy/<span class="hljs-attr">envoy</span>:v1<span class="hljs-number">.28</span><span class="hljs-number">.0</span>
<span class="hljs-variable constant_">COPY</span> ./envoy.<span class="hljs-property">yaml</span> /etc/envoy/envoy.<span class="hljs-property">yaml</span>
</code></pre>
<h1>단계 6: 앱 실행을 위한 docker-compose.yaml 생성</h1>
<pre><code class="hljs language-js"><span class="hljs-attr">version</span>: <span class="hljs-string">'3'</span>
<span class="hljs-attr">services</span>:
  grpc-<span class="hljs-attr">server</span>:
    <span class="hljs-attr">image</span>: go-grpc-server-<span class="hljs-keyword">with</span>-<span class="hljs-attr">envoy</span>:latest  # 실제 <span class="hljs-title class_">Go</span> gRPC 서버 이미지 이름과 태그로 변경
    <span class="hljs-attr">ports</span>:
      - <span class="hljs-string">"8080:8080"</span>  # 컨테이너의 gRPC 포트를 호스트 머신에 매핑
    <span class="hljs-attr">networks</span>:
      - go-grpc-server-<span class="hljs-keyword">with</span>-envoy

  gateway-<span class="hljs-attr">envoy</span>:
    <span class="hljs-attr">build</span>:
      <span class="hljs-attr">context</span>: ./envoy/config
      <span class="hljs-attr">dockerfile</span>: <span class="hljs-title class_">Dockerfile</span>
    <span class="hljs-attr">ports</span>:
      - <span class="hljs-string">'8083:8080'</span>

    <span class="hljs-attr">networks</span>:
      - go-grpc-server-<span class="hljs-keyword">with</span>-envoy

<span class="hljs-attr">networks</span>:
  go-grpc-server-<span class="hljs-keyword">with</span>-<span class="hljs-attr">envoy</span>:
</code></pre>
<p>백엔드를 Envoy 프록시로 실행하려면:</p>
<pre><code class="hljs language-js">docker-compose up
</code></pre>
<p>출력:</p>
<p><img src="/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_1.png" alt="이미지"></p>
<h1>단계 7: 리액트 앱 생성하기</h1>
<pre><code class="hljs language-js">npx create-react-app my-grpc-app
cd my-grpc-app
</code></pre>
<h1>단계 8: gRPC-Web 및 google-protobuf 플러그인 설치</h1>
<pre><code class="hljs language-js">npm install -g protoc-gen-ts
npm i protoc-gen-grpc-web
</code></pre>
<h1>단계 9: 리액트 앱에서 다른 종속성 구성하기</h1>
<pre><code class="hljs language-js">  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"@grpc/proto-loader"</span>: <span class="hljs-string">"^0.7.10"</span>,
    <span class="hljs-string">"@testing-library/jest-dom"</span>: <span class="hljs-string">"^5.17.0"</span>,
    <span class="hljs-string">"@testing-library/react"</span>: <span class="hljs-string">"^13.4.0"</span>,
    <span class="hljs-string">"@testing-library/user-event"</span>: <span class="hljs-string">"^13.5.0"</span>,
    <span class="hljs-string">"@types/react"</span>: <span class="hljs-string">"^18.2.47"</span>,
    <span class="hljs-string">"@types/react-dom"</span>: <span class="hljs-string">"^18.2.18"</span>,
    <span class="hljs-string">"google-proto-files"</span>: <span class="hljs-string">"^4.0.0"</span>,
    <span class="hljs-string">"google-protobuf"</span>: <span class="hljs-string">"3.21.2"</span>,
    <span class="hljs-string">"grpc-web"</span>: <span class="hljs-string">"^1.5.0"</span>,
    <span class="hljs-string">"protoc-gen-grpc-web"</span>: <span class="hljs-string">"^1.4.2"</span>,
    <span class="hljs-string">"protoc-gen-ts"</span>: <span class="hljs-string">"^0.8.7"</span>,
    <span class="hljs-string">"react"</span>: <span class="hljs-string">"^18.2.0"</span>,
    <span class="hljs-string">"react-dom"</span>: <span class="hljs-string">"^18.2.0"</span>,
    <span class="hljs-string">"react-scripts"</span>: <span class="hljs-string">"5.0.1"</span>,
    <span class="hljs-string">"web-vitals"</span>: <span class="hljs-string">"^2.1.4"</span>
  }
</code></pre>
<h1>단계 10: 리액트 앱을 위한 GRPC 클라이언트 코드 생성</h1>
<p>.proto 파일을 컴파일하여 js 코드를 생성하세요:</p>
<pre><code class="hljs language-js">protoc -I=src/proto userInfo.<span class="hljs-property">proto</span> --js_out=import_style=commonjs,<span class="hljs-attr">binary</span>:./src/proto --grpc-web_out=import_style=commonjs,mode=<span class="hljs-attr">grpcwebtext</span>:./src/proto
</code></pre>
<h1>단계 11: React 앱 구성하기</h1>
<p>UserDetails.js</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UsrClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../proto/userInfo_grpc_web_pb'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UserRequest</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../proto/userInfo_pb'</span>;<span class="hljs-comment">// 생성된 클라이언트 코드를 가져옵니다</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDetail</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {
        <span class="hljs-variable language_">super</span>(props);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = {
            <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
        };
    }

    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UsrClient</span>(<span class="hljs-string">'http://localhost:8083'</span>); <span class="hljs-comment">// 사용 중인 gRPC 서버 URL로 교체해주세요</span>

        <span class="hljs-comment">// 사용자 이름을 사용해 요청 생성</span>
        <span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRequest</span>();
        <span class="hljs-comment">// 원하는 사용자 이름으로 대체해주세요</span>

        <span class="hljs-comment">// GetUser RPC 호출</span>
        client.<span class="hljs-title function_">getUser</span>(request, {}, <span class="hljs-function">(<span class="hljs-params">err, response</span>) =></span> {
            <span class="hljs-keyword">if</span> (!err) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">user</span>: response.<span class="hljs-title function_">getUser</span>() });
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'사용자 데이터를 불러오는 중 오류 발생'</span> });
            }
        });
    }

    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">const</span> { user, error } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;

        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
                {error ? (
                    <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>Error: {error}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                ) : user ? (
                    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">h1</span>></span>사용자 세부 정보<span class="hljs-tag">&#x3C;/<span class="hljs-name">h1</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>이름: {user.getName()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>나이: {user.getAge()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">h2</span>></span>주소<span class="hljs-tag">&#x3C;/<span class="hljs-name">h2</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>거리: {user.getAddress().getStreet()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>도시: {user.getAddress().getCity()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>주: {user.getAddress().getState()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>우편번호: {user.getAddress().getZip()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        {/* 전화번호 정보를 비슷하게 표시할 수 있습니다 */}
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>업데이트 날짜: {user.getUpdatedAt()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>생성 날짜: {user.getCreatedAt()}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
                ) : (
                    <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>로딩 중...<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
                )}
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
        );
    }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">UserDetail</span>;
</code></pre>
<p>App.js</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> logo <span class="hljs-keyword">from</span> <span class="hljs-string">'./logo.svg'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">UserDetail</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/UserDetails'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"App"</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"App-header"</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{logo}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"App-logo"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"logo"</span> /></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">UserDetail</span>></span>
          
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">UserDetail</span>></span>
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">header</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<h3>Step 12: React 앱 빌드 및 실행</h3>
<p>React 앱을 빌드하고 실행하세요.</p>
<pre><code class="hljs language-js">npm start
</code></pre>
<p>결과 -</p>
<img src="/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_2.png">
<h1>결론</h1>
<p>본 튜토리얼에서는 Go로 GRPC 서비스를 생성하는 방법, Envoy를 프록시로 구성하는 방법, 그리고 React 앱을 빌드하여 Envoy를 통해 GRPC 서비스와 통신하는 과정을 다루었습니다. 이 설정은 분산 시스템을 구축하는 확장 가능하고 효율적인 방법을 제공합니다. 필요에 따라 서비스 및 React 앱에 더 많은 GRPC 메서드와 기능을 추가하여 이 예제를 확장할 수 있습니다. 즐거운 코딩하세요!</p>
<p>더 많은 정보를 위해 코드를 확인하세요: GitHub</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"스켈러블한 마이크로서비스 구축 Go로 GRPC 서비스 만들기 및 Envoy를 통해 React 앱에서 사용하기","description":"","date":"2024-05-14 10:14","slug":"2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy","content":"\n\n\u003cimg src=\"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png\" /\u003e\n\n# 준비물\n\n구현에 들어가기 전에 시스템에 다음 사항이 설치되어 있는지 확인하세요:\n\n- Go: 공식 웹사이트(https://golang.org/)에서 Go를 설치하세요.\n- Node.js와 npm: (https://nodejs.org/)에서 Node.js를 다운로드하고 설치하세요.\n- Docker: Envoy 프록시 컨테이너를 실행하기 위해 Docker를 설치하세요(https://www.docker.com/).\n\n\n\n# 단계 1: Go에서 GRPC 서비스 만들기\n\n먼저 Go로 GRPC 서비스를 만들어봅시다. 프로젝트를 위한 새 디렉토리를 만들고 Go 환경을 설정해보세요:\n\n```js\ngo-grpc-server-with-envoy\n```\n\n아래 명령을 실행하여 프로젝트를 초기화하세요:\n\n\n\n```js\ncd go-grpc-server-with-envoy\ngo mod init\n```\n\n지금은 새로운 Go 파일을 만들어서 서비스를 구현해보세요. 예를 들어 main.go 파일을 만들 수 있습니다. 이 파일에서 GRPC 서비스와 그 메서드를 정의해보세요. 다음은 간단한 예시입니다:\n\n```js\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"net\"\n\t\"google.golang.org/grpc\"\n)\n\n// YourService should implement the methods of your GRPC service.\ntype YourService struct{}\n\n// 여기에 GRPC 메서드를 구현하세요.\n\nfunc main() {\n\tlistener, err := net.Listen(\"tcp\", \":8080\")\n\tif err != nil {\n\t\tlog.Fatalf(\"Failed to listen: %v\", err)\n\t}\n\n\tgrpcServer := grpc.NewServer()\n\t// 여기에 서비스를 등록하세요.\n\n\tif err := grpcServer.Serve(listener); err != nil {\n\t\tlog.Fatalf(\"Failed to serve: %v\", err)\n\t}\n}\n```\n\n# 스텝 2: 프로토버프 정의 만들기\n\n\n\n\n서비스와 메시지를 Protocol Buffers(Protobuf)를 사용하여 정의하세요. \"proto\" 폴더 안에 .proto 파일을 만들어주세요. 예를 들어 UserInfo.proto 파일을 만들어서 서비스와 메시지 유형을 정의해주세요:\n\n```js\nsyntax = \"proto3\";\n\npackage proto;\n\noption go_package = \"app/proto\";\n\nmessage User {\n    string name = 1;\n    int32 age = 2;\n    Address address = 3;\n    PhoneNumber phone = 4;\n    string updated_at = 5;\n    string created_at = 6;\n}\n\nmessage Address {\n    string street = 1;\n    string city = 2;\n    string state = 3;\n    string zip = 4;\n}\n\nmessage PhoneNumber {\n    string primary = 1;\n    map\u003cstring, string\u003e others = 2;\n}\n\nmessage UserRequest {\n    string name = 1;\n}\n\nmessage UserResponse {\n    User user = 1;\n    int32 status = 2;\n    string error = 3;\n}\n\nservice Usr {\n    rpc GetUser(UserRequest) returns (UserResponse) {}\n}\n```\n\n.proto 파일을 컴파일하여 Go 코드를 생성하세요:\n\n```js\n protoc ./proto/userInfo.proto --go_out=. --go-grpc_out=.\n```\n\n\n\n# 단계 3: GRPC 서비스 구현하기\n\nmain.go 파일에 .proto 파일의 정의에 따라 GRPC 서비스 메소드를 구현해주세요.\n\n```go\npackage main\n\nimport (\n    \"context\"\n    \"log\"\n    \"net\"\n    \"time\"\n\n    \"github.com/digvijay17july/golang-projects/go-grpc-react-example/go-grpc-server-with-envoy/app/proto\"\n    \"google.golang.org/grpc\"\n)\n\ntype server struct {\n    proto.UnimplementedUsrServer\n}\n\nfunc (*server) GetUser(ctx context.Context, in *proto.UserRequest) (*proto.UserResponse, error) {\n    \n    others := make(map[string]string)\n    others[\"secondary\"] = \"233453\"\n    phone := \u0026proto.PhoneNumber{Primary: \"1234567890\", Others: others}\n    user := \u0026proto.User{Name: \"Digvijay\", Age: 23, Address: \u0026proto.Address{Street: \"Pune\", City: \"Pune\", State: \"MAHARASHTRA\", Zip: \"201223\"}, Phone: phone, UpdatedAt: time.Now().UTC().String(), CreatedAt: time.Now().UTC().String()}\n    return \u0026proto.UserResponse{User: user, Status: 200, Error: \"\"}, nil\n}\n\nfunc main() {\n    lis, err := net.Listen(\"tcp\", \":8080\")\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n    s := grpc.NewServer()\n    grpcServer := \u0026server{}\n    proto.RegisterUsrServer(s, grpcServer)\n    log.Printf(\"Starting server on port :%v\", lis.Addr())\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"failed to serve: %v\", err)\n    }\n\n}\n```\n\n# 단계 4: GRPC 서비스 Docker 이미지 빌드 및 실행하기\n\n\n\nDockerfile for the Grpc Service app -\n\n```js\nFROM golang:1.21.4-alpine\n\nWORKDIR /app\n\nCOPY go.sum ./\n\nCOPY . ./\n\nRUN go build -o /go-grpc-server-with-envoy\n\nEXPOSE 8080\n\nCMD [\"/go-grpc-server-with-envoy\"]\n```\n\n이미지 빌드하기 -\n\n```js\ndocker build -t go-grpc-server-with-envoy .\n```\n\n\n\n# 단계 5: Envoy Proxy 설정하기\n\nEnvoy 폴더를 생성하세요. 이 폴더에는 2개의 파일이 포함됩니다.\n\n- ./config/envoy.yaml\n\n```js\nadmin:\n  address:\n    socket_address: { address: 0.0.0.0, port_value: 9901 }\nstatic_resources:\n  listeners:\n    - name: listener_0\n      address:\n        socket_address: { address: 0.0.0.0, port_value:  8080 }\n      filter_chains:\n        - filters:\n            - name: envoy.filters.network.http_connection_manager\n              typed_config:\n                \"@type\": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager\n                codec_type: auto\n                stat_prefix: ingress_http\n                route_config:\n                  name: local_route\n                  virtual_hosts:\n                    - name: local_service\n                      domains: [\"*\"]\n                      routes:\n                        - match: { prefix: \"/\"}\n                          route: { cluster: grpc_service}\n                      cors:\n                        allow_origin_string_match:\n                          - prefix: \"*\"\n                        allow_methods: GET, PUT, DELETE, POST, OPTIONS\n                        allow_headers: keep-alive,user-agent,cache-control,content-type,content-transfer-encoding,custom-header-1,x-accept-content-transfer-encoding,x-accept-response-streaming,x-user-agent,x-grpc-web,grpc-timeout\n                        max_age: \"1728000\"\n                        expose_headers: custom-header-1,grpc-status,grpc-message\n                http_filters:\n                  - name: envoy.filters.http.grpc_web\n                    typed_config:\n                      \"@type\": type.googleapis.com/envoy.extensions.filters.http.grpc_web.v3.GrpcWeb\n                  - name: envoy.filters.http.cors\n                    typed_config:\n                      \"@type\": type.googleapis.com/envoy.extensions.filters.http.cors.v3.Cors\n                  - name: envoy.filters.http.router\n                    typed_config:\n                      \"@type\": type.googleapis.com/envoy.extensions.filters.http.router.v3.Router\n  clusters:\n    - name: grpc_service\n      connect_timeout: 0.25s\n      type: LOGICAL_DNS\n      typed_extension_protocol_options:\n        envoy.extensions.upstreams.http.v3.HttpProtocolOptions:\n          \"@type\": type.googleapis.com/envoy.extensions.upstreams.http.v3.HttpProtocolOptions\n          explicit_http_config:\n            http2_protocol_options: {}\n      lb_policy: ROUND_ROBIN\n      load_assignment:\n        cluster_name: grpc_service\n        endpoints:\n          - lb_endpoints:\n              - endpoint:\n                  address:\n                    socket_address:\n                      address: host.docker.internal\n                      port_value: 8080\n```\n\n\n\n2. ./config/Dockerfile\n\n```js\nFROM envoyproxy/envoy:v1.28.0\nCOPY ./envoy.yaml /etc/envoy/envoy.yaml\n```\n\n# 단계 6: 앱 실행을 위한 docker-compose.yaml 생성\n\n```js\nversion: '3'\nservices:\n  grpc-server:\n    image: go-grpc-server-with-envoy:latest  # 실제 Go gRPC 서버 이미지 이름과 태그로 변경\n    ports:\n      - \"8080:8080\"  # 컨테이너의 gRPC 포트를 호스트 머신에 매핑\n    networks:\n      - go-grpc-server-with-envoy\n\n  gateway-envoy:\n    build:\n      context: ./envoy/config\n      dockerfile: Dockerfile\n    ports:\n      - '8083:8080'\n\n    networks:\n      - go-grpc-server-with-envoy\n\nnetworks:\n  go-grpc-server-with-envoy:\n```\n\n\n\n백엔드를 Envoy 프록시로 실행하려면:\n\n```js\ndocker-compose up\n```\n\n출력:\n\n![이미지](/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_1.png)\n\n\n\n# 단계 7: 리액트 앱 생성하기\n\n```js\nnpx create-react-app my-grpc-app\ncd my-grpc-app\n```\n\n# 단계 8: gRPC-Web 및 google-protobuf 플러그인 설치\n\n```js\nnpm install -g protoc-gen-ts\nnpm i protoc-gen-grpc-web\n```\n\n\n\n# 단계 9: 리액트 앱에서 다른 종속성 구성하기\n\n```js\n  \"dependencies\": {\n    \"@grpc/proto-loader\": \"^0.7.10\",\n    \"@testing-library/jest-dom\": \"^5.17.0\",\n    \"@testing-library/react\": \"^13.4.0\",\n    \"@testing-library/user-event\": \"^13.5.0\",\n    \"@types/react\": \"^18.2.47\",\n    \"@types/react-dom\": \"^18.2.18\",\n    \"google-proto-files\": \"^4.0.0\",\n    \"google-protobuf\": \"3.21.2\",\n    \"grpc-web\": \"^1.5.0\",\n    \"protoc-gen-grpc-web\": \"^1.4.2\",\n    \"protoc-gen-ts\": \"^0.8.7\",\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"react-scripts\": \"5.0.1\",\n    \"web-vitals\": \"^2.1.4\"\n  }\n```\n\n# 단계 10: 리액트 앱을 위한 GRPC 클라이언트 코드 생성\n\n.proto 파일을 컴파일하여 js 코드를 생성하세요:\n\n\n\n```js\nprotoc -I=src/proto userInfo.proto --js_out=import_style=commonjs,binary:./src/proto --grpc-web_out=import_style=commonjs,mode=grpcwebtext:./src/proto\n```\n\n# 단계 11: React 앱 구성하기\n\nUserDetails.js\n\n```js\nimport React, { Component } from 'react';\nimport { UsrClient } from '../proto/userInfo_grpc_web_pb';\nimport { UserRequest } from '../proto/userInfo_pb';// 생성된 클라이언트 코드를 가져옵니다\n\nclass UserDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            user: null,\n            error: null,\n        };\n    }\n\n    componentDidMount() {\n        const client = new UsrClient('http://localhost:8083'); // 사용 중인 gRPC 서버 URL로 교체해주세요\n\n        // 사용자 이름을 사용해 요청 생성\n        const request = new UserRequest();\n        // 원하는 사용자 이름으로 대체해주세요\n\n        // GetUser RPC 호출\n        client.getUser(request, {}, (err, response) =\u003e {\n            if (!err) {\n                this.setState({ user: response.getUser() });\n            } else {\n                this.setState({ error: '사용자 데이터를 불러오는 중 오류 발생' });\n            }\n        });\n    }\n\n    render() {\n        const { user, error } = this.state;\n\n        return (\n            \u003cdiv\u003e\n                {error ? (\n                    \u003cp\u003eError: {error}\u003c/p\u003e\n                ) : user ? (\n                    \u003cdiv\u003e\n                        \u003ch1\u003e사용자 세부 정보\u003c/h1\u003e\n                        \u003cp\u003e이름: {user.getName()}\u003c/p\u003e\n                        \u003cp\u003e나이: {user.getAge()}\u003c/p\u003e\n                        \u003ch2\u003e주소\u003c/h2\u003e\n                        \u003cp\u003e거리: {user.getAddress().getStreet()}\u003c/p\u003e\n                        \u003cp\u003e도시: {user.getAddress().getCity()}\u003c/p\u003e\n                        \u003cp\u003e주: {user.getAddress().getState()}\u003c/p\u003e\n                        \u003cp\u003e우편번호: {user.getAddress().getZip()}\u003c/p\u003e\n                        {/* 전화번호 정보를 비슷하게 표시할 수 있습니다 */}\n                        \u003cp\u003e업데이트 날짜: {user.getUpdatedAt()}\u003c/p\u003e\n                        \u003cp\u003e생성 날짜: {user.getCreatedAt()}\u003c/p\u003e\n                    \u003c/div\u003e\n                ) : (\n                    \u003cp\u003e로딩 중...\u003c/p\u003e\n                )}\n            \u003c/div\u003e\n        );\n    }\n}\n\nexport default UserDetail;\n```\n\n\n\nApp.js\n\n```js\nimport logo from './logo.svg';\nimport './App.css';\nimport UserDetail from './components/UserDetails';\n\nfunction App() {\n  return (\n    \u003cdiv className=\"App\"\u003e\n      \u003cheader className=\"App-header\"\u003e\n        \u003cimg src={logo} className=\"App-logo\" alt=\"logo\" /\u003e\n        \u003cUserDetail\u003e\n          \n        \u003c/UserDetail\u003e\n      \u003c/header\u003e\n    \u003c/div\u003e\n  );\n}\n\nexport default App;\n```\n\n### Step 12: React 앱 빌드 및 실행\n\nReact 앱을 빌드하고 실행하세요.\n\n\n\n```js\nnpm start\n```\n\n결과 -\n\n\u003cimg src=\"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_2.png\" /\u003e\n\n# 결론\n\n\n\n본 튜토리얼에서는 Go로 GRPC 서비스를 생성하는 방법, Envoy를 프록시로 구성하는 방법, 그리고 React 앱을 빌드하여 Envoy를 통해 GRPC 서비스와 통신하는 과정을 다루었습니다. 이 설정은 분산 시스템을 구축하는 확장 가능하고 효율적인 방법을 제공합니다. 필요에 따라 서비스 및 React 앱에 더 많은 GRPC 메서드와 기능을 추가하여 이 예제를 확장할 수 있습니다. 즐거운 코딩하세요!\n\n더 많은 정보를 위해 코드를 확인하세요: GitHub","ogImage":{"url":"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png"},"coverImage":"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png","tag":["Tech"],"readingTime":11},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cimg src=\"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_0.png\"\u003e\n\u003ch1\u003e준비물\u003c/h1\u003e\n\u003cp\u003e구현에 들어가기 전에 시스템에 다음 사항이 설치되어 있는지 확인하세요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGo: 공식 웹사이트(\u003ca href=\"https://golang.org/)%EC%97%90%EC%84%9C\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://golang.org/)에서\u003c/a\u003e Go를 설치하세요.\u003c/li\u003e\n\u003cli\u003eNode.js와 npm: (\u003ca href=\"https://nodejs.org/)%EC%97%90%EC%84%9C\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://nodejs.org/)에서\u003c/a\u003e Node.js를 다운로드하고 설치하세요.\u003c/li\u003e\n\u003cli\u003eDocker: Envoy 프록시 컨테이너를 실행하기 위해 Docker를 설치하세요(\u003ca href=\"https://www.docker.com/\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.docker.com/\u003c/a\u003e).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e단계 1: Go에서 GRPC 서비스 만들기\u003c/h1\u003e\n\u003cp\u003e먼저 Go로 GRPC 서비스를 만들어봅시다. 프로젝트를 위한 새 디렉토리를 만들고 Go 환경을 설정해보세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ego-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래 명령을 실행하여 프로젝트를 초기화하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecd go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy\ngo mod init\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e지금은 새로운 Go 파일을 만들어서 서비스를 구현해보세요. 예를 들어 main.go 파일을 만들 수 있습니다. 이 파일에서 GRPC 서비스와 그 메서드를 정의해보세요. 다음은 간단한 예시입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epackage main\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e (\n\t\u003cspan class=\"hljs-string\"\u003e\"context\"\u003c/span\u003e\n\t\u003cspan class=\"hljs-string\"\u003e\"log\"\u003c/span\u003e\n\t\u003cspan class=\"hljs-string\"\u003e\"net\"\u003c/span\u003e\n\t\u003cspan class=\"hljs-string\"\u003e\"google.golang.org/grpc\"\u003c/span\u003e\n)\n\n\u003cspan class=\"hljs-comment\"\u003e// YourService should implement the methods of your GRPC service.\u003c/span\u003e\ntype \u003cspan class=\"hljs-title class_\"\u003eYourService\u003c/span\u003e struct{}\n\n\u003cspan class=\"hljs-comment\"\u003e// 여기에 GRPC 메서드를 구현하세요.\u003c/span\u003e\n\nfunc \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n\tlistener, err := net.\u003cspan class=\"hljs-title class_\"\u003eListen\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"tcp\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\":8080\"\u003c/span\u003e)\n\t\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e err != nil {\n\t\tlog.\u003cspan class=\"hljs-title class_\"\u003eFatalf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Failed to listen: %v\"\u003c/span\u003e, err)\n\t}\n\n\tgrpcServer := grpc.\u003cspan class=\"hljs-title class_\"\u003eNewServer\u003c/span\u003e()\n\t\u003cspan class=\"hljs-comment\"\u003e// 여기에 서비스를 등록하세요.\u003c/span\u003e\n\n\t\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e err := grpcServer.\u003cspan class=\"hljs-title class_\"\u003eServe\u003c/span\u003e(listener); err != nil {\n\t\tlog.\u003cspan class=\"hljs-title class_\"\u003eFatalf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Failed to serve: %v\"\u003c/span\u003e, err)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e스텝 2: 프로토버프 정의 만들기\u003c/h1\u003e\n\u003cp\u003e서비스와 메시지를 Protocol Buffers(Protobuf)를 사용하여 정의하세요. \"proto\" 폴더 안에 .proto 파일을 만들어주세요. 예를 들어 UserInfo.proto 파일을 만들어서 서비스와 메시지 유형을 정의해주세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003esyntax = \u003cspan class=\"hljs-string\"\u003e\"proto3\"\u003c/span\u003e;\n\npackage proto;\n\noption go_package = \u003cspan class=\"hljs-string\"\u003e\"app/proto\"\u003c/span\u003e;\n\nmessage \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e {\n    string name = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    int32 age = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-title class_\"\u003eAddress\u003c/span\u003e address = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e;\n    \u003cspan class=\"hljs-title class_\"\u003ePhoneNumber\u003c/span\u003e phone = \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e;\n    string updated_at = \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e;\n    string created_at = \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e;\n}\n\nmessage \u003cspan class=\"hljs-title class_\"\u003eAddress\u003c/span\u003e {\n    string street = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    string city = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e;\n    string state = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e;\n    string zip = \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e;\n}\n\nmessage \u003cspan class=\"hljs-title class_\"\u003ePhoneNumber\u003c/span\u003e {\n    string primary = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    map\u0026#x3C;string, string\u003e others = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e;\n}\n\nmessage \u003cspan class=\"hljs-title class_\"\u003eUserRequest\u003c/span\u003e {\n    string name = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n}\n\nmessage \u003cspan class=\"hljs-title class_\"\u003eUserResponse\u003c/span\u003e {\n    \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e user = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    int32 status = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e;\n    string error = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e;\n}\n\nservice \u003cspan class=\"hljs-title class_\"\u003eUsr\u003c/span\u003e {\n    rpc \u003cspan class=\"hljs-title class_\"\u003eGetUser\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eUserRequest\u003c/span\u003e) returns (\u003cspan class=\"hljs-title class_\"\u003eUserResponse\u003c/span\u003e) {}\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e.proto 파일을 컴파일하여 Go 코드를 생성하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e protoc ./proto/userInfo.\u003cspan class=\"hljs-property\"\u003eproto\u003c/span\u003e --go_out=. --go-grpc_out=.\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 3: GRPC 서비스 구현하기\u003c/h1\u003e\n\u003cp\u003emain.go 파일에 .proto 파일의 정의에 따라 GRPC 서비스 메소드를 구현해주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-go\"\u003e\u003cspan class=\"hljs-keyword\"\u003epackage\u003c/span\u003e main\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e (\n    \u003cspan class=\"hljs-string\"\u003e\"context\"\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003e\"log\"\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003e\"net\"\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003e\"time\"\u003c/span\u003e\n\n    \u003cspan class=\"hljs-string\"\u003e\"github.com/digvijay17july/golang-projects/go-grpc-react-example/go-grpc-server-with-envoy/app/proto\"\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003e\"google.golang.org/grpc\"\u003c/span\u003e\n)\n\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e server \u003cspan class=\"hljs-keyword\"\u003estruct\u003c/span\u003e {\n    proto.UnimplementedUsrServer\n}\n\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(*server)\u003c/span\u003e\u003c/span\u003e GetUser(ctx context.Context, in *proto.UserRequest) (*proto.UserResponse, \u003cspan class=\"hljs-type\"\u003eerror\u003c/span\u003e) {\n    \n    others := \u003cspan class=\"hljs-built_in\"\u003emake\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003emap\u003c/span\u003e[\u003cspan class=\"hljs-type\"\u003estring\u003c/span\u003e]\u003cspan class=\"hljs-type\"\u003estring\u003c/span\u003e)\n    others[\u003cspan class=\"hljs-string\"\u003e\"secondary\"\u003c/span\u003e] = \u003cspan class=\"hljs-string\"\u003e\"233453\"\u003c/span\u003e\n    phone := \u0026#x26;proto.PhoneNumber{Primary: \u003cspan class=\"hljs-string\"\u003e\"1234567890\"\u003c/span\u003e, Others: others}\n    user := \u0026#x26;proto.User{Name: \u003cspan class=\"hljs-string\"\u003e\"Digvijay\"\u003c/span\u003e, Age: \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e, Address: \u0026#x26;proto.Address{Street: \u003cspan class=\"hljs-string\"\u003e\"Pune\"\u003c/span\u003e, City: \u003cspan class=\"hljs-string\"\u003e\"Pune\"\u003c/span\u003e, State: \u003cspan class=\"hljs-string\"\u003e\"MAHARASHTRA\"\u003c/span\u003e, Zip: \u003cspan class=\"hljs-string\"\u003e\"201223\"\u003c/span\u003e}, Phone: phone, UpdatedAt: time.Now().UTC().String(), CreatedAt: time.Now().UTC().String()}\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u0026#x26;proto.UserResponse{User: user, Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, Error: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e}, \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emain\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e\u003c/span\u003e {\n    lis, err := net.Listen(\u003cspan class=\"hljs-string\"\u003e\"tcp\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\":8080\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e err != \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e {\n        log.Fatalf(\u003cspan class=\"hljs-string\"\u003e\"failed to listen: %v\"\u003c/span\u003e, err)\n    }\n    s := grpc.NewServer()\n    grpcServer := \u0026#x26;server{}\n    proto.RegisterUsrServer(s, grpcServer)\n    log.Printf(\u003cspan class=\"hljs-string\"\u003e\"Starting server on port :%v\"\u003c/span\u003e, lis.Addr())\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e err := s.Serve(lis); err != \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e {\n        log.Fatalf(\u003cspan class=\"hljs-string\"\u003e\"failed to serve: %v\"\u003c/span\u003e, err)\n    }\n\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 4: GRPC 서비스 Docker 이미지 빌드 및 실행하기\u003c/h1\u003e\n\u003cp\u003eDockerfile for the Grpc Service app -\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003egolang\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1.21\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e-alpine\n\n\u003cspan class=\"hljs-variable constant_\"\u003eWORKDIR\u003c/span\u003e /app\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCOPY\u003c/span\u003e go.\u003cspan class=\"hljs-property\"\u003esum\u003c/span\u003e ./\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCOPY\u003c/span\u003e . ./\n\n\u003cspan class=\"hljs-variable constant_\"\u003eRUN\u003c/span\u003e go build -o /go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy\n\n\u003cspan class=\"hljs-variable constant_\"\u003eEXPOSE\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCMD\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\"/go-grpc-server-with-envoy\"\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이미지 빌드하기 -\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edocker build -t go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy .\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 5: Envoy Proxy 설정하기\u003c/h1\u003e\n\u003cp\u003eEnvoy 폴더를 생성하세요. 이 폴더에는 2개의 파일이 포함됩니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e./config/envoy.yaml\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eadmin\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003esocket_address\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eport_value\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e9901\u003c/span\u003e }\n\u003cspan class=\"hljs-attr\"\u003estatic_resources\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003elisteners\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: listener_0\n      \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e:\n        \u003cspan class=\"hljs-attr\"\u003esocket_address\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eport_value\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e }\n      \u003cspan class=\"hljs-attr\"\u003efilter_chains\u003c/span\u003e:\n        - \u003cspan class=\"hljs-attr\"\u003efilters\u003c/span\u003e:\n            - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: envoy.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp_connection_manager\u003c/span\u003e\n              \u003cspan class=\"hljs-attr\"\u003etyped_config\u003c/span\u003e:\n                \u003cspan class=\"hljs-string\"\u003e\"@type\"\u003c/span\u003e: type.\u003cspan class=\"hljs-property\"\u003egoogleapis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp_connection_manager\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eHttpConnectionManager\u003c/span\u003e\n                \u003cspan class=\"hljs-attr\"\u003ecodec_type\u003c/span\u003e: auto\n                \u003cspan class=\"hljs-attr\"\u003estat_prefix\u003c/span\u003e: ingress_http\n                \u003cspan class=\"hljs-attr\"\u003eroute_config\u003c/span\u003e:\n                  \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: local_route\n                  \u003cspan class=\"hljs-attr\"\u003evirtual_hosts\u003c/span\u003e:\n                    - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: local_service\n                      \u003cspan class=\"hljs-attr\"\u003edomains\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"*\"\u003c/span\u003e]\n                      \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e:\n                        - \u003cspan class=\"hljs-attr\"\u003ematch\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003eprefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e}\n                          \u003cspan class=\"hljs-attr\"\u003eroute\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ecluster\u003c/span\u003e: grpc_service}\n                      \u003cspan class=\"hljs-attr\"\u003ecors\u003c/span\u003e:\n                        \u003cspan class=\"hljs-attr\"\u003eallow_origin_string_match\u003c/span\u003e:\n                          - \u003cspan class=\"hljs-attr\"\u003eprefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"*\"\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr\"\u003eallow_methods\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eGET\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003ePUT\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eDELETE\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003ePOST\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eOPTIONS\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr\"\u003eallow_headers\u003c/span\u003e: keep-alive,user-agent,cache-control,content-type,content-transfer-encoding,custom-header-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,x-accept-content-transfer-encoding,x-accept-response-streaming,x-user-agent,x-grpc-web,grpc-timeout\n                        \u003cspan class=\"hljs-attr\"\u003emax_age\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1728000\"\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr\"\u003eexpose_headers\u003c/span\u003e: custom-header-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,grpc-status,grpc-message\n                \u003cspan class=\"hljs-attr\"\u003ehttp_filters\u003c/span\u003e:\n                  - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: envoy.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egrpc_web\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr\"\u003etyped_config\u003c/span\u003e:\n                      \u003cspan class=\"hljs-string\"\u003e\"@type\"\u003c/span\u003e: type.\u003cspan class=\"hljs-property\"\u003egoogleapis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egrpc_web\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eGrpcWeb\u003c/span\u003e\n                  - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: envoy.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecors\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr\"\u003etyped_config\u003c/span\u003e:\n                      \u003cspan class=\"hljs-string\"\u003e\"@type\"\u003c/span\u003e: type.\u003cspan class=\"hljs-property\"\u003egoogleapis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecors\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eCors\u003c/span\u003e\n                  - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: envoy.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003erouter\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr\"\u003etyped_config\u003c/span\u003e:\n                      \u003cspan class=\"hljs-string\"\u003e\"@type\"\u003c/span\u003e: type.\u003cspan class=\"hljs-property\"\u003egoogleapis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efilters\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003erouter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eRouter\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eclusters\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: grpc_service\n      \u003cspan class=\"hljs-attr\"\u003econnect_timeout\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e25s\n      \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eLOGICAL_DNS\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003etyped_extension_protocol_options\u003c/span\u003e:\n        envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eupstreams\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eHttpProtocolOptions\u003c/span\u003e:\n          \u003cspan class=\"hljs-string\"\u003e\"@type\"\u003c/span\u003e: type.\u003cspan class=\"hljs-property\"\u003egoogleapis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/envoy.\u003cspan class=\"hljs-property\"\u003eextensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eupstreams\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ev3\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eHttpProtocolOptions\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003eexplicit_http_config\u003c/span\u003e:\n            \u003cspan class=\"hljs-attr\"\u003ehttp2_protocol_options\u003c/span\u003e: {}\n      \u003cspan class=\"hljs-attr\"\u003elb_policy\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eROUND_ROBIN\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eload_assignment\u003c/span\u003e:\n        \u003cspan class=\"hljs-attr\"\u003ecluster_name\u003c/span\u003e: grpc_service\n        \u003cspan class=\"hljs-attr\"\u003eendpoints\u003c/span\u003e:\n          - \u003cspan class=\"hljs-attr\"\u003elb_endpoints\u003c/span\u003e:\n              - \u003cspan class=\"hljs-attr\"\u003eendpoint\u003c/span\u003e:\n                  \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e:\n                    \u003cspan class=\"hljs-attr\"\u003esocket_address\u003c/span\u003e:\n                      \u003cspan class=\"hljs-attr\"\u003eaddress\u003c/span\u003e: host.\u003cspan class=\"hljs-property\"\u003edocker\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einternal\u003c/span\u003e\n                      \u003cspan class=\"hljs-attr\"\u003eport_value\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e./config/Dockerfile\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e envoyproxy/\u003cspan class=\"hljs-attr\"\u003eenvoy\u003c/span\u003e:v1\u003cspan class=\"hljs-number\"\u003e.28\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eCOPY\u003c/span\u003e ./envoy.\u003cspan class=\"hljs-property\"\u003eyaml\u003c/span\u003e /etc/envoy/envoy.\u003cspan class=\"hljs-property\"\u003eyaml\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 6: 앱 실행을 위한 docker-compose.yaml 생성\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'3'\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  grpc-\u003cspan class=\"hljs-attr\"\u003eserver\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-\u003cspan class=\"hljs-attr\"\u003eenvoy\u003c/span\u003e:latest  # 실제 \u003cspan class=\"hljs-title class_\"\u003eGo\u003c/span\u003e gRPC 서버 이미지 이름과 태그로 변경\n    \u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e:\n      - \u003cspan class=\"hljs-string\"\u003e\"8080:8080\"\u003c/span\u003e  # 컨테이너의 gRPC 포트를 호스트 머신에 매핑\n    \u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n      - go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy\n\n  gateway-\u003cspan class=\"hljs-attr\"\u003eenvoy\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003ebuild\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003econtext\u003c/span\u003e: ./envoy/config\n      \u003cspan class=\"hljs-attr\"\u003edockerfile\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDockerfile\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e:\n      - \u003cspan class=\"hljs-string\"\u003e'8083:8080'\u003c/span\u003e\n\n    \u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n      - go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-envoy\n\n\u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n  go-grpc-server-\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e-\u003cspan class=\"hljs-attr\"\u003eenvoy\u003c/span\u003e:\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e백엔드를 Envoy 프록시로 실행하려면:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edocker-compose up\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e출력:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_1.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch1\u003e단계 7: 리액트 앱 생성하기\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003enpx create-react-app my-grpc-app\ncd my-grpc-app\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 8: gRPC-Web 및 google-protobuf 플러그인 설치\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003enpm install -g protoc-gen-ts\nnpm i protoc-gen-grpc-web\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 9: 리액트 앱에서 다른 종속성 구성하기\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e  \u003cspan class=\"hljs-string\"\u003e\"dependencies\"\u003c/span\u003e: {\n    \u003cspan class=\"hljs-string\"\u003e\"@grpc/proto-loader\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^0.7.10\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"@testing-library/jest-dom\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^5.17.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"@testing-library/react\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^13.4.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"@testing-library/user-event\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^13.5.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"@types/react\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^18.2.47\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"@types/react-dom\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^18.2.18\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"google-proto-files\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^4.0.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"google-protobuf\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3.21.2\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"grpc-web\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^1.5.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"protoc-gen-grpc-web\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^1.4.2\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"protoc-gen-ts\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^0.8.7\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"react\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^18.2.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"react-dom\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^18.2.0\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"react-scripts\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"5.0.1\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"web-vitals\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"^2.1.4\"\u003c/span\u003e\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 10: 리액트 앱을 위한 GRPC 클라이언트 코드 생성\u003c/h1\u003e\n\u003cp\u003e.proto 파일을 컴파일하여 js 코드를 생성하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eprotoc -I=src/proto userInfo.\u003cspan class=\"hljs-property\"\u003eproto\u003c/span\u003e --js_out=import_style=commonjs,\u003cspan class=\"hljs-attr\"\u003ebinary\u003c/span\u003e:./src/proto --grpc-web_out=import_style=commonjs,mode=\u003cspan class=\"hljs-attr\"\u003egrpcwebtext\u003c/span\u003e:./src/proto\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e단계 11: React 앱 구성하기\u003c/h1\u003e\n\u003cp\u003eUserDetails.js\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e, { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'react'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eUsrClient\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'../proto/userInfo_grpc_web_pb'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eUserRequest\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'../proto/userInfo_pb'\u003c/span\u003e;\u003cspan class=\"hljs-comment\"\u003e// 생성된 클라이언트 코드를 가져옵니다\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUserDetail\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eComponent\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprops\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable language_\"\u003esuper\u003c/span\u003e(props);\n        \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003estate\u003c/span\u003e = {\n            \u003cspan class=\"hljs-attr\"\u003euser\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr\"\u003eerror\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\n        };\n    }\n\n    \u003cspan class=\"hljs-title function_\"\u003ecomponentDidMount\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e client = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUsrClient\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'http://localhost:8083'\u003c/span\u003e); \u003cspan class=\"hljs-comment\"\u003e// 사용 중인 gRPC 서버 URL로 교체해주세요\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e// 사용자 이름을 사용해 요청 생성\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e request = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUserRequest\u003c/span\u003e();\n        \u003cspan class=\"hljs-comment\"\u003e// 원하는 사용자 이름으로 대체해주세요\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e// GetUser RPC 호출\u003c/span\u003e\n        client.\u003cspan class=\"hljs-title function_\"\u003egetUser\u003c/span\u003e(request, {}, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr, response\u003c/span\u003e) =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!err) {\n                \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003esetState\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003euser\u003c/span\u003e: response.\u003cspan class=\"hljs-title function_\"\u003egetUser\u003c/span\u003e() });\n            } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n                \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003esetState\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003eerror\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'사용자 데이터를 불러오는 중 오류 발생'\u003c/span\u003e });\n            }\n        });\n    }\n\n    \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { user, error } = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003estate\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\n                {error ? (\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003eError: {error}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                ) : user ? (\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u003e\u003c/span\u003e사용자 세부 정보\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e이름: {user.getName()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e나이: {user.getAge()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eh2\u003c/span\u003e\u003e\u003c/span\u003e주소\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eh2\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e거리: {user.getAddress().getStreet()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e도시: {user.getAddress().getCity()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e주: {user.getAddress().getState()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e우편번호: {user.getAddress().getZip()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        {/* 전화번호 정보를 비슷하게 표시할 수 있습니다 */}\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e업데이트 날짜: {user.getUpdatedAt()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e생성 날짜: {user.getCreatedAt()}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\n                ) : (\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e로딩 중...\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u003e\u003c/span\u003e\n                )}\n            \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n        );\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUserDetail\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eApp.js\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e logo \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./logo.svg'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./App.css'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUserDetail\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./components/UserDetails'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eApp\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"App\"\u003c/span\u003e\u003e\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eheader\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"App-header\"\u003c/span\u003e\u003e\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eimg\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{logo}\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"App-logo\"\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ealt\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"logo\"\u003c/span\u003e /\u003e\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eUserDetail\u003c/span\u003e\u003e\u003c/span\u003e\n          \n        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eUserDetail\u003c/span\u003e\u003e\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eheader\u003c/span\u003e\u003e\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  );\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eApp\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eStep 12: React 앱 빌드 및 실행\u003c/h3\u003e\n\u003cp\u003eReact 앱을 빌드하고 실행하세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003enpm start\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e결과 -\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy_2.png\"\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003e본 튜토리얼에서는 Go로 GRPC 서비스를 생성하는 방법, Envoy를 프록시로 구성하는 방법, 그리고 React 앱을 빌드하여 Envoy를 통해 GRPC 서비스와 통신하는 과정을 다루었습니다. 이 설정은 분산 시스템을 구축하는 확장 가능하고 효율적인 방법을 제공합니다. 필요에 따라 서비스 및 React 앱에 더 많은 GRPC 메서드와 기능을 추가하여 이 예제를 확장할 수 있습니다. 즐거운 코딩하세요!\u003c/p\u003e\n\u003cp\u003e더 많은 정보를 위해 코드를 확인하세요: GitHub\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-14-BuildingScalableMicroservicesCreatingaGRPCServicewithGoandConsumingitinaReactAppviaEnvoy"},"buildId":"OFpTzInQeZKWBaqJEukNX","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>