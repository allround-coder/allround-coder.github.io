<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>파이썬과 QGIS로 인도의 낙타 80 찾는 방법 | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="파이썬과 QGIS로 인도의 낙타 80 찾는 방법 | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="파이썬과 QGIS로 인도의 낙타 80 찾는 방법 | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation" data-gatsby-head="true"/><meta name="twitter:title" content="파이썬과 QGIS로 인도의 낙타 80 찾는 방법 | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-22 02:56" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/Y-fCAg8BUV7y2HNFwX9AA/_buildManifest.js" defer=""></script><script src="/_next/static/Y-fCAg8BUV7y2HNFwX9AA/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">파이썬과 QGIS로 인도의 낙타 80 찾는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="파이썬과 QGIS로 인도의 낙타 80 찾는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 22, 2024</span><span class="posts_reading_time__f7YPP">5<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h2>파이썬 자동화</h2>
<p>"안녕 Aayush, 내가 인도의 저소득 농촌 여성들을 위한 낙타 기반 생계 개선에 집중해야 할 곳을 알고 싶어", 라는 요구가 왔어요. 라자스탄 출신인 내 친구가 말했어요. 그녀는 라자스탄의 사막 지역이 정답일 것이라고 알고 있었지만, 직감을 뒷받침할 공식 자료가 필요했어요. 그래서 제가 나서서 이 정보를 찾기로 했어요.</p>
<h2>단계 1</h2>
<p>인도 정부의 데이터 제공 플랫폼인 data.gov.in 에서 2019년 20번째 가축 조사 자료 시트 제2020년 승업부와 가축전문부, 수산부, 가축전문부의 자료를 찾아보세요.</p>
<div class="content-ad"></div>
<h2>단계 2</h2>
<p>개발자 도구를 사용하여 한 번에 모든 파일에 액세스할 수 있는 URL을 얻는 cURL을 얻으세요. 이렇게 하지 않았다면 각 파일을 개별적으로 클릭하여 양식을 작성하고 캡차를 입력한 다음 CSV를 수동으로 다운로드해야 했을 것입니다. 이 방법으로 제게 많은 시간을 절약했어요.</p>
<h2>Step 3</h2>
<p>Postman에 URL을 게시하고 해당하는 Python 요청 코드를 가져와서 응답을 구문 분석하세요.</p>
<div class="content-ad"></div>
<h2>단계 4</h2>
<p>저는 Python을 사용하여 응답을 구문 분석하고, 이 코드를 사용하여 모든 URL 링크를 가져왔어요.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> pprint <span class="hljs-keyword">import</span> pprint
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://data.gov.in/backend/dmspublic/v1/resources?filters[catalog_reference]=6885101&#x26;offset=0&#x26;limit=35&#x26;sort[changed]=desc&#x26;filters[domain_visibility]=4"</span>

payload = {}
headers = {
  <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/json, text/plain, */*'</span>,
  <span class="hljs-string">'Accept-Language'</span>: <span class="hljs-string">'en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7'</span>,
  <span class="hljs-string">'Connection'</span>: <span class="hljs-string">'keep-alive'</span>,
  <span class="hljs-string">'Cookie'</span>: <span class="hljs-string">'fontSize=67.5; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==jyF1Zg==9zCLz_Tsia4CNE6H2-pAKy8Ou1w=; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==uiR1Zg==JTC1HaNqvL2oNi2kwWYolcsi_TU='</span>,
  <span class="hljs-string">'Referer'</span>: <span class="hljs-string">'https://data.gov.in/catalog/20th-livestock-census'</span>,
  <span class="hljs-string">'Sec-Fetch-Dest'</span>: <span class="hljs-string">'empty'</span>,
  <span class="hljs-string">'Sec-Fetch-Mode'</span>: <span class="hljs-string">'cors'</span>,
  <span class="hljs-string">'Sec-Fetch-Site'</span>: <span class="hljs-string">'same-origin'</span>,
  <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36'</span>,
  <span class="hljs-string">'dnt'</span>: <span class="hljs-string">'1'</span>,
  <span class="hljs-string">'sec-ch-ua'</span>: <span class="hljs-string">'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"'</span>,
  <span class="hljs-string">'sec-ch-ua-mobile'</span>: <span class="hljs-string">'?0'</span>,
  <span class="hljs-string">'sec-ch-ua-platform'</span>: <span class="hljs-string">'"macOS"'</span>,
  <span class="hljs-string">'sec-gpc'</span>: <span class="hljs-string">'1'</span>
}

response = requests.<span class="hljs-title function_">request</span>(<span class="hljs-string">"GET"</span>, url, headers=headers, data=payload)
</code></pre>
<pre><code class="hljs language-js">rjson = response.<span class="hljs-title function_">json</span>()
rows = rjson[<span class="hljs-string">'data'</span>][<span class="hljs-string">'rows'</span>]
urls = []
<span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-attr">rows</span>:
    url = <span class="hljs-string">"https://"</span>+row[<span class="hljs-string">'datafile'</span>][<span class="hljs-number">0</span>]
    <span class="hljs-title function_">print</span>(url)
    urls.<span class="hljs-title function_">append</span>(url)
</code></pre>
<div class="content-ad"></div>
<p>최종 출력물은 CSV를 얻기 위해 구문 분석한 URL 목록입니다.</p>
<p><img src="/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png" alt="이미지"></p>
<h2>단계 5</h2>
<p>모든 파일을 다운로드하여 연결하여 최종 데이터 프레임을 얻었습니다. 그 후에는 80%의 기준점을 사용하여 낙타 인구의 80%를 보유한 지역을 파악했습니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">save_directory = <span class="hljs-string">'./csv_files/'</span>

<span class="hljs-keyword">if</span> not os.<span class="hljs-property">path</span>.<span class="hljs-title function_">exists</span>(save_directory):
    os.<span class="hljs-title function_">makedirs</span>(save_directory)

def <span class="hljs-title function_">download_file</span>(url, save_directory):
    <span class="hljs-attr">try</span>:
        response = requests.<span class="hljs-title function_">get</span>(url)
        response.<span class="hljs-title function_">raise_for_status</span>()  # 요청이 성공적인지 확인
        file_name = os.<span class="hljs-property">path</span>.<span class="hljs-title function_">join</span>(save_directory, url.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>)[-<span class="hljs-number">1</span>])
        <span class="hljs-keyword">with</span> <span class="hljs-title function_">open</span>(file_name, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> <span class="hljs-attr">file</span>:
            file.<span class="hljs-title function_">write</span>(response.<span class="hljs-property">content</span>)
        <span class="hljs-title function_">print</span>(f<span class="hljs-string">"다운로드 완료: {file_name}"</span>)
    except requests.<span class="hljs-property">exceptions</span>.<span class="hljs-property">RequestException</span> <span class="hljs-keyword">as</span> <span class="hljs-attr">e</span>:
        <span class="hljs-title function_">print</span>(f<span class="hljs-string">"{url}을(를) 다운로드하는 데 실패했습니다: {e}"</span>)

<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> <span class="hljs-attr">urls</span>:
    <span class="hljs-title function_">download_file</span>(url, save_directory)

csv_directory = save_directory

dataframes = []

all_headers = <span class="hljs-title function_">set</span>()

<span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.<span class="hljs-title function_">listdir</span>(csv_directory):
    <span class="hljs-keyword">if</span> filename.<span class="hljs-title function_">endswith</span>(<span class="hljs-string">'.csv'</span>):
        file_path = os.<span class="hljs-property">path</span>.<span class="hljs-title function_">join</span>(csv_directory, filename)
        df = pd.<span class="hljs-title function_">read_csv</span>(file_path)
        dataframes.<span class="hljs-title function_">append</span>(df)
        all_headers.<span class="hljs-title function_">update</span>(df.<span class="hljs-property">columns</span>)

# 모든 데이터 프레임이 동일한 헤더를 갖고 있는지 확인
headers_match = <span class="hljs-title function_">all</span>(<span class="hljs-title function_">len</span>(df.<span class="hljs-property">columns</span>.<span class="hljs-title function_">difference</span>(all_headers)) == <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> dataframes)

<span class="hljs-keyword">if</span> <span class="hljs-attr">headers_match</span>:
    combined_df = pd.<span class="hljs-title function_">concat</span>(dataframes, ignore_index=<span class="hljs-title class_">True</span>)
<span class="hljs-attr">else</span>:
    combined_df = pd.<span class="hljs-title class_">DataFrame</span>(columns=all_headers)
    <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> <span class="hljs-attr">dataframes</span>:
        df = df.<span class="hljs-title function_">reindex</span>(columns=all_headers)  # 모든 열이 존재하는지 확인
        combined_df = pd.<span class="hljs-title function_">concat</span>([combined_df, df], ignore_index=<span class="hljs-title class_">True</span>)

combined_csv_path = os.<span class="hljs-property">path</span>.<span class="hljs-title function_">join</span>(csv_directory, <span class="hljs-string">'combined.csv'</span>)
combined_df.<span class="hljs-title function_">to_csv</span>(combined_csv_path, index=<span class="hljs-title class_">False</span>)

<span class="hljs-title function_">print</span>(f<span class="hljs-string">"결합된 CSV가 저장되었습니다: {combined_csv_path}"</span>)
</code></pre>
<pre><code class="hljs language-js">df[<span class="hljs-string">'camel'</span>] = pd.<span class="hljs-title function_">to_numeric</span>(df[<span class="hljs-string">'camel'</span>], errors=<span class="hljs-string">'coerce'</span>)
df_sorted = df.<span class="hljs-title function_">sort_values</span>(by=<span class="hljs-string">'camel'</span>, ascending=<span class="hljs-title class_">False</span>).<span class="hljs-title function_">reset_index</span>(drop=<span class="hljs-title class_">True</span>)
df_sorted[<span class="hljs-string">'cumulative_sum'</span>] = df_sorted[<span class="hljs-string">'camel'</span>].<span class="hljs-title function_">cumsum</span>()
total_camels = df_sorted[<span class="hljs-string">'camel'</span>].<span class="hljs-title function_">sum</span>()
threshold = <span class="hljs-number">0.8</span> * total_camels
df_sorted[<span class="hljs-string">'cumulative_percentage'</span>] = df_sorted[<span class="hljs-string">'cumulative_sum'</span>] / total_camels
districts_80_percent = df_sorted[df_sorted[<span class="hljs-string">'cumulative_percentage'</span>] &#x3C;= <span class="hljs-number">0.8</span>]
<span class="hljs-title function_">print</span>(districts_80_percent[[<span class="hljs-string">'state_name'</span>,<span class="hljs-string">'district_name'</span>, <span class="hljs-string">'camel'</span>, <span class="hljs-string">'cumulative_sum'</span>, <span class="hljs-string">'cumulative_percentage'</span>]])
</code></pre>
<img src="/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_1.png">
<h2>단계 6</h2>
<div class="content-ad"></div>
<p>인도의 지구 행정 구역 geojson 파일을 받았어요. 이 파일을 이용하여 18개의 지구를 필터링하는 기능을 만들고, QGIS에서 이를 시각화하며 배경 레이어를 구글 위성 지도로 설정하여 최종 결과물을 얻었어요.</p>
<p>만약 어떤 단계에 대해 더 알고 싶다면 언제든지 저에게 문의해주세요. 이것은 공개 데이터를 활용하여 결정을 내리는 데 있어 있는 가능성 중 하나의 작은 예시에 불과해요. 즐기세요!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"파이썬과 QGIS로 인도의 낙타 80 찾는 방법","description":"","date":"2024-06-22 02:56","slug":"2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation","content":"\n\n## 파이썬 자동화\n\n\"안녕 Aayush, 내가 인도의 저소득 농촌 여성들을 위한 낙타 기반 생계 개선에 집중해야 할 곳을 알고 싶어\", 라는 요구가 왔어요. 라자스탄 출신인 내 친구가 말했어요. 그녀는 라자스탄의 사막 지역이 정답일 것이라고 알고 있었지만, 직감을 뒷받침할 공식 자료가 필요했어요. 그래서 제가 나서서 이 정보를 찾기로 했어요. \n\n## 단계 1\n\n인도 정부의 데이터 제공 플랫폼인 data.gov.in 에서 2019년 20번째 가축 조사 자료 시트 제2020년 승업부와 가축전문부, 수산부, 가축전문부의 자료를 찾아보세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 단계 2\n\n개발자 도구를 사용하여 한 번에 모든 파일에 액세스할 수 있는 URL을 얻는 cURL을 얻으세요. 이렇게 하지 않았다면 각 파일을 개별적으로 클릭하여 양식을 작성하고 캡차를 입력한 다음 CSV를 수동으로 다운로드해야 했을 것입니다. 이 방법으로 제게 많은 시간을 절약했어요.\n\n## Step 3\n\nPostman에 URL을 게시하고 해당하는 Python 요청 코드를 가져와서 응답을 구문 분석하세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 단계 4\n\n저는 Python을 사용하여 응답을 구문 분석하고, 이 코드를 사용하여 모든 URL 링크를 가져왔어요.\n\n```js\nfrom pprint import pprint\nimport os\nimport pandas as pd\nimport requests\n\nurl = \"https://data.gov.in/backend/dmspublic/v1/resources?filters[catalog_reference]=6885101\u0026offset=0\u0026limit=35\u0026sort[changed]=desc\u0026filters[domain_visibility]=4\"\n\npayload = {}\nheaders = {\n  'Accept': 'application/json, text/plain, */*',\n  'Accept-Language': 'en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7',\n  'Connection': 'keep-alive',\n  'Cookie': 'fontSize=67.5; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==jyF1Zg==9zCLz_Tsia4CNE6H2-pAKy8Ou1w=; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==uiR1Zg==JTC1HaNqvL2oNi2kwWYolcsi_TU=',\n  'Referer': 'https://data.gov.in/catalog/20th-livestock-census',\n  'Sec-Fetch-Dest': 'empty',\n  'Sec-Fetch-Mode': 'cors',\n  'Sec-Fetch-Site': 'same-origin',\n  'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36',\n  'dnt': '1',\n  'sec-ch-ua': '\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"126\", \"Google Chrome\";v=\"126\"',\n  'sec-ch-ua-mobile': '?0',\n  'sec-ch-ua-platform': '\"macOS\"',\n  'sec-gpc': '1'\n}\n\nresponse = requests.request(\"GET\", url, headers=headers, data=payload)\n```\n\n```js\nrjson = response.json()\nrows = rjson['data']['rows']\nurls = []\nfor row in rows:\n    url = \"https://\"+row['datafile'][0]\n    print(url)\n    urls.append(url)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n최종 출력물은 CSV를 얻기 위해 구문 분석한 URL 목록입니다.\n\n![이미지](/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png)\n\n## 단계 5\n\n모든 파일을 다운로드하여 연결하여 최종 데이터 프레임을 얻었습니다. 그 후에는 80%의 기준점을 사용하여 낙타 인구의 80%를 보유한 지역을 파악했습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\nsave_directory = './csv_files/'\n\nif not os.path.exists(save_directory):\n    os.makedirs(save_directory)\n\ndef download_file(url, save_directory):\n    try:\n        response = requests.get(url)\n        response.raise_for_status()  # 요청이 성공적인지 확인\n        file_name = os.path.join(save_directory, url.split('/')[-1])\n        with open(file_name, 'wb') as file:\n            file.write(response.content)\n        print(f\"다운로드 완료: {file_name}\")\n    except requests.exceptions.RequestException as e:\n        print(f\"{url}을(를) 다운로드하는 데 실패했습니다: {e}\")\n\nfor url in urls:\n    download_file(url, save_directory)\n\ncsv_directory = save_directory\n\ndataframes = []\n\nall_headers = set()\n\nfor filename in os.listdir(csv_directory):\n    if filename.endswith('.csv'):\n        file_path = os.path.join(csv_directory, filename)\n        df = pd.read_csv(file_path)\n        dataframes.append(df)\n        all_headers.update(df.columns)\n\n# 모든 데이터 프레임이 동일한 헤더를 갖고 있는지 확인\nheaders_match = all(len(df.columns.difference(all_headers)) == 0 for df in dataframes)\n\nif headers_match:\n    combined_df = pd.concat(dataframes, ignore_index=True)\nelse:\n    combined_df = pd.DataFrame(columns=all_headers)\n    for df in dataframes:\n        df = df.reindex(columns=all_headers)  # 모든 열이 존재하는지 확인\n        combined_df = pd.concat([combined_df, df], ignore_index=True)\n\ncombined_csv_path = os.path.join(csv_directory, 'combined.csv')\ncombined_df.to_csv(combined_csv_path, index=False)\n\nprint(f\"결합된 CSV가 저장되었습니다: {combined_csv_path}\")\r\n```\n\n```js\r\ndf['camel'] = pd.to_numeric(df['camel'], errors='coerce')\ndf_sorted = df.sort_values(by='camel', ascending=False).reset_index(drop=True)\ndf_sorted['cumulative_sum'] = df_sorted['camel'].cumsum()\ntotal_camels = df_sorted['camel'].sum()\nthreshold = 0.8 * total_camels\ndf_sorted['cumulative_percentage'] = df_sorted['cumulative_sum'] / total_camels\ndistricts_80_percent = df_sorted[df_sorted['cumulative_percentage'] \u003c= 0.8]\nprint(districts_80_percent[['state_name','district_name', 'camel', 'cumulative_sum', 'cumulative_percentage']])\r\n```\n\n\u003cimg src=\"/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_1.png\" /\u003e\n\n## 단계 6\r\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n인도의 지구 행정 구역 geojson 파일을 받았어요. 이 파일을 이용하여 18개의 지구를 필터링하는 기능을 만들고, QGIS에서 이를 시각화하며 배경 레이어를 구글 위성 지도로 설정하여 최종 결과물을 얻었어요.\n\n만약 어떤 단계에 대해 더 알고 싶다면 언제든지 저에게 문의해주세요. 이것은 공개 데이터를 활용하여 결정을 내리는 데 있어 있는 가능성 중 하나의 작은 예시에 불과해요. 즐기세요!","ogImage":{"url":"/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png"},"coverImage":"/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png","tag":["Tech"],"readingTime":5},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch2\u003e파이썬 자동화\u003c/h2\u003e\n\u003cp\u003e\"안녕 Aayush, 내가 인도의 저소득 농촌 여성들을 위한 낙타 기반 생계 개선에 집중해야 할 곳을 알고 싶어\", 라는 요구가 왔어요. 라자스탄 출신인 내 친구가 말했어요. 그녀는 라자스탄의 사막 지역이 정답일 것이라고 알고 있었지만, 직감을 뒷받침할 공식 자료가 필요했어요. 그래서 제가 나서서 이 정보를 찾기로 했어요.\u003c/p\u003e\n\u003ch2\u003e단계 1\u003c/h2\u003e\n\u003cp\u003e인도 정부의 데이터 제공 플랫폼인 data.gov.in 에서 2019년 20번째 가축 조사 자료 시트 제2020년 승업부와 가축전문부, 수산부, 가축전문부의 자료를 찾아보세요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch2\u003e단계 2\u003c/h2\u003e\n\u003cp\u003e개발자 도구를 사용하여 한 번에 모든 파일에 액세스할 수 있는 URL을 얻는 cURL을 얻으세요. 이렇게 하지 않았다면 각 파일을 개별적으로 클릭하여 양식을 작성하고 캡차를 입력한 다음 CSV를 수동으로 다운로드해야 했을 것입니다. 이 방법으로 제게 많은 시간을 절약했어요.\u003c/p\u003e\n\u003ch2\u003eStep 3\u003c/h2\u003e\n\u003cp\u003ePostman에 URL을 게시하고 해당하는 Python 요청 코드를 가져와서 응답을 구문 분석하세요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch2\u003e단계 4\u003c/h2\u003e\n\u003cp\u003e저는 Python을 사용하여 응답을 구문 분석하고, 이 코드를 사용하여 모든 URL 링크를 가져왔어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pprint \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pprint\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e os\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\n\nurl = \u003cspan class=\"hljs-string\"\u003e\"https://data.gov.in/backend/dmspublic/v1/resources?filters[catalog_reference]=6885101\u0026#x26;offset=0\u0026#x26;limit=35\u0026#x26;sort[changed]=desc\u0026#x26;filters[domain_visibility]=4\"\u003c/span\u003e\n\npayload = {}\nheaders = {\n  \u003cspan class=\"hljs-string\"\u003e'Accept'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'application/json, text/plain, */*'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Accept-Language'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Connection'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'keep-alive'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Cookie'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'fontSize=67.5; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==jyF1Zg==9zCLz_Tsia4CNE6H2-pAKy8Ou1w=; citrix_ns_id=AAA7TRx1ZjuD0ksAAAAAADuMGtjGAxHPGX4gOzVglnj-t-2_KYp3QS5pOwB3wsrGOw==uiR1Zg==JTC1HaNqvL2oNi2kwWYolcsi_TU='\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Referer'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'https://data.gov.in/catalog/20th-livestock-census'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Sec-Fetch-Dest'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'empty'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Sec-Fetch-Mode'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'cors'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'Sec-Fetch-Site'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'same-origin'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'User-Agent'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'dnt'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'1'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'sec-ch-ua'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"126\", \"Google Chrome\";v=\"126\"'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'sec-ch-ua-mobile'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'?0'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'sec-ch-ua-platform'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\"macOS\"'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'sec-gpc'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'1'\u003c/span\u003e\n}\n\nresponse = requests.\u003cspan class=\"hljs-title function_\"\u003erequest\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"GET\"\u003c/span\u003e, url, headers=headers, data=payload)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003erjson = response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e()\nrows = rjson[\u003cspan class=\"hljs-string\"\u003e'data'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'rows'\u003c/span\u003e]\nurls = []\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e row \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003erows\u003c/span\u003e:\n    url = \u003cspan class=\"hljs-string\"\u003e\"https://\"\u003c/span\u003e+row[\u003cspan class=\"hljs-string\"\u003e'datafile'\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(url)\n    urls.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(url)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e최종 출력물은 CSV를 얻기 위해 구문 분석한 URL 목록입니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch2\u003e단계 5\u003c/h2\u003e\n\u003cp\u003e모든 파일을 다운로드하여 연결하여 최종 데이터 프레임을 얻었습니다. 그 후에는 80%의 기준점을 사용하여 낙타 인구의 80%를 보유한 지역을 파악했습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003esave_directory = \u003cspan class=\"hljs-string\"\u003e'./csv_files/'\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e not os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexists\u003c/span\u003e(save_directory):\n    os.\u003cspan class=\"hljs-title function_\"\u003emakedirs\u003c/span\u003e(save_directory)\n\ndef \u003cspan class=\"hljs-title function_\"\u003edownload_file\u003c/span\u003e(url, save_directory):\n    \u003cspan class=\"hljs-attr\"\u003etry\u003c/span\u003e:\n        response = requests.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(url)\n        response.\u003cspan class=\"hljs-title function_\"\u003eraise_for_status\u003c/span\u003e()  # 요청이 성공적인지 확인\n        file_name = os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(save_directory, url.\u003cspan class=\"hljs-title function_\"\u003esplit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e)[-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e])\n        \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eopen\u003c/span\u003e(file_name, \u003cspan class=\"hljs-string\"\u003e'wb'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003efile\u003c/span\u003e:\n            file.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(response.\u003cspan class=\"hljs-property\"\u003econtent\u003c/span\u003e)\n        \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"다운로드 완료: {file_name}\"\u003c/span\u003e)\n    except requests.\u003cspan class=\"hljs-property\"\u003eexceptions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eRequestException\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ee\u003c/span\u003e:\n        \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"{url}을(를) 다운로드하는 데 실패했습니다: {e}\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e url \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eurls\u003c/span\u003e:\n    \u003cspan class=\"hljs-title function_\"\u003edownload_file\u003c/span\u003e(url, save_directory)\n\ncsv_directory = save_directory\n\ndataframes = []\n\nall_headers = \u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e()\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e filename \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e os.\u003cspan class=\"hljs-title function_\"\u003elistdir\u003c/span\u003e(csv_directory):\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e filename.\u003cspan class=\"hljs-title function_\"\u003eendswith\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'.csv'\u003c/span\u003e):\n        file_path = os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(csv_directory, filename)\n        df = pd.\u003cspan class=\"hljs-title function_\"\u003eread_csv\u003c/span\u003e(file_path)\n        dataframes.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(df)\n        all_headers.\u003cspan class=\"hljs-title function_\"\u003eupdate\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003ecolumns\u003c/span\u003e)\n\n# 모든 데이터 프레임이 동일한 헤더를 갖고 있는지 확인\nheaders_match = \u003cspan class=\"hljs-title function_\"\u003eall\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003ecolumns\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003edifference\u003c/span\u003e(all_headers)) == \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e df \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e dataframes)\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eheaders_match\u003c/span\u003e:\n    combined_df = pd.\u003cspan class=\"hljs-title function_\"\u003econcat\u003c/span\u003e(dataframes, ignore_index=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\n\u003cspan class=\"hljs-attr\"\u003eelse\u003c/span\u003e:\n    combined_df = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e(columns=all_headers)\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e df \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edataframes\u003c/span\u003e:\n        df = df.\u003cspan class=\"hljs-title function_\"\u003ereindex\u003c/span\u003e(columns=all_headers)  # 모든 열이 존재하는지 확인\n        combined_df = pd.\u003cspan class=\"hljs-title function_\"\u003econcat\u003c/span\u003e([combined_df, df], ignore_index=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\n\ncombined_csv_path = os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(csv_directory, \u003cspan class=\"hljs-string\"\u003e'combined.csv'\u003c/span\u003e)\ncombined_df.\u003cspan class=\"hljs-title function_\"\u003eto_csv\u003c/span\u003e(combined_csv_path, index=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"결합된 CSV가 저장되었습니다: {combined_csv_path}\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edf[\u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e] = pd.\u003cspan class=\"hljs-title function_\"\u003eto_numeric\u003c/span\u003e(df[\u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e], errors=\u003cspan class=\"hljs-string\"\u003e'coerce'\u003c/span\u003e)\ndf_sorted = df.\u003cspan class=\"hljs-title function_\"\u003esort_values\u003c/span\u003e(by=\u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e, ascending=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ereset_index\u003c/span\u003e(drop=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\ndf_sorted[\u003cspan class=\"hljs-string\"\u003e'cumulative_sum'\u003c/span\u003e] = df_sorted[\u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003ecumsum\u003c/span\u003e()\ntotal_camels = df_sorted[\u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e()\nthreshold = \u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e * total_camels\ndf_sorted[\u003cspan class=\"hljs-string\"\u003e'cumulative_percentage'\u003c/span\u003e] = df_sorted[\u003cspan class=\"hljs-string\"\u003e'cumulative_sum'\u003c/span\u003e] / total_camels\ndistricts_80_percent = df_sorted[df_sorted[\u003cspan class=\"hljs-string\"\u003e'cumulative_percentage'\u003c/span\u003e] \u0026#x3C;= \u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e]\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(districts_80_percent[[\u003cspan class=\"hljs-string\"\u003e'state_name'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'district_name'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'camel'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'cumulative_sum'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'cumulative_percentage'\u003c/span\u003e]])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation_1.png\"\u003e\n\u003ch2\u003e단계 6\u003c/h2\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e인도의 지구 행정 구역 geojson 파일을 받았어요. 이 파일을 이용하여 18개의 지구를 필터링하는 기능을 만들고, QGIS에서 이를 시각화하며 배경 레이어를 구글 위성 지도로 설정하여 최종 결과물을 얻었어요.\u003c/p\u003e\n\u003cp\u003e만약 어떤 단계에 대해 더 알고 싶다면 언제든지 저에게 문의해주세요. 이것은 공개 데이터를 활용하여 결정을 내리는 데 있어 있는 가능성 중 하나의 작은 예시에 불과해요. 즐기세요!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-22-HereshowIusedPythonandQGIStofindout80ofIndiascamelpopulation"},"buildId":"Y-fCAg8BUV7y2HNFwX9AA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>