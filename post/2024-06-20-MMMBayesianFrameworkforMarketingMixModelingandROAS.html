<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS | allround-coder</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://allround-coder.github.io///post/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS | allround-coder" data-gatsby-head="true"/><meta property="og:title" content="Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS | allround-coder" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://allround-coder.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://allround-coder.github.io///post/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS" data-gatsby-head="true"/><meta name="twitter:title" content="Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS | allround-coder" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | allround-coder" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-20 02:06" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZFDEQ947R4"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
  
            gtag('config', 'G-ZFDEQ947R4');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b088bc509ff5c497.js" defer=""></script><script src="/_next/static/Y-fCAg8BUV7y2HNFwX9AA/_buildManifest.js" defer=""></script><script src="/_next/static/Y-fCAg8BUV7y2HNFwX9AA/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Allround Coder</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Allround Coder</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 20, 2024</span><span class="posts_reading_time__f7YPP">20<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>이 게시물은 Rafael Guedes와 함께 공동 저술되었습니다.</p>
<h1>소개</h1>
<p>확장 가능한 인터넷 비즈니스는 성장을 이끌기 위해 마케팅에 의존합니다. 물론 그것뿐만이 아니라 특정 규모에서는 매우 효율적으로 고객을 확보하지 않을 수 없는 회사가 매우 적습니다. 기업들이 마케팅에 인공지능(AI) 능력을 가져오기 위해 많이 투자하고 있는 두 가지 핫한 주제는 미디어 믹스 모델링(MMM)과 고객 평생 가치(LTV) 예측입니다. 이 두 가지는 기업들이 마케팅에 투자하는 비용 대비 이익을 증가시키는 데 초점을 맞추고 있습니다. 이 글은 MMM이 무엇인지와 적용하는 데 가장 효과적인 방법에 대해 다루고 있습니다.</p>
<p>MMM은 마케팅 팀이 투자의 영향과 대화 유도에 어떻게 기여하는지를 측정할 수 있는 기술입니다. 이 일의 복잡성은 최근 몇 년 동안 급속히 증가했습니다. 왜냐하면 광고를 할 수 있는 플랫폼이 급증했기 때문입니다. 이 현상은 잠재 고객을 오프라인 또는 온라인 버킷으로 나눌 수 있는 다양한 미디어 채널에 분산시켰습니다. 전통적인 오프라인 채널은 디지털 지원이 없으며 신문, 라디오, 텔레비전 광고, 쿠폰, 박람회 부스 등을 포함할 수 있습니다. 온라인 채널은 급증했고 기업들은 이러한 채널을 함께 사용하고 있습니다. 이메일, 소셜 미디어, 유기적 검색, 유료 검색, 제휴 마케팅, 인플루언서 마케팅 등을 사용합니다.</p>
<div class="content-ad"></div>
<p>중요한 점 중 하나는 좋은 MMM이 동일하게 정확한 데이터 기반 속성 모델이 필요하다는 것입니다. 즉, 어떤 채널이 특정 고객을 확보하는 데 기여했는지를 나타냅니다. 또한 속성은 사용자 수준에서 수행되지만, MMM은 일반적으로 확보 채널 수준에서 적용됩니다. 데이터 기반 속성은 이 글의 범위를 벗어납니다.</p>
<p>이 글에서는 두 가지에 초점을 맞춥니다. 첫째, 각 미디어 채널의 성능에 대한 투명성을 높이기 위해 설계된 베이지안 모델을 개발합니다. 둘째, 이 경우 수익이라는 변수를 최대화하기 위해 예산 할당을 최적화합니다. 베이지안 접근 방식이 MMM에 어떻게 작용하는지에 대한 상세한 내용을 제공하는 동시에 공개 데이터셋을 활용하여 모델의 정확성을 테스트하고 각 채널의 광고비 투자 대비 수익률(ROAS)을 계산합니다. 마지막으로, 수익을 극대화하기 위해 세 가지 채널 간의 가상 예산을 최적화합니다.</p>
<p>항상 코드는 우리의 GitHub에서 이용할 수 있습니다.</p>
<div class="content-ad"></div>
<h1>미디어 믹스 모델링: 무엇인가요?</h1>
<p>MMM은 전 세계 기업들에게 광고 채널의 효과를 측정하고 미디어 비용이 매출에 미치는 영향에 대한 투명성을 제공하여 조직을 강화합니다. 이러한 모델은 매출, 광고 지출 대비 수익 (ROAS), 수익, 전환, LTV 등의 관심 대상 대상 변수를 최적화하여 채널 간 예산 할당 결정 프로세스를 지원하는 데 중요한 역할을 합니다.</p>
<p>지난 몇 년 동안 많은 연구가 수행되었으며, 관심 대상 변수에 영향을 미치는 지출을 모델링하기 위해 여러 모델이 제안되었습니다. 이러한 모델은 지리적으로 집계된 주간 또는 월간 데이터에 기반합니다. 우리는 의존 변수(위에서 정의한 관심 대상 변수 중 하나 이상)와 독립 변수 간의 관계를 모델링하는 데 관심이 있습니다. 일부 독립 변수는 명백합니다. 예를 들어 광고 채널 별 광고 비용이 그렇습니다. 그러나 가격, 제품 유통, 인플레이션, 날씨, 계절성 및 시장 경쟁력과 같은 추가 관련 효과를 포함하여 접근 방식을 확장할 수 있습니다.</p>
<p>전통적인 접근 방식은 회귀 방법을 활용하여 상관 관계에서 인과 관계를 추론합니다. 그러나 매출의 반응은 선형적이지 않습니다 - 고수준 지출에서 수익이 감소하는 포화 현상이 있습니다. 게다가 광고에는 선행 또는 잔류 효과가 있어 이전 주에 지출한 내용이 다음 주의 매출에 영향을 미칠 수 있습니다.</p>
<div class="content-ad"></div>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_1.png">
<h1>미디어 믹스 모델의 베이지안 방법론</h1>
<p>베이지안 방법론은 포화/형태와 래그/캐리오버 효과를 고려하기 위해 정의될 수 있습니다.</p>
<p>모델 세부사항에 대해 깊이 파고들기 전에, 모델이 어떤 변수를 고려하는지 더 잘 이해하기 위해 가상의 데이터 세트를 정의해보겠습니다. 국가 수준에서 매주 데이터가 있으며 각 행이 주차(t)를 나타내고 각 열이 미디어 채널(m) 또는 계절성 또는 제품 가격과 같은 제어 변수(c)를 나타내는 가정 데이터 세트를 정의해보겠습니다. 주차 t에서 채널 m의 미디어 비용은 Xt,m로 정의되며 동일한 주차에 대한 제어 변수는 Zt,c로 정의됩니다.</p>
<div class="content-ad"></div>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_2.png">
<h1>랙 또는 캐리오버 효과</h1>
<p>캐리오버 효과는 adstock라는 함수에 의해 모델링됩니다 [1]. 이 함수는 특정 채널에서 지출의 누적 효과를 만듭니다. 이 함수는 현재 주와 이전 L-1 주의 미디어 비용을 가중 평균을 통해 변환합니다. L은 특정 미디어 채널의 캐리오버 효과의 최대 기간이며, 가중 평균 방정식에서 가중치 Wm를 추정하는 데 중요한 역할을 합니다.</p>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_3.png">
<div class="content-ad"></div>
<p>미디어 채널마다 L을 다르게 설정할 수 있습니다. 이것은 전문가가 정의해야 하는 초매개변수입니다. 특정 채널에 대한 사전 정보가 없는 경우, 저자들은 잠재적으로 지연된 효과를 포착하기 위해 L을 13과 같은 큰 숫자로 설정하는 것이 좋다고 충고합니다.</p>
<p>가중치를 정의하는 방정식은 두 가지 다른 형태를 가질 수 있습니다:</p>
<ul>
<li>즉각적인/Geometric Adstock [2]는 광고 효과 피크가 광고 노출과 동시에 발생할 때 사용됩니다. 즉, 우리가 특정 미디어 채널의 지출을 늘린 주에 매출이 최대치를 기록한 경우입니다. 방정식 2에서 αm은 광고 효과의 유지율입니다.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_4.png" alt="equation"></p>
<div class="content-ad"></div>
<ul>
<li>광고 효과의 정점이 더 오랜 시간이 걸려 구축되고 판매에 즉시 영향을 주지 않는 경우를 지연된 Adstock [1]라고합니다. 식 3에서 θm은 정점 효과의 지연을 나타냅니다.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_5.png" alt="이미지"></p>
<p>이제 상상 속 데이터셋을 선택하고 Facebook 채널의 즉각적 및 지연 Adstock를 계산해 보겠습니다. 먼저 데이터셋에 5주를 추가했습니다. 보존율(αm)은 80%이며, 정점 지연(θm)은 5주입니다. 이후 즉각적인 효과에 대한 가중치와 지연된 효과에 대한 가중치를 계산하여 8주차에서 즉각 및 지연 Adstock의 최종값에 도달합니다.</p>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_6.png" alt="이미지"></p>
<div class="content-ad"></div>
<p>표 3는 각 주별 지출이 8주차의 매출량에 얼마나 기여하는지를 보여줍니다.</p>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_7.png" alt="Figure 3"></p>
<h1>포화 또는 모양 효과</h1>
<p>포화 또는 모양 효과는 미디어 비용을 로지스틱 포화 함수 [3]와 같은 곡률 함수를 통해 변환하여 모델링합니다. 다음과 같이 정의됩니다:</p>
<div class="content-ad"></div>
<p>이 중에서 x는 미디어 비용을 나타내고, λ는 포화 곡선의 가파르기를 제어한다. 즉, 미디어 비용 효과가 얼마나 빨리 포화되는지를 결정한다. 그러면 낮은 λ 값은 응답 함수의 증가가 점진적이라고 해석할 수 있으며, 미디어 비용이 넓은 범위의 값들에 대해 주목할 만한 효과를 갖는다는 것을 의미한다. 반대로, 높은 λ 값은 지출에 대한 감소된 수익을 가져올 것이다. Figure 4는 이러한 다른 행동들을 매우 명확히 보여줍니다.</p>
<p>이 모델에 어떤 매개변수를 사용해야 하는지 알기가 어렵습니다. 왜냐하면 이는 각 채널의 행동에 매우 구체적이기 때문입니다. 그럼에도 불구하고, Bayesian 접근 방식에서 이러한 매개변수는 사전 분포를 사용하여 추정됩니다. 따라서, 모델은 주어진 데이터에 대해 가능한 가치 매개변수를 선택합니다. 따라서, 우리는 단일 값이 아닌 분포를 설정해야 합니다.</p>
<div class="content-ad"></div>
<h1>캐리오버와 형태 효과 결합</h1>
<p>이전 두 섹션에서 언급했듯이 캐리오버와 형태 효과를 모델링하려면 각 채널의 미디어 비용에 변환을 적용해야 합니다. 어떤 변환을 먼저 적용해야 하는지에 대한 질문이 제기됩니다. 저자들은 다음을 제안합니다:</p>
<ul>
<li>미디어 비용이 특정 기간에 집중적으로 소비된다면 형태 효과는 캐리오버에 따릅니다.</li>
<li>미디어 비용이 여러 시간대에 고르게 분산된다면 캐리오버는 형태 효과에 따릅니다.</li>
</ul>
<p>기관들은 일반적으로 마케팅 활동을 집중하기 때문에 가장 흔한 접근 방식은 캐리오버 → 형태 효과의 결합입니다.</p>
<div class="content-ad"></div>
<p>이에 따라 t주차의 종속 변수인 매출 y는 미디어 비용 및 제어 변수의 선형 결합을 통해 모델링될 수 있습니다. 또한 회귀 계수 β를 사용하여 각 미디어 채널에 대한 다른 효과를 모델링합니다.</p>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_10.png" alt="image"></p>
<p>여기서 𝛂는 y절편입니다. 함수 f(xm,t)는 광고재고(지속성) 및 포화 효과를 고려한 대상 변수에 대한 미디어의 기여를 인코딩합니다. γc는 제어 변수 Zt,c의 효과이며, et는 백색 잡음입니다.</p>
<h1>베이지안 모델</h1>
<div class="content-ad"></div>
<p>베이지안 접근법은 모델 매개변수에 대한 사전 분포를 정의하는 것으로 시작하여, 데이터를 고려하기 전의 초기 신념을 반영합니다. 새로운 데이터가 도입되면 모수가 주어졌을 때 데이터를 관찰할 확률을 나타내는 우도 함수가 계산됩니다. 이 문맥에서 데이터에는 미디어 채널 X와 종속 변수 y를 설명하는 제어 변수 Z가 포함됩니다. 베이즈 정리를 사용하여 사후 분포는 사전 분포와 우도 함수를 결합하여 얻어집니다.</p>
<p>저자들은 각 미디어 채널(X)과 제어 변수(Z)의 매개변수 값을 선택하는데 샘플링 효율성 때문에 Gibbs Sampling[4]에 의존합니다.</p>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_11.png" alt="이미지"></p>
<p>데이터가 강력한 정보를 함유하고 명확한 패턴을 가질 때 모델은 매개변수를 추정할 때 사전 분포에 더 적게 의존한다는 것을 기억해 주세요.</p>
<div class="content-ad"></div>
<p>하지만, 저자들은 각 매개변수에 대한 사전 분포를 정의하는 방법에 대한 일부 지침을 남겼습니다:</p>
<ul>
<li>유지율 (α)은 [0, 1[으로 제한되어 있으며, beta나 균일 분포와 같이 [0, 1[에 대해 정의된 사전을 가져야 합니다.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_12.png" alt="이미지"></p>
<ul>
<li>지연 매개변수 (θ)는 일반적으로 [0, L-1]에 제한되어 있으며, 균일 분포나 스케일링된 베타 분포와 같은 사전을 가져야 합니다.</li>
</ul>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_13.png" alt="image"></p>
<ul>
<li>Gamma (γ) and Intercept are usually modeled by a normal distribution.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_14.png" alt="image"></p>
<ul>
<li>Lambda (λ) is usually modeled by a gamma distribution.</li>
</ul>
<div class="content-ad"></div>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_15.png">
<ul>
<li>회귀 계수 (β)는 일반적으로 미디어 소비가 y에 부정적인 영향을 미치지 않기 때문에 정규 분포와 같은 양수 우선 순위로 모델링됩니다.</li>
</ul>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_16.png">
<h1>PyMC를 활용한 베이지안 미디어 믹스 모델링</h1>
<div class="content-ad"></div>
<p>해당 섹션은 카글의 공개 데이터셋을 활용하여 CC0 라이선스로 Bayesian 모델을 구현했습니다. 이 데이터셋은 세 가지 다른 미디어 채널(TV, 라디오, 신문)에 대한 지출 및 동일 기간의 판매에 대한 정보를 포함하고 있습니다.</p>
<p>데이터셋은 다음과 같이 구성되어 있습니다:</p>
<ul>
<li>ID — 행을 식별합니다.</li>
<li>TV 광고 예산($) — TV에 대한 광고 지출;</li>
<li>라디오 광고 예산($) — 라디오에 대한 광고 지출;</li>
<li>신문 광고 예산($) — 신문에 대한 광고 지출;</li>
<li>판매($) — 목표 변수입니다.</li>
</ul>
<p>적합된 Bayesian 모델은 각 채널별 ROAS, 유지율 및 포화 효과를 계산하는 데 도움이 될 것입니다. 또한 미래 주차를 위한 예산 할당을 최적화하는 데도 도움이 될 것입니다.</p>
<div class="content-ad"></div>
<p>모형의 신뢰성을 측정하기 위해 각 매체 채널의 지출과 제어 변수에 기반하여 보이지 않는 데이터에서 종속 변수를 얼마나 잘 모델링할 수 있는지를 평가할 것입니다. 우리는 평균 절대 오차 (MAE)와 같은 회귀 지표를 활용할 것입니다. 벤치마킹 측면에서, 항상 훈련 데이터의 평균 값으로 예측하는 단순 모형을 사용합니다. 그런데, MMM이 없을 때 기업들이 종종 이를 의존합니다.</p>
<p>먼저 라이브러리를 가져오겠습니다:</p>
<pre><code class="hljs language-js">%matplotlib inline
%load_ext autoreload
%autoreload <span class="hljs-number">2</span>
<span class="hljs-keyword">import</span> arviz <span class="hljs-keyword">as</span> az
<span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.<span class="hljs-property">pyplot</span> <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> utils
<span class="hljs-keyword">from</span> pymc_marketing.<span class="hljs-property">mmm</span>.<span class="hljs-property">delayed_saturated_mmm</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">DelayedSaturatedMMM</span>
<span class="hljs-keyword">from</span> sklearn.<span class="hljs-property">metrics</span> <span class="hljs-keyword">import</span> mean_absolute_error
</code></pre>
<p>그런 다음 데이터셋을 로드하고 일부 기본 전처리 작업을 수행합니다. 열 이름을 간소화하고 ID를 기반으로 새로운 날짜 열을 추가했습니다. 계절성 및 추세와 같은 제어 변수로 데이터셋을 보강하는 데 도움이 됩니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-python"><span class="hljs-comment"># 데이터 로드 및 열 이름 변경</span>
df = pd.read_csv(<span class="hljs-string">'data/data.csv'</span>)
df = df.rename(columns={<span class="hljs-string">'Unnamed: 0'</span>: <span class="hljs-string">'id'</span>, <span class="hljs-string">'TV Ad Budget ($)'</span>:<span class="hljs-string">'tv'</span>, <span class="hljs-string">'Radio Ad Budget ($)'</span>: <span class="hljs-string">'radio'</span>, <span class="hljs-string">'Newspaper Ad Budget ($)'</span>: <span class="hljs-string">'newspaper'</span>, <span class="hljs-string">'Sales ($)'</span>: <span class="hljs-string">'sales'</span>})

<span class="hljs-comment"># 날짜 열 생성</span>
df[<span class="hljs-string">'ds'</span>] = df[<span class="hljs-string">'id'</span>].apply(<span class="hljs-keyword">lambda</span> x: pd.to_datetime(<span class="hljs-string">"2024-02-26"</span>)-datetime.timedelta(weeks=<span class="hljs-built_in">len</span>(df)-x))
</code></pre>
<p>그 후에는 데이터 내 상관 관계를 이해하기 위한 탐색적 데이터 분석을 수행합니다:</p>
<ol>
<li>종속 변수와 각 매체 채널 간의 상관 관계를 평가합니다.</li>
</ol>
<ul>
<li>TV는 판매와 가장 크게 관련된 특성이며, Newspaper는 가장 낮은 상관 관계를 갖고 있습니다.</li>
</ul>
<div class="content-ad"></div>
<pre><code class="hljs language-python">corr_matrix = df[[<span class="hljs-string">'sales'</span>, <span class="hljs-string">'tv'</span>, <span class="hljs-string">'radio'</span>, <span class="hljs-string">'newspaper'</span>]].corr()
sns.heatmap(corr_matrix, annot=<span class="hljs-literal">True</span>, cmap=<span class="hljs-string">'Blues'</span>)
plt.show()
</code></pre>
<ol start="2">
<li>판매량과 각 매체 채널 간의 상관 관계를 평가하기 위해 판매량 대 매체 채널을 그래픽으로 나타냅니다:</li>
</ol>
<ul>
<li>판매량에는 명확한 추세나 계절성이 없습니다.</li>
<li>TV 광고의 영향은 판매에 즉각적인 영향을 미칩니다.</li>
<li>라디오 광고의 영향도 판매에 즉각적인 영향을 미칩니다. 예를 들어, TV 광고가 낮은 값을 가졌던 2022년 1~3주에는 판매량이 급등하는데, 이는 라디오의 급등과 일치합니다.</li>
<li>신문 광고의 영향은 1~2주의 지연이 있는 것으로 보이지만, TV와 라디오 광고가 동시에 진행되었기 때문에 정확히 파악하기 어렵습니다.</li>
</ul>
<pre><code class="hljs language-python"><span class="hljs-comment"># 판매량만</span>
utils.line_plot(df.copy(), [<span class="hljs-string">'sales'</span>], <span class="hljs-string">'시간에 따른 판매'</span>)

<span class="hljs-comment"># 판매 대 TV 광고</span>
utils.line_plot(df.copy(), [<span class="hljs-string">'sales'</span>, <span class="hljs-string">'tv'</span>], <span class="hljs-string">'시간에 따른 판매 대 TV'</span>)

<span class="hljs-comment"># 판매 대 라디오 광고</span>
utils.line_plot(df.copy(), [<span class="hljs-string">'sales'</span>, <span class="hljs-string">'radio'</span>], <span class="hljs-string">'시간에 따른 판매 대 라디오'</span>)

<span class="hljs-comment"># 판매 대 신문 광고</span>
utils.line_plot(df.copy(), [<span class="hljs-string">'sales'</span>, <span class="hljs-string">'newspaper'</span>], <span class="hljs-string">'시간에 따른 판매 대 신문'</span>)
</code></pre>
<div class="content-ad"></div>
<p>EDA를 마무리했으니 모델링 부분을 준비할 차례입니다:</p>
<ol>
<li>데이터를 훈련 및 테스트 세트로 나누는 작업을 시작하겠습니다:</li>
</ol>
<pre><code class="hljs language-js">train_df = df.<span class="hljs-title function_">sort_values</span>(by=<span class="hljs-string">'ds'</span>).<span class="hljs-property">iloc</span>[:-<span class="hljs-number">5</span>,:]
test_df = df.<span class="hljs-title function_">sort_values</span>(by=<span class="hljs-string">'ds'</span>).<span class="hljs-property">iloc</span>[-<span class="hljs-number">5</span>:,:]
</code></pre>
<ol start="2">
<li>이전에 생성한 주간 데이터를 사용하여 추세와 계절성과 같은 통제 변수를 추출하려고 합니다.</li>
</ol>
<div class="content-ad"></div>
<ul>
<li>시계열 모델 Prophet을 사용하여 Meta에서 시계열을 추세 및 계절성으로 분해하고 이를 제어 변수로 사용합니다.</li>
</ul>
<pre><code class="hljs language-js">seasonality, trend = utils.<span class="hljs-title function_">extract_trend_seasonality</span>(train_df, <span class="hljs-string">'sales'</span>, <span class="hljs-number">5</span>)
train_df.<span class="hljs-property">loc</span>[:, <span class="hljs-string">'seasonality'</span>] = seasonality[:-<span class="hljs-number">5</span>]
test_df.<span class="hljs-property">loc</span>[:,<span class="hljs-string">'seasonality'</span>] = seasonality[-<span class="hljs-number">5</span>:]
train_df.<span class="hljs-property">loc</span>[:,<span class="hljs-string">'trend'</span>] = trend[:-<span class="hljs-number">5</span>]
test_df.<span class="hljs-property">loc</span>[:,<span class="hljs-string">'trend'</span>] = trend[-<span class="hljs-number">5</span>:]
</code></pre>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_17.png" alt="Image"></p>
<ol start="3">
<li>모델을 위한 다른 하이퍼파라미터를 설정합니다. 이러한 매개변수는 전통적인 ML 하이퍼파라미터 검색을 통해 정의할 수 있습니다. dist, mu 및 sigma 값을 변경하여 일부 회귀 지표를 최적화합니다. 더 높은 표준 편차 값(sigma)은 모델에 더 많은 자유를 제공하여 최적의 매개변수를 탐색할 수 있음을 기억하세요.</li>
</ol>
<div class="content-ad"></div>
<pre><code class="hljs language-js">my_model_config = {<span class="hljs-string">'intercept'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Normal'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'mu'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'sigma'</span>: <span class="hljs-number">2</span>},
 <span class="hljs-string">'beta_channel'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'HalfNormal'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'sigma'</span>: <span class="hljs-number">2</span>},
 <span class="hljs-string">'alpha'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Beta'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'alpha'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'beta'</span>: <span class="hljs-number">3</span>},
 <span class="hljs-string">'lam'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Gamma'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'alpha'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'beta'</span>: <span class="hljs-number">1</span>},
 <span class="hljs-string">'likelihood'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Normal'</span>,
  <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'sigma'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'HalfNormal'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'sigma'</span>: <span class="hljs-number">2</span>}},
 <span class="hljs-string">'gamma_control'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Normal'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'mu'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'sigma'</span>: <span class="hljs-number">2</span>},
 <span class="hljs-string">'gamma_fourier'</span>: {<span class="hljs-string">'dist'</span>: <span class="hljs-string">'Laplace'</span>, <span class="hljs-string">'kwargs'</span>: {<span class="hljs-string">'mu'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'b'</span>: <span class="hljs-number">1</span>}}}
</code></pre>
<img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_18.png">
<p>Figure 13에서 저희가 구현한 모델의 Kruschke 다이어그램을 제시합니다. 이는 이전에 정의한 내용에 대한 간결한 개요를 제공합니다. 이러한 다이어그램을 해석할 때 고려해야 할 몇 가지 측면이 있습니다. 각 노드 내에서 변수와 해당 분포를 찾을 수 있음을 유의하십시오. 예를 들어, α를 포함하는 원은 이전에 정의한 대로 베타 분포를 나타냅니다. 음영 처리된 노드는 관측된 변수를 나타냅니다. 둥근 모서리 상자는 반복을 나타냅니다. 예를 들어, 저희는 세 개의 확보 채널이 있으므로 각 채널에 대해 별도의 α, β 및 λ 매개변수 집합을 설정합니다. 화살표는 종속성을 보여줍니다. 저희 모델에서는 두 개의 화살표가 가능 함수를 가리키는데, 하나는 mu 매개변수에 종속성을 나타내고 다른 하나는 sigma 매개변수에 종속성을 나타냅니다. mu 매개변수 자체가 세 개의 추가 종속성을 가지고 있음을 상기해 주세요. 우리는 이동 효과, 모양 효과 및 제어 변수를 통합하여 매출을 모델링하기로 선택했음을 기억하세요.</p>
<p>이제 우리는 교육 및 테스트 세트, 그리고 모델 구성을 정의했으므로 베이지안 모델을 초기화하고 교육 데이터에 맞출 수 있습니다.</p>
<div class="content-ad"></div>
<ul>
<li>미디어 채널 ["tv", "radio", "newspaper"]</li>
<li>통제 변수 ["seasonality", "trend"]</li>
<li>EDA에서 광고주는 지연 매개변수로 최대 2까지 인 것으로 보입니다.</li>
</ul>
<pre><code class="hljs language-js">mmm = <span class="hljs-title class_">DelayedSaturatedMMM</span>(
    model_config=my_model_config,
    sampler_config={<span class="hljs-string">"progressbar"</span>: <span class="hljs-title class_">True</span>},
    date_column=<span class="hljs-string">"ds"</span>,
    channel_columns=[<span class="hljs-string">"tv"</span>, <span class="hljs-string">"radio"</span>, <span class="hljs-string">"newspaper"</span>],
    control_columns=[<span class="hljs-string">"seasonality"</span>, <span class="hljs-string">"trend"</span>],
    adstock_max_lag=<span class="hljs-number">2</span>,
)

mmm.<span class="hljs-title function_">fit</span>(X=train_df[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'tv'</span>, <span class="hljs-string">'radio'</span>, <span class="hljs-string">"newspaper"</span>, <span class="hljs-string">"seasonality"</span>, <span class="hljs-string">"trend"</span>]], y=train_df[<span class="hljs-string">'sales'</span>], target_accept=<span class="hljs-number">0.95</span>, chains=<span class="hljs-number">4</span>, random_seed=<span class="hljs-number">42</span>)
</code></pre>
<p>모델을 적합한 후에는 샘플링 예측값(파란색)과 실제 값(검은색)을 비교하여 학습 데이터에 얼마나 잘 맞는지 확인할 수 있습니다. 우리의 경우, 그들이 잘 일치하는 것을 확인할 수 있습니다.</p>
<pre><code class="hljs language-js">mmm.<span class="hljs-title function_">sample_posterior_predictive</span>(train_df[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'tv'</span>, <span class="hljs-string">'radio'</span>, <span class="hljs-string">"newspaper"</span>, <span class="hljs-string">"seasonality"</span>, <span class="hljs-string">"trend"</span>]], extend_idata=<span class="hljs-title class_">True</span>, combined=<span class="hljs-title class_">True</span>)
mmm.<span class="hljs-title function_">plot_posterior_predictive</span>(original_scale=<span class="hljs-title class_">True</span>);
</code></pre>
<div class="content-ad"></div>
<p>이제 다양한 방법으로 모델 해석을 시작할 수 있습니다:</p>
<ol>
<li>파라미터 추정 확인:</li>
</ol>
<ul>
<li>라디오는 계수(베타)가 가장 높으므로 투자 대비 가장 높은 수익을 보이는 것으로 보입니다(1.185), 그 다음에 TV와 신문이 이어집니다.</li>
<li>유지율 α는 TV에 대해 3.2%, 라디오에 대해 2.3%, 신문에 대해 23.9%입니다.</li>
</ul>
<pre><code class="hljs language-js">az.<span class="hljs-title function_">summary</span>(data=mmm.<span class="hljs-property">fit_result</span>,
    var_names=[
        <span class="hljs-string">"intercept"</span>,
        <span class="hljs-string">"likelihood_sigma"</span>,
        <span class="hljs-string">"beta_channel"</span>,
        <span class="hljs-string">"alpha"</span>,
        <span class="hljs-string">"lam"</span>,
        <span class="hljs-string">"gamma_control"</span>,
    ],
)
</code></pre>
<div class="content-ad"></div>
<ul>
<li>TV에서 포화율 λ가 더 높으며 (3.138), 전체 지출의 73%를 차지합니다. 그림 12에서 3개 채널의 포화율을 더 쉽게 비교할 수 있습니다.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_19.png" alt="Figure 12"></p>
<ol start="2">
<li>채널 기여 및 ROAS 확인:</li>
</ol>
<ul>
<li>ROAS는 매체 채널 중 하나의 지출을 제로로 설정하여 현재 매출 대비 예측 매출이 어떻게 변경되는지를 평가하여 계산됩니다. 예를 들어, 신문의 매체 지출을 제로로 설정하면 매출 큰 감소를 예상하지 않습니다. 따라서, 이에 대한 ROAS는 낮을 것입니다.</li>
<li>TV가 높은 지출을 했기 때문에 가장 큰 기여를 가지고 있지만, 모델은 라디오에 대해 더 높은 ROAS를 예측합니다.</li>
</ul>
<div class="content-ad"></div>
<pre><code class="hljs language-js"># 채널의 공헌도
fig = mmm.<span class="hljs-title function_">plot_channel_contribution_share_hdi</span>(figsize=(<span class="hljs-number">7</span>, <span class="hljs-number">5</span>))

# <span class="hljs-variable constant_">ROAS</span> 계산
utils.<span class="hljs-title function_">plot_ROAS</span>(mmm, train_df, [<span class="hljs-string">"tv"</span>, <span class="hljs-string">"radio"</span>, <span class="hljs-string">"newspaper"</span>])
</code></pre>
<ol start="3">
<li>마지막으로, 각 채널별 광고비 지출을 50% 증가시킨다면 어떤 일이 일어날지도 평가할 수 있습니다. 이때는 캐리오버와 포화 효과를 고려합니다.</li>
</ol>
<p>X 축은 채널 데이터 백분율 수준입니다:</p>
<ul>
<li>When =1 일 때, 모델 입력 지출 데이터가 됩니다.</li>
<li>When =1.5 일 때, 지출을 50% 증가시켰을 때의 공헌도가 어떨지 볼 수 있습니다.</li>
</ul>
<div class="content-ad"></div>
<p>신문은 지출이 50% 증가해도 그다지 많은 기여를 못 할 것 같아요.</p>
<p>라디오는 TV에 비해 훨씬 포화되지 않아 보여요. 두 선의 기울기를 비교해 봤을 때 그렇죠.</p>
<pre><code class="hljs language-js">plt.<span class="hljs-property">rcParams</span>[<span class="hljs-string">"figure.figsize"</span>] = (<span class="hljs-number">20</span>,<span class="hljs-number">5</span>)
mmm.<span class="hljs-title function_">plot_channel_contributions_grid</span>(start=<span class="hljs-number">0</span>, stop=<span class="hljs-number">1.5</span>, num=<span class="hljs-number">12</span>);
</code></pre>
<p>우리의 결론이 올바른지 확인하기 위해 시험 집합을 사용하여 미디어 채널과 제어 변수를 기반으로 미래 매출을 예측하는 모델의 성능을 평가할 수 있어요. 이를 위해 MAE를 사용하고 소박한 모델과 비교할 거에요.</p>
<div class="content-ad"></div>
<ul>
<li>우리는 평균 목표가 13.8인 경우 MAE가 2.01이었습니다.</li>
<li>우리는 베이스라인보다 오차가 58% 낮습니다.</li>
</ul>
<pre><code class="hljs language-js">y_out_of_sample = mmm.<span class="hljs-title function_">sample_posterior_predictive</span>(X_pred=test_df[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'tv'</span>, <span class="hljs-string">'radio'</span>, <span class="hljs-string">"newspaper"</span>, <span class="hljs-string">"seasonality"</span>, <span class="hljs-string">"trend"</span>]], extend_idata=<span class="hljs-title class_">False</span>)
y_pred = [np.<span class="hljs-title function_">median</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> y_out_of_sample[<span class="hljs-string">'y'</span>]]

<span class="hljs-title function_">print</span>(f<span class="hljs-string">"평균 절대 오차 (MAE): {mean_absolute_error(test_df['sales'], y_pred)} (평균 목표: {test_df['sales'].mean()})"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"평균 절대 비율 오차 (MASE): {mean_absolute_error(test_df['sales'], y_pred)/mean_absolute_error(test_df['sales'], [train_df['sales'].mean()]*5)}"</span>)
</code></pre>
<p>회귀 결과는 모델이 매체 채널과 제어 변수를 기반으로 매출을 모델링하기에 신뢰할만하고 잘 한다는 것을 보여줍니다.</p>
<h1>예산 할당</h1>
<div class="content-ad"></div>
<p>판매에 대한 지출 효과가 선형적이지 않을 것으로 가정하기 때문에 어느 시점에서 포화될 것으로 예상됩니다. 따라서, 우리는 어떤 포화 함수가 우리의 데이터와 더 잘 맞는지 결정해야 합니다. 포화 모델링을 위한 두 가지 함수 옵션이 있습니다:</p>
<ul>
<li>α(alpha)가 포화 지점인 시그모이드 함수, 즉 지출 증가가 판매 증가로 이어지지 않고, λ(lambda)는 곡선의 기울기를 제어하는 요인입니다. 더 높은 값은 곡선을 더 가파르게 만듭니다.</li>
</ul>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_20.png" alt="이미지"></p>
<ul>
<li>알파(alpha)가 채널이 가질 수 있는 최대 기여도인 Michaelis-Menten 함수이며, 람다(lambda)는 곡선이 방향을 조정하는 순간, 즉 기울기입니다.</li>
</ul>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_21.png" alt="image"></p>
<p>저희 데이터에 더 적합한 곡선을 결정하기 위해, 적합된 MMM을 사용하여 각 함수의 매개변수를 계산할 것입니다. 그 후 두 가지를 모두 플롯하고 시각적으로 어느 것이 더 적합한지 확인할 것입니다.</p>
<ul>
<li>특정 사용 사례에서, 시그모이드 함수가 더 나은 결과를 보였습니다.</li>
</ul>
<pre><code class="hljs language-js"># 플롯 및 알파, 람다 추출
sigmoid_response_curve_fig = mmm.<span class="hljs-title function_">plot_direct_contribution_curves</span>(show_fit=<span class="hljs-title class_">True</span>)
sigmoid_params = mmm.<span class="hljs-title function_">compute_channel_curve_optimization_parameters_original_scale</span>(method=<span class="hljs-string">'sigmoid'</span>)

mm_response_curve_fig = mmm.<span class="hljs-title function_">plot_direct_contribution_curves</span>(show_fit=<span class="hljs-title class_">True</span>, method=<span class="hljs-string">'michaelis-menten'</span>)
mm_params = mmm.<span class="hljs-title function_">compute_channel_curve_optimization_parameters_original_scale</span>(method=<span class="hljs-string">'michaelis-menten'</span>)
</code></pre>
<div class="content-ad"></div>
<p>이제 각 미디어 채널의 시그모이드 매개변수(α 및 λ)가 있으므로 각 채널의 포화점을 알 수 있습니다. 따라서 추가 지출은 수익을 증가시키지 않을 것이며, 다른 채널에 투자된 금액은 원하는 효과를 얻을 수 있습니다.</p>
<p>채널 포화도를 기반으로 한 예산 할당을 최적화하기 위한 알고리즘을 사용할 수 있습니다. 이 때 고려해야 할 세 가지 변수는 채널 포화도, 사용 가능한 총 예산 및 각 채널의 예산 제약 사항입니다. PyMC에는 Sequential Least Squares Quadratic Programming (SLSQP)을 구현한 것이 있습니다. 이는 세 가지 변수를 고려하여 모든 채널에서 총 기여도를 최대화합니다:</p>
<ul>
<li>총 예산 제한;</li>
<li>각 채널의 최소 및 최대 지출 한도;</li>
<li>포화 곡선.</li>
</ul>
<pre><code class="hljs language-python">result_sigmoid = mmm.optimize_channel_budget_for_maximum_contribution(
    method=<span class="hljs-string">'sigmoid'</span>, <span class="hljs-comment"># 포화 함수를 정의</span>
    total_budget=<span class="hljs-number">500</span>, <span class="hljs-comment"># 총 예산</span>
    parameters=sigmoid_params, <span class="hljs-comment"># 이전에 추출한 시그모이드 매개변수</span>
    budget_bounds={<span class="hljs-string">'tv'</span>: [<span class="hljs-number">75</span>, <span class="hljs-number">296</span>], <span class="hljs-string">'radio'</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">300</span>], <span class="hljs-string">'newspaper'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">25</span>]} <span class="hljs-comment"># 채널별 예산 제약 사항</span>
)
</code></pre>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_22.png" alt="image"></p>
<p>표 4는 우리의 예산 배정 결과를 보여줍니다. 라디오는 추정 기여도가 가장 높은 채널이며, TV는 가장 높은 예산을 쓰도록 권장받은 채널입니다.</p>
<h1>시장 불확실성 하의 예산 배정</h1>
<p>현재 경제 상황에서 많은 불확실성을 겪고 있습니다. 따라서, 다양한 시나리오를 수용할 수 있는 예산 배정 전략을 설계해야 합니다.</p>
<div class="content-ad"></div>
<p>세 가지 다른 시나리오를 고려해 봅시다:</p>
<ul>
<li>초기: 경제가 안정 상태를 유지하며, 예산 할당은 이전 섹션에서 계산된 것과 동일합니다.</li>
<li>시나리오 2: 경제가 경기 침체를 겪고 예산이 40% 삭감됩니다.</li>
<li>시나리오 3: 경제가 유리해지고 성장을 시작하며, 예산이 20% 증가합니다.</li>
</ul>
<p>이러한 다른 시나리오에서 예산 할당을 최적화하기 위해 동일한 적합된 MMM 모델과 모델의 시그모이드 매개변수를 사용할 것입니다. 같은 코드를 사용하지만 이번에는 사용 가능한 예산을 줄이거나 증가시키기 위해 다른 시나리오를 반복할 것입니다.</p>
<pre><code class="hljs language-js">scenarios_result = []
total_budget = <span class="hljs-number">500</span>
channels = [<span class="hljs-string">'tv'</span>, <span class="hljs-string">'radio'</span>, <span class="hljs-string">'newspaper'</span>]

<span class="hljs-keyword">for</span> scenario <span class="hljs-keyword">in</span> np.<span class="hljs-title function_">array</span>([<span class="hljs-number">0.6</span>, <span class="hljs-number">1.2</span>]):
    scenarios_result.<span class="hljs-title function_">append</span>(
        mmm.<span class="hljs-title function_">optimize_channel_budget_for_maximum_contribution</span>(
            method=<span class="hljs-string">"sigmoid"</span>,  # 포화 함수 정의
            total_budget=total_budget * scenario,
            parameters=sigmoid_params,
            budget_bounds={
                <span class="hljs-attr">channel</span>: [<span class="hljs-number">1</span>, total_budget * scenario] <span class="hljs-keyword">for</span> channel <span class="hljs-keyword">in</span> channels
            },
        ).<span class="hljs-title function_">to_dict</span>()
    )
_ = mmm.<span class="hljs-title function_">plot_budget_scenearios</span>(
    base_data=result_sigmoid, method=<span class="hljs-string">"sigmoid"</span>, scenarios_data=scenarios_result
)
</code></pre>
<div class="content-ad"></div>
<p>그림 19에서 보듯이, 경제 불황 시나리오에서 TV에 할당된 예산은 초기 시나리오와 비교했을 때 라디오보다 크게 감소합니다. 이는 라디오의 ROAS가 높기 때문에 예상되는 현상입니다. 반면, 성장 시나리오에서는 TV와 라디오에 할당된 예산이 유사하게 증가합니다.</p>
<h1>결론</h1>
<p>미디어믹스 모델링을 위한 AI는 투자에서 긍정적인 수익을 창출하고 가치 있는 충성고객을 확보하는 차이를 만들어줄 수 있습니다. 또는 잘못된 미디어 채널과 잘못된 고객에게 금전적 자원을 낭비하는 것 사이의 차이를 만들어줄 수도 있습니다.</p>
<p>본 문서에서는 각 회사의 미디어 채널이 새로운 고객을 확보할 수 있는 잠재력을 더 자세히 평가하고 투명성을 제공할 수 있는 마케팅 믹스 모델링을 위한 베이지안 프레임워크를 개발했습니다. 우리의 접근 방식은 마케팅팀의 도메인 지식을 사전 분포를 설정함으로써 통합할 수 있습니다. 이는 모델의 능력을 향상시키고 미디어 채널과 관심 변수(예: 판매) 간의 관계를 이해하는데 도움이 됩니다. 마지막으로, 회사가 새로운 고객을 확보하기 위해 투자할 능력에 따라 예산 할당 전략을 최적화할 수 있습니다. 현재의 거시 경제 상황에서 기업은 수익성으로 돌아갈 수 있으며 성장에 투자할 예산을 줄일 수 있습니다. 우리는 영향을 최소화하면서 어디서 예산을 삭감할지에 대한 데이터 기반 의사결정 방법을 보여주었습니다. 반대로, 상황이 긍정적일 때 어디에 투자할지와 회사가 더 빨리 성장하기 위해 더 많은 자원을 투입하려는 경우 어디에 투자할지를 보여주었습니다.</p>
<div class="content-ad"></div>
<p>우리는 현재 기관들에 새로운 AI 애플리케이션을 개발하고 배포하고 있어요. 예를 들어, 우리는 생성 모델 AI로 고객 경험을 향상시키고 시계열 예측으로 계획 프로세스를 개선하고 있어요. 이 경우에는 AI가 마케팅 예산의 효율성을 향상시킬 수 있는 방법을 보여주고 있어요. 우리의 경험에 따르면, AI 채택 측면에서 선진적이고 성숙한 기관은 핵심 활동에 중점을 둔 특화된 AI 모델 스위트가 필요해요.</p>
<h1>나에 대해</h1>
<p>AI 분야의 시리얼 창업가이자 리더에요. 비즈니스를 위한 AI 제품을 개발하고 AI 중심의 스타트업에 투자하고 있어요.</p>
<p>ZAAI 설립자 | LinkedIn | X/Twitter</p>
<div class="content-ad"></div>
<h1>참고문헌</h1>
<p>[1] Yuxue Jin, Yueqing Wang, Yunting Sun, David Chan, Jim Koehler. (2017). Bayesian Methods for Media Mix Modeling with Carryover and Shape Effects.</p>
<p>[2] Dominique M. Hanssens , Leonard J. Parsons , Randall L. Schultz. (2003). Market response models: econometric and time series analysis. Springer Science &#x26; Business Media.</p>
<p>[3] Hill, A. V. (1910). 혈색소 분자의 집단화가 분리 곡선에 미치는 가능한 영향. Journal of Physiology, 40 (suppl), iv–vii. doi:10.1113/jphysiol.1910. sp001386.</p>
<div class="content-ad"></div>
<p>[4] Gelfand, A. E. &#x26; Smith, A. F. (1990). Sampling-based approaches to calculating marginal densities. Journal of the American statistical association, 85 (410), 398–409</p>
<hr>
<p>모든 이미지는 저자의 작품이며, 다르게 표기되지 않았습니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Bayesian Framework을 활용한 마케팅 믹스 모델링과 ROAS","description":"","date":"2024-06-20 02:06","slug":"2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS","content":"\n\n이 게시물은 Rafael Guedes와 함께 공동 저술되었습니다.\n\n# 소개\n\n확장 가능한 인터넷 비즈니스는 성장을 이끌기 위해 마케팅에 의존합니다. 물론 그것뿐만이 아니라 특정 규모에서는 매우 효율적으로 고객을 확보하지 않을 수 없는 회사가 매우 적습니다. 기업들이 마케팅에 인공지능(AI) 능력을 가져오기 위해 많이 투자하고 있는 두 가지 핫한 주제는 미디어 믹스 모델링(MMM)과 고객 평생 가치(LTV) 예측입니다. 이 두 가지는 기업들이 마케팅에 투자하는 비용 대비 이익을 증가시키는 데 초점을 맞추고 있습니다. 이 글은 MMM이 무엇인지와 적용하는 데 가장 효과적인 방법에 대해 다루고 있습니다.\n\nMMM은 마케팅 팀이 투자의 영향과 대화 유도에 어떻게 기여하는지를 측정할 수 있는 기술입니다. 이 일의 복잡성은 최근 몇 년 동안 급속히 증가했습니다. 왜냐하면 광고를 할 수 있는 플랫폼이 급증했기 때문입니다. 이 현상은 잠재 고객을 오프라인 또는 온라인 버킷으로 나눌 수 있는 다양한 미디어 채널에 분산시켰습니다. 전통적인 오프라인 채널은 디지털 지원이 없으며 신문, 라디오, 텔레비전 광고, 쿠폰, 박람회 부스 등을 포함할 수 있습니다. 온라인 채널은 급증했고 기업들은 이러한 채널을 함께 사용하고 있습니다. 이메일, 소셜 미디어, 유기적 검색, 유료 검색, 제휴 마케팅, 인플루언서 마케팅 등을 사용합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n중요한 점 중 하나는 좋은 MMM이 동일하게 정확한 데이터 기반 속성 모델이 필요하다는 것입니다. 즉, 어떤 채널이 특정 고객을 확보하는 데 기여했는지를 나타냅니다. 또한 속성은 사용자 수준에서 수행되지만, MMM은 일반적으로 확보 채널 수준에서 적용됩니다. 데이터 기반 속성은 이 글의 범위를 벗어납니다.\n\n이 글에서는 두 가지에 초점을 맞춥니다. 첫째, 각 미디어 채널의 성능에 대한 투명성을 높이기 위해 설계된 베이지안 모델을 개발합니다. 둘째, 이 경우 수익이라는 변수를 최대화하기 위해 예산 할당을 최적화합니다. 베이지안 접근 방식이 MMM에 어떻게 작용하는지에 대한 상세한 내용을 제공하는 동시에 공개 데이터셋을 활용하여 모델의 정확성을 테스트하고 각 채널의 광고비 투자 대비 수익률(ROAS)을 계산합니다. 마지막으로, 수익을 극대화하기 위해 세 가지 채널 간의 가상 예산을 최적화합니다.\n\n항상 코드는 우리의 GitHub에서 이용할 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 미디어 믹스 모델링: 무엇인가요?\n\nMMM은 전 세계 기업들에게 광고 채널의 효과를 측정하고 미디어 비용이 매출에 미치는 영향에 대한 투명성을 제공하여 조직을 강화합니다. 이러한 모델은 매출, 광고 지출 대비 수익 (ROAS), 수익, 전환, LTV 등의 관심 대상 대상 변수를 최적화하여 채널 간 예산 할당 결정 프로세스를 지원하는 데 중요한 역할을 합니다.\n\n지난 몇 년 동안 많은 연구가 수행되었으며, 관심 대상 변수에 영향을 미치는 지출을 모델링하기 위해 여러 모델이 제안되었습니다. 이러한 모델은 지리적으로 집계된 주간 또는 월간 데이터에 기반합니다. 우리는 의존 변수(위에서 정의한 관심 대상 변수 중 하나 이상)와 독립 변수 간의 관계를 모델링하는 데 관심이 있습니다. 일부 독립 변수는 명백합니다. 예를 들어 광고 채널 별 광고 비용이 그렇습니다. 그러나 가격, 제품 유통, 인플레이션, 날씨, 계절성 및 시장 경쟁력과 같은 추가 관련 효과를 포함하여 접근 방식을 확장할 수 있습니다.\n\n전통적인 접근 방식은 회귀 방법을 활용하여 상관 관계에서 인과 관계를 추론합니다. 그러나 매출의 반응은 선형적이지 않습니다 - 고수준 지출에서 수익이 감소하는 포화 현상이 있습니다. 게다가 광고에는 선행 또는 잔류 효과가 있어 이전 주에 지출한 내용이 다음 주의 매출에 영향을 미칠 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_1.png\" /\u003e\n\n# 미디어 믹스 모델의 베이지안 방법론\n\n베이지안 방법론은 포화/형태와 래그/캐리오버 효과를 고려하기 위해 정의될 수 있습니다.\n\n모델 세부사항에 대해 깊이 파고들기 전에, 모델이 어떤 변수를 고려하는지 더 잘 이해하기 위해 가상의 데이터 세트를 정의해보겠습니다. 국가 수준에서 매주 데이터가 있으며 각 행이 주차(t)를 나타내고 각 열이 미디어 채널(m) 또는 계절성 또는 제품 가격과 같은 제어 변수(c)를 나타내는 가정 데이터 세트를 정의해보겠습니다. 주차 t에서 채널 m의 미디어 비용은 Xt,m로 정의되며 동일한 주차에 대한 제어 변수는 Zt,c로 정의됩니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_2.png\" /\u003e\n\n# 랙 또는 캐리오버 효과\n\n캐리오버 효과는 adstock라는 함수에 의해 모델링됩니다 [1]. 이 함수는 특정 채널에서 지출의 누적 효과를 만듭니다. 이 함수는 현재 주와 이전 L-1 주의 미디어 비용을 가중 평균을 통해 변환합니다. L은 특정 미디어 채널의 캐리오버 효과의 최대 기간이며, 가중 평균 방정식에서 가중치 Wm를 추정하는 데 중요한 역할을 합니다.\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_3.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n미디어 채널마다 L을 다르게 설정할 수 있습니다. 이것은 전문가가 정의해야 하는 초매개변수입니다. 특정 채널에 대한 사전 정보가 없는 경우, 저자들은 잠재적으로 지연된 효과를 포착하기 위해 L을 13과 같은 큰 숫자로 설정하는 것이 좋다고 충고합니다.\n\n가중치를 정의하는 방정식은 두 가지 다른 형태를 가질 수 있습니다:\n\n- 즉각적인/Geometric Adstock [2]는 광고 효과 피크가 광고 노출과 동시에 발생할 때 사용됩니다. 즉, 우리가 특정 미디어 채널의 지출을 늘린 주에 매출이 최대치를 기록한 경우입니다. 방정식 2에서 αm은 광고 효과의 유지율입니다.\n\n![equation](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_4.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 광고 효과의 정점이 더 오랜 시간이 걸려 구축되고 판매에 즉시 영향을 주지 않는 경우를 지연된 Adstock [1]라고합니다. 식 3에서 θm은 정점 효과의 지연을 나타냅니다.\n\n![이미지](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_5.png)\n\n이제 상상 속 데이터셋을 선택하고 Facebook 채널의 즉각적 및 지연 Adstock를 계산해 보겠습니다. 먼저 데이터셋에 5주를 추가했습니다. 보존율(αm)은 80%이며, 정점 지연(θm)은 5주입니다. 이후 즉각적인 효과에 대한 가중치와 지연된 효과에 대한 가중치를 계산하여 8주차에서 즉각 및 지연 Adstock의 최종값에 도달합니다.\n\n![이미지](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_6.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n표 3는 각 주별 지출이 8주차의 매출량에 얼마나 기여하는지를 보여줍니다.\n\n![Figure 3](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_7.png)\n\n# 포화 또는 모양 효과\n\n포화 또는 모양 효과는 미디어 비용을 로지스틱 포화 함수 [3]와 같은 곡률 함수를 통해 변환하여 모델링합니다. 다음과 같이 정의됩니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이 중에서 x는 미디어 비용을 나타내고, λ는 포화 곡선의 가파르기를 제어한다. 즉, 미디어 비용 효과가 얼마나 빨리 포화되는지를 결정한다. 그러면 낮은 λ 값은 응답 함수의 증가가 점진적이라고 해석할 수 있으며, 미디어 비용이 넓은 범위의 값들에 대해 주목할 만한 효과를 갖는다는 것을 의미한다. 반대로, 높은 λ 값은 지출에 대한 감소된 수익을 가져올 것이다. Figure 4는 이러한 다른 행동들을 매우 명확히 보여줍니다.\n\n이 모델에 어떤 매개변수를 사용해야 하는지 알기가 어렵습니다. 왜냐하면 이는 각 채널의 행동에 매우 구체적이기 때문입니다. 그럼에도 불구하고, Bayesian 접근 방식에서 이러한 매개변수는 사전 분포를 사용하여 추정됩니다. 따라서, 모델은 주어진 데이터에 대해 가능한 가치 매개변수를 선택합니다. 따라서, 우리는 단일 값이 아닌 분포를 설정해야 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 캐리오버와 형태 효과 결합\n\n이전 두 섹션에서 언급했듯이 캐리오버와 형태 효과를 모델링하려면 각 채널의 미디어 비용에 변환을 적용해야 합니다. 어떤 변환을 먼저 적용해야 하는지에 대한 질문이 제기됩니다. 저자들은 다음을 제안합니다:\n\n- 미디어 비용이 특정 기간에 집중적으로 소비된다면 형태 효과는 캐리오버에 따릅니다.\n- 미디어 비용이 여러 시간대에 고르게 분산된다면 캐리오버는 형태 효과에 따릅니다.\n\n기관들은 일반적으로 마케팅 활동을 집중하기 때문에 가장 흔한 접근 방식은 캐리오버 → 형태 효과의 결합입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이에 따라 t주차의 종속 변수인 매출 y는 미디어 비용 및 제어 변수의 선형 결합을 통해 모델링될 수 있습니다. 또한 회귀 계수 β를 사용하여 각 미디어 채널에 대한 다른 효과를 모델링합니다.\n\n![image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_10.png)\n\n여기서 𝛂는 y절편입니다. 함수 f(xm,t)는 광고재고(지속성) 및 포화 효과를 고려한 대상 변수에 대한 미디어의 기여를 인코딩합니다. γc는 제어 변수 Zt,c의 효과이며, et는 백색 잡음입니다.\n\n# 베이지안 모델\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n베이지안 접근법은 모델 매개변수에 대한 사전 분포를 정의하는 것으로 시작하여, 데이터를 고려하기 전의 초기 신념을 반영합니다. 새로운 데이터가 도입되면 모수가 주어졌을 때 데이터를 관찰할 확률을 나타내는 우도 함수가 계산됩니다. 이 문맥에서 데이터에는 미디어 채널 X와 종속 변수 y를 설명하는 제어 변수 Z가 포함됩니다. 베이즈 정리를 사용하여 사후 분포는 사전 분포와 우도 함수를 결합하여 얻어집니다.\n\n저자들은 각 미디어 채널(X)과 제어 변수(Z)의 매개변수 값을 선택하는데 샘플링 효율성 때문에 Gibbs Sampling[4]에 의존합니다.\n\n![이미지](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_11.png)\n\n데이터가 강력한 정보를 함유하고 명확한 패턴을 가질 때 모델은 매개변수를 추정할 때 사전 분포에 더 적게 의존한다는 것을 기억해 주세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n하지만, 저자들은 각 매개변수에 대한 사전 분포를 정의하는 방법에 대한 일부 지침을 남겼습니다:\n\n- 유지율 (α)은 [0, 1[으로 제한되어 있으며, beta나 균일 분포와 같이 [0, 1[에 대해 정의된 사전을 가져야 합니다.\n\n![이미지](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_12.png)\n\n- 지연 매개변수 (θ)는 일반적으로 [0, L-1]에 제한되어 있으며, 균일 분포나 스케일링된 베타 분포와 같은 사전을 가져야 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_13.png)\n\n- Gamma (γ) and Intercept are usually modeled by a normal distribution.\n\n![image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_14.png)\n\n- Lambda (λ) is usually modeled by a gamma distribution.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_15.png\" /\u003e\n\n- 회귀 계수 (β)는 일반적으로 미디어 소비가 y에 부정적인 영향을 미치지 않기 때문에 정규 분포와 같은 양수 우선 순위로 모델링됩니다.\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_16.png\" /\u003e\n\n# PyMC를 활용한 베이지안 미디어 믹스 모델링\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n해당 섹션은 카글의 공개 데이터셋을 활용하여 CC0 라이선스로 Bayesian 모델을 구현했습니다. 이 데이터셋은 세 가지 다른 미디어 채널(TV, 라디오, 신문)에 대한 지출 및 동일 기간의 판매에 대한 정보를 포함하고 있습니다.\n\n데이터셋은 다음과 같이 구성되어 있습니다:\n\n- ID — 행을 식별합니다.\n- TV 광고 예산($) — TV에 대한 광고 지출;\n- 라디오 광고 예산($) — 라디오에 대한 광고 지출;\n- 신문 광고 예산($) — 신문에 대한 광고 지출;\n- 판매($) — 목표 변수입니다.\n\n적합된 Bayesian 모델은 각 채널별 ROAS, 유지율 및 포화 효과를 계산하는 데 도움이 될 것입니다. 또한 미래 주차를 위한 예산 할당을 최적화하는 데도 도움이 될 것입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n모형의 신뢰성을 측정하기 위해 각 매체 채널의 지출과 제어 변수에 기반하여 보이지 않는 데이터에서 종속 변수를 얼마나 잘 모델링할 수 있는지를 평가할 것입니다. 우리는 평균 절대 오차 (MAE)와 같은 회귀 지표를 활용할 것입니다. 벤치마킹 측면에서, 항상 훈련 데이터의 평균 값으로 예측하는 단순 모형을 사용합니다. 그런데, MMM이 없을 때 기업들이 종종 이를 의존합니다.\n\n먼저 라이브러리를 가져오겠습니다:\n\n```js\n%matplotlib inline\n%load_ext autoreload\n%autoreload 2\nimport arviz as az\nimport datetime\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport utils\nfrom pymc_marketing.mmm.delayed_saturated_mmm import DelayedSaturatedMMM\nfrom sklearn.metrics import mean_absolute_error\n```\n\n그런 다음 데이터셋을 로드하고 일부 기본 전처리 작업을 수행합니다. 열 이름을 간소화하고 ID를 기반으로 새로운 날짜 열을 추가했습니다. 계절성 및 추세와 같은 제어 변수로 데이터셋을 보강하는 데 도움이 됩니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```python\n# 데이터 로드 및 열 이름 변경\ndf = pd.read_csv('data/data.csv')\ndf = df.rename(columns={'Unnamed: 0': 'id', 'TV Ad Budget ($)':'tv', 'Radio Ad Budget ($)': 'radio', 'Newspaper Ad Budget ($)': 'newspaper', 'Sales ($)': 'sales'})\n\n# 날짜 열 생성\ndf['ds'] = df['id'].apply(lambda x: pd.to_datetime(\"2024-02-26\")-datetime.timedelta(weeks=len(df)-x))\n```\n\n그 후에는 데이터 내 상관 관계를 이해하기 위한 탐색적 데이터 분석을 수행합니다:\n\n1. 종속 변수와 각 매체 채널 간의 상관 관계를 평가합니다.\n\n- TV는 판매와 가장 크게 관련된 특성이며, Newspaper는 가장 낮은 상관 관계를 갖고 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```python\ncorr_matrix = df[['sales', 'tv', 'radio', 'newspaper']].corr()\nsns.heatmap(corr_matrix, annot=True, cmap='Blues')\nplt.show()\n```\n\n2. 판매량과 각 매체 채널 간의 상관 관계를 평가하기 위해 판매량 대 매체 채널을 그래픽으로 나타냅니다:\n\n- 판매량에는 명확한 추세나 계절성이 없습니다.\n- TV 광고의 영향은 판매에 즉각적인 영향을 미칩니다.\n- 라디오 광고의 영향도 판매에 즉각적인 영향을 미칩니다. 예를 들어, TV 광고가 낮은 값을 가졌던 2022년 1~3주에는 판매량이 급등하는데, 이는 라디오의 급등과 일치합니다.\n- 신문 광고의 영향은 1~2주의 지연이 있는 것으로 보이지만, TV와 라디오 광고가 동시에 진행되었기 때문에 정확히 파악하기 어렵습니다.\n\n```python\n# 판매량만\nutils.line_plot(df.copy(), ['sales'], '시간에 따른 판매')\n\n# 판매 대 TV 광고\nutils.line_plot(df.copy(), ['sales', 'tv'], '시간에 따른 판매 대 TV')\n\n# 판매 대 라디오 광고\nutils.line_plot(df.copy(), ['sales', 'radio'], '시간에 따른 판매 대 라디오')\n\n# 판매 대 신문 광고\nutils.line_plot(df.copy(), ['sales', 'newspaper'], '시간에 따른 판매 대 신문')\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nEDA를 마무리했으니 모델링 부분을 준비할 차례입니다:\n\n1. 데이터를 훈련 및 테스트 세트로 나누는 작업을 시작하겠습니다:\n\n```js\ntrain_df = df.sort_values(by='ds').iloc[:-5,:]\ntest_df = df.sort_values(by='ds').iloc[-5:,:]\n```\n\n2. 이전에 생성한 주간 데이터를 사용하여 추세와 계절성과 같은 통제 변수를 추출하려고 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 시계열 모델 Prophet을 사용하여 Meta에서 시계열을 추세 및 계절성으로 분해하고 이를 제어 변수로 사용합니다.\n\n```js\nseasonality, trend = utils.extract_trend_seasonality(train_df, 'sales', 5)\ntrain_df.loc[:, 'seasonality'] = seasonality[:-5]\ntest_df.loc[:,'seasonality'] = seasonality[-5:]\ntrain_df.loc[:,'trend'] = trend[:-5]\ntest_df.loc[:,'trend'] = trend[-5:]\n```\n\n![Image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_17.png)\n\n3. 모델을 위한 다른 하이퍼파라미터를 설정합니다. 이러한 매개변수는 전통적인 ML 하이퍼파라미터 검색을 통해 정의할 수 있습니다. dist, mu 및 sigma 값을 변경하여 일부 회귀 지표를 최적화합니다. 더 높은 표준 편차 값(sigma)은 모델에 더 많은 자유를 제공하여 최적의 매개변수를 탐색할 수 있음을 기억하세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nmy_model_config = {'intercept': {'dist': 'Normal', 'kwargs': {'mu': 0, 'sigma': 2},\n 'beta_channel': {'dist': 'HalfNormal', 'kwargs': {'sigma': 2},\n 'alpha': {'dist': 'Beta', 'kwargs': {'alpha': 1, 'beta': 3},\n 'lam': {'dist': 'Gamma', 'kwargs': {'alpha': 3, 'beta': 1},\n 'likelihood': {'dist': 'Normal',\n  'kwargs': {'sigma': {'dist': 'HalfNormal', 'kwargs': {'sigma': 2}},\n 'gamma_control': {'dist': 'Normal', 'kwargs': {'mu': 0, 'sigma': 2},\n 'gamma_fourier': {'dist': 'Laplace', 'kwargs': {'mu': 0, 'b': 1}}}\n```\n\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_18.png\" /\u003e\n\nFigure 13에서 저희가 구현한 모델의 Kruschke 다이어그램을 제시합니다. 이는 이전에 정의한 내용에 대한 간결한 개요를 제공합니다. 이러한 다이어그램을 해석할 때 고려해야 할 몇 가지 측면이 있습니다. 각 노드 내에서 변수와 해당 분포를 찾을 수 있음을 유의하십시오. 예를 들어, α를 포함하는 원은 이전에 정의한 대로 베타 분포를 나타냅니다. 음영 처리된 노드는 관측된 변수를 나타냅니다. 둥근 모서리 상자는 반복을 나타냅니다. 예를 들어, 저희는 세 개의 확보 채널이 있으므로 각 채널에 대해 별도의 α, β 및 λ 매개변수 집합을 설정합니다. 화살표는 종속성을 보여줍니다. 저희 모델에서는 두 개의 화살표가 가능 함수를 가리키는데, 하나는 mu 매개변수에 종속성을 나타내고 다른 하나는 sigma 매개변수에 종속성을 나타냅니다. mu 매개변수 자체가 세 개의 추가 종속성을 가지고 있음을 상기해 주세요. 우리는 이동 효과, 모양 효과 및 제어 변수를 통합하여 매출을 모델링하기로 선택했음을 기억하세요.\n\n이제 우리는 교육 및 테스트 세트, 그리고 모델 구성을 정의했으므로 베이지안 모델을 초기화하고 교육 데이터에 맞출 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 미디어 채널 [\"tv\", \"radio\", \"newspaper\"]\n- 통제 변수 [\"seasonality\", \"trend\"]\n- EDA에서 광고주는 지연 매개변수로 최대 2까지 인 것으로 보입니다.\n\n```js\nmmm = DelayedSaturatedMMM(\n    model_config=my_model_config,\n    sampler_config={\"progressbar\": True},\n    date_column=\"ds\",\n    channel_columns=[\"tv\", \"radio\", \"newspaper\"],\n    control_columns=[\"seasonality\", \"trend\"],\n    adstock_max_lag=2,\n)\n\nmmm.fit(X=train_df[['ds', 'tv', 'radio', \"newspaper\", \"seasonality\", \"trend\"]], y=train_df['sales'], target_accept=0.95, chains=4, random_seed=42)\n```\n\n모델을 적합한 후에는 샘플링 예측값(파란색)과 실제 값(검은색)을 비교하여 학습 데이터에 얼마나 잘 맞는지 확인할 수 있습니다. 우리의 경우, 그들이 잘 일치하는 것을 확인할 수 있습니다.\n\n```js\nmmm.sample_posterior_predictive(train_df[['ds', 'tv', 'radio', \"newspaper\", \"seasonality\", \"trend\"]], extend_idata=True, combined=True)\nmmm.plot_posterior_predictive(original_scale=True);\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이제 다양한 방법으로 모델 해석을 시작할 수 있습니다:\n\n1. 파라미터 추정 확인:\n\n- 라디오는 계수(베타)가 가장 높으므로 투자 대비 가장 높은 수익을 보이는 것으로 보입니다(1.185), 그 다음에 TV와 신문이 이어집니다.\n- 유지율 α는 TV에 대해 3.2%, 라디오에 대해 2.3%, 신문에 대해 23.9%입니다.\n\n```js\naz.summary(data=mmm.fit_result,\n    var_names=[\n        \"intercept\",\n        \"likelihood_sigma\",\n        \"beta_channel\",\n        \"alpha\",\n        \"lam\",\n        \"gamma_control\",\n    ],\n)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- TV에서 포화율 λ가 더 높으며 (3.138), 전체 지출의 73%를 차지합니다. 그림 12에서 3개 채널의 포화율을 더 쉽게 비교할 수 있습니다.\n\n![Figure 12](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_19.png)\n\n2. 채널 기여 및 ROAS 확인:\n\n- ROAS는 매체 채널 중 하나의 지출을 제로로 설정하여 현재 매출 대비 예측 매출이 어떻게 변경되는지를 평가하여 계산됩니다. 예를 들어, 신문의 매체 지출을 제로로 설정하면 매출 큰 감소를 예상하지 않습니다. 따라서, 이에 대한 ROAS는 낮을 것입니다.\n- TV가 높은 지출을 했기 때문에 가장 큰 기여를 가지고 있지만, 모델은 라디오에 대해 더 높은 ROAS를 예측합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\n# 채널의 공헌도\nfig = mmm.plot_channel_contribution_share_hdi(figsize=(7, 5))\n\n# ROAS 계산\nutils.plot_ROAS(mmm, train_df, [\"tv\", \"radio\", \"newspaper\"])\r\n```\n\n3. 마지막으로, 각 채널별 광고비 지출을 50% 증가시킨다면 어떤 일이 일어날지도 평가할 수 있습니다. 이때는 캐리오버와 포화 효과를 고려합니다.\n\nX 축은 채널 데이터 백분율 수준입니다:\n\n- When =1 일 때, 모델 입력 지출 데이터가 됩니다.\n- When =1.5 일 때, 지출을 50% 증가시켰을 때의 공헌도가 어떨지 볼 수 있습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n신문은 지출이 50% 증가해도 그다지 많은 기여를 못 할 것 같아요. \n\n라디오는 TV에 비해 훨씬 포화되지 않아 보여요. 두 선의 기울기를 비교해 봤을 때 그렇죠.\n\n```js\nplt.rcParams[\"figure.figsize\"] = (20,5)\nmmm.plot_channel_contributions_grid(start=0, stop=1.5, num=12);\n```\n\n우리의 결론이 올바른지 확인하기 위해 시험 집합을 사용하여 미디어 채널과 제어 변수를 기반으로 미래 매출을 예측하는 모델의 성능을 평가할 수 있어요. 이를 위해 MAE를 사용하고 소박한 모델과 비교할 거에요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 우리는 평균 목표가 13.8인 경우 MAE가 2.01이었습니다.\n- 우리는 베이스라인보다 오차가 58% 낮습니다.\n\n```js\ny_out_of_sample = mmm.sample_posterior_predictive(X_pred=test_df[['ds', 'tv', 'radio', \"newspaper\", \"seasonality\", \"trend\"]], extend_idata=False)\ny_pred = [np.median(x) for x in y_out_of_sample['y']]\n\nprint(f\"평균 절대 오차 (MAE): {mean_absolute_error(test_df['sales'], y_pred)} (평균 목표: {test_df['sales'].mean()})\")\nprint(f\"평균 절대 비율 오차 (MASE): {mean_absolute_error(test_df['sales'], y_pred)/mean_absolute_error(test_df['sales'], [train_df['sales'].mean()]*5)}\")\n```\n\n회귀 결과는 모델이 매체 채널과 제어 변수를 기반으로 매출을 모델링하기에 신뢰할만하고 잘 한다는 것을 보여줍니다.\n\n# 예산 할당\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n판매에 대한 지출 효과가 선형적이지 않을 것으로 가정하기 때문에 어느 시점에서 포화될 것으로 예상됩니다. 따라서, 우리는 어떤 포화 함수가 우리의 데이터와 더 잘 맞는지 결정해야 합니다. 포화 모델링을 위한 두 가지 함수 옵션이 있습니다:\n\n- α(alpha)가 포화 지점인 시그모이드 함수, 즉 지출 증가가 판매 증가로 이어지지 않고, λ(lambda)는 곡선의 기울기를 제어하는 요인입니다. 더 높은 값은 곡선을 더 가파르게 만듭니다.\n\n![이미지](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_20.png)\n\n- 알파(alpha)가 채널이 가질 수 있는 최대 기여도인 Michaelis-Menten 함수이며, 람다(lambda)는 곡선이 방향을 조정하는 순간, 즉 기울기입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_21.png)\n\n저희 데이터에 더 적합한 곡선을 결정하기 위해, 적합된 MMM을 사용하여 각 함수의 매개변수를 계산할 것입니다. 그 후 두 가지를 모두 플롯하고 시각적으로 어느 것이 더 적합한지 확인할 것입니다.\n\n- 특정 사용 사례에서, 시그모이드 함수가 더 나은 결과를 보였습니다.\n\n```js\n# 플롯 및 알파, 람다 추출\nsigmoid_response_curve_fig = mmm.plot_direct_contribution_curves(show_fit=True)\nsigmoid_params = mmm.compute_channel_curve_optimization_parameters_original_scale(method='sigmoid')\n\nmm_response_curve_fig = mmm.plot_direct_contribution_curves(show_fit=True, method='michaelis-menten')\nmm_params = mmm.compute_channel_curve_optimization_parameters_original_scale(method='michaelis-menten')\n``` \n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이제 각 미디어 채널의 시그모이드 매개변수(α 및 λ)가 있으므로 각 채널의 포화점을 알 수 있습니다. 따라서 추가 지출은 수익을 증가시키지 않을 것이며, 다른 채널에 투자된 금액은 원하는 효과를 얻을 수 있습니다.\n\n채널 포화도를 기반으로 한 예산 할당을 최적화하기 위한 알고리즘을 사용할 수 있습니다. 이 때 고려해야 할 세 가지 변수는 채널 포화도, 사용 가능한 총 예산 및 각 채널의 예산 제약 사항입니다. PyMC에는 Sequential Least Squares Quadratic Programming (SLSQP)을 구현한 것이 있습니다. 이는 세 가지 변수를 고려하여 모든 채널에서 총 기여도를 최대화합니다:\n\n- 총 예산 제한;\n- 각 채널의 최소 및 최대 지출 한도;\n- 포화 곡선.\n\n```python\nresult_sigmoid = mmm.optimize_channel_budget_for_maximum_contribution(\n    method='sigmoid', # 포화 함수를 정의\n    total_budget=500, # 총 예산\n    parameters=sigmoid_params, # 이전에 추출한 시그모이드 매개변수\n    budget_bounds={'tv': [75, 296], 'radio': [10, 300], 'newspaper': [1, 25]} # 채널별 예산 제약 사항\n)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n![image](/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_22.png)\n\n표 4는 우리의 예산 배정 결과를 보여줍니다. 라디오는 추정 기여도가 가장 높은 채널이며, TV는 가장 높은 예산을 쓰도록 권장받은 채널입니다.\n\n# 시장 불확실성 하의 예산 배정\n\n현재 경제 상황에서 많은 불확실성을 겪고 있습니다. 따라서, 다양한 시나리오를 수용할 수 있는 예산 배정 전략을 설계해야 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n세 가지 다른 시나리오를 고려해 봅시다:\n\n- 초기: 경제가 안정 상태를 유지하며, 예산 할당은 이전 섹션에서 계산된 것과 동일합니다.\n- 시나리오 2: 경제가 경기 침체를 겪고 예산이 40% 삭감됩니다.\n- 시나리오 3: 경제가 유리해지고 성장을 시작하며, 예산이 20% 증가합니다.\n\n이러한 다른 시나리오에서 예산 할당을 최적화하기 위해 동일한 적합된 MMM 모델과 모델의 시그모이드 매개변수를 사용할 것입니다. 같은 코드를 사용하지만 이번에는 사용 가능한 예산을 줄이거나 증가시키기 위해 다른 시나리오를 반복할 것입니다.\n\n```js\nscenarios_result = []\ntotal_budget = 500\nchannels = ['tv', 'radio', 'newspaper']\n\nfor scenario in np.array([0.6, 1.2]):\n    scenarios_result.append(\n        mmm.optimize_channel_budget_for_maximum_contribution(\n            method=\"sigmoid\",  # 포화 함수 정의\n            total_budget=total_budget * scenario,\n            parameters=sigmoid_params,\n            budget_bounds={\n                channel: [1, total_budget * scenario] for channel in channels\n            },\n        ).to_dict()\n    )\n_ = mmm.plot_budget_scenearios(\n    base_data=result_sigmoid, method=\"sigmoid\", scenarios_data=scenarios_result\n)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n그림 19에서 보듯이, 경제 불황 시나리오에서 TV에 할당된 예산은 초기 시나리오와 비교했을 때 라디오보다 크게 감소합니다. 이는 라디오의 ROAS가 높기 때문에 예상되는 현상입니다. 반면, 성장 시나리오에서는 TV와 라디오에 할당된 예산이 유사하게 증가합니다.\n\n# 결론\n\n미디어믹스 모델링을 위한 AI는 투자에서 긍정적인 수익을 창출하고 가치 있는 충성고객을 확보하는 차이를 만들어줄 수 있습니다. 또는 잘못된 미디어 채널과 잘못된 고객에게 금전적 자원을 낭비하는 것 사이의 차이를 만들어줄 수도 있습니다.\n\n본 문서에서는 각 회사의 미디어 채널이 새로운 고객을 확보할 수 있는 잠재력을 더 자세히 평가하고 투명성을 제공할 수 있는 마케팅 믹스 모델링을 위한 베이지안 프레임워크를 개발했습니다. 우리의 접근 방식은 마케팅팀의 도메인 지식을 사전 분포를 설정함으로써 통합할 수 있습니다. 이는 모델의 능력을 향상시키고 미디어 채널과 관심 변수(예: 판매) 간의 관계를 이해하는데 도움이 됩니다. 마지막으로, 회사가 새로운 고객을 확보하기 위해 투자할 능력에 따라 예산 할당 전략을 최적화할 수 있습니다. 현재의 거시 경제 상황에서 기업은 수익성으로 돌아갈 수 있으며 성장에 투자할 예산을 줄일 수 있습니다. 우리는 영향을 최소화하면서 어디서 예산을 삭감할지에 대한 데이터 기반 의사결정 방법을 보여주었습니다. 반대로, 상황이 긍정적일 때 어디에 투자할지와 회사가 더 빨리 성장하기 위해 더 많은 자원을 투입하려는 경우 어디에 투자할지를 보여주었습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n우리는 현재 기관들에 새로운 AI 애플리케이션을 개발하고 배포하고 있어요. 예를 들어, 우리는 생성 모델 AI로 고객 경험을 향상시키고 시계열 예측으로 계획 프로세스를 개선하고 있어요. 이 경우에는 AI가 마케팅 예산의 효율성을 향상시킬 수 있는 방법을 보여주고 있어요. 우리의 경험에 따르면, AI 채택 측면에서 선진적이고 성숙한 기관은 핵심 활동에 중점을 둔 특화된 AI 모델 스위트가 필요해요.\n\n# 나에 대해\n\nAI 분야의 시리얼 창업가이자 리더에요. 비즈니스를 위한 AI 제품을 개발하고 AI 중심의 스타트업에 투자하고 있어요.\n\nZAAI 설립자 | LinkedIn | X/Twitter\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 참고문헌\n\n[1] Yuxue Jin, Yueqing Wang, Yunting Sun, David Chan, Jim Koehler. (2017). Bayesian Methods for Media Mix Modeling with Carryover and Shape Effects.\n\n[2] Dominique M. Hanssens , Leonard J. Parsons , Randall L. Schultz. (2003). Market response models: econometric and time series analysis. Springer Science \u0026 Business Media.\n\n[3] Hill, A. V. (1910). 혈색소 분자의 집단화가 분리 곡선에 미치는 가능한 영향. Journal of Physiology, 40 (suppl), iv–vii. doi:10.1113/jphysiol.1910. sp001386.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n[4] Gelfand, A. E. \u0026 Smith, A. F. (1990). Sampling-based approaches to calculating marginal densities. Journal of the American statistical association, 85 (410), 398–409\n\n---\n\n모든 이미지는 저자의 작품이며, 다르게 표기되지 않았습니다.","ogImage":{"url":"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_0.png"},"coverImage":"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_0.png","tag":["Tech"],"readingTime":20},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e이 게시물은 Rafael Guedes와 함께 공동 저술되었습니다.\u003c/p\u003e\n\u003ch1\u003e소개\u003c/h1\u003e\n\u003cp\u003e확장 가능한 인터넷 비즈니스는 성장을 이끌기 위해 마케팅에 의존합니다. 물론 그것뿐만이 아니라 특정 규모에서는 매우 효율적으로 고객을 확보하지 않을 수 없는 회사가 매우 적습니다. 기업들이 마케팅에 인공지능(AI) 능력을 가져오기 위해 많이 투자하고 있는 두 가지 핫한 주제는 미디어 믹스 모델링(MMM)과 고객 평생 가치(LTV) 예측입니다. 이 두 가지는 기업들이 마케팅에 투자하는 비용 대비 이익을 증가시키는 데 초점을 맞추고 있습니다. 이 글은 MMM이 무엇인지와 적용하는 데 가장 효과적인 방법에 대해 다루고 있습니다.\u003c/p\u003e\n\u003cp\u003eMMM은 마케팅 팀이 투자의 영향과 대화 유도에 어떻게 기여하는지를 측정할 수 있는 기술입니다. 이 일의 복잡성은 최근 몇 년 동안 급속히 증가했습니다. 왜냐하면 광고를 할 수 있는 플랫폼이 급증했기 때문입니다. 이 현상은 잠재 고객을 오프라인 또는 온라인 버킷으로 나눌 수 있는 다양한 미디어 채널에 분산시켰습니다. 전통적인 오프라인 채널은 디지털 지원이 없으며 신문, 라디오, 텔레비전 광고, 쿠폰, 박람회 부스 등을 포함할 수 있습니다. 온라인 채널은 급증했고 기업들은 이러한 채널을 함께 사용하고 있습니다. 이메일, 소셜 미디어, 유기적 검색, 유료 검색, 제휴 마케팅, 인플루언서 마케팅 등을 사용합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e중요한 점 중 하나는 좋은 MMM이 동일하게 정확한 데이터 기반 속성 모델이 필요하다는 것입니다. 즉, 어떤 채널이 특정 고객을 확보하는 데 기여했는지를 나타냅니다. 또한 속성은 사용자 수준에서 수행되지만, MMM은 일반적으로 확보 채널 수준에서 적용됩니다. 데이터 기반 속성은 이 글의 범위를 벗어납니다.\u003c/p\u003e\n\u003cp\u003e이 글에서는 두 가지에 초점을 맞춥니다. 첫째, 각 미디어 채널의 성능에 대한 투명성을 높이기 위해 설계된 베이지안 모델을 개발합니다. 둘째, 이 경우 수익이라는 변수를 최대화하기 위해 예산 할당을 최적화합니다. 베이지안 접근 방식이 MMM에 어떻게 작용하는지에 대한 상세한 내용을 제공하는 동시에 공개 데이터셋을 활용하여 모델의 정확성을 테스트하고 각 채널의 광고비 투자 대비 수익률(ROAS)을 계산합니다. 마지막으로, 수익을 극대화하기 위해 세 가지 채널 간의 가상 예산을 최적화합니다.\u003c/p\u003e\n\u003cp\u003e항상 코드는 우리의 GitHub에서 이용할 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e미디어 믹스 모델링: 무엇인가요?\u003c/h1\u003e\n\u003cp\u003eMMM은 전 세계 기업들에게 광고 채널의 효과를 측정하고 미디어 비용이 매출에 미치는 영향에 대한 투명성을 제공하여 조직을 강화합니다. 이러한 모델은 매출, 광고 지출 대비 수익 (ROAS), 수익, 전환, LTV 등의 관심 대상 대상 변수를 최적화하여 채널 간 예산 할당 결정 프로세스를 지원하는 데 중요한 역할을 합니다.\u003c/p\u003e\n\u003cp\u003e지난 몇 년 동안 많은 연구가 수행되었으며, 관심 대상 변수에 영향을 미치는 지출을 모델링하기 위해 여러 모델이 제안되었습니다. 이러한 모델은 지리적으로 집계된 주간 또는 월간 데이터에 기반합니다. 우리는 의존 변수(위에서 정의한 관심 대상 변수 중 하나 이상)와 독립 변수 간의 관계를 모델링하는 데 관심이 있습니다. 일부 독립 변수는 명백합니다. 예를 들어 광고 채널 별 광고 비용이 그렇습니다. 그러나 가격, 제품 유통, 인플레이션, 날씨, 계절성 및 시장 경쟁력과 같은 추가 관련 효과를 포함하여 접근 방식을 확장할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e전통적인 접근 방식은 회귀 방법을 활용하여 상관 관계에서 인과 관계를 추론합니다. 그러나 매출의 반응은 선형적이지 않습니다 - 고수준 지출에서 수익이 감소하는 포화 현상이 있습니다. 게다가 광고에는 선행 또는 잔류 효과가 있어 이전 주에 지출한 내용이 다음 주의 매출에 영향을 미칠 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_1.png\"\u003e\n\u003ch1\u003e미디어 믹스 모델의 베이지안 방법론\u003c/h1\u003e\n\u003cp\u003e베이지안 방법론은 포화/형태와 래그/캐리오버 효과를 고려하기 위해 정의될 수 있습니다.\u003c/p\u003e\n\u003cp\u003e모델 세부사항에 대해 깊이 파고들기 전에, 모델이 어떤 변수를 고려하는지 더 잘 이해하기 위해 가상의 데이터 세트를 정의해보겠습니다. 국가 수준에서 매주 데이터가 있으며 각 행이 주차(t)를 나타내고 각 열이 미디어 채널(m) 또는 계절성 또는 제품 가격과 같은 제어 변수(c)를 나타내는 가정 데이터 세트를 정의해보겠습니다. 주차 t에서 채널 m의 미디어 비용은 Xt,m로 정의되며 동일한 주차에 대한 제어 변수는 Zt,c로 정의됩니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_2.png\"\u003e\n\u003ch1\u003e랙 또는 캐리오버 효과\u003c/h1\u003e\n\u003cp\u003e캐리오버 효과는 adstock라는 함수에 의해 모델링됩니다 [1]. 이 함수는 특정 채널에서 지출의 누적 효과를 만듭니다. 이 함수는 현재 주와 이전 L-1 주의 미디어 비용을 가중 평균을 통해 변환합니다. L은 특정 미디어 채널의 캐리오버 효과의 최대 기간이며, 가중 평균 방정식에서 가중치 Wm를 추정하는 데 중요한 역할을 합니다.\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_3.png\"\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e미디어 채널마다 L을 다르게 설정할 수 있습니다. 이것은 전문가가 정의해야 하는 초매개변수입니다. 특정 채널에 대한 사전 정보가 없는 경우, 저자들은 잠재적으로 지연된 효과를 포착하기 위해 L을 13과 같은 큰 숫자로 설정하는 것이 좋다고 충고합니다.\u003c/p\u003e\n\u003cp\u003e가중치를 정의하는 방정식은 두 가지 다른 형태를 가질 수 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e즉각적인/Geometric Adstock [2]는 광고 효과 피크가 광고 노출과 동시에 발생할 때 사용됩니다. 즉, 우리가 특정 미디어 채널의 지출을 늘린 주에 매출이 최대치를 기록한 경우입니다. 방정식 2에서 αm은 광고 효과의 유지율입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_4.png\" alt=\"equation\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e광고 효과의 정점이 더 오랜 시간이 걸려 구축되고 판매에 즉시 영향을 주지 않는 경우를 지연된 Adstock [1]라고합니다. 식 3에서 θm은 정점 효과의 지연을 나타냅니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_5.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e이제 상상 속 데이터셋을 선택하고 Facebook 채널의 즉각적 및 지연 Adstock를 계산해 보겠습니다. 먼저 데이터셋에 5주를 추가했습니다. 보존율(αm)은 80%이며, 정점 지연(θm)은 5주입니다. 이후 즉각적인 효과에 대한 가중치와 지연된 효과에 대한 가중치를 계산하여 8주차에서 즉각 및 지연 Adstock의 최종값에 도달합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_6.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e표 3는 각 주별 지출이 8주차의 매출량에 얼마나 기여하는지를 보여줍니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_7.png\" alt=\"Figure 3\"\u003e\u003c/p\u003e\n\u003ch1\u003e포화 또는 모양 효과\u003c/h1\u003e\n\u003cp\u003e포화 또는 모양 효과는 미디어 비용을 로지스틱 포화 함수 [3]와 같은 곡률 함수를 통해 변환하여 모델링합니다. 다음과 같이 정의됩니다:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이 중에서 x는 미디어 비용을 나타내고, λ는 포화 곡선의 가파르기를 제어한다. 즉, 미디어 비용 효과가 얼마나 빨리 포화되는지를 결정한다. 그러면 낮은 λ 값은 응답 함수의 증가가 점진적이라고 해석할 수 있으며, 미디어 비용이 넓은 범위의 값들에 대해 주목할 만한 효과를 갖는다는 것을 의미한다. 반대로, 높은 λ 값은 지출에 대한 감소된 수익을 가져올 것이다. Figure 4는 이러한 다른 행동들을 매우 명확히 보여줍니다.\u003c/p\u003e\n\u003cp\u003e이 모델에 어떤 매개변수를 사용해야 하는지 알기가 어렵습니다. 왜냐하면 이는 각 채널의 행동에 매우 구체적이기 때문입니다. 그럼에도 불구하고, Bayesian 접근 방식에서 이러한 매개변수는 사전 분포를 사용하여 추정됩니다. 따라서, 모델은 주어진 데이터에 대해 가능한 가치 매개변수를 선택합니다. 따라서, 우리는 단일 값이 아닌 분포를 설정해야 합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e캐리오버와 형태 효과 결합\u003c/h1\u003e\n\u003cp\u003e이전 두 섹션에서 언급했듯이 캐리오버와 형태 효과를 모델링하려면 각 채널의 미디어 비용에 변환을 적용해야 합니다. 어떤 변환을 먼저 적용해야 하는지에 대한 질문이 제기됩니다. 저자들은 다음을 제안합니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e미디어 비용이 특정 기간에 집중적으로 소비된다면 형태 효과는 캐리오버에 따릅니다.\u003c/li\u003e\n\u003cli\u003e미디어 비용이 여러 시간대에 고르게 분산된다면 캐리오버는 형태 효과에 따릅니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e기관들은 일반적으로 마케팅 활동을 집중하기 때문에 가장 흔한 접근 방식은 캐리오버 → 형태 효과의 결합입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이에 따라 t주차의 종속 변수인 매출 y는 미디어 비용 및 제어 변수의 선형 결합을 통해 모델링될 수 있습니다. 또한 회귀 계수 β를 사용하여 각 미디어 채널에 대한 다른 효과를 모델링합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_10.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e여기서 𝛂는 y절편입니다. 함수 f(xm,t)는 광고재고(지속성) 및 포화 효과를 고려한 대상 변수에 대한 미디어의 기여를 인코딩합니다. γc는 제어 변수 Zt,c의 효과이며, et는 백색 잡음입니다.\u003c/p\u003e\n\u003ch1\u003e베이지안 모델\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e베이지안 접근법은 모델 매개변수에 대한 사전 분포를 정의하는 것으로 시작하여, 데이터를 고려하기 전의 초기 신념을 반영합니다. 새로운 데이터가 도입되면 모수가 주어졌을 때 데이터를 관찰할 확률을 나타내는 우도 함수가 계산됩니다. 이 문맥에서 데이터에는 미디어 채널 X와 종속 변수 y를 설명하는 제어 변수 Z가 포함됩니다. 베이즈 정리를 사용하여 사후 분포는 사전 분포와 우도 함수를 결합하여 얻어집니다.\u003c/p\u003e\n\u003cp\u003e저자들은 각 미디어 채널(X)과 제어 변수(Z)의 매개변수 값을 선택하는데 샘플링 효율성 때문에 Gibbs Sampling[4]에 의존합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_11.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e데이터가 강력한 정보를 함유하고 명확한 패턴을 가질 때 모델은 매개변수를 추정할 때 사전 분포에 더 적게 의존한다는 것을 기억해 주세요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e하지만, 저자들은 각 매개변수에 대한 사전 분포를 정의하는 방법에 대한 일부 지침을 남겼습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e유지율 (α)은 [0, 1[으로 제한되어 있으며, beta나 균일 분포와 같이 [0, 1[에 대해 정의된 사전을 가져야 합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_12.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e지연 매개변수 (θ)는 일반적으로 [0, L-1]에 제한되어 있으며, 균일 분포나 스케일링된 베타 분포와 같은 사전을 가져야 합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_13.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGamma (γ) and Intercept are usually modeled by a normal distribution.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_14.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLambda (λ) is usually modeled by a gamma distribution.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_15.png\"\u003e\n\u003cul\u003e\n\u003cli\u003e회귀 계수 (β)는 일반적으로 미디어 소비가 y에 부정적인 영향을 미치지 않기 때문에 정규 분포와 같은 양수 우선 순위로 모델링됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_16.png\"\u003e\n\u003ch1\u003ePyMC를 활용한 베이지안 미디어 믹스 모델링\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e해당 섹션은 카글의 공개 데이터셋을 활용하여 CC0 라이선스로 Bayesian 모델을 구현했습니다. 이 데이터셋은 세 가지 다른 미디어 채널(TV, 라디오, 신문)에 대한 지출 및 동일 기간의 판매에 대한 정보를 포함하고 있습니다.\u003c/p\u003e\n\u003cp\u003e데이터셋은 다음과 같이 구성되어 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eID — 행을 식별합니다.\u003c/li\u003e\n\u003cli\u003eTV 광고 예산($) — TV에 대한 광고 지출;\u003c/li\u003e\n\u003cli\u003e라디오 광고 예산($) — 라디오에 대한 광고 지출;\u003c/li\u003e\n\u003cli\u003e신문 광고 예산($) — 신문에 대한 광고 지출;\u003c/li\u003e\n\u003cli\u003e판매($) — 목표 변수입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e적합된 Bayesian 모델은 각 채널별 ROAS, 유지율 및 포화 효과를 계산하는 데 도움이 될 것입니다. 또한 미래 주차를 위한 예산 할당을 최적화하는 데도 도움이 될 것입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e모형의 신뢰성을 측정하기 위해 각 매체 채널의 지출과 제어 변수에 기반하여 보이지 않는 데이터에서 종속 변수를 얼마나 잘 모델링할 수 있는지를 평가할 것입니다. 우리는 평균 절대 오차 (MAE)와 같은 회귀 지표를 활용할 것입니다. 벤치마킹 측면에서, 항상 훈련 데이터의 평균 값으로 예측하는 단순 모형을 사용합니다. 그런데, MMM이 없을 때 기업들이 종종 이를 의존합니다.\u003c/p\u003e\n\u003cp\u003e먼저 라이브러리를 가져오겠습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e%matplotlib inline\n%load_ext autoreload\n%autoreload \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e arviz \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e az\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e seaborn \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e sns\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e matplotlib.\u003cspan class=\"hljs-property\"\u003epyplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e plt\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e numpy \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e np\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e utils\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pymc_marketing.\u003cspan class=\"hljs-property\"\u003emmm\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edelayed_saturated_mmm\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDelayedSaturatedMMM\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.\u003cspan class=\"hljs-property\"\u003emetrics\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e mean_absolute_error\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그런 다음 데이터셋을 로드하고 일부 기본 전처리 작업을 수행합니다. 열 이름을 간소화하고 ID를 기반으로 새로운 날짜 열을 추가했습니다. 계절성 및 추세와 같은 제어 변수로 데이터셋을 보강하는 데 도움이 됩니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 데이터 로드 및 열 이름 변경\u003c/span\u003e\ndf = pd.read_csv(\u003cspan class=\"hljs-string\"\u003e'data/data.csv'\u003c/span\u003e)\ndf = df.rename(columns={\u003cspan class=\"hljs-string\"\u003e'Unnamed: 0'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'TV Ad Budget ($)'\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Radio Ad Budget ($)'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Newspaper Ad Budget ($)'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'newspaper'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Sales ($)'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e})\n\n\u003cspan class=\"hljs-comment\"\u003e# 날짜 열 생성\u003c/span\u003e\ndf[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e] = df[\u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e].apply(\u003cspan class=\"hljs-keyword\"\u003elambda\u003c/span\u003e x: pd.to_datetime(\u003cspan class=\"hljs-string\"\u003e\"2024-02-26\"\u003c/span\u003e)-datetime.timedelta(weeks=\u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(df)-x))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 후에는 데이터 내 상관 관계를 이해하기 위한 탐색적 데이터 분석을 수행합니다:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e종속 변수와 각 매체 채널 간의 상관 관계를 평가합니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eTV는 판매와 가장 크게 관련된 특성이며, Newspaper는 가장 낮은 상관 관계를 갖고 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecorr_matrix = df[[\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'newspaper'\u003c/span\u003e]].corr()\nsns.heatmap(corr_matrix, annot=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e, cmap=\u003cspan class=\"hljs-string\"\u003e'Blues'\u003c/span\u003e)\nplt.show()\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e판매량과 각 매체 채널 간의 상관 관계를 평가하기 위해 판매량 대 매체 채널을 그래픽으로 나타냅니다:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e판매량에는 명확한 추세나 계절성이 없습니다.\u003c/li\u003e\n\u003cli\u003eTV 광고의 영향은 판매에 즉각적인 영향을 미칩니다.\u003c/li\u003e\n\u003cli\u003e라디오 광고의 영향도 판매에 즉각적인 영향을 미칩니다. 예를 들어, TV 광고가 낮은 값을 가졌던 2022년 1~3주에는 판매량이 급등하는데, 이는 라디오의 급등과 일치합니다.\u003c/li\u003e\n\u003cli\u003e신문 광고의 영향은 1~2주의 지연이 있는 것으로 보이지만, TV와 라디오 광고가 동시에 진행되었기 때문에 정확히 파악하기 어렵습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 판매량만\u003c/span\u003e\nutils.line_plot(df.copy(), [\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'시간에 따른 판매'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# 판매 대 TV 광고\u003c/span\u003e\nutils.line_plot(df.copy(), [\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'시간에 따른 판매 대 TV'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# 판매 대 라디오 광고\u003c/span\u003e\nutils.line_plot(df.copy(), [\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'시간에 따른 판매 대 라디오'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# 판매 대 신문 광고\u003c/span\u003e\nutils.line_plot(df.copy(), [\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'newspaper'\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'시간에 따른 판매 대 신문'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eEDA를 마무리했으니 모델링 부분을 준비할 차례입니다:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e데이터를 훈련 및 테스트 세트로 나누는 작업을 시작하겠습니다:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003etrain_df = df.\u003cspan class=\"hljs-title function_\"\u003esort_values\u003c/span\u003e(by=\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e).\u003cspan class=\"hljs-property\"\u003eiloc\u003c/span\u003e[:-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,:]\ntest_df = df.\u003cspan class=\"hljs-title function_\"\u003esort_values\u003c/span\u003e(by=\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e).\u003cspan class=\"hljs-property\"\u003eiloc\u003c/span\u003e[-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e:,:]\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e이전에 생성한 주간 데이터를 사용하여 추세와 계절성과 같은 통제 변수를 추출하려고 합니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e시계열 모델 Prophet을 사용하여 Meta에서 시계열을 추세 및 계절성으로 분해하고 이를 제어 변수로 사용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eseasonality, trend = utils.\u003cspan class=\"hljs-title function_\"\u003eextract_trend_seasonality\u003c/span\u003e(train_df, \u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\ntrain_df.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:, \u003cspan class=\"hljs-string\"\u003e'seasonality'\u003c/span\u003e] = seasonality[:-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e]\ntest_df.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:,\u003cspan class=\"hljs-string\"\u003e'seasonality'\u003c/span\u003e] = seasonality[-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e:]\ntrain_df.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:,\u003cspan class=\"hljs-string\"\u003e'trend'\u003c/span\u003e] = trend[:-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e]\ntest_df.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[:,\u003cspan class=\"hljs-string\"\u003e'trend'\u003c/span\u003e] = trend[-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e:]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_17.png\" alt=\"Image\"\u003e\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e모델을 위한 다른 하이퍼파라미터를 설정합니다. 이러한 매개변수는 전통적인 ML 하이퍼파라미터 검색을 통해 정의할 수 있습니다. dist, mu 및 sigma 값을 변경하여 일부 회귀 지표를 최적화합니다. 더 높은 표준 편차 값(sigma)은 모델에 더 많은 자유를 제공하여 최적의 매개변수를 탐색할 수 있음을 기억하세요.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emy_model_config = {\u003cspan class=\"hljs-string\"\u003e'intercept'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Normal'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'mu'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'sigma'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e},\n \u003cspan class=\"hljs-string\"\u003e'beta_channel'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'HalfNormal'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'sigma'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e},\n \u003cspan class=\"hljs-string\"\u003e'alpha'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Beta'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'alpha'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'beta'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e},\n \u003cspan class=\"hljs-string\"\u003e'lam'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Gamma'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'alpha'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'beta'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e},\n \u003cspan class=\"hljs-string\"\u003e'likelihood'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Normal'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'sigma'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'HalfNormal'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'sigma'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e}},\n \u003cspan class=\"hljs-string\"\u003e'gamma_control'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Normal'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'mu'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'sigma'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e},\n \u003cspan class=\"hljs-string\"\u003e'gamma_fourier'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'dist'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Laplace'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kwargs'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'mu'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'b'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}}}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_18.png\"\u003e\n\u003cp\u003eFigure 13에서 저희가 구현한 모델의 Kruschke 다이어그램을 제시합니다. 이는 이전에 정의한 내용에 대한 간결한 개요를 제공합니다. 이러한 다이어그램을 해석할 때 고려해야 할 몇 가지 측면이 있습니다. 각 노드 내에서 변수와 해당 분포를 찾을 수 있음을 유의하십시오. 예를 들어, α를 포함하는 원은 이전에 정의한 대로 베타 분포를 나타냅니다. 음영 처리된 노드는 관측된 변수를 나타냅니다. 둥근 모서리 상자는 반복을 나타냅니다. 예를 들어, 저희는 세 개의 확보 채널이 있으므로 각 채널에 대해 별도의 α, β 및 λ 매개변수 집합을 설정합니다. 화살표는 종속성을 보여줍니다. 저희 모델에서는 두 개의 화살표가 가능 함수를 가리키는데, 하나는 mu 매개변수에 종속성을 나타내고 다른 하나는 sigma 매개변수에 종속성을 나타냅니다. mu 매개변수 자체가 세 개의 추가 종속성을 가지고 있음을 상기해 주세요. 우리는 이동 효과, 모양 효과 및 제어 변수를 통합하여 매출을 모델링하기로 선택했음을 기억하세요.\u003c/p\u003e\n\u003cp\u003e이제 우리는 교육 및 테스트 세트, 그리고 모델 구성을 정의했으므로 베이지안 모델을 초기화하고 교육 데이터에 맞출 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e미디어 채널 [\"tv\", \"radio\", \"newspaper\"]\u003c/li\u003e\n\u003cli\u003e통제 변수 [\"seasonality\", \"trend\"]\u003c/li\u003e\n\u003cli\u003eEDA에서 광고주는 지연 매개변수로 최대 2까지 인 것으로 보입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emmm = \u003cspan class=\"hljs-title class_\"\u003eDelayedSaturatedMMM\u003c/span\u003e(\n    model_config=my_model_config,\n    sampler_config={\u003cspan class=\"hljs-string\"\u003e\"progressbar\"\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e},\n    date_column=\u003cspan class=\"hljs-string\"\u003e\"ds\"\u003c/span\u003e,\n    channel_columns=[\u003cspan class=\"hljs-string\"\u003e\"tv\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"radio\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"newspaper\"\u003c/span\u003e],\n    control_columns=[\u003cspan class=\"hljs-string\"\u003e\"seasonality\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"trend\"\u003c/span\u003e],\n    adstock_max_lag=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n)\n\nmmm.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(X=train_df[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"newspaper\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"seasonality\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"trend\"\u003c/span\u003e]], y=train_df[\u003cspan class=\"hljs-string\"\u003e'sales'\u003c/span\u003e], target_accept=\u003cspan class=\"hljs-number\"\u003e0.95\u003c/span\u003e, chains=\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, random_seed=\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e모델을 적합한 후에는 샘플링 예측값(파란색)과 실제 값(검은색)을 비교하여 학습 데이터에 얼마나 잘 맞는지 확인할 수 있습니다. 우리의 경우, 그들이 잘 일치하는 것을 확인할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emmm.\u003cspan class=\"hljs-title function_\"\u003esample_posterior_predictive\u003c/span\u003e(train_df[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"newspaper\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"seasonality\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"trend\"\u003c/span\u003e]], extend_idata=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e, combined=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\nmmm.\u003cspan class=\"hljs-title function_\"\u003eplot_posterior_predictive\u003c/span\u003e(original_scale=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이제 다양한 방법으로 모델 해석을 시작할 수 있습니다:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e파라미터 추정 확인:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e라디오는 계수(베타)가 가장 높으므로 투자 대비 가장 높은 수익을 보이는 것으로 보입니다(1.185), 그 다음에 TV와 신문이 이어집니다.\u003c/li\u003e\n\u003cli\u003e유지율 α는 TV에 대해 3.2%, 라디오에 대해 2.3%, 신문에 대해 23.9%입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eaz.\u003cspan class=\"hljs-title function_\"\u003esummary\u003c/span\u003e(data=mmm.\u003cspan class=\"hljs-property\"\u003efit_result\u003c/span\u003e,\n    var_names=[\n        \u003cspan class=\"hljs-string\"\u003e\"intercept\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"likelihood_sigma\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"beta_channel\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"alpha\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"lam\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"gamma_control\"\u003c/span\u003e,\n    ],\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eTV에서 포화율 λ가 더 높으며 (3.138), 전체 지출의 73%를 차지합니다. 그림 12에서 3개 채널의 포화율을 더 쉽게 비교할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_19.png\" alt=\"Figure 12\"\u003e\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e채널 기여 및 ROAS 확인:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eROAS는 매체 채널 중 하나의 지출을 제로로 설정하여 현재 매출 대비 예측 매출이 어떻게 변경되는지를 평가하여 계산됩니다. 예를 들어, 신문의 매체 지출을 제로로 설정하면 매출 큰 감소를 예상하지 않습니다. 따라서, 이에 대한 ROAS는 낮을 것입니다.\u003c/li\u003e\n\u003cli\u003eTV가 높은 지출을 했기 때문에 가장 큰 기여를 가지고 있지만, 모델은 라디오에 대해 더 높은 ROAS를 예측합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 채널의 공헌도\nfig = mmm.\u003cspan class=\"hljs-title function_\"\u003eplot_channel_contribution_share_hdi\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eROAS\u003c/span\u003e 계산\nutils.\u003cspan class=\"hljs-title function_\"\u003eplot_ROAS\u003c/span\u003e(mmm, train_df, [\u003cspan class=\"hljs-string\"\u003e\"tv\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"radio\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"newspaper\"\u003c/span\u003e])\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e마지막으로, 각 채널별 광고비 지출을 50% 증가시킨다면 어떤 일이 일어날지도 평가할 수 있습니다. 이때는 캐리오버와 포화 효과를 고려합니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eX 축은 채널 데이터 백분율 수준입니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen =1 일 때, 모델 입력 지출 데이터가 됩니다.\u003c/li\u003e\n\u003cli\u003eWhen =1.5 일 때, 지출을 50% 증가시켰을 때의 공헌도가 어떨지 볼 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e신문은 지출이 50% 증가해도 그다지 많은 기여를 못 할 것 같아요.\u003c/p\u003e\n\u003cp\u003e라디오는 TV에 비해 훨씬 포화되지 않아 보여요. 두 선의 기울기를 비교해 봤을 때 그렇죠.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eplt.\u003cspan class=\"hljs-property\"\u003ercParams\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"figure.figsize\"\u003c/span\u003e] = (\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\nmmm.\u003cspan class=\"hljs-title function_\"\u003eplot_channel_contributions_grid\u003c/span\u003e(start=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, stop=\u003cspan class=\"hljs-number\"\u003e1.5\u003c/span\u003e, num=\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e우리의 결론이 올바른지 확인하기 위해 시험 집합을 사용하여 미디어 채널과 제어 변수를 기반으로 미래 매출을 예측하는 모델의 성능을 평가할 수 있어요. 이를 위해 MAE를 사용하고 소박한 모델과 비교할 거에요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e우리는 평균 목표가 13.8인 경우 MAE가 2.01이었습니다.\u003c/li\u003e\n\u003cli\u003e우리는 베이스라인보다 오차가 58% 낮습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ey_out_of_sample = mmm.\u003cspan class=\"hljs-title function_\"\u003esample_posterior_predictive\u003c/span\u003e(X_pred=test_df[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"newspaper\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"seasonality\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"trend\"\u003c/span\u003e]], extend_idata=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\ny_pred = [np.\u003cspan class=\"hljs-title function_\"\u003emedian\u003c/span\u003e(x) \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e y_out_of_sample[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e]]\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"평균 절대 오차 (MAE): {mean_absolute_error(test_df['sales'], y_pred)} (평균 목표: {test_df['sales'].mean()})\"\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"평균 절대 비율 오차 (MASE): {mean_absolute_error(test_df['sales'], y_pred)/mean_absolute_error(test_df['sales'], [train_df['sales'].mean()]*5)}\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e회귀 결과는 모델이 매체 채널과 제어 변수를 기반으로 매출을 모델링하기에 신뢰할만하고 잘 한다는 것을 보여줍니다.\u003c/p\u003e\n\u003ch1\u003e예산 할당\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e판매에 대한 지출 효과가 선형적이지 않을 것으로 가정하기 때문에 어느 시점에서 포화될 것으로 예상됩니다. 따라서, 우리는 어떤 포화 함수가 우리의 데이터와 더 잘 맞는지 결정해야 합니다. 포화 모델링을 위한 두 가지 함수 옵션이 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eα(alpha)가 포화 지점인 시그모이드 함수, 즉 지출 증가가 판매 증가로 이어지지 않고, λ(lambda)는 곡선의 기울기를 제어하는 요인입니다. 더 높은 값은 곡선을 더 가파르게 만듭니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_20.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e알파(alpha)가 채널이 가질 수 있는 최대 기여도인 Michaelis-Menten 함수이며, 람다(lambda)는 곡선이 방향을 조정하는 순간, 즉 기울기입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_21.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e저희 데이터에 더 적합한 곡선을 결정하기 위해, 적합된 MMM을 사용하여 각 함수의 매개변수를 계산할 것입니다. 그 후 두 가지를 모두 플롯하고 시각적으로 어느 것이 더 적합한지 확인할 것입니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e특정 사용 사례에서, 시그모이드 함수가 더 나은 결과를 보였습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 플롯 및 알파, 람다 추출\nsigmoid_response_curve_fig = mmm.\u003cspan class=\"hljs-title function_\"\u003eplot_direct_contribution_curves\u003c/span\u003e(show_fit=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\nsigmoid_params = mmm.\u003cspan class=\"hljs-title function_\"\u003ecompute_channel_curve_optimization_parameters_original_scale\u003c/span\u003e(method=\u003cspan class=\"hljs-string\"\u003e'sigmoid'\u003c/span\u003e)\n\nmm_response_curve_fig = mmm.\u003cspan class=\"hljs-title function_\"\u003eplot_direct_contribution_curves\u003c/span\u003e(show_fit=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e, method=\u003cspan class=\"hljs-string\"\u003e'michaelis-menten'\u003c/span\u003e)\nmm_params = mmm.\u003cspan class=\"hljs-title function_\"\u003ecompute_channel_curve_optimization_parameters_original_scale\u003c/span\u003e(method=\u003cspan class=\"hljs-string\"\u003e'michaelis-menten'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이제 각 미디어 채널의 시그모이드 매개변수(α 및 λ)가 있으므로 각 채널의 포화점을 알 수 있습니다. 따라서 추가 지출은 수익을 증가시키지 않을 것이며, 다른 채널에 투자된 금액은 원하는 효과를 얻을 수 있습니다.\u003c/p\u003e\n\u003cp\u003e채널 포화도를 기반으로 한 예산 할당을 최적화하기 위한 알고리즘을 사용할 수 있습니다. 이 때 고려해야 할 세 가지 변수는 채널 포화도, 사용 가능한 총 예산 및 각 채널의 예산 제약 사항입니다. PyMC에는 Sequential Least Squares Quadratic Programming (SLSQP)을 구현한 것이 있습니다. 이는 세 가지 변수를 고려하여 모든 채널에서 총 기여도를 최대화합니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e총 예산 제한;\u003c/li\u003e\n\u003cli\u003e각 채널의 최소 및 최대 지출 한도;\u003c/li\u003e\n\u003cli\u003e포화 곡선.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eresult_sigmoid = mmm.optimize_channel_budget_for_maximum_contribution(\n    method=\u003cspan class=\"hljs-string\"\u003e'sigmoid'\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e# 포화 함수를 정의\u003c/span\u003e\n    total_budget=\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e# 총 예산\u003c/span\u003e\n    parameters=sigmoid_params, \u003cspan class=\"hljs-comment\"\u003e# 이전에 추출한 시그모이드 매개변수\u003c/span\u003e\n    budget_bounds={\u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e75\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e296\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e'newspaper'\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e]} \u003cspan class=\"hljs-comment\"\u003e# 채널별 예산 제약 사항\u003c/span\u003e\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS_22.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e표 4는 우리의 예산 배정 결과를 보여줍니다. 라디오는 추정 기여도가 가장 높은 채널이며, TV는 가장 높은 예산을 쓰도록 권장받은 채널입니다.\u003c/p\u003e\n\u003ch1\u003e시장 불확실성 하의 예산 배정\u003c/h1\u003e\n\u003cp\u003e현재 경제 상황에서 많은 불확실성을 겪고 있습니다. 따라서, 다양한 시나리오를 수용할 수 있는 예산 배정 전략을 설계해야 합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e세 가지 다른 시나리오를 고려해 봅시다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e초기: 경제가 안정 상태를 유지하며, 예산 할당은 이전 섹션에서 계산된 것과 동일합니다.\u003c/li\u003e\n\u003cli\u003e시나리오 2: 경제가 경기 침체를 겪고 예산이 40% 삭감됩니다.\u003c/li\u003e\n\u003cli\u003e시나리오 3: 경제가 유리해지고 성장을 시작하며, 예산이 20% 증가합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이러한 다른 시나리오에서 예산 할당을 최적화하기 위해 동일한 적합된 MMM 모델과 모델의 시그모이드 매개변수를 사용할 것입니다. 같은 코드를 사용하지만 이번에는 사용 가능한 예산을 줄이거나 증가시키기 위해 다른 시나리오를 반복할 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003escenarios_result = []\ntotal_budget = \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e\nchannels = [\u003cspan class=\"hljs-string\"\u003e'tv'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'radio'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'newspaper'\u003c/span\u003e]\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e scenario \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e np.\u003cspan class=\"hljs-title function_\"\u003earray\u003c/span\u003e([\u003cspan class=\"hljs-number\"\u003e0.6\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1.2\u003c/span\u003e]):\n    scenarios_result.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(\n        mmm.\u003cspan class=\"hljs-title function_\"\u003eoptimize_channel_budget_for_maximum_contribution\u003c/span\u003e(\n            method=\u003cspan class=\"hljs-string\"\u003e\"sigmoid\"\u003c/span\u003e,  # 포화 함수 정의\n            total_budget=total_budget * scenario,\n            parameters=sigmoid_params,\n            budget_bounds={\n                \u003cspan class=\"hljs-attr\"\u003echannel\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, total_budget * scenario] \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e channel \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e channels\n            },\n        ).\u003cspan class=\"hljs-title function_\"\u003eto_dict\u003c/span\u003e()\n    )\n_ = mmm.\u003cspan class=\"hljs-title function_\"\u003eplot_budget_scenearios\u003c/span\u003e(\n    base_data=result_sigmoid, method=\u003cspan class=\"hljs-string\"\u003e\"sigmoid\"\u003c/span\u003e, scenarios_data=scenarios_result\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e그림 19에서 보듯이, 경제 불황 시나리오에서 TV에 할당된 예산은 초기 시나리오와 비교했을 때 라디오보다 크게 감소합니다. 이는 라디오의 ROAS가 높기 때문에 예상되는 현상입니다. 반면, 성장 시나리오에서는 TV와 라디오에 할당된 예산이 유사하게 증가합니다.\u003c/p\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003e미디어믹스 모델링을 위한 AI는 투자에서 긍정적인 수익을 창출하고 가치 있는 충성고객을 확보하는 차이를 만들어줄 수 있습니다. 또는 잘못된 미디어 채널과 잘못된 고객에게 금전적 자원을 낭비하는 것 사이의 차이를 만들어줄 수도 있습니다.\u003c/p\u003e\n\u003cp\u003e본 문서에서는 각 회사의 미디어 채널이 새로운 고객을 확보할 수 있는 잠재력을 더 자세히 평가하고 투명성을 제공할 수 있는 마케팅 믹스 모델링을 위한 베이지안 프레임워크를 개발했습니다. 우리의 접근 방식은 마케팅팀의 도메인 지식을 사전 분포를 설정함으로써 통합할 수 있습니다. 이는 모델의 능력을 향상시키고 미디어 채널과 관심 변수(예: 판매) 간의 관계를 이해하는데 도움이 됩니다. 마지막으로, 회사가 새로운 고객을 확보하기 위해 투자할 능력에 따라 예산 할당 전략을 최적화할 수 있습니다. 현재의 거시 경제 상황에서 기업은 수익성으로 돌아갈 수 있으며 성장에 투자할 예산을 줄일 수 있습니다. 우리는 영향을 최소화하면서 어디서 예산을 삭감할지에 대한 데이터 기반 의사결정 방법을 보여주었습니다. 반대로, 상황이 긍정적일 때 어디에 투자할지와 회사가 더 빨리 성장하기 위해 더 많은 자원을 투입하려는 경우 어디에 투자할지를 보여주었습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e우리는 현재 기관들에 새로운 AI 애플리케이션을 개발하고 배포하고 있어요. 예를 들어, 우리는 생성 모델 AI로 고객 경험을 향상시키고 시계열 예측으로 계획 프로세스를 개선하고 있어요. 이 경우에는 AI가 마케팅 예산의 효율성을 향상시킬 수 있는 방법을 보여주고 있어요. 우리의 경험에 따르면, AI 채택 측면에서 선진적이고 성숙한 기관은 핵심 활동에 중점을 둔 특화된 AI 모델 스위트가 필요해요.\u003c/p\u003e\n\u003ch1\u003e나에 대해\u003c/h1\u003e\n\u003cp\u003eAI 분야의 시리얼 창업가이자 리더에요. 비즈니스를 위한 AI 제품을 개발하고 AI 중심의 스타트업에 투자하고 있어요.\u003c/p\u003e\n\u003cp\u003eZAAI 설립자 | LinkedIn | X/Twitter\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e참고문헌\u003c/h1\u003e\n\u003cp\u003e[1] Yuxue Jin, Yueqing Wang, Yunting Sun, David Chan, Jim Koehler. (2017). Bayesian Methods for Media Mix Modeling with Carryover and Shape Effects.\u003c/p\u003e\n\u003cp\u003e[2] Dominique M. Hanssens , Leonard J. Parsons , Randall L. Schultz. (2003). Market response models: econometric and time series analysis. Springer Science \u0026#x26; Business Media.\u003c/p\u003e\n\u003cp\u003e[3] Hill, A. V. (1910). 혈색소 분자의 집단화가 분리 곡선에 미치는 가능한 영향. Journal of Physiology, 40 (suppl), iv–vii. doi:10.1113/jphysiol.1910. sp001386.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e[4] Gelfand, A. E. \u0026#x26; Smith, A. F. (1990). Sampling-based approaches to calculating marginal densities. Journal of the American statistical association, 85 (410), 398–409\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e모든 이미지는 저자의 작품이며, 다르게 표기되지 않았습니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-20-MMMBayesianFrameworkforMarketingMixModelingandROAS"},"buildId":"Y-fCAg8BUV7y2HNFwX9AA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>